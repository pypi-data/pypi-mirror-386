var Pe=Object.defineProperty;var a=(e,t)=>Pe(e,"name",{value:t,configurable:!0});import{P as O,a as I,N as it,S as F,f as Oe,c as xt,T as Ie,l as Be,b as He,d as L,e as Ne,g as Re,F as B,j as ze,h as _e,i as je,k as De,m as te,n as Fe,o as We,p as Ve,q as Ke,r as qe,s as Ue,t as Ge,u as Je,v as Xe,w as Ye,x as Qe,y as Ot,z as Ze,A as Z,B as tn,C as en,D as nn,E as rn,G as ee,H as tt,R as sn,I as on,J as an,K as ln,L as cn,M as dn,O as It,Q as ne,U as un,V as pn,W as fn,X as hn,Y as mn,Z as gn,_ as kn,$ as bn,a0 as yn,a1 as Bt,a2 as Ht,a3 as Nt,a4 as Mn,a5 as vn,a6 as Rt,a7 as wn,a8 as re,a9 as Tn,aa as xn,ab as Sn,ac as Cn,ad as An,ae as En,af as Ln,ag as se,ah as R,ai as $n,aj as Pn}from"./vendor-other-CSnDbCIp.js";function at(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}a(at,"createChainableState");class lt{static{a(this,"CommandManager")}constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:r}=this,{view:s}=n,{tr:o}=r,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([l,c])=>[l,a((...p)=>{const u=c(...p)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(o),u},"method")]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,l=[],c=!!t,d=t||o.tr,p=a(()=>(!c&&n&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(d),l.every(f=>f===!0)),"run"),u={...Object.fromEntries(Object.entries(r).map(([f,h])=>[f,a((...g)=>{const b=this.buildProps(d,n),k=h(...g)(b);return l.push(k),u},"chainedCommand")])),run:p};return u}createCan(t){const{rawCommands:n,state:r}=this,s=!1,o=t||r.tr,i=this.buildProps(o,s);return{...Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...p)=>d(...p)({...i,dispatch:void 0})])),chain:a(()=>this.createChain(o,s),"chain")}}buildProps(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,l={tr:t,editor:s,view:i,state:at({state:o,transaction:t}),dispatch:n?()=>{}:void 0,chain:a(()=>this.createChain(t,n),"chain"),can:a(()=>this.createCan(t),"can"),get commands(){return Object.fromEntries(Object.entries(r).map(([c,d])=>[c,(...p)=>d(...p)(l)]))}};return l}}class On{static{a(this,"EventEmitter")}constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const r=this.callbacks[t];return r&&r.forEach(s=>s.apply(this,n)),this}off(t,n){const r=this.callbacks[t];return r&&(n?this.callbacks[t]=r.filter(s=>s!==n):delete this.callbacks[t]),this}once(t,n){const r=a((...s)=>{this.off(t,r),n.apply(this,s)},"onceFn");return this.on(t,r)}removeAllListeners(){this.callbacks={}}}function y(e,t,n){return e.config[t]===void 0&&e.parent?y(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?y(e.parent,t,n):null}):e.config[t]}a(y,"getExtensionField");function ct(e){const t=e.filter(s=>s.type==="extension"),n=e.filter(s=>s.type==="node"),r=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}a(ct,"splitExtensions");function oe(e){const t=[],{nodeExtensions:n,markExtensions:r}=ct(e),s=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const l={name:i.name,options:i.options,storage:i.storage,extensions:s},c=y(i,"addGlobalAttributes",l);if(!c)return;c().forEach(p=>{p.types.forEach(u=>{Object.entries(p.attributes).forEach(([f,h])=>{t.push({type:u,name:f,attribute:{...o,...h}})})})})}),s.forEach(i=>{const l={name:i.name,options:i.options,storage:i.storage},c=y(i,"addAttributes",l);if(!c)return;const d=c();Object.entries(d).forEach(([p,u])=>{const f={...o,...u};typeof f?.default=="function"&&(f.default=f.default()),f?.isRequired&&f?.default===void 0&&delete f.default,t.push({type:i.name,name:p,attribute:f})})}),t}a(oe,"getAttributesFromExtensions");function A(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}a(A,"getNodeType");function x(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r={...t};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const l=o?o.split(" "):[],c=r[s]?r[s].split(" "):[],d=l.filter(p=>!c.includes(p));r[s]=[...c,...d].join(" ")}else if(s==="style"){const l=o?o.split(";").map(p=>p.trim()).filter(Boolean):[],c=r[s]?r[s].split(";").map(p=>p.trim()).filter(Boolean):[],d=new Map;c.forEach(p=>{const[u,f]=p.split(":").map(h=>h.trim());d.set(u,f)}),l.forEach(p=>{const[u,f]=p.split(":").map(h=>h.trim());d.set(u,f)}),r[s]=Array.from(d.entries()).map(([p,u])=>`${p}: ${u}`).join("; ")}else r[s]=o}),r},{})}a(x,"mergeAttributes");function bt(e,t){return t.filter(n=>n.type===e.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>x(n,r),{})}a(bt,"getRenderedAttributes");function ie(e){return typeof e=="function"}a(ie,"isFunction");function v(e,t=void 0,...n){return ie(e)?t?e.bind(t)(...n):e(...n):e}a(v,"callOrReturn");function In(e={}){return Object.keys(e).length===0&&e.constructor===Object}a(In,"isEmptyObject");function Bn(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}a(Bn,"fromString");function zt(e,t){return"style"in e?e:{...e,getAttrs:a(n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(r===!1)return!1;const s=t.reduce((o,i)=>{const l=i.attribute.parseHTML?i.attribute.parseHTML(n):Bn(n.getAttribute(i.name));return l==null?o:{...o,[i.name]:l}},{});return{...r,...s}},"getAttrs")}}a(zt,"injectExtensionAttributesToParseRule");function _t(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&In(n)?!1:n!=null))}a(_t,"cleanUpSchemaItem");function Hn(e,t){var n;const r=oe(e),{nodeExtensions:s,markExtensions:o}=ct(e),i=(n=s.find(d=>y(d,"topNode")))===null||n===void 0?void 0:n.name,l=Object.fromEntries(s.map(d=>{const p=r.filter(k=>k.type===d.name),u={name:d.name,options:d.options,storage:d.storage,editor:t},f=e.reduce((k,M)=>{const T=y(M,"extendNodeSchema",u);return{...k,...T?T(d):{}}},{}),h=_t({...f,content:v(y(d,"content",u)),marks:v(y(d,"marks",u)),group:v(y(d,"group",u)),inline:v(y(d,"inline",u)),atom:v(y(d,"atom",u)),selectable:v(y(d,"selectable",u)),draggable:v(y(d,"draggable",u)),code:v(y(d,"code",u)),whitespace:v(y(d,"whitespace",u)),linebreakReplacement:v(y(d,"linebreakReplacement",u)),defining:v(y(d,"defining",u)),isolating:v(y(d,"isolating",u)),attrs:Object.fromEntries(p.map(k=>{var M;return[k.name,{default:(M=k?.attribute)===null||M===void 0?void 0:M.default}]}))}),m=v(y(d,"parseHTML",u));m&&(h.parseDOM=m.map(k=>zt(k,p)));const g=y(d,"renderHTML",u);g&&(h.toDOM=k=>g({node:k,HTMLAttributes:bt(k,p)}));const b=y(d,"renderText",u);return b&&(h.toText=b),[d.name,h]})),c=Object.fromEntries(o.map(d=>{const p=r.filter(b=>b.type===d.name),u={name:d.name,options:d.options,storage:d.storage,editor:t},f=e.reduce((b,k)=>{const M=y(k,"extendMarkSchema",u);return{...b,...M?M(d):{}}},{}),h=_t({...f,inclusive:v(y(d,"inclusive",u)),excludes:v(y(d,"excludes",u)),group:v(y(d,"group",u)),spanning:v(y(d,"spanning",u)),code:v(y(d,"code",u)),attrs:Object.fromEntries(p.map(b=>{var k;return[b.name,{default:(k=b?.attribute)===null||k===void 0?void 0:k.default}]}))}),m=v(y(d,"parseHTML",u));m&&(h.parseDOM=m.map(b=>zt(b,p)));const g=y(d,"renderHTML",u);return g&&(h.toDOM=b=>g({mark:b,HTMLAttributes:bt(b,p)})),[d.name,h]}));return new ee({topNode:i,nodes:l,marks:c})}a(Hn,"getSchemaByResolvedExtensions");function ht(e,t){return t.nodes[e]||t.marks[e]||null}a(ht,"getSchemaTypeByName");function jt(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}a(jt,"isExtensionRulesEnabled");function G(e,t){const n=cn.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}a(G,"getHTMLFromFragment");const Nn=a((e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(s,o,i,l)=>{var c,d;const p=((d=(c=s.type.spec).toText)===null||d===void 0?void 0:d.call(c,{node:s,pos:o,parent:i,index:l}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?p:p.slice(0,Math.max(0,r-o))}),n},"getTextContentFromNodes");function St(e){return Object.prototype.toString.call(e)==="[object RegExp]"}a(St,"isRegExp");class dt{static{a(this,"InputRule")}constructor(t){this.find=t.find,this.handler=t.handler}}const Rn=a((e,t)=>{if(St(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r},"inputRuleMatcherHandler");function J(e){var t;const{editor:n,from:r,to:s,text:o,rules:i,plugin:l}=e,{view:c}=n;if(c.composing)return!1;const d=c.state.doc.resolve(r);if(d.parent.type.spec.code||!((t=d.nodeBefore||d.nodeAfter)===null||t===void 0)&&t.marks.find(f=>f.type.spec.code))return!1;let p=!1;const u=Nn(d)+o;return i.forEach(f=>{if(p)return;const h=Rn(u,f.find);if(!h)return;const m=c.state.tr,g=at({state:c.state,transaction:m}),b={from:r-(h[0].length-o.length),to:s},{commands:k,chain:M,can:T}=new lt({editor:n,state:g});f.handler({state:g,range:b,match:h,commands:k,chain:M,can:T})===null||!m.steps.length||(m.setMeta(l,{transform:m,from:r,to:s,text:o}),c.dispatch(m),p=!0)}),p}a(J,"run$1");function zn(e){const{editor:t,rules:n}=e,r=new O({state:{init(){return null},apply(s,o,i){const l=s.getMeta(r);if(l)return l;const c=s.getMeta("applyInputRules");return!!c&&setTimeout(()=>{let{text:p}=c;typeof p=="string"?p=p:p=G(B.from(p),i.schema);const{from:u}=c,f=u+p.length;J({editor:t,from:u,to:f,text:p,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,i,l){return J({editor:t,from:o,to:i,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:a(s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&J({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1),"compositionend")},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?J({editor:t,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}a(zn,"inputRulesPlugin");function _n(e){return Object.prototype.toString.call(e).slice(8,-1)}a(_n,"getType");function X(e){return _n(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}a(X,"isPlainObject");function ut(e,t){const n={...e};return X(e)&&X(t)&&Object.keys(t).forEach(r=>{X(t[r])&&X(e[r])?n[r]=ut(e[r],t[r]):n[r]=t[r]}),n}a(ut,"mergeDeep");class ${static{a(this,"Mark")}constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=v(y(this,"addOptions",{name:this.name}))),this.storage=v(y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new $(t)}configure(t={}){const n=this.extend({...this.config,addOptions:a(()=>ut(this.options,t),"addOptions")});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new $(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=v(y(n,"addOptions",{name:n.name})),n.storage=v(y(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:r}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(d=>d?.type.name===n.name))return!1;const c=i.find(d=>d?.type.name===n.name);return c&&r.removeStoredMark(c),r.insertText(" ",s.pos),t.view.dispatch(r),!0}return!1}}function jn(e){return typeof e=="number"}a(jn,"isNumber");class Dn{static{a(this,"PasteRule")}constructor(t){this.find=t.find,this.handler=t.handler}}const Fn=a((e,t,n)=>{if(St(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=e,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]},"pasteRuleMatcherHandler");function Wn(e){const{editor:t,state:n,from:r,to:s,rule:o,pasteEvent:i,dropEvent:l}=e,{commands:c,chain:d,can:p}=new lt({editor:t,state:n}),u=[];return n.doc.nodesBetween(r,s,(h,m)=>{if(!h.isTextblock||h.type.spec.code)return;const g=Math.max(r,m),b=Math.min(s,m+h.content.size),k=h.textBetween(g-m,b-m,void 0,"￼");Fn(k,o.find,i).forEach(T=>{if(T.index===void 0)return;const C=g+T.index+1,S=C+T[0].length,P={from:n.tr.mapping.map(C),to:n.tr.mapping.map(S)},H=o.handler({state:n,range:P,match:T,commands:c,chain:d,can:p,pasteEvent:i,dropEvent:l});u.push(H)})}),u.every(h=>h!==null)}a(Wn,"run");const Vn=a(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=n.clipboardData)===null||t===void 0||t.setData("text/html",e),n},"createClipboardPasteEvent");function Kn(e){const{editor:t,rules:n}=e;let r=null,s=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const c=a(({state:p,from:u,to:f,rule:h,pasteEvt:m})=>{const g=p.tr,b=at({state:p,transaction:g});if(!(!Wn({editor:t,state:b,from:Math.max(u-1,0),to:f.b-1,rule:h,pasteEvent:m,dropEvent:l})||!g.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}},"processEvent");return n.map(p=>new O({view(u){const f=a(h=>{var m;r=!((m=u.dom.parentElement)===null||m===void 0)&&m.contains(h.target)?u.dom.parentElement:null},"handleDragstart");return window.addEventListener("dragstart",f),{destroy(){window.removeEventListener("dragstart",f)}}},props:{handleDOMEvents:{drop:a((u,f)=>(o=r===u.dom.parentElement,l=f,!1),"drop"),paste:a((u,f)=>{var h;const m=(h=f.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return i=f,s=!!m?.includes("data-pm-slice"),!1},"paste")}},appendTransaction:a((u,f,h)=>{const m=u[0],g=m.getMeta("uiEvent")==="paste"&&!s,b=m.getMeta("uiEvent")==="drop"&&!o,k=m.getMeta("applyPasteRules"),M=!!k;if(!g&&!b&&!M)return;if(M){let{text:S}=k;typeof S=="string"?S=S:S=G(B.from(S),h.schema);const{from:P}=k,H=P+S.length,N=Vn(S);return c({rule:p,state:h,from:P,to:{b:H},pasteEvt:N})}const T=f.doc.content.findDiffStart(h.doc.content),C=f.doc.content.findDiffEnd(h.doc.content);if(!(!jn(T)||!C||T===C.b))return c({rule:p,state:h,from:T,to:C,pasteEvt:i})},"appendTransaction")}))}a(Kn,"pasteRulesPlugin");function qn(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return Array.from(new Set(t))}a(qn,"findDuplicates");class V{static{a(this,"ExtensionManager")}constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=V.resolve(t),this.schema=Hn(this.extensions,n),this.setupExtensions()}static resolve(t){const n=V.sort(V.flatten(t)),r=qn(n.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},s=y(n,"addExtensions",r);return s?[n,...this.flatten(s())]:n}).flat(10)}static sort(t){return t.sort((r,s)=>{const o=y(r,"priority")||100,i=y(s,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:ht(n.name,this.schema)},s=y(n,"addCommands",r);return s?{...t,...s()}:t},{})}get plugins(){const{editor:t}=this,n=V.sort([...this.extensions].reverse()),r=[],s=[],o=n.map(i=>{const l={name:i.name,options:i.options,storage:i.storage,editor:t,type:ht(i.name,this.schema)},c=[],d=y(i,"addKeyboardShortcuts",l);let p={};if(i.type==="mark"&&y(i,"exitable",l)&&(p.ArrowRight=()=>$.handleExit({editor:t,mark:i})),d){const g=Object.fromEntries(Object.entries(d()).map(([b,k])=>[b,()=>k({editor:t})]));p={...p,...g}}const u=dn(p);c.push(u);const f=y(i,"addInputRules",l);jt(i,t.options.enableInputRules)&&f&&r.push(...f());const h=y(i,"addPasteRules",l);jt(i,t.options.enablePasteRules)&&h&&s.push(...h());const m=y(i,"addProseMirrorPlugins",l);if(m){const g=m();c.push(...g)}return c}).flat();return[zn({editor:t,rules:r}),...Kn({editor:t,rules:s}),...o]}get attributes(){return oe(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=ct(this.extensions);return Object.fromEntries(n.filter(r=>!!y(r,"addNodeView")).map(r=>{const s=this.attributes.filter(c=>c.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:t,type:A(r.name,this.schema)},i=y(r,"addNodeView",o);if(!i)return[];const l=a((c,d,p,u,f)=>{const h=bt(c,s);return i()({node:c,view:d,getPos:p,decorations:u,innerDecorations:f,editor:t,extension:r,HTMLAttributes:h})},"nodeview");return[r.name,l]}))}setupExtensions(){this.extensions.forEach(t=>{var n;this.editor.extensionStorage[t.name]=t.storage;const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:ht(t.name,this.schema)};t.type==="mark"&&(!((n=v(y(t,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(t.name);const s=y(t,"onBeforeCreate",r),o=y(t,"onCreate",r),i=y(t,"onUpdate",r),l=y(t,"onSelectionUpdate",r),c=y(t,"onTransaction",r),d=y(t,"onFocus",r),p=y(t,"onBlur",r),u=y(t,"onDestroy",r);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),i&&this.editor.on("update",i),l&&this.editor.on("selectionUpdate",l),c&&this.editor.on("transaction",c),d&&this.editor.on("focus",d),p&&this.editor.on("blur",p),u&&this.editor.on("destroy",u)})}}class E{static{a(this,"Extension")}constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=v(y(this,"addOptions",{name:this.name}))),this.storage=v(y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new E(t)}configure(t={}){const n=this.extend({...this.config,addOptions:a(()=>ut(this.options,t),"addOptions")});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new E({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=v(y(n,"addOptions",{name:n.name})),n.storage=v(y(n,"addStorage",{name:n.name,options:n.options})),n}}function ae(e,t,n){const{from:r,to:s}=t,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let l="";return e.nodesBetween(r,s,(c,d,p,u)=>{var f;c.isBlock&&d>r&&(l+=o);const h=i?.[c.type.name];if(h)return p&&(l+=h({node:c,pos:d,parent:p,index:u,range:t})),!1;c.isText&&(l+=(f=c?.text)===null||f===void 0?void 0:f.slice(Math.max(r,d)-d,s-d))}),l}a(ae,"getTextBetween");function le(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}a(le,"getTextSerializersFromSchema");const ce=E.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new O({key:new I("clipboardTextSerializer"),props:{clipboardTextSerializer:a(()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:s}=t,{ranges:o}=s,i=Math.min(...o.map(p=>p.$from.pos)),l=Math.max(...o.map(p=>p.$to.pos)),c=le(n);return ae(r,{from:i,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})},"clipboardTextSerializer")}})]}}),Un=a(()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window?.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),"blur"),Gn=a((e=!1)=>({commands:t})=>t.setContent("",e),"clearContent"),Jn=a(()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{e.doc.nodesBetween(o.pos,i.pos,(l,c)=>{if(l.type.isText)return;const{doc:d,mapping:p}=t,u=d.resolve(p.map(c)),f=d.resolve(p.map(c+l.nodeSize)),h=u.blockRange(f);if(!h)return;const m=Be(h);if(l.type.isTextblock){const{defaultType:g}=u.parent.contentMatchAt(u.index());t.setNodeMarkup(h.start,g)}(m||m===0)&&t.lift(h,m)})}),!0},"clearNodes"),Xn=a(e=>t=>e(t),"command"),Yn=a(()=>({state:e,dispatch:t})=>He(e,t),"createParagraphNear"),Qn=a((e,t)=>({editor:n,tr:r})=>{const{state:s}=n,o=s.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const i=r.mapping.map(t);return r.insert(i,o.content),r.setSelection(new L(r.doc.resolve(i-1))),!0},"cut"),Zn=a(()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(t){const l=s.before(o),c=s.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},"deleteCurrentNode"),tr=a(e=>({tr:t,state:n,dispatch:r})=>{const s=A(e,n.schema),o=t.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const c=o.before(i),d=o.after(i);t.delete(c,d).scrollIntoView()}return!0}return!1},"deleteNode"),er=a(e=>({tr:t,dispatch:n})=>{const{from:r,to:s}=e;return n&&t.delete(r,s),!0},"deleteRange"),nr=a(()=>({state:e,dispatch:t})=>Ne(e,t),"deleteSelection"),rr=a(()=>({commands:e})=>e.keyboardShortcut("Enter"),"enter"),sr=a(()=>({state:e,dispatch:t})=>Re(e,t),"exitCode");function nt(e,t,n={strict:!0}){const r=Object.keys(t);return r.length?r.every(s=>n.strict?t[s]===e[s]:St(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}a(nt,"objectIncludes");function de(e,t,n={}){return e.find(r=>r.type===t&&nt(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}a(de,"findMarkInSet");function Dt(e,t,n={}){return!!de(e,t,n)}a(Dt,"isMarkInSet");function Ct(e,t,n){var r;if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if((!s.node||!s.node.marks.some(p=>p.type===t))&&(s=e.parent.childBefore(e.parentOffset)),!s.node||!s.node.marks.some(p=>p.type===t)||(n=n||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!de([...s.node.marks],t,n)))return;let i=s.index,l=e.start()+s.offset,c=i+1,d=l+s.node.nodeSize;for(;i>0&&Dt([...e.parent.child(i-1).marks],t,n);)i-=1,l-=e.parent.child(i).nodeSize;for(;c<e.parent.childCount&&Dt([...e.parent.child(c).marks],t,n);)d+=e.parent.child(c).nodeSize,c+=1;return{from:l,to:d}}a(Ct,"getMarkRange");function z(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}a(z,"getMarkType");const or=a((e,t={})=>({tr:n,state:r,dispatch:s})=>{const o=z(e,r.schema),{doc:i,selection:l}=n,{$from:c,from:d,to:p}=l;if(s){const u=Ct(c,o,t);if(u&&u.from<=d&&u.to>=p){const f=L.create(i,u.from,u.to);n.setSelection(f)}}return!0},"extendMarkRange"),ir=a(e=>t=>{const n=typeof e=="function"?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1},"first");function ue(e){return e instanceof L}a(ue,"isTextSelection");function D(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}a(D,"minMax");function pe(e,t=null){if(!t)return null;const n=F.atStart(e),r=F.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return r;const s=n.from,o=r.to;return t==="all"?L.create(e,D(0,s,o),D(e.content.size,s,o)):L.create(e,D(t,s,o),D(t,s,o))}a(pe,"resolveFocusPosition");function At(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}a(At,"isiOS");const ar=a((e=null,t={})=>({editor:n,view:r,tr:s,dispatch:o})=>{t={scrollIntoView:!0,...t};const i=a(()=>{At()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),t?.scrollIntoView&&n.commands.scrollIntoView())})},"delayedFocus");if(r.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!ue(n.state.selection))return i(),!0;const l=pe(s.doc,e)||n.state.selection,c=n.state.selection.eq(l);return o&&(c||s.setSelection(l),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},"focus"),lr=a((e,t)=>n=>e.every((r,s)=>t(r,{...n,index:s})),"forEach"),cr=a((e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),"insertContent"),fe=a(e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):r.nodeType===1&&fe(r)}return e},"removeWhitespaces");function Y(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return fe(n)}a(Y,"elementFromString$1");function rt(e,t,n){if(e instanceof rn||e instanceof B)return e;n={slice:!0,parseOptions:{},...n};const r=typeof e=="object"&&e!==null,s=typeof e=="string";if(r)try{if(Array.isArray(e)&&e.length>0)return B.fromArray(e.map(l=>t.nodeFromJSON(l)));const i=t.nodeFromJSON(e);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),rt("",t,n)}if(s){if(n.errorOnInvalidContent){let i=!1,l="";const c=new ee({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:a(d=>(i=!0,l=typeof d=="string"?d:d.outerHTML,null),"getAttrs")}]}})});if(n.slice?tt.fromSchema(c).parseSlice(Y(e),n.parseOptions):tt.fromSchema(c).parse(Y(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const o=tt.fromSchema(t);return n.slice?o.parseSlice(Y(e),n.parseOptions).content:o.parse(Y(e),n.parseOptions)}return rt("",t,n)}a(rt,"createNodeFromContent");function dr(e,t,n){const r=e.steps.length-1;if(r<t)return;const s=e.steps[r];if(!(s instanceof sn||s instanceof on))return;const o=e.mapping.maps[r];let i=0;o.forEach((l,c,d,p)=>{i===0&&(i=p)}),e.setSelection(F.near(e.doc.resolve(i),n))}a(dr,"selectionToInsertionEnd");const ur=a(e=>!("type"in e),"isFragment"),pr=a((e,t,n)=>({tr:r,dispatch:s,editor:o})=>{var i;if(s){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;try{l=rt(t,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(i=n.errorOnInvalidContent)!==null&&i!==void 0?i:o.options.enableContentCheck})}catch(m){return o.emit("contentError",{editor:o,error:m,disableCollaboration:a(()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)},"disableCollaboration")}),!1}let{from:c,to:d}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},p=!0,u=!0;if((ur(l)?l:[l]).forEach(m=>{m.check(),p=p?m.isText&&m.marks.length===0:!1,u=u?m.isBlock:!1}),c===d&&u){const{parent:m}=r.doc.resolve(c);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(c-=1,d+=1)}let h;if(p){if(Array.isArray(t))h=t.map(m=>m.text||"").join("");else if(t instanceof B){let m="";t.forEach(g=>{g.text&&(m+=g.text)}),h=m}else typeof t=="object"&&t&&t.text?h=t.text:h=t;r.insertText(h,c,d)}else h=l,r.replaceWith(c,d,h);n.updateSelection&&dr(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:h}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:h})}return!0},"insertContentAt"),fr=a(()=>({state:e,dispatch:t})=>ze(e,t),"joinUp"),hr=a(()=>({state:e,dispatch:t})=>_e(e,t),"joinDown"),mr=a(()=>({state:e,dispatch:t})=>je(e,t),"joinBackward"),gr=a(()=>({state:e,dispatch:t})=>De(e,t),"joinForward"),kr=a(()=>({state:e,dispatch:t,tr:n})=>{try{const r=te(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},"joinItemBackward"),br=a(()=>({state:e,dispatch:t,tr:n})=>{try{const r=te(e.doc,e.selection.$from.pos,1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},"joinItemForward"),yr=a(()=>({state:e,dispatch:t})=>Fe(e,t),"joinTextblockBackward"),Mr=a(()=>({state:e,dispatch:t})=>We(e,t),"joinTextblockForward");function he(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}a(he,"isMacOS");function vr(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let l=0;l<t.length-1;l+=1){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))At()||he()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}a(vr,"normalizeKeyName");const wr=a(e=>({editor:t,view:n,tr:r,dispatch:s})=>{const o=vr(e).split(/-(?!$)/),i=o.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),l=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{n.someProp("handleKeyDown",d=>d(n,l))});return c?.steps.forEach(d=>{const p=d.map(r.mapping);p&&s&&r.maybeStep(p)}),!0},"keyboardShortcut");function q(e,t,n={}){const{from:r,to:s,empty:o}=e.selection,i=t?A(t,e.schema):null,l=[];e.doc.nodesBetween(r,s,(u,f)=>{if(u.isText)return;const h=Math.max(r,f),m=Math.min(s,f+u.nodeSize);l.push({node:u,from:h,to:m})});const c=s-r,d=l.filter(u=>i?i.name===u.node.type.name:!0).filter(u=>nt(u.node.attrs,n,{strict:!1}));return o?!!d.length:d.reduce((u,f)=>u+f.to-f.from,0)>=c}a(q,"isNodeActive");const Tr=a((e,t={})=>({state:n,dispatch:r})=>{const s=A(e,n.schema);return q(n,s,t)?Ve(n,r):!1},"lift"),xr=a(()=>({state:e,dispatch:t})=>Ke(e,t),"liftEmptyBlock"),Sr=a(e=>({state:t,dispatch:n})=>{const r=A(e,t.schema);return qe(r)(t,n)},"liftListItem"),Cr=a(()=>({state:e,dispatch:t})=>Ue(e,t),"newlineInCode");function pt(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}a(pt,"getSchemaTypeNameByName");function Ft(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((r,s)=>(n.includes(s)||(r[s]=e[s]),r),{})}a(Ft,"deleteProps");const Ar=a((e,t)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const l=pt(typeof e=="string"?e:e.name,r.schema);return l?(l==="node"&&(o=A(e,r.schema)),l==="mark"&&(i=z(e,r.schema)),s&&n.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(d,p)=>{o&&o===d.type&&n.setNodeMarkup(p,void 0,Ft(d.attrs,t)),i&&d.marks.length&&d.marks.forEach(u=>{i===u.type&&n.addMark(p,p+d.nodeSize,i.create(Ft(u.attrs,t)))})})}),!0):!1},"resetAttributes"),Er=a(()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),"scrollIntoView"),Lr=a(()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),"selectAll"),$r=a(()=>({state:e,dispatch:t})=>Ge(e,t),"selectNodeBackward"),Pr=a(()=>({state:e,dispatch:t})=>Je(e,t),"selectNodeForward"),Or=a(()=>({state:e,dispatch:t})=>Xe(e,t),"selectParentNode"),Ir=a(()=>({state:e,dispatch:t})=>Ye(e,t),"selectTextblockEnd"),Br=a(()=>({state:e,dispatch:t})=>Qe(e,t),"selectTextblockStart");function yt(e,t,n={},r={}){return rt(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}a(yt,"createDocument");const Hr=a((e,t=!1,n={},r={})=>({editor:s,tr:o,dispatch:i,commands:l})=>{var c,d;const{doc:p}=o;if(n.preserveWhitespace!=="full"){const u=yt(e,s.schema,n,{errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck});return i&&o.replaceWith(0,p.content.size,u).setMeta("preventUpdate",!t),!0}return i&&o.setMeta("preventUpdate",!t),l.insertContentAt({from:0,to:p.content.size},e,{parseOptions:n,errorOnInvalidContent:(d=r.errorOnInvalidContent)!==null&&d!==void 0?d:s.options.enableContentCheck})},"setContent");function me(e,t){const n=z(t,e.schema),{from:r,to:s,empty:o}=e.selection,i=[];o?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,s,c=>{i.push(...c.marks)});const l=i.find(c=>c.type.name===n.name);return l?{...l.attrs}:{}}a(me,"getMarkAttributes");function Nr(e,t){const n=new Ie(e);return t.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}a(Nr,"combineTransactionSteps");function Rr(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}a(Rr,"defaultBlockAt");function zr(e,t,n){const r=[];return e.nodesBetween(t.from,t.to,(s,o)=>{n(s)&&r.push({node:s,pos:o})}),r}a(zr,"findChildrenInRange");function ge(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}a(ge,"findParentNodeClosestToPos");function Et(e){return t=>ge(t.$from,e)}a(Et,"findParentNode");function _r(e,t){const n={from:0,to:e.content.size};return ae(e,n,t)}a(_r,"getText");function jr(e,t){const n=A(t,e.schema),{from:r,to:s}=e.selection,o=[];e.doc.nodesBetween(r,s,l=>{o.push(l)});const i=o.reverse().find(l=>l.type.name===n.name);return i?{...i.attrs}:{}}a(jr,"getNodeAttributes");function ke(e,t){const n=pt(typeof t=="string"?t:t.name,e.schema);return n==="node"?jr(e,t):n==="mark"?me(e,t):{}}a(ke,"getAttributes");function Dr(e,t=JSON.stringify){const n={};return e.filter(r=>{const s=t(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}a(Dr,"removeDuplicates");function Fr(e){const t=Dr(e);return t.length===1?t:t.filter((n,r)=>!t.filter((o,i)=>i!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}a(Fr,"simplifyChangedRanges");function Wr(e){const{mapping:t,steps:n}=e,r=[];return t.maps.forEach((s,o)=>{const i=[];if(s.ranges.length)s.forEach((l,c)=>{i.push({from:l,to:c})});else{const{from:l,to:c}=n[o];if(l===void 0||c===void 0)return;i.push({from:l,to:c})}i.forEach(({from:l,to:c})=>{const d=t.slice(o).map(l,-1),p=t.slice(o).map(c),u=t.invert().map(d,-1),f=t.invert().map(p);r.push({oldRange:{from:u,to:f},newRange:{from:d,to:p}})})}),Fr(r)}a(Wr,"getChangedRanges");function Lt(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(s=>{const o=n.resolve(e),i=Ct(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(e,t,(s,o)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}a(Lt,"getMarksBetween");function et(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=e.find(o=>o.type===t&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}a(et,"getSplittedAttributes");function Mt(e,t,n={}){const{empty:r,ranges:s}=e.selection,o=t?z(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(u=>o?o.name===u.type.name:!0).find(u=>nt(u.attrs,n,{strict:!1}));let i=0;const l=[];if(s.forEach(({$from:u,$to:f})=>{const h=u.pos,m=f.pos;e.doc.nodesBetween(h,m,(g,b)=>{if(!g.isText&&!g.marks.length)return;const k=Math.max(h,b),M=Math.min(m,b+g.nodeSize),T=M-k;i+=T,l.push(...g.marks.map(C=>({mark:C,from:k,to:M})))})}),i===0)return!1;const c=l.filter(u=>o?o.name===u.mark.type.name:!0).filter(u=>nt(u.mark.attrs,n,{strict:!1})).reduce((u,f)=>u+f.to-f.from,0),d=l.filter(u=>o?u.mark.type!==o&&u.mark.type.excludes(o):!0).reduce((u,f)=>u+f.to-f.from,0);return(c>0?c+d:c)>=i}a(Mt,"isMarkActive");function Vr(e,t,n={}){if(!t)return q(e,null,n)||Mt(e,null,n);const r=pt(t,e.schema);return r==="node"?q(e,t,n):r==="mark"?Mt(e,t,n):!1}a(Vr,"isActive");function Wt(e,t){const{nodeExtensions:n}=ct(t),r=n.find(i=>i.name===e);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=v(y(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}a(Wt,"isList");function $t(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((r=e.text)!==null&&r!==void 0?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let s=!0;return e.content.forEach(o=>{s!==!1&&($t(o,{ignoreWhitespace:n,checkChildren:t})||(s=!1))}),s}return!1}a($t,"isNodeEmpty");function Kr(e){return e instanceof it}a(Kr,"isNodeSelection");function qr(e,t,n){var r;const{selection:s}=t;let o=null;if(ue(s)&&(o=s.$cursor),o){const l=(r=e.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(l)||!l.some(c=>c.type.excludes(n))}const{ranges:i}=s;return i.some(({$from:l,$to:c})=>{let d=l.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(l.pos,c.pos,(p,u,f)=>{if(d)return!1;if(p.isInline){const h=!f||f.type.allowsMarkType(n),m=!!n.isInSet(p.marks)||!p.marks.some(g=>g.type.excludes(n));d=h&&m}return!d}),d})}a(qr,"canSetMark");const Ur=a((e,t={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:l}=o,c=z(e,r.schema);if(s)if(i){const d=me(r,c);n.addStoredMark(c.create({...d,...t}))}else l.forEach(d=>{const p=d.$from.pos,u=d.$to.pos;r.doc.nodesBetween(p,u,(f,h)=>{const m=Math.max(h,p),g=Math.min(h+f.nodeSize,u);f.marks.find(k=>k.type===c)?f.marks.forEach(k=>{c===k.type&&n.addMark(m,g,c.create({...k.attrs,...t}))}):n.addMark(m,g,c.create(t))})});return qr(r,n,c)},"setMark"),Gr=a((e,t)=>({tr:n})=>(n.setMeta(e,t),!0),"setMeta"),Jr=a((e,t={})=>({state:n,dispatch:r,chain:s})=>{const o=A(e,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock?s().command(({commands:l})=>Ot(o,{...i,...t})(n)?!0:l.clearNodes()).command(({state:l})=>Ot(o,{...i,...t})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},"setNode"),Xr=a(e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,s=D(e,0,r.content.size),o=it.create(r,s);t.setSelection(o)}return!0},"setNodeSelection"),Yr=a(e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:s,to:o}=typeof e=="number"?{from:e,to:e}:e,i=L.atStart(r).from,l=L.atEnd(r).to,c=D(s,i,l),d=D(o,i,l),p=L.create(r,c,d);t.setSelection(p)}return!0},"setTextSelection"),Qr=a(e=>({state:t,dispatch:n})=>{const r=A(e,t.schema);return Ze(r)(t,n)},"sinkListItem");function Vt(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(s=>t?.includes(s.type.name));e.tr.ensureMarks(r)}}a(Vt,"ensureMarks");const Zr=a(({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=t,{$from:l,$to:c}=o,d=s.extensionManager.attributes,p=et(d,l.node().type.name,l.node().attrs);if(o instanceof it&&o.node.isBlock)return!l.parentOffset||!Z(i,l.pos)?!1:(r&&(e&&Vt(n,s.extensionManager.splittableMarks),t.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const u=c.parentOffset===c.parent.content.size,f=l.depth===0?void 0:Rr(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=u&&f?[{type:f,attrs:p}]:void 0,m=Z(t.doc,t.mapping.map(l.pos),1,h);if(!h&&!m&&Z(t.doc,t.mapping.map(l.pos),1,f?[{type:f}]:void 0)&&(m=!0,h=f?[{type:f,attrs:p}]:void 0),r){if(m&&(o instanceof L&&t.deleteSelection(),t.split(t.mapping.map(l.pos),1,h),f&&!u&&!l.parentOffset&&l.parent.type!==f)){const g=t.mapping.map(l.before()),b=t.doc.resolve(g);l.node(-1).canReplaceWith(b.index(),b.index()+1,f)&&t.setNodeMarkup(t.mapping.map(l.before()),f)}e&&Vt(n,s.extensionManager.splittableMarks),t.scrollIntoView()}return m},"splitBlock"),ts=a((e,t={})=>({tr:n,state:r,dispatch:s,editor:o})=>{var i;const l=A(e,r.schema),{$from:c,$to:d}=r.selection,p=r.selection.node;if(p&&p.isBlock||c.depth<2||!c.sameParent(d))return!1;const u=c.node(-1);if(u.type!==l)return!1;const f=o.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==l||c.index(-2)!==c.node(-2).childCount-1)return!1;if(s){let k=B.empty;const M=c.index(-1)?1:c.index(-2)?2:3;for(let N=c.depth-M;N>=c.depth-3;N-=1)k=B.from(c.node(N).copy(k));const T=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,C={...et(f,c.node().type.name,c.node().attrs),...t},S=((i=l.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(C))||void 0;k=k.append(B.from(l.createAndFill(null,S)||void 0));const P=c.before(c.depth-(M-1));n.replace(P,c.after(-T),new tn(k,4-M,0));let H=-1;n.doc.nodesBetween(P,n.doc.content.size,(N,$e)=>{if(H>-1)return!1;N.isTextblock&&N.content.size===0&&(H=$e+1)}),H>-1&&n.setSelection(L.near(n.doc.resolve(H))),n.scrollIntoView()}return!0}const h=d.pos===c.end()?u.contentMatchAt(0).defaultType:null,m={...et(f,u.type.name,u.attrs),...t},g={...et(f,c.node().type.name,c.node().attrs),...t};n.delete(c.pos,d.pos);const b=h?[{type:l,attrs:m},{type:h,attrs:g}]:[{type:l,attrs:m}];if(!Z(n.doc,c.pos,2))return!1;if(s){const{selection:k,storedMarks:M}=r,{splittableMarks:T}=o.extensionManager,C=M||k.$to.parentOffset&&k.$from.marks();if(n.split(c.pos,2,b).scrollIntoView(),!C||!s)return!0;const S=C.filter(P=>T.includes(P.type.name));n.ensureMarks(S)}return!0},"splitListItem"),mt=a((e,t)=>{const n=Et(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===s?.type&&xt(e.doc,n.pos)&&e.join(n.pos),!0},"joinListBackwards"),gt=a((e,t)=>{const n=Et(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===s?.type&&xt(e.doc,r)&&e.join(r),!0},"joinListForwards"),es=a((e,t,n,r={})=>({editor:s,tr:o,state:i,dispatch:l,chain:c,commands:d,can:p})=>{const{extensions:u,splittableMarks:f}=s.extensionManager,h=A(e,i.schema),m=A(t,i.schema),{selection:g,storedMarks:b}=i,{$from:k,$to:M}=g,T=k.blockRange(M),C=b||g.$to.parentOffset&&g.$from.marks();if(!T)return!1;const S=Et(P=>Wt(P.type.name,u))(g);if(T.depth>=1&&S&&T.depth-S.depth<=1){if(S.node.type===h)return d.liftListItem(m);if(Wt(S.node.type.name,u)&&h.validContent(S.node.content)&&l)return c().command(()=>(o.setNodeMarkup(S.pos,h),!0)).command(()=>mt(o,h)).command(()=>gt(o,h)).run()}return!n||!C||!l?c().command(()=>p().wrapInList(h,r)?!0:d.clearNodes()).wrapInList(h,r).command(()=>mt(o,h)).command(()=>gt(o,h)).run():c().command(()=>{const P=p().wrapInList(h,r),H=C.filter(N=>f.includes(N.type.name));return o.ensureMarks(H),P?!0:d.clearNodes()}).wrapInList(h,r).command(()=>mt(o,h)).command(()=>gt(o,h)).run()},"toggleList"),ns=a((e,t={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=z(e,r.schema);return Mt(r,i,t)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,t)},"toggleMark"),rs=a((e,t,n={})=>({state:r,commands:s})=>{const o=A(e,r.schema),i=A(t,r.schema),l=q(r,o,n);let c;return r.selection.$anchor.sameParent(r.selection.$head)&&(c=r.selection.$anchor.parent.attrs),l?s.setNode(i,c):s.setNode(o,{...c,...n})},"toggleNode"),ss=a((e,t={})=>({state:n,commands:r})=>{const s=A(e,n.schema);return q(n,s,t)?r.lift(s):r.wrapIn(s,t)},"toggleWrap"),os=a(()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(e))){if(t){const i=e.tr,l=o.transform;for(let c=l.steps.length-1;c>=0;c-=1)i.step(l.steps[c].invert(l.docs[c]));if(o.text){const c=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,c))}else i.delete(o.from,o.to)}return!0}}return!1},"undoInputRule"),is=a(()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:s}=n;return r||t&&s.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},"unsetAllMarks"),as=a((e,t={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=t,{selection:l}=n,c=z(e,r.schema),{$from:d,empty:p,ranges:u}=l;if(!s)return!0;if(p&&i){let{from:f,to:h}=l;const m=(o=d.marks().find(b=>b.type===c))===null||o===void 0?void 0:o.attrs,g=Ct(d,c,m);g&&(f=g.from,h=g.to),n.removeMark(f,h,c)}else u.forEach(f=>{n.removeMark(f.$from.pos,f.$to.pos,c)});return n.removeStoredMark(c),!0},"unsetMark"),ls=a((e,t={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const l=pt(typeof e=="string"?e:e.name,r.schema);return l?(l==="node"&&(o=A(e,r.schema)),l==="mark"&&(i=z(e,r.schema)),s&&n.selection.ranges.forEach(c=>{const d=c.$from.pos,p=c.$to.pos;let u,f,h,m;n.selection.empty?r.doc.nodesBetween(d,p,(g,b)=>{o&&o===g.type&&(h=Math.max(b,d),m=Math.min(b+g.nodeSize,p),u=b,f=g)}):r.doc.nodesBetween(d,p,(g,b)=>{b<d&&o&&o===g.type&&(h=Math.max(b,d),m=Math.min(b+g.nodeSize,p),u=b,f=g),b>=d&&b<=p&&(o&&o===g.type&&n.setNodeMarkup(b,void 0,{...g.attrs,...t}),i&&g.marks.length&&g.marks.forEach(k=>{if(i===k.type){const M=Math.max(b,d),T=Math.min(b+g.nodeSize,p);n.addMark(M,T,i.create({...k.attrs,...t}))}}))}),f&&(u!==void 0&&n.setNodeMarkup(u,void 0,{...f.attrs,...t}),i&&f.marks.length&&f.marks.forEach(g=>{i===g.type&&n.addMark(h,m,i.create({...g.attrs,...t}))}))}),!0):!1},"updateAttributes"),cs=a((e,t={})=>({state:n,dispatch:r})=>{const s=A(e,n.schema);return en(s,t)(n,r)},"wrapIn"),ds=a((e,t={})=>({state:n,dispatch:r})=>{const s=A(e,n.schema);return nn(s,t)(n,r)},"wrapInList");var us=Object.freeze({__proto__:null,blur:Un,clearContent:Gn,clearNodes:Jn,command:Xn,createParagraphNear:Yn,cut:Qn,deleteCurrentNode:Zn,deleteNode:tr,deleteRange:er,deleteSelection:nr,enter:rr,exitCode:sr,extendMarkRange:or,first:ir,focus:ar,forEach:lr,insertContent:cr,insertContentAt:pr,joinBackward:mr,joinDown:hr,joinForward:gr,joinItemBackward:kr,joinItemForward:br,joinTextblockBackward:yr,joinTextblockForward:Mr,joinUp:fr,keyboardShortcut:wr,lift:Tr,liftEmptyBlock:xr,liftListItem:Sr,newlineInCode:Cr,resetAttributes:Ar,scrollIntoView:Er,selectAll:Lr,selectNodeBackward:$r,selectNodeForward:Pr,selectParentNode:Or,selectTextblockEnd:Ir,selectTextblockStart:Br,setContent:Hr,setMark:Ur,setMeta:Gr,setNode:Jr,setNodeSelection:Xr,setTextSelection:Yr,sinkListItem:Qr,splitBlock:Zr,splitListItem:ts,toggleList:es,toggleMark:ns,toggleNode:rs,toggleWrap:ss,undoInputRule:os,unsetAllMarks:is,unsetMark:as,updateAttributes:ls,wrapIn:cs,wrapInList:ds});const be=E.create({name:"commands",addCommands(){return{...us}}}),ye=E.create({name:"drop",addProseMirrorPlugins(){return[new O({key:new I("tiptapDrop"),props:{handleDrop:a((e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})},"handleDrop")}})]}}),Me=E.create({name:"editable",addProseMirrorPlugins(){return[new O({key:new I("editable"),props:{editable:a(()=>this.editor.options.editable,"editable")}})]}}),ve=E.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new O({key:new I("focusEvents"),props:{handleDOMEvents:{focus:a((t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},"focus"),blur:a((t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},"blur")}}})]}}),we=E.create({name:"keymap",addKeyboardShortcuts(){const e=a(()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:l})=>{const{selection:c,doc:d}=l,{empty:p,$anchor:u}=c,{pos:f,parent:h}=u,m=u.parent.isTextblock&&f>0?l.doc.resolve(f-1):u,g=m.parent.type.spec.isolating,b=u.pos-u.parentOffset,k=g&&m.parent.childCount===1?b===u.pos:F.atStart(d).from===f;return!p||!h.type.isTextblock||h.textContent.length||!k||k&&u.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),"handleBackspace"),t=a(()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),"handleDelete"),r={Enter:a(()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"handleEnter"),"Mod-Enter":a(()=>this.editor.commands.exitCode(),"Mod-Enter"),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":a(()=>this.editor.commands.selectAll(),"Mod-a")},s={...r},o={...r,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":a(()=>this.editor.commands.selectTextblockStart(),"Ctrl-a"),"Ctrl-e":a(()=>this.editor.commands.selectTextblockEnd(),"Ctrl-e")};return At()||he()?o:s},addProseMirrorPlugins(){return[new O({key:new I("clearDocument"),appendTransaction:a((e,t,n)=>{const r=e.some(g=>g.docChanged)&&!t.doc.eq(n.doc),s=e.some(g=>g.getMeta("preventClearDocument"));if(!r||s)return;const{empty:o,from:i,to:l}=t.selection,c=F.atStart(t.doc).from,d=F.atEnd(t.doc).to;if(o||!(i===c&&l===d)||!$t(n.doc))return;const f=n.tr,h=at({state:n,transaction:f}),{commands:m}=new lt({editor:this.editor,state:h});if(m.clearNodes(),!!f.steps.length)return f},"appendTransaction")})]}}),Te=E.create({name:"paste",addProseMirrorPlugins(){return[new O({key:new I("tiptapPaste"),props:{handlePaste:a((e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})},"handlePaste")}})]}}),xe=E.create({name:"tabindex",addProseMirrorPlugins(){return[new O({key:new I("tabindex"),props:{attributes:a(()=>this.editor.isEditable?{tabindex:"0"}:{},"attributes")}})]}});var ps=Object.freeze({__proto__:null,ClipboardTextSerializer:ce,Commands:be,Drop:ye,Editable:Me,FocusEvents:ve,Keymap:we,Paste:Te,Tabindex:xe});class j{static{a(this,"NodePos")}get name(){return this.node.type.name}constructor(t,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=n,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new j(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new j(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new j(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,i=this.pos+r+(o?0:1),l=this.resolvedPos.doc.resolve(i);if(!s&&l.depth<=this.depth)return;const c=new j(l,this.editor,s,s?n:null);s&&(c.actualDepth=this.depth+1),t.push(new j(l,this.editor,s,s?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===t)if(Object.keys(n).length>0){const o=s.node.attrs,i=Object.keys(n);for(let l=0;l<i.length;l+=1){const c=i[l];if(o[c]!==n[c])break}}else r=s;s=s.parent}return r}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(n);return this.children.forEach(i=>{r&&s.length>0||(i.node.type.name===t&&o.every(c=>n[c]===i.node.attrs[c])&&s.push(i),!(r&&s.length>0)&&(s=s.concat(i.querySelectorAll(t,n,r))))}),s}setAttribute(t){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(n)}}const fs=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function hs(e,t,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}a(hs,"createStyleTag");class di extends On{static{a(this,"Editor")}constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:a(()=>null,"onBeforeCreate"),onCreate:a(()=>null,"onCreate"),onUpdate:a(()=>null,"onUpdate"),onSelectionUpdate:a(()=>null,"onSelectionUpdate"),onTransaction:a(()=>null,"onTransaction"),onFocus:a(()=>null,"onFocus"),onBlur:a(()=>null,"onBlur"),onDestroy:a(()=>null,"onDestroy"),onContentError:a(({error:n})=>{throw n},"onContentError"),onPaste:a(()=>null,"onPaste"),onDrop:a(()=>null,"onDrop")},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:s})=>this.options.onDrop(n,r,s)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=hs(fs,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const r=ie(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(t){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(t).forEach(o=>{const i=typeof o=="string"?`${o}$`:o.key;r=n.filter(l=>!l.key.startsWith(i))}),n.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var t,n;const s=[...this.options.enableCoreExtensions?[Me,ce.configure({blockSeparator:(n=(t=this.options.coreExtensionOptions)===null||t===void 0?void 0:t.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),be,ve,we,xe,ye,Te].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o?.type));this.extensionManager=new V(s,this)}createCommandManager(){this.commandManager=new lt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var t;let n;try{n=yt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(i){if(!(i instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(i.message))throw i;this.emit("contentError",{editor:this,error:i,disableCollaboration:a(()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()},"disableCollaboration")}),n=yt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=pe(n,this.options.autofocus);this.view=new an(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(t=this.options.editorProps)===null||t===void 0?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:ln.create({doc:n,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(i=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(i)});return}const n=this.state.apply(t),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=t.getMeta("focus"),o=t.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return ke(this.state,t)}isActive(t,n){const r=typeof t=="string"?t:null,s=typeof t=="string"?n:t;return Vr(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return G(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:r={}}=t||{};return _r(this.state.doc,{blockSeparator:n,textSerializers:{...le(this.schema),...r}})}get isEmpty(){return $t(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const t=this.view.dom;t&&t.editor&&delete t.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(t,n))||null}$nodes(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new j(n,this)}get $doc(){return this.$pos(0)}}function K(e){return new dt({find:e.find,handler:a(({state:t,range:n,match:r})=>{const s=v(e.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=t,i=r[r.length-1],l=r[0];if(i){const c=l.search(/\S/),d=n.from+l.indexOf(i),p=d+i.length;if(Lt(n.from,n.to,t.doc).filter(h=>h.mark.type.excluded.find(g=>g===e.type&&g!==h.mark.type)).filter(h=>h.to>d).length)return null;p<n.to&&o.delete(p,n.to),d>n.from&&o.delete(n.from+c,d);const f=n.from+c+i.length;o.addMark(n.from+c,f,e.type.create(s||{})),o.removeStoredMark(e.type)}},"handler")})}a(K,"markInputRule");function ms(e){return new dt({find:e.find,handler:a(({state:t,range:n,match:r})=>{const s=v(e.getAttributes,void 0,r)||{},{tr:o}=t,i=n.from;let l=n.to;const c=e.type.create(s);if(r[1]){const d=r[0].lastIndexOf(r[1]);let p=i+d;p>l?p=l:l=p+r[1].length;const u=r[0][r[0].length-1];o.insertText(u,i+r[0].length-1),o.replaceWith(p,l,c)}else if(r[0]){const d=e.type.isInline?i:i-1;o.insert(d,e.type.create(s)).delete(o.mapping.map(i),o.mapping.map(l))}o.scrollIntoView()},"handler")})}a(ms,"nodeInputRule");function vt(e){return new dt({find:e.find,handler:a(({state:t,range:n,match:r})=>{const s=t.doc.resolve(n.from),o=v(e.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)},"handler")})}a(vt,"textblockTypeInputRule");function U(e){return new dt({find:e.find,handler:a(({state:t,range:n,match:r,chain:s})=>{const o=v(e.getAttributes,void 0,r)||{},i=t.tr.delete(n.from,n.to),c=i.doc.resolve(n.from).blockRange(),d=c&&Oe(c,e.type,o);if(!d)return null;if(i.wrap(c,d),e.keepMarks&&e.editor){const{selection:u,storedMarks:f}=t,{splittableMarks:h}=e.editor.extensionManager,m=f||u.$to.parentOffset&&u.$from.marks();if(m){const g=m.filter(b=>h.includes(b.type.name));i.ensureMarks(g)}}if(e.keepAttributes){const u=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(u,o).run()}const p=i.doc.resolve(n.from-1).nodeBefore;p&&p.type===e.type&&xt(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,p))&&i.join(n.from-1)},"handler")})}a(U,"wrappingInputRule");let w=class wt{static{a(this,"Node")}constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=v(y(this,"addOptions",{name:this.name}))),this.storage=v(y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new wt(t)}configure(t={}){const n=this.extend({...this.config,addOptions:a(()=>ut(this.options,t),"addOptions")});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new wt(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=v(y(n,"addOptions",{name:n.name})),n.storage=v(y(n,"addStorage",{name:n.name,options:n.options})),n}};function W(e){return new Dn({find:e.find,handler:a(({state:t,range:n,match:r,pasteEvent:s})=>{const o=v(e.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=t,l=r[r.length-1],c=r[0];let d=n.to;if(l){const p=c.search(/\S/),u=n.from+c.indexOf(l),f=u+l.length;if(Lt(n.from,n.to,t.doc).filter(m=>m.mark.type.excluded.find(b=>b===e.type&&b!==m.mark.type)).filter(m=>m.to>u).length)return null;f<n.to&&i.delete(f,n.to),u>n.from&&i.delete(n.from+p,u),d=n.from+p+l.length,i.addMark(n.from+p,d,e.type.create(o||{})),i.removeStoredMark(e.type)}},"handler")})}a(W,"markPasteRule");function gs(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}a(gs,"isValidLinkStructure");function ks(e){return new O({key:new I("autolink"),appendTransaction:a((t,n,r)=>{const s=t.some(d=>d.docChanged)&&!n.doc.eq(r.doc),o=t.some(d=>d.getMeta("preventAutolink"));if(!s||o)return;const{tr:i}=r,l=Nr(n.doc,[...t]);if(Wr(l).forEach(({newRange:d})=>{const p=zr(r.doc,d,h=>h.isTextblock);let u,f;if(p.length>1?(u=p[0],f=r.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ")):p.length&&r.doc.textBetween(d.from,d.to," "," ").endsWith(" ")&&(u=p[0],f=r.doc.textBetween(u.pos,d.to,void 0," ")),u&&f){const h=f.split(" ").filter(k=>k!=="");if(h.length<=0)return!1;const m=h[h.length-1],g=u.pos+f.lastIndexOf(m);if(!m)return!1;const b=un(m).map(k=>k.toObject(e.defaultProtocol));if(!gs(b))return!1;b.filter(k=>k.isLink).map(k=>({...k,from:g+k.start+1,to:g+k.end+1})).filter(k=>r.schema.marks.code?!r.doc.rangeHasMark(k.from,k.to,r.schema.marks.code):!0).filter(k=>e.validate(k.value)).filter(k=>e.shouldAutoLink(k.value)).forEach(k=>{Lt(k.from,k.to,r.doc).some(M=>M.mark.type===e.type)||i.addMark(k.from,k.to,e.type.create({href:k.href}))})}}),!!i.steps.length)return i},"appendTransaction")})}a(ks,"autolink");function bs(e){return new O({key:new I("handleClickLink"),props:{handleClick:a((t,n,r)=>{var s,o;if(r.button!==0||!t.editable)return!1;let i=r.target;const l=[];for(;i.nodeName!=="DIV";)l.push(i),i=i.parentNode;if(!l.find(f=>f.nodeName==="A"))return!1;const c=ke(t.state,e.type.name),d=r.target,p=(s=d?.href)!==null&&s!==void 0?s:c.href,u=(o=d?.target)!==null&&o!==void 0?o:c.target;return d&&p?(window.open(p,u),!0):!1},"handleClick")}})}a(bs,"clickHandler");function ys(e){return new O({key:new I("handlePasteLink"),props:{handlePaste:a((t,n,r)=>{const{state:s}=t,{selection:o}=s,{empty:i}=o;if(i)return!1;let l="";r.content.forEach(d=>{l+=d.textContent});const c=ne(l,{defaultProtocol:e.defaultProtocol}).find(d=>d.isLink&&d.value===l);return!l||!c?!1:(e.editor.commands.setMark(e.type,{href:c.href}),!0)},"handlePaste")}})}a(ys,"pasteHandler");const Ms=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function _(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!e||e.replace(Ms,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z+.-]+(?:[^a-z+.-:]|$))`,"i"))}a(_,"isAllowedUri");const ui=$.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){It(e);return}It(e.scheme,e.optionalSlashes)})},onDestroy(){pn()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:a((e,t)=>!!_(e,t.protocols),"isAllowedUri"),validate:a(e=>!!e,"validate"),shouldAutoLink:a(e=>!!e,"shouldAutoLink")}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:a(e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:a(n=>!!_(n,this.options.protocols),"defaultValidate"),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null},"getAttrs")}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:a(t=>!!_(t,this.options.protocols),"defaultValidate"),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",x(this.options.HTMLAttributes,e),0]:["a",x(this.options.HTMLAttributes,{...e,href:""}),0]},addCommands(){return{setLink:a(e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:a(r=>!!_(r,this.options.protocols),"defaultValidate"),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},"setLink"),toggleLink:a(e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:a(r=>!!_(r,this.options.protocols),"defaultValidate"),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},"toggleLink"),unsetLink:a(()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),"unsetLink")}},addPasteRules(){return[W({find:a(e=>{const t=[];if(e){const{protocols:n,defaultProtocol:r}=this.options,s=ne(e).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:a(i=>!!_(i,n),"defaultValidate"),protocols:n,defaultProtocol:r}));s.length&&s.forEach(o=>t.push({text:o.value,data:{href:o.href},index:o.start}))}return t},"find"),type:this.type,getAttributes:a(e=>{var t;return{href:(t=e.data)===null||t===void 0?void 0:t.href}},"getAttributes")})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;return this.options.autolink&&e.push(ks({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:a(r=>this.options.isAllowedUri(r,{defaultValidate:a(s=>!!_(s,t),"defaultValidate"),protocols:t,defaultProtocol:n}),"validate"),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(bs({type:this.type})),this.options.linkOnPaste&&e.push(ys({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}});function Tt(e,t){return t?["width",`${Math.max(t,e)}px`]:["min-width",`${e}px`]}a(Tt,"getColStyleDeclaration");function Kt(e,t,n,r,s,o){var i;let l=0,c=!0,d=t.firstChild;const p=e.firstChild;if(p!==null)for(let u=0,f=0;u<p.childCount;u+=1){const{colspan:h,colwidth:m}=p.child(u).attrs;for(let g=0;g<h;g+=1,f+=1){const b=s===f?o:m&&m[g],k=b?`${b}px`:"";if(l+=b||r,b||(c=!1),d){if(d.style.width!==k){const[M,T]=Tt(r,b);d.style.setProperty(M,T)}d=d.nextSibling}else{const M=document.createElement("col"),[T,C]=Tt(r,b);M.style.setProperty(T,C),t.appendChild(M)}}}for(;d;){const u=d.nextSibling;(i=d.parentNode)===null||i===void 0||i.removeChild(d),d=u}c?(n.style.width=`${l}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${l}px`)}a(Kt,"updateColumns");class vs{static{a(this,"TableView")}constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Kt(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,Kt(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type==="attributes"&&(t.target===this.table||this.colgroup.contains(t.target))}}function ws(e,t,n,r){let s=0,o=!0;const i=[],l=e.firstChild;if(!l)return{};for(let u=0,f=0;u<l.childCount;u+=1){const{colspan:h,colwidth:m}=l.child(u).attrs;for(let g=0;g<h;g+=1,f+=1){const b=n===f?r:m&&m[g];s+=b||t,b||(o=!1);const[k,M]=Tt(t,b);i.push(["col",{style:`${k}: ${M}`}])}}const c=o?`${s}px`:"",d=o?"":`${s}px`;return{colgroup:["colgroup",{},...i],tableWidth:c,tableMinWidth:d}}a(ws,"createColGroup");function qt(e,t){return e.createAndFill()}a(qt,"createCell");function Ts(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const r=e.nodes[n];r.spec.tableRole&&(t[r.spec.tableRole]=r)}),e.cached.tableNodeTypes=t,t}a(Ts,"getTableNodeTypes");function xs(e,t,n,r,s){const o=Ts(e),i=[],l=[];for(let d=0;d<n;d+=1){const p=qt(o.cell);if(p&&l.push(p),r){const u=qt(o.header_cell);u&&i.push(u)}}const c=[];for(let d=0;d<t;d+=1)c.push(o.row.createChecked(null,r&&d===0?i:l));return o.table.createChecked(null,c)}a(xs,"createTable");function Ss(e){return e instanceof re}a(Ss,"isCellSelection");const Q=a(({editor:e})=>{const{selection:t}=e.state;if(!Ss(t))return!1;let n=0;const r=ge(t.ranges[0].$from,o=>o.type.name==="table");return r?.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1},"deleteTableWhenAllCellsSelected"),pi=w.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:vs,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:e,HTMLAttributes:t}){const{colgroup:n,tableWidth:r,tableMinWidth:s}=ws(e,this.options.cellMinWidth);return["table",x(this.options.HTMLAttributes,t,{style:r?`width: ${r}`:`min-width: ${s}`}),n,["tbody",0]]},addCommands(){return{insertTable:a(({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:s,editor:o})=>{const i=xs(o.schema,e,t,n);if(s){const l=r.selection.from+1;r.replaceSelectionWith(i).scrollIntoView().setSelection(L.near(r.doc.resolve(l)))}return!0},"insertTable"),addColumnBefore:a(()=>({state:e,dispatch:t})=>fn(e,t),"addColumnBefore"),addColumnAfter:a(()=>({state:e,dispatch:t})=>hn(e,t),"addColumnAfter"),deleteColumn:a(()=>({state:e,dispatch:t})=>mn(e,t),"deleteColumn"),addRowBefore:a(()=>({state:e,dispatch:t})=>gn(e,t),"addRowBefore"),addRowAfter:a(()=>({state:e,dispatch:t})=>kn(e,t),"addRowAfter"),deleteRow:a(()=>({state:e,dispatch:t})=>bn(e,t),"deleteRow"),deleteTable:a(()=>({state:e,dispatch:t})=>yn(e,t),"deleteTable"),mergeCells:a(()=>({state:e,dispatch:t})=>Bt(e,t),"mergeCells"),splitCell:a(()=>({state:e,dispatch:t})=>Ht(e,t),"splitCell"),toggleHeaderColumn:a(()=>({state:e,dispatch:t})=>Nt("column")(e,t),"toggleHeaderColumn"),toggleHeaderRow:a(()=>({state:e,dispatch:t})=>Nt("row")(e,t),"toggleHeaderRow"),toggleHeaderCell:a(()=>({state:e,dispatch:t})=>Mn(e,t),"toggleHeaderCell"),mergeOrSplit:a(()=>({state:e,dispatch:t})=>Bt(e,t)?!0:Ht(e,t),"mergeOrSplit"),setCellAttribute:a((e,t)=>({state:n,dispatch:r})=>vn(e,t)(n,r),"setCellAttribute"),goToNextCell:a(()=>({state:e,dispatch:t})=>Rt(1)(e,t),"goToNextCell"),goToPreviousCell:a(()=>({state:e,dispatch:t})=>Rt(-1)(e,t),"goToPreviousCell"),fixTables:a(()=>({state:e,dispatch:t})=>(t&&wn(e),!0),"fixTables"),setCellSelection:a(e=>({tr:t,dispatch:n})=>{if(n){const r=re.create(t.doc,e.anchorCell,e.headCell);t.setSelection(r)}return!0},"setCellSelection")}},addKeyboardShortcuts(){return{Tab:a(()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Tab"),"Shift-Tab":a(()=>this.editor.commands.goToPreviousCell(),"Shift-Tab"),Backspace:Q,"Mod-Backspace":Q,Delete:Q,"Mod-Delete":Q}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Tn({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],xn({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:v(y(e,"tableRole",t))}}}),fi=w.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:a(e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(r=>parseInt(r,10)):null},"parseHTML")}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",x(this.options.HTMLAttributes,e),0]}}),hi=w.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:a(e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(r=>parseInt(r,10)):null},"parseHTML")}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",x(this.options.HTMLAttributes,e),0]}}),mi=w.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",x(this.options.HTMLAttributes,e),0]}}),Cs=/^\s*>\s$/,As=w.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:a(()=>({commands:e})=>e.wrapIn(this.name),"setBlockquote"),toggleBlockquote:a(()=>({commands:e})=>e.toggleWrap(this.name),"toggleBlockquote"),unsetBlockquote:a(()=>({commands:e})=>e.lift(this.name),"unsetBlockquote")}},addKeyboardShortcuts(){return{"Mod-Shift-b":a(()=>this.editor.commands.toggleBlockquote(),"Mod-Shift-b")}},addInputRules(){return[U({find:Cs,type:this.type})]}}),Es=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Ls=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,$s=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Ps=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Os=$.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:a(e=>e.style.fontWeight!=="normal"&&null,"getAttrs")},{style:"font-weight=400",clearMark:a(e=>e.type.name===this.name,"clearMark")},{style:"font-weight",getAttrs:a(e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null,"getAttrs")}]},renderHTML({HTMLAttributes:e}){return["strong",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:a(()=>({commands:e})=>e.setMark(this.name),"setBold"),toggleBold:a(()=>({commands:e})=>e.toggleMark(this.name),"toggleBold"),unsetBold:a(()=>({commands:e})=>e.unsetMark(this.name),"unsetBold")}},addKeyboardShortcuts(){return{"Mod-b":a(()=>this.editor.commands.toggleBold(),"Mod-b"),"Mod-B":a(()=>this.editor.commands.toggleBold(),"Mod-B")}},addInputRules(){return[K({find:Es,type:this.type}),K({find:$s,type:this.type})]},addPasteRules(){return[W({find:Ls,type:this.type}),W({find:Ps,type:this.type})]}}),Is="listItem",Ut="textStyle",Gt=/^\s*([-+*])\s$/,Bs=w.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",x(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:a(()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Is,this.editor.getAttributes(Ut)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks),"toggleBulletList")}},addKeyboardShortcuts(){return{"Mod-Shift-8":a(()=>this.editor.commands.toggleBulletList(),"Mod-Shift-8")}},addInputRules(){let e=U({find:Gt,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=U({find:Gt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:a(()=>this.editor.getAttributes(Ut),"getAttributes"),editor:this.editor})),[e]}}),Hs=/(?<!`)`([^`]+)`(?!`)/,Ns=/(?<!`)`([^`]+)`(?!`)/g,Rs=$.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:a(()=>({commands:e})=>e.setMark(this.name),"setCode"),toggleCode:a(()=>({commands:e})=>e.toggleMark(this.name),"toggleCode"),unsetCode:a(()=>({commands:e})=>e.unsetMark(this.name),"unsetCode")}},addKeyboardShortcuts(){return{"Mod-e":a(()=>this.editor.commands.toggleCode(),"Mod-e")}},addInputRules(){return[K({find:Hs,type:this.type})]},addPasteRules(){return[W({find:Ns,type:this.type})]}}),zs=/^```([a-z]+)?[\s\n]$/,_s=/^~~~([a-z]+)?[\s\n]$/,js=w.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:a(e=>{var t;const{languageClassPrefix:n}=this.options,o=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},"parseHTML"),rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",x(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:a(e=>({commands:t})=>t.setNode(this.name,e),"setCodeBlock"),toggleCodeBlock:a(e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e),"toggleCodeBlock")}},addKeyboardShortcuts(){return{"Mod-Alt-c":a(()=>this.editor.commands.toggleCodeBlock(),"Mod-Alt-c"),Backspace:a(()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},"Backspace"),Enter:a(({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},"Enter"),ArrowDown:a(({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const l=s.after();return l===void 0?!1:r.nodeAt(l)?e.commands.command(({tr:d})=>(d.setSelection(F.near(r.resolve(l))),!0)):e.commands.exitCode()},"ArrowDown")}},addInputRules(){return[vt({find:zs,type:this.type,getAttributes:a(e=>({language:e[1]}),"getAttributes")}),vt({find:_s,type:this.type,getAttributes:a(e=>({language:e[1]}),"getAttributes")})]},addProseMirrorPlugins(){return[new O({key:new I("codeBlockVSCodeHandler"),props:{handlePaste:a((e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s?.mode;if(!n||!o)return!1;const{tr:i,schema:l}=e.state,c=l.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},c)),i.selection.$from.parent.type!==this.type&&i.setSelection(L.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0},"handlePaste")}})]}}),Ds=w.create({name:"doc",topNode:!0,content:"block+"}),Fs=E.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Sn(this.options)]}}),Ws=E.create({name:"gapCursor",addProseMirrorPlugins(){return[Cn()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=v(y(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),Vs=w.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",x(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:a(()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:l}=r.extensionManager,c=o||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:d,dispatch:p})=>{if(p&&c&&i){const u=c.filter(f=>l.includes(f.type.name));d.ensureMarks(u)}return!0}).run()})]),"setHardBreak")}},addKeyboardShortcuts(){return{"Mod-Enter":a(()=>this.editor.commands.setHardBreak(),"Mod-Enter"),"Shift-Enter":a(()=>this.editor.commands.setHardBreak(),"Shift-Enter")}}}),Ks=w.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,x(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:a(e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,"setHeading"),toggleHeading:a(e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1,"toggleHeading")}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>vt({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),qs=E.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:a(()=>({state:e,dispatch:t})=>An(e,t),"undo"),redo:a(()=>({state:e,dispatch:t})=>En(e,t),"redo")}},addProseMirrorPlugins(){return[Ln(this.options)]},addKeyboardShortcuts(){return{"Mod-z":a(()=>this.editor.commands.undo(),"Mod-z"),"Shift-Mod-z":a(()=>this.editor.commands.redo(),"Shift-Mod-z"),"Mod-y":a(()=>this.editor.commands.redo(),"Mod-y"),"Mod-я":a(()=>this.editor.commands.undo(),"Mod-я"),"Shift-Mod-я":a(()=>this.editor.commands.redo(),"Shift-Mod-я")}}}),Us=w.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",x(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:a(()=>({chain:e,state:t})=>{const{selection:n}=t,{$from:r,$to:s}=n,o=e();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):Kr(n)?o.insertContentAt(s.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:i,dispatch:l})=>{var c;if(l){const{$to:d}=i.selection,p=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?i.setSelection(L.create(i.doc,d.pos+1)):d.nodeAfter.isBlock?i.setSelection(it.create(i.doc,d.pos)):i.setSelection(L.create(i.doc,d.pos));else{const u=(c=d.parent.type.contentMatch.defaultType)===null||c===void 0?void 0:c.create();u&&(i.insert(p,u),i.setSelection(L.create(i.doc,p+1)))}i.scrollIntoView()}return!0}).run()},"setHorizontalRule")}},addInputRules(){return[ms({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),Gs=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Js=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Xs=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Ys=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Qs=$.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:a(e=>e.style.fontStyle!=="normal"&&null,"getAttrs")},{style:"font-style=normal",clearMark:a(e=>e.type.name===this.name,"clearMark")},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:a(()=>({commands:e})=>e.setMark(this.name),"setItalic"),toggleItalic:a(()=>({commands:e})=>e.toggleMark(this.name),"toggleItalic"),unsetItalic:a(()=>({commands:e})=>e.unsetMark(this.name),"unsetItalic")}},addKeyboardShortcuts(){return{"Mod-i":a(()=>this.editor.commands.toggleItalic(),"Mod-i"),"Mod-I":a(()=>this.editor.commands.toggleItalic(),"Mod-I")}},addInputRules(){return[K({find:Gs,type:this.type}),K({find:Xs,type:this.type})]},addPasteRules(){return[W({find:Js,type:this.type}),W({find:Ys,type:this.type})]}}),Zs=w.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",x(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:a(()=>this.editor.commands.splitListItem(this.name),"Enter"),Tab:a(()=>this.editor.commands.sinkListItem(this.name),"Tab"),"Shift-Tab":a(()=>this.editor.commands.liftListItem(this.name),"Shift-Tab")}}}),to="listItem",Jt="textStyle",Xt=/^(\d+)\.\s$/,eo=w.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:a(e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1,"parseHTML")},type:{default:void 0,parseHTML:a(e=>e.getAttribute("type"),"parseHTML")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",x(this.options.HTMLAttributes,n),0]:["ol",x(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:a(()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(to,this.editor.getAttributes(Jt)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks),"toggleOrderedList")}},addKeyboardShortcuts(){return{"Mod-Shift-7":a(()=>this.editor.commands.toggleOrderedList(),"Mod-Shift-7")}},addInputRules(){let e=U({find:Xt,type:this.type,getAttributes:a(t=>({start:+t[1]}),"getAttributes"),joinPredicate:a((t,n)=>n.childCount+n.attrs.start===+t[1],"joinPredicate")});return(this.options.keepMarks||this.options.keepAttributes)&&(e=U({find:Xt,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:a(t=>({start:+t[1],...this.editor.getAttributes(Jt)}),"getAttributes"),joinPredicate:a((t,n)=>n.childCount+n.attrs.start===+t[1],"joinPredicate"),editor:this.editor})),[e]}}),no=w.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:a(()=>({commands:e})=>e.setNode(this.name),"setParagraph")}},addKeyboardShortcuts(){return{"Mod-Alt-0":a(()=>this.editor.commands.setParagraph(),"Mod-Alt-0")}}}),ro=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,so=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,oo=$.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:a(e=>e.includes("line-through")?{}:!1,"getAttrs")}]},renderHTML({HTMLAttributes:e}){return["s",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:a(()=>({commands:e})=>e.setMark(this.name),"setStrike"),toggleStrike:a(()=>({commands:e})=>e.toggleMark(this.name),"toggleStrike"),unsetStrike:a(()=>({commands:e})=>e.unsetMark(this.name),"unsetStrike")}},addKeyboardShortcuts(){return{"Mod-Shift-s":a(()=>this.editor.commands.toggleStrike(),"Mod-Shift-s")}},addInputRules(){return[K({find:ro,type:this.type})]},addPasteRules(){return[W({find:so,type:this.type})]}}),io=w.create({name:"text",group:"inline"}),gi=E.create({name:"starterKit",addExtensions(){var e,t,n,r,s,o,i,l,c,d,p,u,f,h,m,g,b,k;const M=[];return this.options.bold!==!1&&M.push(Os.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.blockquote!==!1&&M.push(As.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bulletList!==!1&&M.push(Bs.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&M.push(Rs.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&M.push(js.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&M.push(Ds.configure((o=this.options)===null||o===void 0?void 0:o.document)),this.options.dropcursor!==!1&&M.push(Fs.configure((i=this.options)===null||i===void 0?void 0:i.dropcursor)),this.options.gapcursor!==!1&&M.push(Ws.configure((l=this.options)===null||l===void 0?void 0:l.gapcursor)),this.options.hardBreak!==!1&&M.push(Vs.configure((c=this.options)===null||c===void 0?void 0:c.hardBreak)),this.options.heading!==!1&&M.push(Ks.configure((d=this.options)===null||d===void 0?void 0:d.heading)),this.options.history!==!1&&M.push(qs.configure((p=this.options)===null||p===void 0?void 0:p.history)),this.options.horizontalRule!==!1&&M.push(Us.configure((u=this.options)===null||u===void 0?void 0:u.horizontalRule)),this.options.italic!==!1&&M.push(Qs.configure((f=this.options)===null||f===void 0?void 0:f.italic)),this.options.listItem!==!1&&M.push(Zs.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&M.push(eo.configure((m=this.options)===null||m===void 0?void 0:m.orderedList)),this.options.paragraph!==!1&&M.push(no.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&M.push(oo.configure((b=this.options)===null||b===void 0?void 0:b.strike)),this.options.text!==!1&&M.push(io.configure((k=this.options)===null||k===void 0?void 0:k.text)),M}});var ao=Object.defineProperty,lo=a((e,t,n)=>t in e?ao(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,"__defNormalProp"),st=a((e,t,n)=>(lo(e,typeof t!="symbol"?t+"":t,n),n),"__publicField");const co=E.create({name:"markdownTightLists",addOptions:a(()=>({tight:!0,tightClass:"tight",listTypes:["bulletList","orderedList"]}),"addOptions"),addGlobalAttributes(){return[{types:this.options.listTypes,attributes:{tight:{default:this.options.tight,parseHTML:a(e=>e.getAttribute("data-tight")==="true"||!e.querySelector("p"),"parseHTML"),renderHTML:a(e=>({class:e.tight?this.options.tightClass:null,"data-tight":e.tight?"true":null}),"renderHTML")}}}]},addCommands(){var e=this;return{toggleTight:a(function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return n=>{let{editor:r,commands:s}=n;function o(i){if(!r.isActive(i))return!1;const l=r.getAttributes(i);return s.updateAttributes(i,{tight:t??!(l!=null&&l.tight)})}return a(o,"toggleTight"),e.options.listTypes.some(i=>o(i))}},"toggleTight")}}}),Yt=se();function Se(e,t){return Yt.inline.State.prototype.scanDelims.call({src:e,posMax:e.length}),new Yt.inline.State(e,null,null,[]).scanDelims(t,!0)}a(Se,"scanDelims");function Ce(e,t,n,r){let s=e.substring(0,n)+e.substring(n+t.length);return s=s.substring(0,n+r)+t+s.substring(n+r),s}a(Ce,"shiftDelim");function uo(e,t,n,r){let s=n,o=e;for(;s<r&&!Se(o,s).can_open;)o=Ce(o,t,s,1),s++;return{text:o,from:s,to:r}}a(uo,"trimStart");function po(e,t,n,r){let s=r,o=e;for(;s>n&&!Se(o,s).can_close;)o=Ce(o,t,s,-1),s--;return{text:o,from:n,to:s}}a(po,"trimEnd");function fo(e,t,n,r){let s={text:e,from:n,to:r};return s=uo(s.text,t,s.from,s.to),s=po(s.text,t,s.from,s.to),s.to-s.from<t.length+1&&(s.text=s.text.substring(0,s.from)+s.text.substring(s.to+t.length)),s.text}a(fo,"trimInline");class ho extends Pn{static{a(this,"MarkdownSerializerState")}constructor(t,n,r){super(t,n,r??{}),st(this,"inTable",!1),this.inlines=[]}render(t,n,r){super.render(t,n,r);const s=this.inlines[this.inlines.length-1];if(s!=null&&s.start&&s!==null&&s!==void 0&&s.end){const{delimiter:o,start:i,end:l}=this.normalizeInline(s);this.out=fo(this.out,o,i,l),this.inlines.pop()}}markString(t,n,r,s){const o=this.marks[t.type.name];if(o.expelEnclosingWhitespace)if(n)this.inlines.push({start:this.out.length,delimiter:o.open});else{const i=this.inlines.pop();this.inlines.push({...i,end:this.out.length})}return super.markString(t,n,r,s)}normalizeInline(t){let{start:n,end:r}=t;for(;this.out.charAt(n).match(/\s/);)n++;return{...t,start:n}}}const Ae=$.create({name:"markdownHTMLMark",addStorage(){return{markdown:{serialize:{open(e,t){var n,r;return this.editor.storage.markdown.options.html?(n=(r=Qt(t))===null||r===void 0?void 0:r[0])!==null&&n!==void 0?n:"":(console.warn(`Tiptap Markdown: "${t.type.name}" mark is only available in html mode`),"")},close(e,t){var n,r;return this.editor.storage.markdown.options.html&&(n=(r=Qt(t))===null||r===void 0?void 0:r[1])!==null&&n!==void 0?n:""}},parse:{}}}}});function Qt(e){const t=e.type.schema,n=t.text(" ",[e]),s=G(B.from(n),t).match(/^(<.*?>) (<\/.*?>)$/);return s?[s[1],s[2]]:null}a(Qt,"getMarkTags");function Pt(e){const t=`<body>${e}</body>`;return new window.DOMParser().parseFromString(t,"text/html").body}a(Pt,"elementFromString");function mo(e){return e?.replace(/</g,"&lt;").replace(/>/g,"&gt;")}a(mo,"escapeHTML");function go(e){const t=e.parentElement,n=t.cloneNode();for(;t.firstChild&&t.firstChild!==e;)n.appendChild(t.firstChild);n.childNodes.length>0&&t.parentElement.insertBefore(n,t),t.parentElement.insertBefore(e,t),t.childNodes.length===0&&t.remove()}a(go,"extractElement");function ko(e){const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}a(ko,"unwrapElement");const ft=w.create({name:"markdownHTMLNode",addStorage(){return{markdown:{serialize(e,t,n){this.editor.storage.markdown.options.html?e.write(bo(t,n)):(console.warn(`Tiptap Markdown: "${t.type.name}" node is only available in html mode`),e.write(`[${t.type.name}]`)),t.isBlock&&e.closeBlock(t)},parse:{}}}}});function bo(e,t){const n=e.type.schema,r=G(B.from(e),n);return e.isBlock&&(t instanceof B||t.type.name===n.topNodeType.name)?yo(r):r}a(bo,"serializeHTML");function yo(e){const n=Pt(e).firstElementChild;return n.innerHTML=n.innerHTML.trim()?`
${n.innerHTML}
`:`
`,n.outerHTML}a(yo,"formatBlock");const Mo=w.create({name:"blockquote"}),vo=Mo.extend({addStorage(){return{markdown:{serialize:R.nodes.blockquote,parse:{}}}}}),wo=w.create({name:"bulletList"}),Ee=wo.extend({addStorage(){return{markdown:{serialize(e,t){return e.renderList(t,"  ",()=>(this.editor.storage.markdown.options.bulletListMarker||"-")+" ")},parse:{}}}}}),To=w.create({name:"codeBlock"}),xo=To.extend({addStorage(){return{markdown:{serialize(e,t){e.write("```"+(t.attrs.language||"")+`
`),e.text(t.textContent,!1),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},parse:{setup(e){var t;e.set({langPrefix:(t=this.options.languageClassPrefix)!==null&&t!==void 0?t:"language-"})},updateDOM(e){e.innerHTML=e.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}}}}),So=w.create({name:"hardBreak"}),Le=So.extend({addStorage(){return{markdown:{serialize(e,t,n,r){for(let s=r+1;s<n.childCount;s++)if(n.child(s).type!=t.type){e.write(e.inTable?ft.storage.markdown.serialize.call(this,e,t,n):`\\
`);return}},parse:{}}}}}),Co=w.create({name:"heading"}),Ao=Co.extend({addStorage(){return{markdown:{serialize:R.nodes.heading,parse:{}}}}}),Eo=w.create({name:"horizontalRule"}),Lo=Eo.extend({addStorage(){return{markdown:{serialize:R.nodes.horizontal_rule,parse:{}}}}}),$o=w.create({name:"image"}),Po=$o.extend({addStorage(){return{markdown:{serialize:R.nodes.image,parse:{}}}}}),Oo=w.create({name:"listItem"}),Io=Oo.extend({addStorage(){return{markdown:{serialize:R.nodes.list_item,parse:{}}}}}),Bo=w.create({name:"orderedList"});function Ho(e,t,n){let r=0;for(;n-r>0&&t.child(n-r-1).type.name===e.type.name;r++);return r}a(Ho,"findIndexOfAdjacentNode");const No=Bo.extend({addStorage(){return{markdown:{serialize(e,t,n,r){const s=t.attrs.start||1,o=String(s+t.childCount-1).length,i=e.repeat(" ",o+2),c=Ho(t,n,r)%2?") ":". ";e.renderList(t,i,d=>{const p=String(s+d);return e.repeat(" ",o-p.length)+p+c})},parse:{}}}}}),Ro=w.create({name:"paragraph"}),zo=Ro.extend({addStorage(){return{markdown:{serialize:R.nodes.paragraph,parse:{}}}}});function kt(e){var t,n;return(t=e==null||(n=e.content)===null||n===void 0?void 0:n.content)!==null&&t!==void 0?t:[]}a(kt,"childNodes");const _o=w.create({name:"table"}),jo=_o.extend({addStorage(){return{markdown:{serialize(e,t,n){if(!Do(t)){ft.storage.markdown.serialize.call(this,e,t,n);return}e.inTable=!0,t.forEach((r,s,o)=>{if(e.write("| "),r.forEach((i,l,c)=>{c&&e.write(" | ");const d=i.firstChild;d.textContent.trim()&&e.renderInline(d)}),e.write(" |"),e.ensureNewLine(),!o){const i=Array.from({length:r.childCount}).map(()=>"---").join(" | ");e.write(`| ${i} |`),e.ensureNewLine()}}),e.closeBlock(t),e.inTable=!1},parse:{}}}}});function Zt(e){return e.attrs.colspan>1||e.attrs.rowspan>1}a(Zt,"hasSpan");function Do(e){const t=kt(e),n=t[0],r=t.slice(1);return!(kt(n).some(s=>s.type.name!=="tableHeader"||Zt(s)||s.childCount>1)||r.some(s=>kt(s).some(o=>o.type.name==="tableHeader"||Zt(o)||o.childCount>1)))}a(Do,"isMarkdownSerializable");const Fo=w.create({name:"taskItem"}),Wo=Fo.extend({addStorage(){return{markdown:{serialize(e,t){const n=t.attrs.checked?"[x]":"[ ]";e.write(`${n} `),e.renderContent(t)},parse:{updateDOM(e){[...e.querySelectorAll(".task-list-item")].forEach(t=>{const n=t.querySelector("input");t.setAttribute("data-type","taskItem"),n&&(t.setAttribute("data-checked",n.checked),n.remove())})}}}}}}),Vo=w.create({name:"taskList"}),Ko=Vo.extend({addStorage(){return{markdown:{serialize:Ee.storage.markdown.serialize,parse:{setup(e){e.use($n)},updateDOM(e){[...e.querySelectorAll(".contains-task-list")].forEach(t=>{t.setAttribute("data-type","taskList")})}}}}}}),qo=w.create({name:"text"}),Uo=qo.extend({addStorage(){return{markdown:{serialize(e,t){e.text(mo(t.text))},parse:{}}}}}),Go=$.create({name:"bold"}),Jo=Go.extend({addStorage(){return{markdown:{serialize:R.marks.strong,parse:{}}}}}),Xo=$.create({name:"code"}),Yo=Xo.extend({addStorage(){return{markdown:{serialize:R.marks.code,parse:{}}}}}),Qo=$.create({name:"italic"}),Zo=Qo.extend({addStorage(){return{markdown:{serialize:R.marks.em,parse:{}}}}}),ti=$.create({name:"link"}),ei=ti.extend({addStorage(){return{markdown:{serialize:R.marks.link,parse:{}}}}}),ni=$.create({name:"strike"}),ri=ni.extend({addStorage(){return{markdown:{serialize:{open:"~~",close:"~~",expelEnclosingWhitespace:!0},parse:{}}}}}),si=[vo,Ee,xo,Le,Ao,Lo,ft,Po,Io,No,zo,jo,Wo,Ko,Uo,Jo,Yo,Ae,Zo,ei,ri];function ot(e){var t,n;const r=(t=e.storage)===null||t===void 0?void 0:t.markdown,s=(n=si.find(o=>o.name===e.name))===null||n===void 0?void 0:n.storage.markdown;return r||s?{...s,...r}:null}a(ot,"getMarkdownSpec");class oi{static{a(this,"MarkdownSerializer")}constructor(t){st(this,"editor",null),this.editor=t}serialize(t){const n=new ho(this.nodes,this.marks,{hardBreakNodeName:Le.name});return n.renderContent(t),n.out}get nodes(){var t;return{...Object.fromEntries(Object.keys(this.editor.schema.nodes).map(n=>[n,this.serializeNode(ft)])),...Object.fromEntries((t=this.editor.extensionManager.extensions.filter(n=>n.type==="node"&&this.serializeNode(n)).map(n=>[n.name,this.serializeNode(n)]))!==null&&t!==void 0?t:[])}}get marks(){var t;return{...Object.fromEntries(Object.keys(this.editor.schema.marks).map(n=>[n,this.serializeMark(Ae)])),...Object.fromEntries((t=this.editor.extensionManager.extensions.filter(n=>n.type==="mark"&&this.serializeMark(n)).map(n=>[n.name,this.serializeMark(n)]))!==null&&t!==void 0?t:[])}}serializeNode(t){var n;return(n=ot(t))===null||n===void 0||(n=n.serialize)===null||n===void 0?void 0:n.bind({editor:this.editor,options:t.options})}serializeMark(t){var n;const r=(n=ot(t))===null||n===void 0?void 0:n.serialize;return r?{...r,open:typeof r.open=="function"?r.open.bind({editor:this.editor,options:t.options}):r.open,close:typeof r.close=="function"?r.close.bind({editor:this.editor,options:t.options}):r.close}:null}}class ii{static{a(this,"MarkdownParser")}constructor(t,n){st(this,"editor",null),st(this,"md",null);let{html:r,linkify:s,breaks:o}=n;this.editor=t,this.md=this.withPatchedRenderer(se({html:r,linkify:s,breaks:o}))}parse(t){let{inline:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){this.editor.extensionManager.extensions.forEach(o=>{var i;return(i=ot(o))===null||i===void 0||(i=i.parse)===null||i===void 0||(i=i.setup)===null||i===void 0?void 0:i.call({editor:this.editor,options:o.options},this.md)});const r=this.md.render(t),s=Pt(r);return this.editor.extensionManager.extensions.forEach(o=>{var i;return(i=ot(o))===null||i===void 0||(i=i.parse)===null||i===void 0||(i=i.updateDOM)===null||i===void 0?void 0:i.call({editor:this.editor,options:o.options},s)}),this.normalizeDOM(s,{inline:n,content:t}),s.innerHTML}return t}normalizeDOM(t,n){let{inline:r,content:s}=n;return this.normalizeBlocks(t),t.querySelectorAll("*").forEach(o=>{var i;((i=o.nextSibling)===null||i===void 0?void 0:i.nodeType)===Node.TEXT_NODE&&!o.closest("pre")&&(o.nextSibling.textContent=o.nextSibling.textContent.replace(/^\n/,""))}),r&&this.normalizeInline(t,s),t}normalizeBlocks(t){const r=Object.values(this.editor.schema.nodes).filter(s=>s.isBlock).map(s=>{var o;return(o=s.spec.parseDOM)===null||o===void 0?void 0:o.map(i=>i.tag)}).flat().filter(Boolean).join(",");r&&[...t.querySelectorAll(r)].forEach(s=>{s.parentElement.matches("p")&&go(s)})}normalizeInline(t,n){var r;if((r=t.firstElementChild)!==null&&r!==void 0&&r.matches("p")){var s,o,i,l;const c=t.firstElementChild,{nextElementSibling:d}=c,p=(s=(o=n.match(/^\s+/))===null||o===void 0?void 0:o[0])!==null&&s!==void 0?s:"",u=d?"":(i=(l=n.match(/\s+$/))===null||l===void 0?void 0:l[0])!==null&&i!==void 0?i:"";if(n.match(/^\n\n/)){c.innerHTML=`${c.innerHTML}${u}`;return}ko(c),t.innerHTML=`${p}${t.innerHTML}${u}`}}withPatchedRenderer(t){const n=a(r=>function(){const s=r(...arguments);return s===`
`?s:s[s.length-1]===`
`?s.slice(0,-1):s},"withoutNewLine");return t.renderer.rules.hardbreak=n(t.renderer.rules.hardbreak),t.renderer.rules.softbreak=n(t.renderer.rules.softbreak),t.renderer.rules.fence=n(t.renderer.rules.fence),t.renderer.rules.code_block=n(t.renderer.rules.code_block),t.renderer.renderToken=n(t.renderer.renderToken.bind(t.renderer)),t}}const ai=E.create({name:"markdownClipboard",addOptions(){return{transformPastedText:!1,transformCopiedText:!1}},addProseMirrorPlugins(){return[new O({key:new I("markdownClipboard"),props:{clipboardTextParser:a((e,t,n)=>{if(n||!this.options.transformPastedText)return null;const r=this.editor.storage.markdown.parser.parse(e,{inline:!0});return tt.fromSchema(this.editor.schema).parseSlice(Pt(r),{preserveWhitespace:!0,context:t})},"clipboardTextParser"),clipboardTextSerializer:a(e=>this.options.transformCopiedText?this.editor.storage.markdown.serializer.serialize(e.content):null,"clipboardTextSerializer")}})]}}),ki=E.create({name:"markdown",priority:50,addOptions(){return{html:!0,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!1,breaks:!1,transformPastedText:!1,transformCopiedText:!1}},addCommands(){const e=ps.Commands.config.addCommands();return{setContent:a((t,n,r)=>s=>e.setContent(s.editor.storage.markdown.parser.parse(t),n,r)(s),"setContent"),insertContentAt:a((t,n,r)=>s=>e.insertContentAt(t,s.editor.storage.markdown.parser.parse(n,{inline:!0}),r)(s),"insertContentAt")}},onBeforeCreate(){this.editor.storage.markdown={options:{...this.options},parser:new ii(this.editor,this.options),serializer:new oi(this.editor),getMarkdown:a(()=>this.editor.storage.markdown.serializer.serialize(this.editor.state.doc),"getMarkdown")},this.editor.options.initialContent=this.editor.options.content,this.editor.options.content=this.editor.storage.markdown.parser.parse(this.editor.options.content)},onCreate(){this.editor.options.content=this.editor.options.initialContent,delete this.editor.options.initialContent},addStorage(){return{}},addExtensions(){return[co.configure({tight:this.options.tightLists,tightClass:this.options.tightListClass}),ai.configure({transformPastedText:this.options.transformPastedText,transformCopiedText:this.options.transformCopiedText})]}});export{di as E,ui as L,ki as M,gi as S,pi as T,fi as a,hi as b,mi as c};
//# sourceMappingURL=vendor-tiptap-BPz0N8rD.js.map
