sourcetype:
  path: sourcetype
  desc: 来源类型
  methods:
    list: 
      path: sourcetype
      method: get
      default_fields:
      - name: name
        alias: 名称
      - name: appTitle
        alias: 应用名称
      - name: description
        alias: 描述
      - name: createTime
        alias: 创建时间
        convert:
          function: format_timestamp
          args:
            - format: '%Y-%m-%d %H:%M:%S'
            - tz: '+08:00'
      - name: updateTime
        alias: 更新时间
        convert:
          function: format_timestamp
          args:
            - format: '%Y-%m-%d %H:%M:%S'
            - tz: '+08:00'
    get: sourcetype
    create:
      path: sourcetype/{{ name| default(faker.word()) }}
      method: post
      data:
        name: '{{ name| default(faker.word()) }}'
        line:
          type: single
          regex: ''
        datetime:
          type: auto
          zoneOffset: 8
          dateTimeFormat: ''
          dateTimePrefix: ''
          maxDateTimeLength: 100
        description: ''
        groupIds: []
        id: ''
        category: custom
        advance:
          charset: utf-8
          fieldDiscovery: true
        preset: 0
        extractions: []
    delete:
      path: sourcetype:batchDelete
      method: post
      data:
        names:
        - '{{ name }}'
extractions:
  path: extractions/list
  desc: 字段提取规则
  methods:
    list:
      path: extractions/list
      method: get
      default_fields:
      - name: name
        alias: 名称
      - name: description
        alias: 描述
      - name: type
        alias: 类型
      - name: sourcetype
        alias: 来源类型
      - name: scope
        alias: 作用域
      - name: appTitle
        alias: 应用名称
      - name: createTime
        alias: 创建时间
        convert:
          function: format_timestamp
          args:
            - format: '%Y-%m-%d %H:%M:%S'
            - tz: '+08:00'
      - name: updateTime
        alias: 更新时间
        convert:
          function: format_timestamp
          args:
            - format: '%Y-%m-%d %H:%M:%S'
            - tz: '+08:00'

    get:
      path: extractions
      method: get
    delete:
      path: extractions:batchDelete
      method: post
      data:
        ids:
        - '{{ id }}'
    create:
      path: extractions
      method: post
      data:
        name: '{{ name }}'
        description: ''
        type: regex
        config:
          pattern: ^(?<a>[\s\S]+)
          delimiter: ','
          delimiterKv: ':'
        sourcetype: json
        indexed: false
        app: search
        schema:
        - field: a
        groupIds: []
