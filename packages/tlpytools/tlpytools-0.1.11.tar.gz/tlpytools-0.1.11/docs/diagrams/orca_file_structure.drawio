<mxfile host="Electron" modified="2025-09-03T00:15:17.222Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.0.4 Chrome/120.0.6099.109 Electron/28.1.0 Safari/537.36" etag="4FJYRINfpESAMCRcWpKx" version="24.0.4" type="device">
  <diagram name="File Structure" id="file-structure">
    <mxGraphModel dx="1674" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="📁 ORCA File Structure &amp; Model Workflow Flexibility" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="200" y="20" width="769" height="40" as="geometry" />
        </mxCell>
        <mxCell id="databank-title" value="🏛️ Databank Structure (db_scenario/)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="80" y="80" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="databank-structure" value="📁 db_scenario/&lt;br&gt;├── 📄 orca_model_config.yaml     🎛️ Main Config&lt;br&gt;├── 📊 orca_model_state.json      📈 Runtime State&lt;br&gt;├── 📝 orca_orchestrator.log      📋 Execution Log&lt;br&gt;│&lt;br&gt;├── 📂 a1_popsim/                 👥 Population Synthesis&lt;br&gt;│   ├── 📁 config/&lt;br&gt;│   ├── 📁 data/                  📊 Input Data&lt;br&gt;│   └── 📁 output/                📦 Step Results&lt;br&gt;│&lt;br&gt;├── 📂 b1_activitysim/            🎯 Travel Demand Model&lt;br&gt;│   ├── 📁 configs/&lt;br&gt;│   ├── 📁 data/&lt;br&gt;│   └── 📁 outputs/&lt;br&gt;│&lt;br&gt;├── 📂 b2_cvm/                    🚛 Commercial Vehicle Model&lt;br&gt;│   ├── 📁 configs/&lt;br&gt;│   ├── 📁 data/&lt;br&gt;│   └── 📁 outputs/&lt;br&gt;│&lt;br&gt;├── 📂 b3_quetzal/                🌐 Traffic Assignment&lt;br&gt;│   ├── 📁 demand/&lt;br&gt;│   ├── 📁 supply/&lt;br&gt;│   └── 📁 outputs/&lt;br&gt;│&lt;br&gt;└── 📦 outputs/                   🗃️ Archived Results&lt;br&gt;    ├── 🗜️ a1_popsim_outputs_iter1.zip&lt;br&gt;    ├── 🗜️ a1_popsim_logs_iter1.zip&lt;br&gt;    ├── 🗜️ b1_activitysim_outputs_iter1.zip&lt;br&gt;    ├── 🗜️ b1_activitysim_trips_iter1.zip&lt;br&gt;    ├── 🗜️ b2_cvm_outputs_iter1.zip&lt;br&gt;    └── 🗜️ b3_quetzal_skims_iterN.zip" style="rounded=0&#xa;;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="80" y="120" width="350" height="410" as="geometry" />
        </mxCell>
        <mxCell id="config-title" value="⚙️ Configuration Flexibility" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="480" y="80" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yaml-config" value="📄 orca_model_config.yaml&lt;br&gt;&lt;br&gt;🔧 Configurable Elements:&lt;br&gt;• Model execution sequence&lt;br&gt;• Environment paths&lt;br&gt;• Command templates&lt;br&gt;• Input data sources&lt;br&gt;• Output archive patterns&lt;br&gt;• Cloud storage settings&lt;br&gt;• Iteration control&lt;br&gt;• Performance monitoring" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="120" width="300" height="150" as="geometry" />
        </mxCell>
        <mxCell id="env-vars" value="🔧 Environment Variables&lt;br&gt;&lt;br&gt;• ORCA_POPSIM_ENV&lt;br&gt;• ORCA_ACTIVITYSIM_ENV&lt;br&gt;• ORCA_CVM_ENV&lt;br&gt;• ORCA_QUETZAL_ENV&lt;br&gt;• UPLOAD_OUTPUTS_ONLY" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="290" width="300" height="100" as="geometry" />
        </mxCell>
        <mxCell id="cli-overrides" value="💻 Command-Line Overrides&lt;br&gt;&lt;br&gt;• --iterations N&lt;br&gt;• --steps component1 component2&lt;br&gt;• --mode cloud_production&lt;br&gt;• --project custom_name&lt;br&gt;• --dry-run&lt;br&gt;• --overwrite" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="410" width="300" height="120" as="geometry" />
        </mxCell>
        <mxCell id="workflow-title" value="🚀 Flexible Model Workflow Examples" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="80" y="860" width="400" height="30" as="geometry" />
        </mxCell>
        <mxCell id="workflow1-title" value="🎯 Standard Transportation Model" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="900" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="workflow1" value="1️⃣ PopSim → 2️⃣ ActivitySim → 3️⃣ CVM → 4️⃣ Quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="80" y="930" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="workflow2-title" value="⚡ Quick Testing (Skip PopSim)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="990" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="workflow2" value="1️⃣ ActivitySim → 2️⃣ CVM → 3️⃣ Quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="80" y="1020" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="workflow3-title" value="🔬 Assignment Only (Pre-computed Demand)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="1080" width="300" height="20" as="geometry" />
        </mxCell>
        <mxCell id="workflow3" value="1️⃣ Quetzal Only" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="80" y="1110" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="python-title" value="🐍 Python Environment Flexibility" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="530" y="860" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="env-example1" value="🏠 Local Development&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;C:\\miniconda3\\envs\\activitysim&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;C:\\miniconda3\\envs\\quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="530" y="900" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="env-example2" value="☁️ Cloud Production&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;/opt/conda/envs/activitysim&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;/opt/conda/envs/quetzal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="750" y="900" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="env-example3" value="🔬 Research Cluster&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;/apps/activitysim/2.0.2&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;/apps/quetzal/latest" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="530" y="1020" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="env-example4" value="🐳 Docker Containers&lt;br&gt;&lt;br&gt;ORCA_ACTIVITYSIM_ENV=&lt;br&gt;docker run activitysim:latest&lt;br&gt;&lt;br&gt;ORCA_QUETZAL_ENV=&lt;br&gt;docker run quetzal:latest" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="750" y="1020" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="dataflow-title" value="📊 Shared Input Data Management" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="820" y="80" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="shared-data" value="🔗 Centralized Input Data&lt;br&gt;&lt;br&gt;📍 ABM/BaseNetworks/Inputs/&lt;br&gt;├── 🏙️ landuse_synpop_2017.zip&lt;br&gt;├── 🏙️ landuse_synpop_2023.zip&lt;br&gt;├── 🌐 base_network_*.txt&lt;br&gt;├── 🌉 bridge_crossing_gy.csv&lt;br&gt;├── 📊 dist_factors_gy.csv.gz&lt;br&gt;├── 👥 PopSim/&lt;br&gt;└── 🎯 ActivitySim/&lt;br&gt;&lt;br&gt;⬇️ Automatically copied to all&lt;br&gt;   sub-component directories" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;align=left;verticalAlign=top;fontFamily=Courier New;" parent="1" vertex="1">
          <mxGeometry x="820" y="120" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="output-archives" value="📦 Output Archive Patterns&lt;br&gt;&lt;br&gt;🎯 ActivitySim:&lt;br&gt;• outputs: output/*.csv, *.h5&lt;br&gt;• trips: output/final_trips.csv&lt;br&gt;&lt;br&gt;🚛 CVM:&lt;br&gt;• outputs: output/*.csv&lt;br&gt;&lt;br&gt;🌐 Quetzal:&lt;br&gt;• skims: outputs/skims/*.omx&lt;br&gt;• results: outputs/assignment/*&lt;br&gt;&lt;br&gt;✨ Flexible patterns support&lt;br&gt;   any file structure!" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="820" y="340" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="features-box" value="🌟 Key Flexibility Features&lt;br&gt;&lt;br&gt;✅ Any Python model workflow&lt;br&gt;✅ Multiple environment support&lt;br&gt;✅ Configurable execution order&lt;br&gt;✅ Flexible file patterns&lt;br&gt;✅ Custom command templates&lt;br&gt;✅ Environment variable overrides&lt;br&gt;✅ Command-line customization&lt;br&gt;✅ Shared input data management&lt;br&gt;✅ Multi-archive output support&lt;br&gt;✅ Cross-platform compatibility" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="530" y="1140" width="280" height="180" as="geometry" />
        </mxCell>
        <mxCell id="benefits-box" value="🎯 Benefits for Model Developers&lt;br&gt;&lt;br&gt;🚀 Rapid prototyping &amp; testing&lt;br&gt;🔧 Easy integration of new models&lt;br&gt;🌍 Support for different environments&lt;br&gt;📊 Automatic data management&lt;br&gt;☁️ Seamless local-to-cloud transition&lt;br&gt;🔄 Iterative model development&lt;br&gt;📈 Performance monitoring&lt;br&gt;🛡️ Robust error handling&lt;br&gt;📝 Comprehensive logging&lt;br&gt;👥 Multi-user collaboration" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="820" y="550" width="280" height="170" as="geometry" />
        </mxCell>
        <mxCell id="additional-title" value="🛠️ Advanced Features" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#1f4e79;" parent="1" vertex="1">
          <mxGeometry x="480" y="560" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="additional-features" value="🔄 Resume from any step&lt;br&gt;📊 Performance profiling&lt;br&gt;🗜️ Automatic compression&lt;br&gt;🧹 Cleanup patterns&lt;br&gt;🔍 Dry-run mode&lt;br&gt;⚠️ Error dump collection&lt;br&gt;🎛️ Multiple operational modes&lt;br&gt;📋 State tracking &amp; recovery" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="480" y="600" width="280" height="120" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
