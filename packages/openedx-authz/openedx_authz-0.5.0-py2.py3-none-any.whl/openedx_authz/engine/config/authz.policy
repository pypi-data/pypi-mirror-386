############################################
# Open edX AuthZ â€” Casbin Policy Configuration
#
# This file defines policies that work with the model configuration.
# Uses namespaced subjects, actions, and scopes for maximum flexibility.
############################################

# Policy definitions - format: p = subject(role), action, scope, effect
# For role definitions use: lib^*, course^*, org^* to specify the scope of the role

# Library Admin Role Policies
p, role^library_admin, act^view_library, lib^*, allow
p, role^library_admin, act^manage_library_tags, lib^*, allow
p, role^library_admin, act^delete_library, lib^*, allow
p, role^library_admin, act^edit_library_content, lib^*, allow
p, role^library_admin, act^publish_library_content, lib^*, allow
p, role^library_admin, act^reuse_library_content, lib^*, allow
p, role^library_admin, act^view_library_team, lib^*, allow
p, role^library_admin, act^manage_library_team, lib^*, allow
p, role^library_admin, act^create_library_collection, lib^*, allow
p, role^library_admin, act^edit_library_collection, lib^*, allow
p, role^library_admin, act^delete_library_collection, lib^*, allow

# Library Author Role Policies
p, role^library_author, act^view_library, lib^*, allow
p, role^library_author, act^manage_library_tags, lib^*, allow
p, role^library_author, act^edit_library_content, lib^*, allow
p, role^library_author, act^publish_library_content, lib^*, allow
p, role^library_author, act^reuse_library_content, lib^*, allow
p, role^library_author, act^view_library_team, lib^*, allow
p, role^library_author, act^create_library_collection, lib^*, allow
p, role^library_author, act^edit_library_collection, lib^*, allow
p, role^library_author, act^delete_library_collection, lib^*, allow

# Library Contributor Role Policies
p, role^library_contributor, act^view_library, lib^*, allow
p, role^library_contributor, act^manage_library_tags, lib^*, allow
p, role^library_contributor, act^edit_library_content, lib^*, allow
p, role^library_contributor, act^reuse_library_content, lib^*, allow
p, role^library_contributor, act^view_library_team, lib^*, allow
p, role^library_contributor, act^create_library_collection, lib^*, allow
p, role^library_contributor, act^edit_library_collection, lib^*, allow
p, role^library_contributor, act^delete_library_collection, lib^*, allow

# Library User Role Policies
p, role^library_user, act^view_library, lib^*, allow
p, role^library_user, act^reuse_library_content, lib^*, allow
p, role^library_user, act^view_library_team, lib^*, allow

# Action Inheritance (g2) - format: g2 = granted_action, implied_action
# Higher-level permissions automatically grant lower-level permissions
# If a user has the granted_action, they also have the implied_action
# Example: g2, act^delete_library, act^view_library means delete permission includes view permission
# Library
g2, act^manage_library_tags, act^edit_library_content
g2, act^delete_library, act^edit_library_content

# Content
g2, act^publish_library_content, act^edit_library_content
g2, act^edit_library_content, act^view_library
g2, act^reuse_library_content, act^view_library
g2, act^publish_library_content, act^view_library

# Team
g2, act^manage_library_team, act^view_library_team

# Collections
g2, act^delete_library_collection, act^edit_library_collection
g2, act^create_library_collection, act^edit_library_collection
g2, act^edit_library_collection, act^view_library
