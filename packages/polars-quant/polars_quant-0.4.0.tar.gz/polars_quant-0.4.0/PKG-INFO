Metadata-Version: 2.4
Name: polars-quant
Version: 0.4.0
Requires-Dist: polars>=1.33.1
Requires-Dist: pyarrow>=21.0.0
License-File: LICENSE
Summary: Blazingly Fast Polars Quant Tool
Author-email: Firstastor <23150126@hdu.edu.cn>
Requires-Python: >=3.9
Description-Content-Type: text/markdown; charset=UTF-8; variant=GFM

# polars-quant ğŸ§®ğŸ“Š

> åŸºäº Rust + Polars çš„é«˜æ€§èƒ½é‡åŒ–åˆ†æä¸å›æµ‹å·¥å…·é›†ï¼Œæä¾›ä¸°å¯Œçš„æŠ€æœ¯æŒ‡æ ‡è®¡ç®—å’Œç‹¬ç«‹èµ„é‡‘æ± å›æµ‹å¼•æ“ã€‚

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![Rust](https://img.shields.io/badge/rust-1.90+-orange.svg)](https://www.rust-lang.org/)

## âœ¨ ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½**ï¼šåŸºäº Rust å®ç°ï¼Œåº•å±‚ä½¿ç”¨ Polars æ•°æ®å¤„ç†ï¼Œé€Ÿåº¦å¿«ã€å†…å­˜å ç”¨ä½
- ğŸ“Š **ä¸°å¯ŒæŒ‡æ ‡**ï¼šæä¾› 50+ å¸¸ç”¨æŠ€æœ¯æŒ‡æ ‡ï¼ˆç§»åŠ¨å¹³å‡ã€åŠ¨é‡ã€éœ‡è¡ã€æˆäº¤é‡ç­‰ï¼‰
- ğŸ’° **ç‹¬ç«‹èµ„é‡‘æ± **ï¼šæ¯åªè‚¡ç¥¨ä½¿ç”¨ç‹¬ç«‹èµ„é‡‘æ± å›æµ‹ï¼Œæ™ºèƒ½å¹¶è¡Œå¤„ç†
- ğŸ¯ **çœŸå®æ¨¡æ‹Ÿ**ï¼šæ”¯æŒä½£é‡‘ï¼ˆå«æœ€ä½ä½£é‡‘ï¼‰ã€æ»‘ç‚¹ã€æ•´ç™¾è‚¡äº¤æ˜“ç­‰å®ç›˜è§„åˆ™
- ğŸ“ˆ **è¯¦ç»†ç»Ÿè®¡**ï¼šæä¾›å¤æ™®æ¯”ç‡ã€ç´¢æè¯ºæ¯”ç‡ã€å¡å°”é©¬æ¯”ç‡ç­‰ 12 ç±»è¯¦ç»†æŒ‡æ ‡
- ğŸ” **çµæ´»åˆ†æ**ï¼šæ”¯æŒå…¨å±€æ±‡æ€»å’Œå•è‚¡ç¥¨æ·±åº¦åˆ†æ

## ğŸ“¦ å®‰è£…

```bash
pip install polars-quant
```

æˆ–ä»æºç å®‰è£…ï¼š

```bash
git clone https://github.com/Firstastor/polars-quant.git
cd polars-quant
pip install maturin
maturin develop --release
```

## ğŸ“š API å‚è€ƒ

### ä¸€ã€å›æµ‹ç±» (Backtest)

#### 1. æ„é€ å‡½æ•°

##### `Backtest(prices, buy_signals, sell_signals, initial_capital, commission_rate, min_commission, slippage)`

åˆ›å»ºå›æµ‹å®ä¾‹ã€‚

**å‚æ•°**ï¼š
- `prices` (DataFrame): ä»·æ ¼æ•°æ®ï¼Œç¬¬ä¸€åˆ—ä¸ºæ—¥æœŸï¼Œå…¶ä½™åˆ—ä¸ºå„è‚¡ç¥¨ä»·æ ¼
- `buy_signals` (DataFrame): ä¹°å…¥ä¿¡å·ï¼Œç¬¬ä¸€åˆ—ä¸ºæ—¥æœŸï¼Œå…¶ä½™åˆ—ä¸ºå¸ƒå°”å€¼ï¼ˆTrue è¡¨ç¤ºä¹°å…¥ï¼ŒFalse è¡¨ç¤ºä¸ä¹°å…¥ï¼‰
- `sell_signals` (DataFrame): å–å‡ºä¿¡å·ï¼Œç¬¬ä¸€åˆ—ä¸ºæ—¥æœŸï¼Œå…¶ä½™åˆ—ä¸ºå¸ƒå°”å€¼ï¼ˆTrue è¡¨ç¤ºå–å‡ºï¼ŒFalse è¡¨ç¤ºä¸å–å‡ºï¼‰
- `initial_capital` (float): åˆå§‹èµ„é‡‘ï¼Œé»˜è®¤ 100000.0
- `commission_rate` (float): ä½£é‡‘è´¹ç‡ï¼Œé»˜è®¤ 0.0003ï¼ˆä¸‡ä¸‰ï¼‰
- `min_commission` (float): æœ€ä½ä½£é‡‘ï¼Œé»˜è®¤ 5.0 å…ƒ
- `slippage` (float): æ»‘ç‚¹ï¼Œé»˜è®¤ 0.0ï¼ˆ0.001 è¡¨ç¤º 0.1%ï¼‰

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import Backtest

bt = Backtest(
    prices=prices_df,
    buy_signals=buy_df,
    sell_signals=sell_df,
    initial_capital=100000.0,
    commission_rate=0.0003,  # ä¸‡ä¸‰
    min_commission=5.0,       # æœ€ä½5å…ƒ
    slippage=0.001            # 0.1%æ»‘ç‚¹
)
```

---

#### 2. å›æµ‹æ‰§è¡Œ

##### `run()`

æ‰§è¡Œå›æµ‹ã€‚

**è¿”å›**ï¼šNone

**ç‰¹æ€§**ï¼š
- è‡ªåŠ¨è¯†åˆ«è‚¡ç¥¨æ•°é‡ï¼Œæ™ºèƒ½é€‰æ‹©ä¸²è¡Œ/å¹¶è¡Œç­–ç•¥
- <4 åªè‚¡ç¥¨ï¼šä¸²è¡Œæ‰§è¡Œï¼ˆé¿å…çº¿ç¨‹å¼€é”€ï¼‰
- â‰¥4 åªè‚¡ç¥¨ï¼šå¹¶è¡Œæ‰§è¡Œï¼ˆåŠ¨æ€çº¿ç¨‹æ± ï¼‰
- æ¯åªè‚¡ç¥¨ç‹¬ç«‹èµ„é‡‘æ± ï¼Œäº’ä¸å½±å“

**ç¤ºä¾‹**ï¼š
```python
bt.run()
```

---

#### 3. ç»“æœæŸ¥è¯¢ - å…¨å±€æ•°æ®

##### `get_daily_records()`

è·å–æ‰€æœ‰è‚¡ç¥¨çš„æ¯æ—¥èµ„é‡‘è®°å½•ã€‚

**è¿”å›**ï¼šDataFrameï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼š
- `symbol` (str): è‚¡ç¥¨ä»£ç 
- `date` (str): æ—¥æœŸ
- `cash` (float): ç°é‡‘
- `stock_value` (float): æŒä»“å¸‚å€¼
- `total_value` (float): æ€»èµ„äº§

**ç¤ºä¾‹**ï¼š
```python
daily = bt.get_daily_records()
print(daily)
```

---

##### `get_position_records()`

è·å–æ‰€æœ‰è‚¡ç¥¨çš„äº¤æ˜“è®°å½•ã€‚

**è¿”å›**ï¼šDataFrameï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼š
- `symbol` (str): è‚¡ç¥¨ä»£ç 
- `entry_date` (str): å¼€ä»“æ—¥æœŸ
- `entry_price` (float): å¼€ä»“ä»·æ ¼
- `quantity` (float): æŒä»“æ•°é‡ï¼ˆæ•´ç™¾è‚¡ï¼‰
- `exit_date` (str): å¹³ä»“æ—¥æœŸ
- `exit_price` (float): å¹³ä»“ä»·æ ¼
- `pnl` (float): ç›ˆäºé‡‘é¢
- `pnl_pct` (float): ç›ˆäºç™¾åˆ†æ¯”
- `holding_days` (int): æŒä»“å¤©æ•°

**ç¤ºä¾‹**ï¼š
```python
positions = bt.get_position_records()
print(positions)
```

---

##### `summary()`

æ‰“å°æ‰€æœ‰è‚¡ç¥¨çš„ç»¼åˆç»Ÿè®¡æ‘˜è¦ã€‚

**è¿”å›**ï¼šNoneï¼ˆç›´æ¥æ‰“å°è¾“å‡ºï¼‰

**åŒ…å«ç»Ÿè®¡é¡¹**ï¼š
1. **åŸºæœ¬ä¿¡æ¯**ï¼šæ€»èµ„äº§ã€æ€»æ”¶ç›Šã€æ”¶ç›Šç‡
2. **äº¤æ˜“ç»Ÿè®¡**ï¼šäº¤æ˜“æ¬¡æ•°ã€èƒœç‡ã€ç›ˆäºæ¯”
3. **æ”¶ç›Šåˆ†æ**ï¼šæœ€å¤§ç›ˆåˆ©/äºæŸã€å¹³å‡ç›ˆåˆ©/äºæŸ
4. **é£é™©æŒ‡æ ‡**ï¼šæœ€å¤§å›æ’¤ã€æœ€å¤§å›æ’¤ç™¾åˆ†æ¯”
5. **é£é™©è°ƒæ•´æ”¶ç›Š**ï¼šå¤æ™®æ¯”ç‡ã€ç´¢æè¯ºæ¯”ç‡ã€å¡å°”é©¬æ¯”ç‡
6. **æ—¶é—´åˆ†æ**ï¼šå¹³å‡æŒä»“å¤©æ•°ã€æœ€é•¿/æœ€çŸ­æŒä»“
7. **è¿ç»­ç»Ÿè®¡**ï¼šæœ€å¤§è¿ç»­ç›ˆåˆ©/äºæŸæ¬¡æ•°
8. **æœˆåº¦/å¹´åº¦æ”¶ç›Š**
9. **æ³¢åŠ¨ç‡æŒ‡æ ‡**
10. **åˆ†å¸ƒç»Ÿè®¡**ï¼šæ”¶ç›Šç‡åˆ†å¸ƒ
11. **èµ„é‡‘æ›²çº¿**ï¼šæœ€é«˜/æœ€ä½ç‚¹
12. **äº¤æ˜“é¢‘ç‡**

**ç¤ºä¾‹**ï¼š
```python
bt.summary()  # ç›´æ¥æ‰“å°ï¼Œæ— éœ€ print()
```

---

#### 4. ç»“æœæŸ¥è¯¢ - å•åªè‚¡ç¥¨

##### `get_stock_daily(symbol)`

è·å–æŒ‡å®šè‚¡ç¥¨çš„æ¯æ—¥èµ„é‡‘è®°å½•ã€‚

**å‚æ•°**ï¼š
- `symbol` (str): è‚¡ç¥¨ä»£ç 

**è¿”å›**ï¼šDataFrameï¼Œåˆ—åŒ `get_daily_records()`

**ç¤ºä¾‹**ï¼š
```python
stock_a_daily = bt.get_stock_daily("AAPL")
print(stock_a_daily)
```

---

##### `get_stock_positions(symbol)`

è·å–æŒ‡å®šè‚¡ç¥¨çš„äº¤æ˜“è®°å½•ã€‚

**å‚æ•°**ï¼š
- `symbol` (str): è‚¡ç¥¨ä»£ç 

**è¿”å›**ï¼šDataFrameï¼Œåˆ—åŒ `get_position_records()`

**ç¤ºä¾‹**ï¼š
```python
stock_a_positions = bt.get_stock_positions("AAPL")
print(stock_a_positions)
```

---

##### `get_stock_summary(symbol)`

æ‰“å°æŒ‡å®šè‚¡ç¥¨çš„ç»Ÿè®¡æ‘˜è¦ã€‚

**å‚æ•°**ï¼š
- `symbol` (str): è‚¡ç¥¨ä»£ç 

**è¿”å›**ï¼šstrï¼ˆç»Ÿè®¡æ‘˜è¦å­—ç¬¦ä¸²ï¼‰

**ç¤ºä¾‹**ï¼š
```python
print(bt.get_stock_summary("AAPL"))
```

---

### äºŒã€æŠ€æœ¯æŒ‡æ ‡å‡½æ•°

æ‰€æœ‰æŒ‡æ ‡å‡½æ•°æ¥å— Polars Series ä½œä¸ºè¾“å…¥ï¼Œè¿”å› Polars Series æˆ–å…ƒç»„ã€‚

#### 1. è¶‹åŠ¿æŒ‡æ ‡ (Overlap Studies)

##### ç§»åŠ¨å¹³å‡ç±»

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `sma(series, period)` | ç®€å•ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `ema(series, period)` | æŒ‡æ•°ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `wma(series, period)` | åŠ æƒç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `dema(series, period)` | åŒé‡æŒ‡æ•°ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `tema(series, period)` | ä¸‰é‡æŒ‡æ•°ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `trima(series, period)` | ä¸‰è§’ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `kama(series, period)` | è€ƒå¤«æ›¼è‡ªé€‚åº”ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `ma(series, period)` | é€šç”¨ç§»åŠ¨å¹³å‡ï¼ˆé»˜è®¤SMAï¼‰ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `t3(series, period, vfactor)` | T3 ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ<br>vfactor: ä½“ç§¯å› å­ | Series |

**ç¤ºä¾‹**ï¼š
```python
import polars as pl
from polars_quant import sma, ema, wma

df = pl.DataFrame({"close": [100, 102, 101, 105, 107, 110]})
df = df.with_columns([
    sma(pl.col("close"), 3).alias("sma_3"),
    ema(pl.col("close"), 3).alias("ema_3"),
    wma(pl.col("close"), 3).alias("wma_3"),
])
```

---

##### å¸ƒæ—å¸¦ä¸é€šé“

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `bband(series, period, std_dev)` | å¸ƒæ—å¸¦ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ<br>std_dev: æ ‡å‡†å·®å€æ•° | (upper, middle, lower) |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import bband

upper, middle, lower = bband(pl.col("close"), 20, 2.0)
df = df.with_columns([
    upper.alias("bb_upper"),
    middle.alias("bb_middle"),
    lower.alias("bb_lower"),
])
```

---

##### MAMA è‡ªé€‚åº”å‡çº¿

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `mama(series, fast_limit, slow_limit)` | MESA è‡ªé€‚åº”ç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>fast_limit: å¿«é€Ÿé™åˆ¶<br>slow_limit: æ…¢é€Ÿé™åˆ¶ | (mama, fama) |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import mama

mama_line, fama_line = mama(pl.col("close"), 0.5, 0.05)
```

---

##### å¯å˜å‘¨æœŸå‡çº¿

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `mavp(series, periods, min_period, max_period)` | å¯å˜å‘¨æœŸç§»åŠ¨å¹³å‡ | series: ä»·æ ¼åºåˆ—<br>periods: å‘¨æœŸåºåˆ—<br>min_period: æœ€å°å‘¨æœŸ<br>max_period: æœ€å¤§å‘¨æœŸ | Series |

---

##### ä»·æ ¼ä½ç½®æŒ‡æ ‡

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `midpoint(series, period)` | ä¸­ç‚¹ä»·æ ¼ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `midprice_hl(high, low, period)` | æœ€é«˜æœ€ä½ä¸­ç‚¹ | high: æœ€é«˜ä»·<br>low: æœ€ä½ä»·<br>period: å‘¨æœŸ | Series |

---

##### æŠ›ç‰©çº¿æŒ‡æ ‡

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `sar(high, low, acceleration, maximum)` | æŠ›ç‰©çº¿è½¬å‘æŒ‡æ ‡ | high: æœ€é«˜ä»·<br>low: æœ€ä½ä»·<br>acceleration: åŠ é€Ÿå› å­<br>maximum: æœ€å¤§å€¼ | Series |
| `sarext(high, low, startvalue, offsetonreverse, accelerationinitlong, accelerationlong, accelerationmaxlong, accelerationinitshort, accelerationshort, accelerationmaxshort)` | æ‰©å±•æŠ›ç‰©çº¿æŒ‡æ ‡ | å¤šä¸ªå‚æ•°é…ç½® | Series |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import sar

sar_values = sar(pl.col("high"), pl.col("low"), 0.02, 0.2)
```

---

#### 2. åŠ¨é‡æŒ‡æ ‡ (Momentum Indicators)

##### ADX ç³»åˆ—ï¼ˆå¹³å‡è¶‹å‘æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `adx(high, low, close, period)` | å¹³å‡è¶‹å‘æŒ‡æ ‡ | high/low/close: ä»·æ ¼<br>period: å‘¨æœŸ | Series |
| `adxr(high, low, close, period)` | å¹³å‡è¶‹å‘è¯„ä¼° | åŒä¸Š | Series |
| `plus_di(high, low, close, period)` | æ­£å‘æŒ‡æ ‡ | åŒä¸Š | Series |
| `minus_di(high, low, close, period)` | è´Ÿå‘æŒ‡æ ‡ | åŒä¸Š | Series |
| `plus_dm(high, low, period)` | æ­£å‘åŠ¨å‘ | high/low: ä»·æ ¼<br>period: å‘¨æœŸ | Series |
| `minus_dm(high, low, period)` | è´Ÿå‘åŠ¨å‘ | åŒä¸Š | Series |
| `dx(high, low, close, period)` | æ–¹å‘æ€§æŒ‡æ ‡ | high/low/close: ä»·æ ¼<br>period: å‘¨æœŸ | Series |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import adx, plus_di, minus_di

df = df.with_columns([
    adx(pl.col("high"), pl.col("low"), pl.col("close"), 14).alias("adx"),
    plus_di(pl.col("high"), pl.col("low"), pl.col("close"), 14).alias("plus_di"),
    minus_di(pl.col("high"), pl.col("low"), pl.col("close"), 14).alias("minus_di"),
])
```

---

##### APO/PPOï¼ˆä»·æ ¼éœ‡è¡å™¨ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `apo(series, fast_period, slow_period)` | ç»å¯¹ä»·æ ¼éœ‡è¡å™¨ | series: ä»·æ ¼åºåˆ—<br>fast_period: å¿«å‘¨æœŸ<br>slow_period: æ…¢å‘¨æœŸ | Series |
| `ppo(series, fast_period, slow_period)` | ç™¾åˆ†æ¯”ä»·æ ¼éœ‡è¡å™¨ | åŒä¸Š | Series |

---

##### Aroon ç³»åˆ—

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `aroon(high, low, period)` | Aroon æŒ‡æ ‡ | high/low: ä»·æ ¼<br>period: å‘¨æœŸ | (aroon_up, aroon_down) |
| `aroonosc(high, low, period)` | Aroon éœ‡è¡å™¨ | åŒä¸Š | Series |

---

##### BOPï¼ˆå‡åŠ¿æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `bop(open, high, low, close)` | å‡åŠ¿æŒ‡æ ‡ | OHLC ä»·æ ¼ | Series |

---

##### CCIï¼ˆå•†å“é€šé“æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `cci(high, low, close, period)` | å•†å“é€šé“æŒ‡æ ‡ | high/low/close: ä»·æ ¼<br>period: å‘¨æœŸ | Series |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import cci

cci_values = cci(pl.col("high"), pl.col("low"), pl.col("close"), 14)
```

---

##### CMOï¼ˆé’±å¾·åŠ¨é‡æ‘†åŠ¨æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `cmo(series, period)` | é’±å¾·åŠ¨é‡æ‘†åŠ¨æŒ‡æ ‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |

---

##### MACD ç³»åˆ—

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `macd(series, fast, slow, signal)` | MACD æŒ‡æ ‡ | series: ä»·æ ¼åºåˆ—<br>fast/slow/signal: å‘¨æœŸ | (macd, signal, hist) |
| `macdext(series, fast, slow, signal, fast_matype, slow_matype, signal_matype)` | æ‰©å±• MACD | åŒä¸Š + MA ç±»å‹ | (macd, signal, hist) |
| `macdfix(series, signal)` | å›ºå®šå‚æ•° MACD | series: ä»·æ ¼åºåˆ—<br>signal: ä¿¡å·å‘¨æœŸ | (macd, signal, hist) |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import macd

macd_line, signal_line, hist = macd(pl.col("close"), 12, 26, 9)
df = df.with_columns([
    macd_line.alias("macd"),
    signal_line.alias("signal"),
    hist.alias("hist"),
])
```

---

##### MFIï¼ˆèµ„é‡‘æµé‡æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `mfi(high, low, close, volume, period)` | èµ„é‡‘æµé‡æŒ‡æ ‡ | HLCV æ•°æ®<br>period: å‘¨æœŸ | Series |

---

##### MOMï¼ˆåŠ¨é‡æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `mom(series, period)` | åŠ¨é‡æŒ‡æ ‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |

---

##### ROC ç³»åˆ—ï¼ˆå˜åŒ–ç‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `roc(series, period)` | å˜åŒ–ç‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |
| `rocp(series, period)` | ç™¾åˆ†æ¯”å˜åŒ–ç‡ | åŒä¸Š | Series |
| `rocr(series, period)` | æ¯”ç‡å˜åŒ–ç‡ | åŒä¸Š | Series |
| `rocr100(series, period)` | ç™¾å€æ¯”ç‡å˜åŒ–ç‡ | åŒä¸Š | Series |

---

##### RSIï¼ˆç›¸å¯¹å¼ºå¼±æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `rsi(series, period)` | ç›¸å¯¹å¼ºå¼±æŒ‡æ ‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸï¼ˆé€šå¸¸14ï¼‰ | Series |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import rsi

rsi_values = rsi(pl.col("close"), 14)
df = df.with_columns(rsi_values.alias("rsi"))
```

---

##### Stochastic ç³»åˆ—ï¼ˆéšæœºæŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `stoch(high, low, close, k_period, d_period)` | æ…¢é€ŸéšæœºæŒ‡æ ‡ | HLC ä»·æ ¼<br>k/d å‘¨æœŸ | (k, d) |
| `stochf(high, low, close, k_period, d_period)` | å¿«é€ŸéšæœºæŒ‡æ ‡ | åŒä¸Š | (k, d) |
| `stochrsi(series, period, k_period, d_period)` | RSI éšæœºæŒ‡æ ‡ | series: ä»·æ ¼åºåˆ—<br>period/k/d: å‘¨æœŸ | (k, d) |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import stoch

k, d = stoch(pl.col("high"), pl.col("low"), pl.col("close"), 14, 3)
df = df.with_columns([k.alias("stoch_k"), d.alias("stoch_d")])
```

---

##### TRIXï¼ˆä¸‰é‡æŒ‡æ•°å¹³æ»‘ç§»åŠ¨å¹³å‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `trix(series, period)` | TRIX æŒ‡æ ‡ | series: ä»·æ ¼åºåˆ—<br>period: å‘¨æœŸ | Series |

---

##### ULTOSCï¼ˆç»ˆæéœ‡è¡å™¨ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `ultosc(high, low, close, period1, period2, period3)` | ç»ˆæéœ‡è¡å™¨ | HLC ä»·æ ¼<br>ä¸‰ä¸ªå‘¨æœŸ | Series |

---

##### WILLRï¼ˆå¨å»‰æŒ‡æ ‡ï¼‰

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `willr(high, low, close, period)` | å¨å»‰ %R | HLC ä»·æ ¼<br>period: å‘¨æœŸ | Series |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import willr

willr_values = willr(pl.col("high"), pl.col("low"), pl.col("close"), 14)
```

---

#### 3. æˆäº¤é‡æŒ‡æ ‡ (Volume Indicators)

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `ad(high, low, close, volume)` | ç´¯ç§¯/æ´¾å‘çº¿ | HLCV æ•°æ® | Series |
| `adosc(high, low, close, volume, fast, slow)` | ç´¯ç§¯/æ´¾å‘éœ‡è¡å™¨ | HLCV æ•°æ®<br>fast/slow: å‘¨æœŸ | Series |
| `obv(close, volume)` | èƒ½é‡æ½®æŒ‡æ ‡ | close/volume: ä»·æ ¼å’Œæˆäº¤é‡ | Series |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import ad, obv

df = df.with_columns([
    ad(pl.col("high"), pl.col("low"), pl.col("close"), pl.col("volume")).alias("ad"),
    obv(pl.col("close"), pl.col("volume")).alias("obv"),
])
```

---

#### 4. æ³¢åŠ¨ç‡æŒ‡æ ‡ (Volatility Indicators)

| å‡½æ•° | è¯´æ˜ | å‚æ•° | è¿”å› |
|------|------|------|------|
| `trange(high, low, close)` | çœŸå®èŒƒå›´ | HLC ä»·æ ¼ | Series |

**ç¤ºä¾‹**ï¼š
```python
from polars_quant import trange

tr = trange(pl.col("high"), pl.col("low"), pl.col("close"))
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¤ºä¾‹ 1ï¼šåŸºç¡€å›æµ‹

```python
import polars as pl
from polars_quant import Backtest

# å‡†å¤‡æ•°æ®
dates = pl.date_range(
    start=pl.date(2023, 1, 1),
    end=pl.date(2023, 12, 31),
    interval="1d",
    eager=True
).cast(str)

n = len(dates)

# ä»·æ ¼æ•°æ®
prices_df = pl.DataFrame({
    "date": dates,
    "AAPL": [100 + i * 0.3 for i in range(n)],
    "MSFT": [200 + i * 0.5 for i in range(n)],
})

# ä¹°å–ä¿¡å·ï¼ˆå¸ƒå°”å€¼ï¼šTrue è¡¨ç¤ºä¹°å…¥/å–å‡ºï¼ŒFalse è¡¨ç¤ºä¸æ“ä½œï¼‰
buy_signals_df = pl.DataFrame({
    "date": dates,
    "AAPL": [i in [10, 100, 200] for i in range(n)],  # ç¬¬10ã€100ã€200å¤©ä¹°å…¥
    "MSFT": [i in [20, 120, 220] for i in range(n)],  # ç¬¬20ã€120ã€220å¤©ä¹°å…¥
})

sell_signals_df = pl.DataFrame({
    "date": dates,
    "AAPL": [i in [60, 150, 280] for i in range(n)],  # ç¬¬60ã€150ã€280å¤©å–å‡º
    "MSFT": [i in [70, 170, 300] for i in range(n)],  # ç¬¬70ã€170ã€300å¤©å–å‡º
})

# åˆ›å»ºå¹¶è¿è¡Œå›æµ‹
bt = Backtest(
    prices=prices_df,
    buy_signals=buy_signals_df,
    sell_signals=sell_signals_df,
    initial_capital=100000.0,
    commission_rate=0.0003,
    min_commission=5.0,
    slippage=0.001
)

bt.run()

# æŸ¥çœ‹ç»“æœ
bt.summary()  # ç»¼åˆç»Ÿè®¡
daily = bt.get_daily_records()  # æ¯æ—¥è®°å½•
positions = bt.get_position_records()  # äº¤æ˜“è®°å½•
```

---

### ç¤ºä¾‹ 2ï¼šæŠ€æœ¯æŒ‡æ ‡è®¡ç®—

```python
import polars as pl
from polars_quant import sma, ema, rsi, macd, bband

# è¯»å–æ•°æ®
df = pl.read_csv("stock_data.csv")

# è®¡ç®—å¤šä¸ªæŒ‡æ ‡
df = df.with_columns([
    # ç§»åŠ¨å¹³å‡
    sma(pl.col("close"), 5).alias("sma_5"),
    sma(pl.col("close"), 20).alias("sma_20"),
    ema(pl.col("close"), 12).alias("ema_12"),
    
    # RSI
    rsi(pl.col("close"), 14).alias("rsi"),
])

# MACD
macd_line, signal_line, hist = macd(pl.col("close"), 12, 26, 9)
df = df.with_columns([
    macd_line.alias("macd"),
    signal_line.alias("signal"),
    hist.alias("hist"),
])

# å¸ƒæ—å¸¦
upper, middle, lower = bband(pl.col("close"), 20, 2.0)
df = df.with_columns([
    upper.alias("bb_upper"),
    middle.alias("bb_middle"),
    lower.alias("bb_lower"),
])

print(df)
```

---

### ç¤ºä¾‹ 3ï¼šå•è‚¡ç¥¨æ·±åº¦åˆ†æ

```python
# è¿è¡Œå›æµ‹å
bt.run()

# æŸ¥çœ‹å•åªè‚¡ç¥¨
stock_daily = bt.get_stock_daily("AAPL")
stock_positions = bt.get_stock_positions("AAPL")
print(bt.get_stock_summary("AAPL"))

# æ—¶é—´æ®µç­›é€‰
q1_data = bt.get_stock_daily("AAPL").filter(
    (pl.col("date") >= "2023-01-01") & (pl.col("date") <= "2023-03-31")
)

# æ‰¾å‡ºæœ€ä½³/æœ€å·®äº¤æ˜“
all_positions = bt.get_position_records()
best_trade = all_positions.filter(pl.col("symbol") == "AAPL").sort("pnl", descending=True).head(1)
worst_trade = all_positions.filter(pl.col("symbol") == "AAPL").sort("pnl").head(1)
```

---

## ğŸ¯ å›æµ‹ç‰¹æ€§è¯´æ˜

### ç‹¬ç«‹èµ„é‡‘æ± 
æ¯åªè‚¡ç¥¨ä½¿ç”¨ç‹¬ç«‹çš„åˆå§‹èµ„é‡‘æ± ï¼Œäº’ä¸å½±å“ã€‚é€‚åˆæµ‹è¯•å¤šç­–ç•¥æˆ–å¯¹æ¯”ä¸åŒè‚¡ç¥¨è¡¨ç°ã€‚

### æ™ºèƒ½å¹¶è¡Œ
- **< 4 åªè‚¡ç¥¨**ï¼šä¸²è¡Œæ‰§è¡Œï¼ˆé¿å…çº¿ç¨‹å¼€é”€ï¼‰
- **â‰¥ 4 åªè‚¡ç¥¨**ï¼šå¹¶è¡Œæ‰§è¡Œï¼Œçº¿ç¨‹æ•° = min(è‚¡ç¥¨æ•°, CPUæ ¸å¿ƒæ•°)

### äº¤æ˜“è§„åˆ™
- **æ•´ç™¾è‚¡äº¤æ˜“**ï¼šè‡ªåŠ¨è®¡ç®—å¯ä¹°å…¥çš„ 100 è‚¡å€æ•°
- **ä½£é‡‘è®¡ç®—**ï¼š`max(äº¤æ˜“é‡‘é¢ Ã— è´¹ç‡, æœ€ä½ä½£é‡‘)`
- **æ»‘ç‚¹æ¨¡æ‹Ÿ**ï¼šä¹°å…¥ä»·ä¸Šæµ®ï¼Œå–å‡ºä»·ä¸‹è°ƒ

### å¼ºåˆ¶å¹³ä»“
å›æµ‹ç»“æŸæ—¶è‡ªåŠ¨å¹³ä»“æ‰€æœ‰æŒä»“ï¼ŒæŒ‰æœ€åä¸€æ—¥æ”¶ç›˜ä»·è®¡ç®—ã€‚

---

## ğŸ“Š ç»Ÿè®¡æŒ‡æ ‡è¯´æ˜

`summary()` æä¾›çš„è¯¦ç»†ç»Ÿè®¡åŒ…æ‹¬ï¼š

- **å¤æ™®æ¯”ç‡** (Sharpe Ratio)ï¼šé£é™©è°ƒæ•´åæ”¶ç›Š
- **ç´¢æè¯ºæ¯”ç‡** (Sortino Ratio)ï¼šåªè€ƒè™‘ä¸‹è¡Œé£é™©çš„æ”¶ç›Šç‡
- **å¡å°”é©¬æ¯”ç‡** (Calmar Ratio)ï¼šå¹´åŒ–æ”¶ç›Šç‡ / æœ€å¤§å›æ’¤
- **æœ€å¤§å›æ’¤** (Max Drawdown)ï¼šèµ„é‡‘æ›²çº¿æœ€å¤§è·Œå¹…
- **èƒœç‡** (Win Rate)ï¼šç›ˆåˆ©äº¤æ˜“å æ¯”
- **ç›ˆäºæ¯”** (Profit Factor)ï¼šæ€»ç›ˆåˆ© / æ€»äºæŸ
- **æŒä»“ç»Ÿè®¡**ï¼šå¹³å‡/æœ€é•¿/æœ€çŸ­æŒä»“å¤©æ•°
- **è¿ç»­ç»Ÿè®¡**ï¼šæœ€å¤§è¿ç»­ç›ˆåˆ©/äºæŸæ¬¡æ•°

---

## ğŸ”§ å¼€å‘

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/Firstastor/polars-quant.git
cd polars-quant

# å®‰è£…å¼€å‘ä¾èµ–
pip install maturin

# å¼€å‘æ¨¡å¼ç¼–è¯‘
maturin develop

# å‘å¸ƒæ¨¡å¼ç¼–è¯‘ï¼ˆæ›´å¿«ï¼‰
maturin develop --release
```

---

## ğŸ“„ è®¸å¯è¯

MIT License

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

## ğŸ“§ è”ç³»

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ [Issue](https://github.com/Firstastor/polars-quant/issues)ã€‚


