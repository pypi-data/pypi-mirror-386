datasets>=4.0.0
megatron-fsdp
pybind11
pyyaml
torch<=2.8.0
torchdata
transformers<=4.55.4
wandb
torchao

[:platform_machine == "x86_64" and platform_system != "Darwin"]
bitsandbytes==0.45.5
liger-kernel>=0.5.9

[fa]
flash-attn<=2.8.3

[moe]
transformer-engine[pytorch]==2.5.0

[vlm]
pillow
transformers<=4.55.4
timm==1.0.16
backoff
numpy
numba
mistral_common[opencv]

[vlm:platform_machine == "x86_64" and platform_system != "Darwin"]
qwen-vl-utils[decord]
torchcodec
