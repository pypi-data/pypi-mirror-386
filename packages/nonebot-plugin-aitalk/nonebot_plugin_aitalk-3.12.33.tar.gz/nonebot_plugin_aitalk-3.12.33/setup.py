# -*- coding: utf-8 -*-
from setuptools import setup

packages = \
['nonebot_plugin_aitalk']

package_data = \
{'': ['*']}

install_requires = \
['aiofiles>=24.1.0,<25.0.0',
 'fish_audio_sdk>=2025.4.2,<2026.0.0',
 'nonebot-adapter-onebot>=2.0.0,<3.0.0',
 'nonebot-plugin-localstore>=0.7.3,<0.8.0',
 'nonebot2>=2.2.0,<3.0.0',
 'openai>=1.0.0,<2.0.0',
 'silk-python>=0.2.6,<0.3.0']

setup_kwargs = {
    'name': 'nonebot-plugin-aitalk',
    'version': '3.12.33',
    'description': '简单好用的AI聊天插件，支持多API，支持让AI理解图片，发送表情包，合成语音，艾特，戳一戳，禁言/解除禁言等；可配置关键词允许AI主动发言',
    'long_description': '<div align="center">\n  <a href="https://v2.nonebot.dev/store"><img src="https://github.com/A-kirami/nonebot-plugin-template/blob/resources/nbp_logo.png" width="180" height="180" alt="NoneBotPluginLogo"></a>\n  <img src="https://github.com/WStudioGroup/hifumi-plugins/blob/main/remove.photos-removed-background.png" width="200">\n  <br>\n  <p><img src="https://github.com/A-kirami/nonebot-plugin-template/blob/resources/NoneBotPlugin.svg" width="240" alt="NoneBotPluginText"></p>\n</div>\n\n<div align="center">\n\n# nonebot-plugin-aitalk\n\n_✨ 简单好用的 AI 聊天插件 ✨_\n\n<a href="./LICENSE">\n    <img src="https://img.shields.io/github/license/captain-wangrun-cn/nonebot-plugin-aitalk.svg" alt="license">\n</a>\n<a href="https://pypi.python.org/pypi/nonebot-plugin-aitalk">\n    <img src="https://img.shields.io/pypi/v/nonebot-plugin-aitalk.svg" alt="pypi">\n</a>\n<img src="https://img.shields.io/badge/python-3.9+-blue.svg" alt="python">\n\n</div>\n\n## 📖 介绍\n\n简单好用的 AI 聊天插件，支持多 API，支持让 AI 理解图片，发送表情包，合成语音，艾特，禁言/解除禁言，戳一戳等；可配置关键词允许 AI 主动发言\n\n> [!IMPORTANT]\n> 写的比较史，欢迎提 pr 或 issue！\n\n## 🆕 特色\n\n### AI 可以发的\n\n- 表情包\n- 语音（非预设语录，AI 想说什么就生成什么）\n- 戳一戳\n- 艾特\n- 群内禁言\n\n### 可以发给 AI 的 (AI 可以理解的)\n\n- 图片/表情包 (需模型支持)\n<!--- 联网搜索 (需模型支持)-->\n\n## 💿 安装\n\n<details open>\n<summary>使用 nb-cli 安装</summary>\n在 nonebot2 项目的根目录下打开命令行, 输入以下指令即可安装\n\n    nb plugin install nonebot-plugin-aitalk\n\n</details>\n\n<details>\n<summary>使用包管理器安装</summary>\n在 nonebot2 项目的插件目录下, 打开命令行, 根据你使用的包管理器, 输入相应的安装命令\n\n<details>\n<summary>pip</summary>\n\n    pip install nonebot-plugin-aitalk\n\n</details>\n\n打开 nonebot2 项目根目录下的 `pyproject.toml` 文件, 在 `[tool.nonebot]` 部分追加写入\n\n    plugins = ["nonebot_plugin_aitalk"]\n\n</details>\n\n## ⚙️ 配置\n\n在 nonebot2 项目的`.env`文件中添加下表中的必填配置\n\n### 必填项\n\n|         配置项         | 类型 | 必填 | 默认值 |                 说明                 |\n| :--------------------: | :--: | :--: | :----: | :----------------------------------: |\n|    aitalk_api_list     | list |  是  |  [ ]   | API 列表，支持多个 API，格式请往下看 |\n| aitalk_available_memes | list |  是  |  [ ]   |   AI 可以发送的表情包，格式请往下    |\n\n<details>\n<summary>aitalk_api_list（api列表）格式</summary>\n  \n```json\n[\n{\n    "name": "向用户展示的模型名称",\n    "api_key": "你的api key",\n    "model_name": "请求api用的模型名称",\n    "api_url": "api接口地址",\n    "image_input": 是否支持图片输入，适用于Qwen2.5-vl等多模态模型,默认为false\n    "send_thinking": 当有思维链时是否发送,默认为false\n    "description": "模型描述，用于展示给用户(非必填)"\n},\n{\n    "name": "向用户展示的模型名称2",\n    "api_key": "你的api key2",\n    "model_name": "请求api用的模型名称2",\n    "api_url": "api接口地址2"\n}\n]\n```\n\n</details>\n\n<details>\n<summary>aitalk_available_memes（AI可以发送的表情包）格式</summary>\n\n```json\n[\n  {\n    "url": "图片地址，支持链接或本地路径。⚠️⚠️注意！如果是windows系统的本地路径，请将路径中的换成/，可以看下面的配置示例⚠️⚠️",\n    "desc": "图片描述，告诉AI这张表情包是什么内容，用于什么场景等等"\n  },\n  {\n    "url": "图片地址2",\n    "desc": "图片描述2"\n  }\n]\n```\n\n</details>\n\n### 选填项\n\n#### 模型\n\n|        配置项        | 类型 | 必填 | 默认值 |      说明      |\n| :------------------: | :--: | :--: | :----: | :------------: |\n| aitalk_default_model | str  |  否  |   ""   | 默认选择的模型 |\n\n#### 提示词\n\n|           配置项            | 类型 | 必填 |                                            默认值                                            |                                                                   说明                                                                    |\n| :-------------------------: | :--: | :--: | :------------------------------------------------------------------------------------------: | :---------------------------------------------------------------------------------------------------------------------------------------: |\n|    aitalk_default_prompt    | str  |  否  | "你的回答应该尽量简洁、幽默、可以使用一些语气词、颜文字。你应该拒绝回答任何政治相关的问题。" |                                                                默认提示词                                                                 |\n| aitalk_disable_busy_prompts | bool |  否  |                                            False                                             |                                     是否关闭诸如“不要着急哦！”或“你的操作太频繁了哦！”之类的提示信息                                      |\n| aitalk_default_prompt_file  | str  |  否  |                                              ""                                              |                         默认提示词文件路径，与提示词二选一，优先使用文件。请注意将 windows 系统路径中的\\替换成\\\\                          |\n|  aitalk_group_prompts_dir   | str  |  否  |                               "./aitalk_config/group_prompts"                                | 分群提示词文件路径，在该路径下存放"群号.txt"文件，(例如: ./aitalk_config/group_prompts/12345.txt)。请注意将 windows 系统路径中的\\替换成\\\\ |\n\n#### 语音合成\n\n|       配置项       | 类型 | 必填 | 默认值 |            说明            |\n| :----------------: | :--: | :--: | :----: | :------------------------: |\n| aitalk_tts_enabled | bool |  否  | false  |      是否开启语音合成      |\n| aitalk_tts_config  | bool |  否  | false  | 语音合成配置，详细请看下方 |\n\n<details>\n<summary>aitalk_tts_config（语音合成配置）格式</summary>\n  \n```json\n{\n    "api_url": "API地址，若默认地址无法访问可以自己搭建一个反向代理",\n    "api_key": "API密钥",\n    "reference_id": "音色id"\n}\n```\n- 前往[FishAudio](https://fish.audio/zh-CN/go-api/billing/)注册登录，并充值（建议先一美元）\n- 创建一个API key并填入配置项![api_key](imgs/QQ20250507-133925.png)\n- 点击上面的`发现`，寻找你想要的音色（或者有能力的自己合成），点进去\n- 复制图片中地址的红圈部分，该部分就是id，填入配置即可![id](imgs/QQ20250507-134145.png)\n\n</details>\n\n#### 消息相关\n\n|                   配置项                    | 类型  | 必填 | 默认值 |                                               说明                                                |\n| :-----------------------------------------: | :---: | :--: | :----: | :-----------------------------------------------------------------------------------------------: |\n|           aitalk_reply_when_meme            | bool  |  否  |  true  |                                   当只有表情包时，是否回复消息                                    |\n|                aitalk_reply                 | bool  |  否  |  true  |                                           是否回复消息                                            |\n|        aitalk_message_send_delay_min        | float |  否  |  0.2   |                     发送多条消息时，每条之间的最小延迟（秒），设为 0 则不延迟                     |\n|        aitalk_message_send_delay_max        | float |  否  |  1.2   |                     发送多条消息时，每条之间的最大延迟（秒），设为 0 则不延迟                     |\n|     aitalk_active_reply_context_timeout     |  int  |  否  |  300   |                             机器人主动回复后，上下文的有效时间（秒）                              |\n| aitalk_active_reply_max_unrelated_followups |  int  |  否  |   3    | 在主动回复上下文中，AI 连续判断 N 次与追问无关后，关闭本次主动回复会话 (0 表示不启用此功能)（秒） |\n|      aitalk_group_active_reply_configs      | Dict  |  否  |   {}   |             分群独立主动回复配置。键为群号字符串，值为该群的特定配置,详见下方配置示例             |\n|         aitalk_active_reply_enabled         | bool  |  否  | False  |                                       是否启用主动回复功能                                        |\n\n#### 其他\n\n|                   配置项                   |   类型    | 必填 | 默认值 |                                         说明                                         |\n| :----------------------------------------: | :-------: | :--: | :----: | :----------------------------------------------------------------------------------: |\n|            aitalk_command_start            |    str    |  否  |   ""   |          对话触发前缀，例如“/对话”，类似 on_command，为空时直接艾特即可触发          |\n|          aitalk_completion_config          |   list    |  否  |  [ ]   |                                生成配置，格式请往下看                                |\n|          aitalk_max_split_length           |    int    |  否  |   5    |  最大分割长度，将会在 prompt 中告诉 ai，回复的消息数量不要大于这个值，可能不起作用   |\n|         aitalk_max_context_length          |    int    |  否  |   20   | 最长上下文消息数量，超过这个数量时，将会逐个抛弃最早的一条消息。这个数值包括设定消息 |\n|          aitalk_save_user_config           |   bool    |  否  |  true  |    是否保存用户配置，关闭 nonebot 时将会保存用户所选模型，对话内容等，启动时读取     |\n|          aitalk_default_available          |   bool    |  否  |  true  |                是否默认允许群聊使用，为 false 时需要手动使用指令开启                 |\n|      aitalk_default_available_private      |   bool    |  否  |  true  |                是否默认允许私聊使用，为 false 时需要手动使用指令开启                 |\n|               aitalk_chat_cd               |    int    |  否  |   5    |                                   聊天 cd，单位秒                                    |\n|        aitalk_active_reply_keywords        | list[str] |  否  |   []   |              主动回复的触发关键字列表, 例如 \'["问题", "请问", "大佬"]\'               |\n|      aitalk_active_reply_probability       |   float   |  否  |  0.3   |                    满足关键字后，触发主动回复的概率 (0.0 到 1.0)                     |\n| aitalk_active_reply_no_keyword_probability |   float   |  否  |  0.05  |          未满足关键字时，触发主动回复的概率 (0.0 到 1.0)，建议设置较低的值           |\n\n<details>\n<summary>aitalk_completion_config（生成配置）格式</summary>\n\n```json\n{\n    "max_token": 1024,\n    "temperature": 0.7\n    "top_p": 0.9\n}\n```\n\n</details>\n\n## ⚙️ 配置示例\n\n<details>\n<summary>env配置示例</summary>\n\n```\naitalk_default_model = "deepseekr1"\naitalk_api_list = \'\n[\n{\n    "name": "deepseekr1",\n    "api_key": "sk-1145141919810",\n    "model_name": "deepseek-ai/DeepSeek-R1",\n    "api_url": "https://api.siliconflow.cn/v1",\n    "send_thinking": true\n},\n{\n    "name": "gemma-27b",\n    "api_key": "sk-1145141919810",\n    "model_name": "google/gemma-2-27b-it",\n    "api_url": "https://api.siliconflow.cn/v1"\n}\n]\n\'\naitalk_available_memes = \'\n[\n{\n    "url": "D:/bots/imgs/1.png",\n    "desc": "很抱歉伤害到你"\n},\n{\n    "url": "D:/bots/imgs/3.png",\n    "desc": "啊哈哈...（感到尴尬）"\n}\n]\n\'\n\naitalk_default_prompt_file = "D:\\\\prompt\\\\日富美.txt"\naitalk_group_prompts_dir = "./aitalk_config/group_prompts"\n\naitalk_tts_enabled = true\naitalk_tts_config = \'\n{\n    "api_url": "https://api.fish.audio",\n    "api_key": "114514919810",\n    "reference_id": "fee77b5adcb840178e9596514d713a3b"\n}\n\'\n\naitalk_message_send_delay_min = 0.3\naitalk_message_send_delay_max = 1.2\n\naitalk_active_reply_enabled = true\naitalk_active_reply_keywords = \'["问题","请问","大佬","咋弄","咋搞","怎么","解压密码"]\'\naitalk_active_reply_probability = 1.0\naitalk_active_reply_no_keyword_probability = 0.05\naitalk_group_active_reply_configs = \'\n{\n    "123456": {\n        "keywords": ["临时触发词temp"],\n        "probability": 1.0,\n        "no_keyword_probability": 0.05\n    },\n    "654321": {\n        "keywords": ["问题","请问","大佬","咋弄","咋搞","怎么"],\n        "probability": 1.0,\n        "no_keyword_probability": 0.05\n    }\n}\'\n\naitalk_disable_busy_prompts = Ture\n```\n\n#### 多群自定义提示词参考配置\n\n<img src="imgs/Snipaste_2025-05-06_23-17-39.png">\n\n</details>\n\n## 🎉 使用\n\n### 指令表\n\n|     指令     |  权限   | 需要@ | 范围 |        说明        |\n| :----------: | :-----: | :---: | :--: | :----------------: |\n|   @机器人    |  群聊   |  是   | 群聊 | 艾特机器人即可聊天 |\n|   模型选择   |  群聊   |  否   | 群聊 |      选择模型      |\n| ai 对话 开启 | 管理员+ |  否   | 群聊 |  开启本群 ai 对话  |\n| ai 对话 关闭 | 管理员+ |  否   | 群聊 |  关闭本群 ai 对话  |\n| 清空聊天记录 |  群聊   |  否   | 群聊 |    清空对话记录    |\n\n### 效果图\n\n<img src="imgs/QQ20250222-232704.png">\n<img src="imgs/QQ20250222-232730.png">\n<img src="imgs/QQ20250222-232813.png">\n<img src="imgs/QQ20250507-134732.png">\n她不肯说qwq\n<img src="imgs/qq_pic_merged_1761231455574.jpg">\n\n### 🍟 参考\n\n[nonebot-plugin-llmchat](https://github.com/FuQuan233/nonebot-plugin-llmchat) 参考了部分代码以及 prompt\n\n## 贡献者\n\n<a href="https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/graphs/contributors">\n  <img src="https://contrib.rocks/image?repo=captain-wangrun-cn/nonebot-plugin-aitalk" />\n</a>\n\n## 📃 更新日志\n\n### 3.12.33（2025.10.23）\n\n- 🆕 添加解除禁言功能[#21](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/issues/21)\n\n### 3.11.33（2025.08.15）\n\n- 🐛 移除无用依赖\n\n### 3.11.32（2025.06.17）\n\n- 🐛 修复了语音配置报错问题\n\n### 3.11.31（2025.06.11）\n\n- 🐛 修复了起始符配置项不生效的问题[#20](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/issues/20)\n\n\n\n### 3.11.28（2025.05.25）\n\n- 🆕 新增默认模型配置项\n\n<details>\n<summary>之前更新</summary>\n### 3.11.30（2025.06.10）\n\n- 🐛 删除无用依赖\n- 🐛 修复某些 API 下的多模态模型出现 Error Code 400[#19](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/issues/19)\n\n### 3.11.29（2025.06.10）\n\n- 🐛 修复某些 API 下的多模态模型出现 Error Code 400[#19](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/issues/19)\n\n### 3.10.28（2025.05.21）\n\n- 🐛 修复“无需回复”BUG[PR#16](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/16)\n- 🆕 允许关闭提示[PR#16](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/16)\n- 🐛 修复某些情况下 QQ 图片因 SSL 无法下载的问题\n\n### 3.9.26（2025.05.12）\n\n- 🆕 更新多群配置主动触发关键词\n- 🔧 增加对 AI 返回的 JSON 字符串的解析的鲁棒性\n- [PR#15](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/15)\n\n### 3.8.25（2025.05.11）\n\n- 🆕 支持读取引用消息中的文本\n- 🆕 增加配置，允许 AI 在回复多条消息时增加随机延迟\n- 🆕 增加配置，允许在检测到关键词时询问 AI，由 AI 自主决定是否需要主动发言回复用户。\n- 🆕 增加独立的 JSON 修复功能，用于在主聊天 AI 返回的 JSON 格式错误后，尝试使用独立对话 AI 自动修复该 JSON 格式。\n- 🔧 更新 README.md 中的配置项\n- [PR#14](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/14)\n\n### 3.4.24（2025.05.08）\n\n- 🐛 修复戳一戳失败的问题[PR#13](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/13)\n\n### 3.5.23（2025.05.07）\n\n- 🆕 图片输入支持引用带有图片的消息[PR#12](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/12)\n- 🆕 支持多图输入[PR#12](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/12)\n- 🔧 添加了一些请求时的异常处理\n- 🐛 修复 README 中配置不完全\n\n### 3.4.22（2025.05.07）\n\n- 🆕 新增语音合成功能\n- 🔧 优化 README\n\n### 2.4.21（2025.05.07）\n\n- 🆕 新增分群不同提示词功能\n- 🐛 其他中量代码优化[PR#11]\n- (https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/11)\n\n### 2.3.20（2025.04.01）\n\n- 🐛 尝试修复思维链问题(#10)(https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/issues/10)\n- 🆕 添加了模型描述，选择模型时发送给用户\n\n### 2.3.19（2025.03.11）\n\n- 🐛 修复 Q 群管家检测 BUG\n\n### 2.3.18（2025.03.07）\n\n- 🐛 修复思维链输出\n\n### 2.3.17（2025.03.07）\n\n- 🐛 修复超出最长上下文数量时的 BUG\n- 🆕 增加禁言用户的功能[PR#8](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/8)\n\n### 2.2.16（2025.03.06）\n\n- 🐛 修复私聊开关 BUG\n\n### 2.2.15（2025.03.05）\n\n- 🆕 支持输出思维链(不推荐开启，思维可能错乱)\n- 🔧 优化 prompt\n- 🐛 再次修复读取“是否回复”配置项的 BUG，并测试通过[PR#5](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/5)\n\n### 2.1.14（2025.03.04）\n\n- 🐛 修复生成失败后队列未移除 BUG\n\n### 2.1.13（2025.03.04）\n\n- 🐛 修复路径 BUG 和配置读取 BUG[PR#4](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/pull/4)\n\n### 2.1.12（2025.03.04）\n\n- 🆕 支持让 AI 理解图片（图片输入）\n- 🐛 优化代码\n- 🆕 更改群聊聊天,支持管理员设置群内模型[#1](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/issues/1)\n- 🐛 修复连续对话问题[#2](https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk/issues/2)\n\n### 1.0.10（2025.03.02）\n\n- 🐛 修复了设置输入状态的问题\n\n### 1.0.9（2025.02.28）\n\n- 🐛 修复了私聊聊天的一些问题\n\n### 1.0.8（2025.02.28）\n\n- 🆕 添加了私聊聊天支持\n\n### 1.0.7（2025.02.25）\n\n- 🐛 更改 data.py\n\n### 1.0.6（2025.02.23）\n\n- 😡 排除 Q 群管家\n\n### 1.0.5（2025.02.23）\n\n- 🐛 修复了表情包链接问题\n\n### 1.0.4（2025.02.23）\n\n- 🐛 修复一些问题,更改 README\n\n### 1.0.3（2025.02.23）\n\n- ⬇️ 修复依赖问题\n\n### 1.0.2（2025.02.23）\n\n- 🐛 修复表情包本地路径问题\n\n### 1.0.1（2025.02.22）\n\n- 📝 更新 README\n\n### 1.0.0（2025.02.22）\n\n- 🎉 发布\n\n</details>\n',
    'author': 'WR',
    'author_email': 'wangrun114514@foxmail.com',
    'maintainer': None,
    'maintainer_email': None,
    'url': 'https://github.com/captain-wangrun-cn/nonebot-plugin-aitalk',
    'packages': packages,
    'package_data': package_data,
    'install_requires': install_requires,
    'python_requires': '>=3.9,<4.0',
}


setup(**setup_kwargs)
