{
  "name": "RunHistoricalDetectionJob",
  "fully_qualified_name": "DatadogApi.RunHistoricalDetectionJob@0.1.0",
  "description": "Initiate a historical detection job in Datadog.\n\nUse this tool to start a historical detection job via Datadog's SIEM API. It is called when there's a need to analyze past data using historical detections.",
  "toolkit": {
    "name": "ArcadeDatadogApi",
    "description": null,
    "version": "0.1.0"
  },
  "input": {
    "parameters": [
      {
        "name": "historical_job_request_data",
        "required": true,
        "description": "JSON object containing the job parameters for running a historical detection job, including rules, queries, and job options.",
        "value_schema": {
          "val_type": "json",
          "inner_val_type": null,
          "enum": null,
          "properties": {
            "data": {
              "val_type": "json",
              "inner_val_type": null,
              "enum": null,
              "properties": {
                "attributes": {
                  "val_type": "json",
                  "inner_val_type": null,
                  "enum": null,
                  "properties": {
                    "fromRule": {
                      "val_type": "json",
                      "inner_val_type": null,
                      "enum": null,
                      "properties": {
                        "from": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Starting time of data analyzed by the job."
                        },
                        "id": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "ID of the detection rule used to create the job."
                        },
                        "index": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Index used to load the data."
                        },
                        "notifications": {
                          "val_type": "array",
                          "inner_val_type": "string",
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Notifications sent when the job is completed."
                        },
                        "to": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Ending time of data analyzed by the job."
                        }
                      },
                      "inner_properties": null,
                      "description": "Definition of a historical job based on a security monitoring rule."
                    },
                    "id": {
                      "val_type": "string",
                      "inner_val_type": null,
                      "enum": null,
                      "properties": null,
                      "inner_properties": null,
                      "description": "Request ID."
                    },
                    "jobDefinition": {
                      "val_type": "json",
                      "inner_val_type": null,
                      "enum": null,
                      "properties": {
                        "calculatedFields": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "expression": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Expression."
                            },
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Field name."
                            }
                          },
                          "description": "Calculated fields."
                        },
                        "cases": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "actions": {
                              "val_type": "array",
                              "inner_val_type": "json",
                              "enum": null,
                              "properties": null,
                              "inner_properties": {
                                "options": {
                                  "val_type": "json",
                                  "inner_val_type": null,
                                  "enum": null,
                                  "properties": {
                                    "duration": {
                                      "val_type": "integer",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Duration of the action in seconds. 0 indicates no expiration."
                                    },
                                    "flaggedIPType": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": [
                                        "SUSPICIOUS",
                                        "FLAGGED"
                                      ],
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Used with the case action of type 'flag_ip'. The value specified in this field is applied as a flag to the IP addresses."
                                    },
                                    "userBehaviorName": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Used with the case action of type 'user_behavior'. The value specified in this field is applied as a risk tag to all users affected by the rule."
                                    }
                                  },
                                  "inner_properties": null,
                                  "description": "Options for the rule action"
                                },
                                "type": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": [
                                    "block_ip",
                                    "block_user",
                                    "user_behavior",
                                    "flag_ip"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The action type."
                                }
                              },
                              "description": "Action to perform for each rule case."
                            },
                            "condition": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "A case contains logical operations (`>`,`>=`, `&&`, `||`) to determine if a signal should be generated\nbased on the event counts in the previously defined queries."
                            },
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Name of the case."
                            },
                            "notifications": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Notification targets."
                            },
                            "status": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "info",
                                "low",
                                "medium",
                                "high",
                                "critical"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Severity of the Security Signal."
                            }
                          },
                          "description": "Cases used for generating job results."
                        },
                        "from": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Starting time of data analyzed by the job."
                        },
                        "groupSignalsBy": {
                          "val_type": "array",
                          "inner_val_type": "string",
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Additional grouping to perform on top of the existing groups in the query section. Must be a subset of the existing groups."
                        },
                        "index": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Index used to load the data."
                        },
                        "message": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Message for generated results."
                        },
                        "name": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Job name."
                        },
                        "options": {
                          "val_type": "json",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": {
                            "detectionMethod": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "threshold",
                                "new_value",
                                "anomaly_detection",
                                "impossible_travel",
                                "hardcoded",
                                "third_party",
                                "anomaly_threshold",
                                "sequence_detection"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "The detection method."
                            },
                            "evaluationWindow": {
                              "val_type": "integer",
                              "inner_val_type": null,
                              "enum": [
                                "0",
                                "60",
                                "300",
                                "600",
                                "900",
                                "1800",
                                "3600",
                                "7200",
                                "10800",
                                "21600",
                                "43200",
                                "86400"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time. For third party detection method, this field is not used."
                            },
                            "impossibleTravelOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "baselineUserLocations": {
                                  "val_type": "boolean",
                                  "inner_val_type": null,
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "If true, signals are suppressed for the first 24 hours. In that time, Datadog learns the user's regular\naccess locations. This can be helpful to reduce noise and infer VPN usage or credentialed API access."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on impossible travel detection method."
                            },
                            "keepAlive": {
                              "val_type": "integer",
                              "inner_val_type": null,
                              "enum": [
                                "0",
                                "60",
                                "300",
                                "600",
                                "900",
                                "1800",
                                "3600",
                                "7200",
                                "10800",
                                "21600",
                                "43200",
                                "86400"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Once a signal is generated, the signal will remain \"open\" if a case is matched at least once within\nthis keep alive window. For third party detection method, this field is not used."
                            },
                            "maxSignalDuration": {
                              "val_type": "integer",
                              "inner_val_type": null,
                              "enum": [
                                "0",
                                "60",
                                "300",
                                "600",
                                "900",
                                "1800",
                                "3600",
                                "7200",
                                "10800",
                                "21600",
                                "43200",
                                "86400"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "A signal will \"close\" regardless of the query being matched once the time exceeds the maximum duration.\nThis time is calculated from the first seen timestamp."
                            },
                            "newValueOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "forgetAfter": {
                                  "val_type": "integer",
                                  "inner_val_type": null,
                                  "enum": [
                                    "1",
                                    "2",
                                    "7",
                                    "14",
                                    "21",
                                    "28"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The duration in days after which a learned value is forgotten."
                                },
                                "learningDuration": {
                                  "val_type": "integer",
                                  "inner_val_type": null,
                                  "enum": [
                                    "0",
                                    "1",
                                    "7"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The duration in days during which values are learned, and after which signals will be generated for values that\nweren't learned. If set to 0, a signal will be generated for all new values after the first value is learned."
                                },
                                "learningMethod": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": [
                                    "duration",
                                    "threshold"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The learning method used to determine when signals should be generated for values that weren't learned."
                                },
                                "learningThreshold": {
                                  "val_type": "integer",
                                  "inner_val_type": null,
                                  "enum": [
                                    "0",
                                    "1"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "A number of occurrences after which signals will be generated for values that weren't learned."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on new value detection method."
                            },
                            "sequenceDetectionOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "stepTransitions": {
                                  "val_type": "array",
                                  "inner_val_type": "json",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": {
                                    "child": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Name of the child step."
                                    },
                                    "evaluationWindow": {
                                      "val_type": "integer",
                                      "inner_val_type": null,
                                      "enum": [
                                        "0",
                                        "60",
                                        "300",
                                        "600",
                                        "900",
                                        "1800",
                                        "3600",
                                        "7200",
                                        "10800",
                                        "21600",
                                        "43200",
                                        "86400"
                                      ],
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time. For third party detection method, this field is not used."
                                    },
                                    "parent": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Name of the parent step."
                                    }
                                  },
                                  "description": "Transitions defining the allowed order of steps and their evaluation windows."
                                },
                                "steps": {
                                  "val_type": "array",
                                  "inner_val_type": "json",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": {
                                    "condition": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Condition referencing rule queries (e.g., `a > 0`)."
                                    },
                                    "evaluationWindow": {
                                      "val_type": "integer",
                                      "inner_val_type": null,
                                      "enum": [
                                        "0",
                                        "60",
                                        "300",
                                        "600",
                                        "900",
                                        "1800",
                                        "3600",
                                        "7200",
                                        "10800",
                                        "21600",
                                        "43200",
                                        "86400"
                                      ],
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time. For third party detection method, this field is not used."
                                    },
                                    "name": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Unique name identifying the step."
                                    }
                                  },
                                  "description": "Steps that define the conditions to be matched in sequence."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on sequence detection method."
                            },
                            "thirdPartyRuleOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "defaultNotifications": {
                                  "val_type": "array",
                                  "inner_val_type": "string",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "Notification targets for the logs that do not correspond to any of the cases."
                                },
                                "defaultStatus": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": [
                                    "info",
                                    "low",
                                    "medium",
                                    "high",
                                    "critical"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "Severity of the Security Signal."
                                },
                                "rootQueries": {
                                  "val_type": "array",
                                  "inner_val_type": "json",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": {
                                    "groupByFields": {
                                      "val_type": "array",
                                      "inner_val_type": "string",
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Fields to group by."
                                    },
                                    "query": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Query to run on logs."
                                    }
                                  },
                                  "description": "Queries to be combined with third party case queries. Each of them can have different group by fields, to aggregate differently based on the type of alert."
                                },
                                "signalTitleTemplate": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "A template for the signal title; if omitted, the title is generated based on the case name."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on third party detection method."
                            }
                          },
                          "inner_properties": null,
                          "description": "Job options."
                        },
                        "queries": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "aggregation": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "count",
                                "cardinality",
                                "sum",
                                "max",
                                "new_value",
                                "geo_data",
                                "event_count",
                                "none"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "The aggregation type."
                            },
                            "dataSource": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "logs",
                                "audit",
                                "app_sec_spans",
                                "spans",
                                "security_runtime",
                                "network",
                                "events"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Source of events, either logs, audit trail, or Datadog events."
                            },
                            "distinctFields": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Field for which the cardinality is measured. Sent as an array."
                            },
                            "groupByFields": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Fields to group by."
                            },
                            "hasOptionalGroupByFields": {
                              "val_type": "boolean",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "When false, events without a group-by value are ignored by the query. When true, events with missing group-by fields are processed with `N/A`, replacing the missing values."
                            },
                            "metrics": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Group of target fields to aggregate over when using the sum, max, geo data, or new value aggregations. The sum, max, and geo data aggregations only accept one value in this list, whereas the new value aggregation accepts up to five values."
                            },
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Name of the query."
                            },
                            "query": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Query to run on logs."
                            }
                          },
                          "description": "Queries for selecting logs analyzed by the job."
                        },
                        "referenceTables": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "checkPresence": {
                              "val_type": "boolean",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Whether to include or exclude the matched values."
                            },
                            "columnName": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The name of the column in the reference table."
                            },
                            "logFieldPath": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The field in the log to match against the reference table."
                            },
                            "ruleQueryName": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The name of the query to apply the reference table to."
                            },
                            "tableName": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The name of the reference table."
                            }
                          },
                          "description": "Reference tables used in the queries."
                        },
                        "tags": {
                          "val_type": "array",
                          "inner_val_type": "string",
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Tags for generated signals."
                        },
                        "thirdPartyCases": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Name of the case."
                            },
                            "notifications": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Notification targets for each case."
                            },
                            "query": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "A query to map a third party event to this case."
                            },
                            "status": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "info",
                                "low",
                                "medium",
                                "high",
                                "critical"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Severity of the Security Signal."
                            }
                          },
                          "description": "Cases for generating results from third-party detection method. Only available for third-party detection method."
                        },
                        "to": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Ending time of data analyzed by the job."
                        },
                        "type": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Job type."
                        }
                      },
                      "inner_properties": null,
                      "description": "Definition of a historical job."
                    }
                  },
                  "inner_properties": null,
                  "description": "Run a historical job request."
                },
                "type": {
                  "val_type": "string",
                  "inner_val_type": null,
                  "enum": [
                    "historicalDetectionsJobCreate"
                  ],
                  "properties": null,
                  "inner_properties": null,
                  "description": "Type of data."
                }
              },
              "inner_properties": null,
              "description": "Data for running a historical job request."
            }
          },
          "inner_properties": null,
          "description": ""
        },
        "inferrable": true,
        "http_endpoint_parameter_name": "requestBody"
      }
    ]
  },
  "output": {
    "description": "Response from the API endpoint 'RunHistoricalJob'.",
    "available_modes": [
      "value",
      "error",
      "null"
    ],
    "value_schema": {
      "val_type": "json",
      "inner_val_type": null,
      "enum": null,
      "properties": null,
      "inner_properties": null,
      "description": null
    }
  },
  "requirements": {
    "authorization": null,
    "secrets": [
      {
        "key": "DATADOG_API_KEY"
      },
      {
        "key": "DATADOG_APPLICATION_KEY"
      },
      {
        "key": "DATADOG_BASE_URL"
      }
    ],
    "metadata": null
  },
  "deprecation_message": null,
  "metadata": {
    "object_type": "api_wrapper_tool",
    "version": "1.1.0",
    "description": "Tools that enable LLMs to interact directly with the Datadog API."
  },
  "http_endpoint": {
    "metadata": {
      "object_type": "http_endpoint",
      "version": "1.2.0",
      "description": ""
    },
    "url": "https://{datadog_base_url}/api/v2/siem-historical-detections/jobs",
    "http_method": "POST",
    "headers": {},
    "parameters": [
      {
        "name": "requestBody",
        "tool_parameter_name": "historical_job_request_data",
        "description": "",
        "value_schema": {
          "val_type": "json",
          "inner_val_type": null,
          "enum": null,
          "properties": {
            "data": {
              "val_type": "json",
              "inner_val_type": null,
              "enum": null,
              "properties": {
                "attributes": {
                  "val_type": "json",
                  "inner_val_type": null,
                  "enum": null,
                  "properties": {
                    "fromRule": {
                      "val_type": "json",
                      "inner_val_type": null,
                      "enum": null,
                      "properties": {
                        "from": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Starting time of data analyzed by the job."
                        },
                        "id": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "ID of the detection rule used to create the job."
                        },
                        "index": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Index used to load the data."
                        },
                        "notifications": {
                          "val_type": "array",
                          "inner_val_type": "string",
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Notifications sent when the job is completed."
                        },
                        "to": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Ending time of data analyzed by the job."
                        }
                      },
                      "inner_properties": null,
                      "description": "Definition of a historical job based on a security monitoring rule."
                    },
                    "id": {
                      "val_type": "string",
                      "inner_val_type": null,
                      "enum": null,
                      "properties": null,
                      "inner_properties": null,
                      "description": "Request ID."
                    },
                    "jobDefinition": {
                      "val_type": "json",
                      "inner_val_type": null,
                      "enum": null,
                      "properties": {
                        "calculatedFields": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "expression": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Expression."
                            },
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Field name."
                            }
                          },
                          "description": "Calculated fields."
                        },
                        "cases": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "actions": {
                              "val_type": "array",
                              "inner_val_type": "json",
                              "enum": null,
                              "properties": null,
                              "inner_properties": {
                                "options": {
                                  "val_type": "json",
                                  "inner_val_type": null,
                                  "enum": null,
                                  "properties": {
                                    "duration": {
                                      "val_type": "integer",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Duration of the action in seconds. 0 indicates no expiration."
                                    },
                                    "flaggedIPType": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": [
                                        "SUSPICIOUS",
                                        "FLAGGED"
                                      ],
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Used with the case action of type 'flag_ip'. The value specified in this field is applied as a flag to the IP addresses."
                                    },
                                    "userBehaviorName": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Used with the case action of type 'user_behavior'. The value specified in this field is applied as a risk tag to all users affected by the rule."
                                    }
                                  },
                                  "inner_properties": null,
                                  "description": "Options for the rule action"
                                },
                                "type": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": [
                                    "block_ip",
                                    "block_user",
                                    "user_behavior",
                                    "flag_ip"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The action type."
                                }
                              },
                              "description": "Action to perform for each rule case."
                            },
                            "condition": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "A case contains logical operations (`>`,`>=`, `&&`, `||`) to determine if a signal should be generated\nbased on the event counts in the previously defined queries."
                            },
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Name of the case."
                            },
                            "notifications": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Notification targets."
                            },
                            "status": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "info",
                                "low",
                                "medium",
                                "high",
                                "critical"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Severity of the Security Signal."
                            }
                          },
                          "description": "Cases used for generating job results."
                        },
                        "from": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Starting time of data analyzed by the job."
                        },
                        "groupSignalsBy": {
                          "val_type": "array",
                          "inner_val_type": "string",
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Additional grouping to perform on top of the existing groups in the query section. Must be a subset of the existing groups."
                        },
                        "index": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Index used to load the data."
                        },
                        "message": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Message for generated results."
                        },
                        "name": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Job name."
                        },
                        "options": {
                          "val_type": "json",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": {
                            "detectionMethod": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "threshold",
                                "new_value",
                                "anomaly_detection",
                                "impossible_travel",
                                "hardcoded",
                                "third_party",
                                "anomaly_threshold",
                                "sequence_detection"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "The detection method."
                            },
                            "evaluationWindow": {
                              "val_type": "integer",
                              "inner_val_type": null,
                              "enum": [
                                "0",
                                "60",
                                "300",
                                "600",
                                "900",
                                "1800",
                                "3600",
                                "7200",
                                "10800",
                                "21600",
                                "43200",
                                "86400"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time. For third party detection method, this field is not used."
                            },
                            "impossibleTravelOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "baselineUserLocations": {
                                  "val_type": "boolean",
                                  "inner_val_type": null,
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "If true, signals are suppressed for the first 24 hours. In that time, Datadog learns the user's regular\naccess locations. This can be helpful to reduce noise and infer VPN usage or credentialed API access."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on impossible travel detection method."
                            },
                            "keepAlive": {
                              "val_type": "integer",
                              "inner_val_type": null,
                              "enum": [
                                "0",
                                "60",
                                "300",
                                "600",
                                "900",
                                "1800",
                                "3600",
                                "7200",
                                "10800",
                                "21600",
                                "43200",
                                "86400"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Once a signal is generated, the signal will remain \"open\" if a case is matched at least once within\nthis keep alive window. For third party detection method, this field is not used."
                            },
                            "maxSignalDuration": {
                              "val_type": "integer",
                              "inner_val_type": null,
                              "enum": [
                                "0",
                                "60",
                                "300",
                                "600",
                                "900",
                                "1800",
                                "3600",
                                "7200",
                                "10800",
                                "21600",
                                "43200",
                                "86400"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "A signal will \"close\" regardless of the query being matched once the time exceeds the maximum duration.\nThis time is calculated from the first seen timestamp."
                            },
                            "newValueOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "forgetAfter": {
                                  "val_type": "integer",
                                  "inner_val_type": null,
                                  "enum": [
                                    "1",
                                    "2",
                                    "7",
                                    "14",
                                    "21",
                                    "28"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The duration in days after which a learned value is forgotten."
                                },
                                "learningDuration": {
                                  "val_type": "integer",
                                  "inner_val_type": null,
                                  "enum": [
                                    "0",
                                    "1",
                                    "7"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The duration in days during which values are learned, and after which signals will be generated for values that\nweren't learned. If set to 0, a signal will be generated for all new values after the first value is learned."
                                },
                                "learningMethod": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": [
                                    "duration",
                                    "threshold"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "The learning method used to determine when signals should be generated for values that weren't learned."
                                },
                                "learningThreshold": {
                                  "val_type": "integer",
                                  "inner_val_type": null,
                                  "enum": [
                                    "0",
                                    "1"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "A number of occurrences after which signals will be generated for values that weren't learned."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on new value detection method."
                            },
                            "sequenceDetectionOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "stepTransitions": {
                                  "val_type": "array",
                                  "inner_val_type": "json",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": {
                                    "child": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Name of the child step."
                                    },
                                    "evaluationWindow": {
                                      "val_type": "integer",
                                      "inner_val_type": null,
                                      "enum": [
                                        "0",
                                        "60",
                                        "300",
                                        "600",
                                        "900",
                                        "1800",
                                        "3600",
                                        "7200",
                                        "10800",
                                        "21600",
                                        "43200",
                                        "86400"
                                      ],
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time. For third party detection method, this field is not used."
                                    },
                                    "parent": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Name of the parent step."
                                    }
                                  },
                                  "description": "Transitions defining the allowed order of steps and their evaluation windows."
                                },
                                "steps": {
                                  "val_type": "array",
                                  "inner_val_type": "json",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": {
                                    "condition": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Condition referencing rule queries (e.g., `a > 0`)."
                                    },
                                    "evaluationWindow": {
                                      "val_type": "integer",
                                      "inner_val_type": null,
                                      "enum": [
                                        "0",
                                        "60",
                                        "300",
                                        "600",
                                        "900",
                                        "1800",
                                        "3600",
                                        "7200",
                                        "10800",
                                        "21600",
                                        "43200",
                                        "86400"
                                      ],
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time. For third party detection method, this field is not used."
                                    },
                                    "name": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Unique name identifying the step."
                                    }
                                  },
                                  "description": "Steps that define the conditions to be matched in sequence."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on sequence detection method."
                            },
                            "thirdPartyRuleOptions": {
                              "val_type": "json",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": {
                                "defaultNotifications": {
                                  "val_type": "array",
                                  "inner_val_type": "string",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "Notification targets for the logs that do not correspond to any of the cases."
                                },
                                "defaultStatus": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": [
                                    "info",
                                    "low",
                                    "medium",
                                    "high",
                                    "critical"
                                  ],
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "Severity of the Security Signal."
                                },
                                "rootQueries": {
                                  "val_type": "array",
                                  "inner_val_type": "json",
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": {
                                    "groupByFields": {
                                      "val_type": "array",
                                      "inner_val_type": "string",
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Fields to group by."
                                    },
                                    "query": {
                                      "val_type": "string",
                                      "inner_val_type": null,
                                      "enum": null,
                                      "properties": null,
                                      "inner_properties": null,
                                      "description": "Query to run on logs."
                                    }
                                  },
                                  "description": "Queries to be combined with third party case queries. Each of them can have different group by fields, to aggregate differently based on the type of alert."
                                },
                                "signalTitleTemplate": {
                                  "val_type": "string",
                                  "inner_val_type": null,
                                  "enum": null,
                                  "properties": null,
                                  "inner_properties": null,
                                  "description": "A template for the signal title; if omitted, the title is generated based on the case name."
                                }
                              },
                              "inner_properties": null,
                              "description": "Options on third party detection method."
                            }
                          },
                          "inner_properties": null,
                          "description": "Job options."
                        },
                        "queries": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "aggregation": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "count",
                                "cardinality",
                                "sum",
                                "max",
                                "new_value",
                                "geo_data",
                                "event_count",
                                "none"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "The aggregation type."
                            },
                            "dataSource": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "logs",
                                "audit",
                                "app_sec_spans",
                                "spans",
                                "security_runtime",
                                "network",
                                "events"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Source of events, either logs, audit trail, or Datadog events."
                            },
                            "distinctFields": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Field for which the cardinality is measured. Sent as an array."
                            },
                            "groupByFields": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Fields to group by."
                            },
                            "hasOptionalGroupByFields": {
                              "val_type": "boolean",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "When false, events without a group-by value are ignored by the query. When true, events with missing group-by fields are processed with `N/A`, replacing the missing values."
                            },
                            "metrics": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Group of target fields to aggregate over when using the sum, max, geo data, or new value aggregations. The sum, max, and geo data aggregations only accept one value in this list, whereas the new value aggregation accepts up to five values."
                            },
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Name of the query."
                            },
                            "query": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Query to run on logs."
                            }
                          },
                          "description": "Queries for selecting logs analyzed by the job."
                        },
                        "referenceTables": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "checkPresence": {
                              "val_type": "boolean",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Whether to include or exclude the matched values."
                            },
                            "columnName": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The name of the column in the reference table."
                            },
                            "logFieldPath": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The field in the log to match against the reference table."
                            },
                            "ruleQueryName": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The name of the query to apply the reference table to."
                            },
                            "tableName": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "The name of the reference table."
                            }
                          },
                          "description": "Reference tables used in the queries."
                        },
                        "tags": {
                          "val_type": "array",
                          "inner_val_type": "string",
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Tags for generated signals."
                        },
                        "thirdPartyCases": {
                          "val_type": "array",
                          "inner_val_type": "json",
                          "enum": null,
                          "properties": null,
                          "inner_properties": {
                            "name": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Name of the case."
                            },
                            "notifications": {
                              "val_type": "array",
                              "inner_val_type": "string",
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "Notification targets for each case."
                            },
                            "query": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": null,
                              "properties": null,
                              "inner_properties": null,
                              "description": "A query to map a third party event to this case."
                            },
                            "status": {
                              "val_type": "string",
                              "inner_val_type": null,
                              "enum": [
                                "info",
                                "low",
                                "medium",
                                "high",
                                "critical"
                              ],
                              "properties": null,
                              "inner_properties": null,
                              "description": "Severity of the Security Signal."
                            }
                          },
                          "description": "Cases for generating results from third-party detection method. Only available for third-party detection method."
                        },
                        "to": {
                          "val_type": "integer",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Ending time of data analyzed by the job."
                        },
                        "type": {
                          "val_type": "string",
                          "inner_val_type": null,
                          "enum": null,
                          "properties": null,
                          "inner_properties": null,
                          "description": "Job type."
                        }
                      },
                      "inner_properties": null,
                      "description": "Definition of a historical job."
                    }
                  },
                  "inner_properties": null,
                  "description": "Run a historical job request."
                },
                "type": {
                  "val_type": "string",
                  "inner_val_type": null,
                  "enum": [
                    "historicalDetectionsJobCreate"
                  ],
                  "properties": null,
                  "inner_properties": null,
                  "description": "Type of data."
                }
              },
              "inner_properties": null,
              "description": "Data for running a historical job request."
            }
          },
          "inner_properties": null,
          "description": ""
        },
        "accepted_as": "body",
        "required": true,
        "deprecated": false,
        "default": null,
        "documentation_urls": []
      }
    ],
    "documentation_urls": [],
    "secrets": [
      {
        "arcade_key": "DATADOG_API_KEY",
        "parameter_name": "DD-API-KEY",
        "accepted_as": "header",
        "formatted_value": null,
        "description": "",
        "is_auth_token": false
      },
      {
        "arcade_key": "DATADOG_APPLICATION_KEY",
        "parameter_name": "DD-APPLICATION-KEY",
        "accepted_as": "header",
        "formatted_value": null,
        "description": "",
        "is_auth_token": false
      },
      {
        "arcade_key": "DATADOG_BASE_URL",
        "parameter_name": "datadog_base_url",
        "accepted_as": "path",
        "formatted_value": null,
        "description": "",
        "is_auth_token": false
      }
    ],
    "request_body_spec": "{\n  \"content\": {\n    \"application/json\": {\n      \"schema\": {\n        \"description\": \"Run a historical job request.\",\n        \"properties\": {\n          \"data\": {\n            \"description\": \"Data for running a historical job request.\",\n            \"properties\": {\n              \"attributes\": {\n                \"description\": \"Run a historical job request.\",\n                \"properties\": {\n                  \"fromRule\": {\n                    \"description\": \"Definition of a historical job based on a security monitoring rule.\",\n                    \"properties\": {\n                      \"from\": {\n                        \"description\": \"Starting time of data analyzed by the job.\",\n                        \"example\": 1729843470000,\n                        \"format\": \"int64\",\n                        \"type\": \"integer\"\n                      },\n                      \"id\": {\n                        \"description\": \"ID of the detection rule used to create the job.\",\n                        \"example\": \"abc-def-ghi\",\n                        \"type\": \"string\"\n                      },\n                      \"index\": {\n                        \"description\": \"Index used to load the data.\",\n                        \"example\": \"cloud_siem\",\n                        \"type\": \"string\"\n                      },\n                      \"notifications\": {\n                        \"description\": \"Notifications sent when the job is completed.\",\n                        \"example\": [\n                          \"@sns-cloudtrail-results\"\n                        ],\n                        \"items\": {\n                          \"type\": \"string\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"to\": {\n                        \"description\": \"Ending time of data analyzed by the job.\",\n                        \"example\": 1729847070000,\n                        \"format\": \"int64\",\n                        \"type\": \"integer\"\n                      }\n                    },\n                    \"required\": [\n                      \"id\",\n                      \"from\",\n                      \"to\",\n                      \"index\"\n                    ],\n                    \"type\": \"object\"\n                  },\n                  \"id\": {\n                    \"description\": \"Request ID.\",\n                    \"type\": \"string\"\n                  },\n                  \"jobDefinition\": {\n                    \"description\": \"Definition of a historical job.\",\n                    \"properties\": {\n                      \"calculatedFields\": {\n                        \"description\": \"Calculated fields.\",\n                        \"items\": {\n                          \"description\": \"Calculated field.\",\n                          \"properties\": {\n                            \"expression\": {\n                              \"description\": \"Expression.\",\n                              \"example\": \"@request_end_timestamp - @request_start_timestamp\",\n                              \"type\": \"string\"\n                            },\n                            \"name\": {\n                              \"description\": \"Field name.\",\n                              \"example\": \"response_time\",\n                              \"type\": \"string\"\n                            }\n                          },\n                          \"required\": [\n                            \"name\",\n                            \"expression\"\n                          ],\n                          \"type\": \"object\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"cases\": {\n                        \"description\": \"Cases used for generating job results.\",\n                        \"items\": {\n                          \"description\": \"Case when signal is generated.\",\n                          \"properties\": {\n                            \"actions\": {\n                              \"description\": \"Action to perform for each rule case.\",\n                              \"items\": {\n                                \"description\": \"Action to perform when a signal is triggered. Only available for Application Security rule type.\",\n                                \"properties\": {\n                                  \"options\": {\n                                    \"additionalProperties\": {},\n                                    \"description\": \"Options for the rule action\",\n                                    \"properties\": {\n                                      \"duration\": {\n                                        \"description\": \"Duration of the action in seconds. 0 indicates no expiration.\",\n                                        \"example\": 0,\n                                        \"format\": \"int64\",\n                                        \"minimum\": 0,\n                                        \"type\": \"integer\"\n                                      },\n                                      \"flaggedIPType\": {\n                                        \"description\": \"Used with the case action of type 'flag_ip'. The value specified in this field is applied as a flag to the IP addresses.\",\n                                        \"enum\": [\n                                          \"SUSPICIOUS\",\n                                          \"FLAGGED\"\n                                        ],\n                                        \"example\": \"FLAGGED\",\n                                        \"type\": \"string\",\n                                        \"x-enum-varnames\": [\n                                          \"SUSPICIOUS\",\n                                          \"FLAGGED\"\n                                        ]\n                                      },\n                                      \"userBehaviorName\": {\n                                        \"description\": \"Used with the case action of type 'user_behavior'. The value specified in this field is applied as a risk tag to all users affected by the rule.\",\n                                        \"type\": \"string\"\n                                      }\n                                    },\n                                    \"type\": \"object\"\n                                  },\n                                  \"type\": {\n                                    \"description\": \"The action type.\",\n                                    \"enum\": [\n                                      \"block_ip\",\n                                      \"block_user\",\n                                      \"user_behavior\",\n                                      \"flag_ip\"\n                                    ],\n                                    \"type\": \"string\",\n                                    \"x-enum-varnames\": [\n                                      \"BLOCK_IP\",\n                                      \"BLOCK_USER\",\n                                      \"USER_BEHAVIOR\",\n                                      \"FLAG_IP\"\n                                    ]\n                                  }\n                                },\n                                \"type\": \"object\"\n                              },\n                              \"type\": \"array\"\n                            },\n                            \"condition\": {\n                              \"description\": \"A case contains logical operations (`>`,`>=`, `&&`, `||`) to determine if a signal should be generated\\nbased on the event counts in the previously defined queries.\",\n                              \"type\": \"string\"\n                            },\n                            \"name\": {\n                              \"description\": \"Name of the case.\",\n                              \"type\": \"string\"\n                            },\n                            \"notifications\": {\n                              \"description\": \"Notification targets.\",\n                              \"items\": {\n                                \"description\": \"Notification.\",\n                                \"type\": \"string\"\n                              },\n                              \"type\": \"array\"\n                            },\n                            \"status\": {\n                              \"description\": \"Severity of the Security Signal.\",\n                              \"enum\": [\n                                \"info\",\n                                \"low\",\n                                \"medium\",\n                                \"high\",\n                                \"critical\"\n                              ],\n                              \"example\": \"critical\",\n                              \"type\": \"string\",\n                              \"x-enum-varnames\": [\n                                \"INFO\",\n                                \"LOW\",\n                                \"MEDIUM\",\n                                \"HIGH\",\n                                \"CRITICAL\"\n                              ]\n                            }\n                          },\n                          \"required\": [\n                            \"status\"\n                          ],\n                          \"type\": \"object\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"from\": {\n                        \"description\": \"Starting time of data analyzed by the job.\",\n                        \"example\": 1729843470000,\n                        \"format\": \"int64\",\n                        \"type\": \"integer\"\n                      },\n                      \"groupSignalsBy\": {\n                        \"description\": \"Additional grouping to perform on top of the existing groups in the query section. Must be a subset of the existing groups.\",\n                        \"example\": [\n                          \"service\"\n                        ],\n                        \"items\": {\n                          \"description\": \"Field to group by.\",\n                          \"type\": \"string\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"index\": {\n                        \"description\": \"Index used to load the data.\",\n                        \"example\": \"cloud_siem\",\n                        \"type\": \"string\"\n                      },\n                      \"message\": {\n                        \"description\": \"Message for generated results.\",\n                        \"example\": \"A large number of failed login attempts.\",\n                        \"type\": \"string\"\n                      },\n                      \"name\": {\n                        \"description\": \"Job name.\",\n                        \"example\": \"Excessive number of failed attempts.\",\n                        \"type\": \"string\"\n                      },\n                      \"options\": {\n                        \"description\": \"Job options.\",\n                        \"properties\": {\n                          \"detectionMethod\": {\n                            \"description\": \"The detection method.\",\n                            \"enum\": [\n                              \"threshold\",\n                              \"new_value\",\n                              \"anomaly_detection\",\n                              \"impossible_travel\",\n                              \"hardcoded\",\n                              \"third_party\",\n                              \"anomaly_threshold\",\n                              \"sequence_detection\"\n                            ],\n                            \"type\": \"string\",\n                            \"x-enum-varnames\": [\n                              \"THRESHOLD\",\n                              \"NEW_VALUE\",\n                              \"ANOMALY_DETECTION\",\n                              \"IMPOSSIBLE_TRAVEL\",\n                              \"HARDCODED\",\n                              \"THIRD_PARTY\",\n                              \"ANOMALY_THRESHOLD\",\n                              \"SEQUENCE_DETECTION\"\n                            ]\n                          },\n                          \"evaluationWindow\": {\n                            \"description\": \"A time window is specified to match when at least one of the cases matches true. This is a sliding window\\nand evaluates in real time. For third party detection method, this field is not used.\",\n                            \"enum\": [\n                              0,\n                              60,\n                              300,\n                              600,\n                              900,\n                              1800,\n                              3600,\n                              7200,\n                              10800,\n                              21600,\n                              43200,\n                              86400\n                            ],\n                            \"format\": \"int32\",\n                            \"type\": \"integer\",\n                            \"x-enum-varnames\": [\n                              \"ZERO_MINUTES\",\n                              \"ONE_MINUTE\",\n                              \"FIVE_MINUTES\",\n                              \"TEN_MINUTES\",\n                              \"FIFTEEN_MINUTES\",\n                              \"THIRTY_MINUTES\",\n                              \"ONE_HOUR\",\n                              \"TWO_HOURS\",\n                              \"THREE_HOURS\",\n                              \"SIX_HOURS\",\n                              \"TWELVE_HOURS\",\n                              \"ONE_DAY\"\n                            ]\n                          },\n                          \"impossibleTravelOptions\": {\n                            \"description\": \"Options on impossible travel detection method.\",\n                            \"properties\": {\n                              \"baselineUserLocations\": {\n                                \"description\": \"If true, signals are suppressed for the first 24 hours. In that time, Datadog learns the user's regular\\naccess locations. This can be helpful to reduce noise and infer VPN usage or credentialed API access.\",\n                                \"example\": true,\n                                \"type\": \"boolean\"\n                              }\n                            },\n                            \"type\": \"object\"\n                          },\n                          \"keepAlive\": {\n                            \"description\": \"Once a signal is generated, the signal will remain \\\"open\\\" if a case is matched at least once within\\nthis keep alive window. For third party detection method, this field is not used.\",\n                            \"enum\": [\n                              0,\n                              60,\n                              300,\n                              600,\n                              900,\n                              1800,\n                              3600,\n                              7200,\n                              10800,\n                              21600,\n                              43200,\n                              86400\n                            ],\n                            \"format\": \"int32\",\n                            \"type\": \"integer\",\n                            \"x-enum-varnames\": [\n                              \"ZERO_MINUTES\",\n                              \"ONE_MINUTE\",\n                              \"FIVE_MINUTES\",\n                              \"TEN_MINUTES\",\n                              \"FIFTEEN_MINUTES\",\n                              \"THIRTY_MINUTES\",\n                              \"ONE_HOUR\",\n                              \"TWO_HOURS\",\n                              \"THREE_HOURS\",\n                              \"SIX_HOURS\",\n                              \"TWELVE_HOURS\",\n                              \"ONE_DAY\"\n                            ]\n                          },\n                          \"maxSignalDuration\": {\n                            \"description\": \"A signal will \\\"close\\\" regardless of the query being matched once the time exceeds the maximum duration.\\nThis time is calculated from the first seen timestamp.\",\n                            \"enum\": [\n                              0,\n                              60,\n                              300,\n                              600,\n                              900,\n                              1800,\n                              3600,\n                              7200,\n                              10800,\n                              21600,\n                              43200,\n                              86400\n                            ],\n                            \"format\": \"int32\",\n                            \"type\": \"integer\",\n                            \"x-enum-varnames\": [\n                              \"ZERO_MINUTES\",\n                              \"ONE_MINUTE\",\n                              \"FIVE_MINUTES\",\n                              \"TEN_MINUTES\",\n                              \"FIFTEEN_MINUTES\",\n                              \"THIRTY_MINUTES\",\n                              \"ONE_HOUR\",\n                              \"TWO_HOURS\",\n                              \"THREE_HOURS\",\n                              \"SIX_HOURS\",\n                              \"TWELVE_HOURS\",\n                              \"ONE_DAY\"\n                            ]\n                          },\n                          \"newValueOptions\": {\n                            \"description\": \"Options on new value detection method.\",\n                            \"properties\": {\n                              \"forgetAfter\": {\n                                \"description\": \"The duration in days after which a learned value is forgotten.\",\n                                \"enum\": [\n                                  1,\n                                  2,\n                                  7,\n                                  14,\n                                  21,\n                                  28\n                                ],\n                                \"format\": \"int32\",\n                                \"type\": \"integer\",\n                                \"x-enum-varnames\": [\n                                  \"ONE_DAY\",\n                                  \"TWO_DAYS\",\n                                  \"ONE_WEEK\",\n                                  \"TWO_WEEKS\",\n                                  \"THREE_WEEKS\",\n                                  \"FOUR_WEEKS\"\n                                ]\n                              },\n                              \"learningDuration\": {\n                                \"default\": 0,\n                                \"description\": \"The duration in days during which values are learned, and after which signals will be generated for values that\\nweren't learned. If set to 0, a signal will be generated for all new values after the first value is learned.\",\n                                \"enum\": [\n                                  0,\n                                  1,\n                                  7\n                                ],\n                                \"format\": \"int32\",\n                                \"type\": \"integer\",\n                                \"x-enum-varnames\": [\n                                  \"ZERO_DAYS\",\n                                  \"ONE_DAY\",\n                                  \"SEVEN_DAYS\"\n                                ]\n                              },\n                              \"learningMethod\": {\n                                \"default\": \"duration\",\n                                \"description\": \"The learning method used to determine when signals should be generated for values that weren't learned.\",\n                                \"enum\": [\n                                  \"duration\",\n                                  \"threshold\"\n                                ],\n                                \"type\": \"string\",\n                                \"x-enum-varnames\": [\n                                  \"DURATION\",\n                                  \"THRESHOLD\"\n                                ]\n                              },\n                              \"learningThreshold\": {\n                                \"default\": 0,\n                                \"description\": \"A number of occurrences after which signals will be generated for values that weren't learned.\",\n                                \"enum\": [\n                                  0,\n                                  1\n                                ],\n                                \"format\": \"int32\",\n                                \"type\": \"integer\",\n                                \"x-enum-varnames\": [\n                                  \"ZERO_OCCURRENCES\",\n                                  \"ONE_OCCURRENCE\"\n                                ]\n                              }\n                            },\n                            \"type\": \"object\"\n                          },\n                          \"sequenceDetectionOptions\": {\n                            \"description\": \"Options on sequence detection method.\",\n                            \"properties\": {\n                              \"stepTransitions\": {\n                                \"description\": \"Transitions defining the allowed order of steps and their evaluation windows.\",\n                                \"items\": {\n                                  \"description\": \"Transition from a parent step to a child step within a sequence detection rule.\",\n                                  \"properties\": {\n                                    \"child\": {\n                                      \"description\": \"Name of the child step.\",\n                                      \"type\": \"string\"\n                                    },\n                                    \"evaluationWindow\": {\n                                      \"description\": \"A time window is specified to match when at least one of the cases matches true. This is a sliding window\\nand evaluates in real time. For third party detection method, this field is not used.\",\n                                      \"enum\": [\n                                        0,\n                                        60,\n                                        300,\n                                        600,\n                                        900,\n                                        1800,\n                                        3600,\n                                        7200,\n                                        10800,\n                                        21600,\n                                        43200,\n                                        86400\n                                      ],\n                                      \"format\": \"int32\",\n                                      \"type\": \"integer\",\n                                      \"x-enum-varnames\": [\n                                        \"ZERO_MINUTES\",\n                                        \"ONE_MINUTE\",\n                                        \"FIVE_MINUTES\",\n                                        \"TEN_MINUTES\",\n                                        \"FIFTEEN_MINUTES\",\n                                        \"THIRTY_MINUTES\",\n                                        \"ONE_HOUR\",\n                                        \"TWO_HOURS\",\n                                        \"THREE_HOURS\",\n                                        \"SIX_HOURS\",\n                                        \"TWELVE_HOURS\",\n                                        \"ONE_DAY\"\n                                      ]\n                                    },\n                                    \"parent\": {\n                                      \"description\": \"Name of the parent step.\",\n                                      \"type\": \"string\"\n                                    }\n                                  },\n                                  \"type\": \"object\"\n                                },\n                                \"type\": \"array\"\n                              },\n                              \"steps\": {\n                                \"description\": \"Steps that define the conditions to be matched in sequence.\",\n                                \"items\": {\n                                  \"description\": \"Step definition for sequence detection containing the step name, condition, and evaluation window.\",\n                                  \"properties\": {\n                                    \"condition\": {\n                                      \"description\": \"Condition referencing rule queries (e.g., `a > 0`).\",\n                                      \"type\": \"string\"\n                                    },\n                                    \"evaluationWindow\": {\n                                      \"description\": \"A time window is specified to match when at least one of the cases matches true. This is a sliding window\\nand evaluates in real time. For third party detection method, this field is not used.\",\n                                      \"enum\": [\n                                        0,\n                                        60,\n                                        300,\n                                        600,\n                                        900,\n                                        1800,\n                                        3600,\n                                        7200,\n                                        10800,\n                                        21600,\n                                        43200,\n                                        86400\n                                      ],\n                                      \"format\": \"int32\",\n                                      \"type\": \"integer\",\n                                      \"x-enum-varnames\": [\n                                        \"ZERO_MINUTES\",\n                                        \"ONE_MINUTE\",\n                                        \"FIVE_MINUTES\",\n                                        \"TEN_MINUTES\",\n                                        \"FIFTEEN_MINUTES\",\n                                        \"THIRTY_MINUTES\",\n                                        \"ONE_HOUR\",\n                                        \"TWO_HOURS\",\n                                        \"THREE_HOURS\",\n                                        \"SIX_HOURS\",\n                                        \"TWELVE_HOURS\",\n                                        \"ONE_DAY\"\n                                      ]\n                                    },\n                                    \"name\": {\n                                      \"description\": \"Unique name identifying the step.\",\n                                      \"type\": \"string\"\n                                    }\n                                  },\n                                  \"type\": \"object\"\n                                },\n                                \"type\": \"array\"\n                              }\n                            },\n                            \"type\": \"object\"\n                          },\n                          \"thirdPartyRuleOptions\": {\n                            \"description\": \"Options on third party detection method.\",\n                            \"properties\": {\n                              \"defaultNotifications\": {\n                                \"description\": \"Notification targets for the logs that do not correspond to any of the cases.\",\n                                \"items\": {\n                                  \"description\": \"Notification.\",\n                                  \"type\": \"string\"\n                                },\n                                \"type\": \"array\"\n                              },\n                              \"defaultStatus\": {\n                                \"description\": \"Severity of the Security Signal.\",\n                                \"enum\": [\n                                  \"info\",\n                                  \"low\",\n                                  \"medium\",\n                                  \"high\",\n                                  \"critical\"\n                                ],\n                                \"example\": \"critical\",\n                                \"type\": \"string\",\n                                \"x-enum-varnames\": [\n                                  \"INFO\",\n                                  \"LOW\",\n                                  \"MEDIUM\",\n                                  \"HIGH\",\n                                  \"CRITICAL\"\n                                ]\n                              },\n                              \"rootQueries\": {\n                                \"description\": \"Queries to be combined with third party case queries. Each of them can have different group by fields, to aggregate differently based on the type of alert.\",\n                                \"items\": {\n                                  \"description\": \"A query to be combined with the third party case query.\",\n                                  \"properties\": {\n                                    \"groupByFields\": {\n                                      \"description\": \"Fields to group by.\",\n                                      \"items\": {\n                                        \"description\": \"Field.\",\n                                        \"type\": \"string\"\n                                      },\n                                      \"type\": \"array\"\n                                    },\n                                    \"query\": {\n                                      \"description\": \"Query to run on logs.\",\n                                      \"example\": \"source:cloudtrail\",\n                                      \"type\": \"string\"\n                                    }\n                                  },\n                                  \"type\": \"object\"\n                                },\n                                \"type\": \"array\"\n                              },\n                              \"signalTitleTemplate\": {\n                                \"description\": \"A template for the signal title; if omitted, the title is generated based on the case name.\",\n                                \"type\": \"string\"\n                              }\n                            },\n                            \"type\": \"object\"\n                          }\n                        },\n                        \"type\": \"object\"\n                      },\n                      \"queries\": {\n                        \"description\": \"Queries for selecting logs analyzed by the job.\",\n                        \"items\": {\n                          \"description\": \"Query for selecting logs analyzed by the historical job.\",\n                          \"properties\": {\n                            \"aggregation\": {\n                              \"description\": \"The aggregation type.\",\n                              \"enum\": [\n                                \"count\",\n                                \"cardinality\",\n                                \"sum\",\n                                \"max\",\n                                \"new_value\",\n                                \"geo_data\",\n                                \"event_count\",\n                                \"none\"\n                              ],\n                              \"type\": \"string\",\n                              \"x-enum-varnames\": [\n                                \"COUNT\",\n                                \"CARDINALITY\",\n                                \"SUM\",\n                                \"MAX\",\n                                \"NEW_VALUE\",\n                                \"GEO_DATA\",\n                                \"EVENT_COUNT\",\n                                \"NONE\"\n                              ]\n                            },\n                            \"dataSource\": {\n                              \"default\": \"logs\",\n                              \"description\": \"Source of events, either logs, audit trail, or Datadog events.\",\n                              \"enum\": [\n                                \"logs\",\n                                \"audit\",\n                                \"app_sec_spans\",\n                                \"spans\",\n                                \"security_runtime\",\n                                \"network\",\n                                \"events\"\n                              ],\n                              \"example\": \"logs\",\n                              \"type\": \"string\",\n                              \"x-enum-varnames\": [\n                                \"LOGS\",\n                                \"AUDIT\",\n                                \"APP_SEC_SPANS\",\n                                \"SPANS\",\n                                \"SECURITY_RUNTIME\",\n                                \"NETWORK\",\n                                \"EVENTS\"\n                              ]\n                            },\n                            \"distinctFields\": {\n                              \"description\": \"Field for which the cardinality is measured. Sent as an array.\",\n                              \"items\": {\n                                \"description\": \"Field.\",\n                                \"type\": \"string\"\n                              },\n                              \"type\": \"array\"\n                            },\n                            \"groupByFields\": {\n                              \"description\": \"Fields to group by.\",\n                              \"items\": {\n                                \"description\": \"Field.\",\n                                \"type\": \"string\"\n                              },\n                              \"type\": \"array\"\n                            },\n                            \"hasOptionalGroupByFields\": {\n                              \"default\": false,\n                              \"description\": \"When false, events without a group-by value are ignored by the query. When true, events with missing group-by fields are processed with `N/A`, replacing the missing values.\",\n                              \"example\": false,\n                              \"type\": \"boolean\"\n                            },\n                            \"metrics\": {\n                              \"description\": \"Group of target fields to aggregate over when using the sum, max, geo data, or new value aggregations. The sum, max, and geo data aggregations only accept one value in this list, whereas the new value aggregation accepts up to five values.\",\n                              \"items\": {\n                                \"description\": \"Field.\",\n                                \"type\": \"string\"\n                              },\n                              \"type\": \"array\"\n                            },\n                            \"name\": {\n                              \"description\": \"Name of the query.\",\n                              \"type\": \"string\"\n                            },\n                            \"query\": {\n                              \"description\": \"Query to run on logs.\",\n                              \"example\": \"a > 3\",\n                              \"type\": \"string\"\n                            }\n                          },\n                          \"type\": \"object\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"referenceTables\": {\n                        \"description\": \"Reference tables used in the queries.\",\n                        \"items\": {\n                          \"description\": \"Reference tables used in the queries.\",\n                          \"properties\": {\n                            \"checkPresence\": {\n                              \"description\": \"Whether to include or exclude the matched values.\",\n                              \"type\": \"boolean\"\n                            },\n                            \"columnName\": {\n                              \"description\": \"The name of the column in the reference table.\",\n                              \"type\": \"string\"\n                            },\n                            \"logFieldPath\": {\n                              \"description\": \"The field in the log to match against the reference table.\",\n                              \"type\": \"string\"\n                            },\n                            \"ruleQueryName\": {\n                              \"description\": \"The name of the query to apply the reference table to.\",\n                              \"type\": \"string\"\n                            },\n                            \"tableName\": {\n                              \"description\": \"The name of the reference table.\",\n                              \"type\": \"string\"\n                            }\n                          },\n                          \"type\": \"object\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"tags\": {\n                        \"description\": \"Tags for generated signals.\",\n                        \"items\": {\n                          \"type\": \"string\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"thirdPartyCases\": {\n                        \"description\": \"Cases for generating results from third-party detection method. Only available for third-party detection method.\",\n                        \"example\": [],\n                        \"items\": {\n                          \"description\": \"Case when a signal is generated by a third party rule.\",\n                          \"properties\": {\n                            \"name\": {\n                              \"description\": \"Name of the case.\",\n                              \"type\": \"string\"\n                            },\n                            \"notifications\": {\n                              \"description\": \"Notification targets for each case.\",\n                              \"items\": {\n                                \"description\": \"Notification.\",\n                                \"type\": \"string\"\n                              },\n                              \"type\": \"array\"\n                            },\n                            \"query\": {\n                              \"description\": \"A query to map a third party event to this case.\",\n                              \"type\": \"string\"\n                            },\n                            \"status\": {\n                              \"description\": \"Severity of the Security Signal.\",\n                              \"enum\": [\n                                \"info\",\n                                \"low\",\n                                \"medium\",\n                                \"high\",\n                                \"critical\"\n                              ],\n                              \"example\": \"critical\",\n                              \"type\": \"string\",\n                              \"x-enum-varnames\": [\n                                \"INFO\",\n                                \"LOW\",\n                                \"MEDIUM\",\n                                \"HIGH\",\n                                \"CRITICAL\"\n                              ]\n                            }\n                          },\n                          \"required\": [\n                            \"status\"\n                          ],\n                          \"type\": \"object\"\n                        },\n                        \"type\": \"array\"\n                      },\n                      \"to\": {\n                        \"description\": \"Ending time of data analyzed by the job.\",\n                        \"example\": 1729847070000,\n                        \"format\": \"int64\",\n                        \"type\": \"integer\"\n                      },\n                      \"type\": {\n                        \"description\": \"Job type.\",\n                        \"type\": \"string\"\n                      }\n                    },\n                    \"required\": [\n                      \"from\",\n                      \"to\",\n                      \"index\",\n                      \"name\",\n                      \"cases\",\n                      \"queries\",\n                      \"message\"\n                    ],\n                    \"type\": \"object\"\n                  }\n                },\n                \"type\": \"object\"\n              },\n              \"type\": {\n                \"description\": \"Type of data.\",\n                \"enum\": [\n                  \"historicalDetectionsJobCreate\"\n                ],\n                \"type\": \"string\",\n                \"x-enum-varnames\": [\n                  \"HISTORICALDETECTIONSJOBCREATE\"\n                ]\n              }\n            },\n            \"type\": \"object\"\n          }\n        },\n        \"type\": \"object\"\n      }\n    }\n  },\n  \"required\": true\n}",
    "use_request_body_schema_mode": true,
    "validate_request_body_schema": true
  }
}
