Metadata-Version: 2.4
Name: autoemxsp
Version: 0.1.5
Summary: AutoEMXSp - Automated Electron Microscopy X-Ray Spectroscopy for Compositional Characterization of Materials
Author-email: Andrea Giunto <agiunto@lbl.gov>
License-Expression: LicenseRef-AcademicNonCommercial
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.11
Classifier: Operating System :: OS Independent
Requires-Python: >=3.11
Description-Content-Type: text/markdown
License-File: LICENSE.txt
Requires-Dist: cvxpy<=1.7.3,>=1.5.3
Requires-Dist: lmfit<=1.3.4,>=1.3.2
Requires-Dist: matplotlib<=3.10.6,>=3.5.2
Requires-Dist: numpy<=2.2.6,>=1.26.4
Requires-Dist: pandas<=2.3.3,>=2.2.2
Requires-Dist: pymatgen<=2025.6.14,>=2024.11.13
Requires-Dist: scikit-learn<=1.7.2,>=1.5.1
Requires-Dist: scipy<=1.16.2,>=1.14.1
Requires-Dist: seaborn<=0.13.2,>=0.13.2
Requires-Dist: sympy<=1.14.0,>=1.13.2
Requires-Dist: yellowbrick==1.5
Requires-Dist: opencv-python<=4.12.0.88,>=4.10.0
Requires-Dist: pillow>=10.0.1
Dynamic: license-file

<div align="center">

# AutoEMXSp 

[![PyPI version](https://badge.fury.io/py/autoemxsp.svg)](https://pypi.org/project/autoemxsp/)
[![Python Version](https://img.shields.io/pypi/pyversions/autoemxsp.svg)](https://pypi.org/project/autoemxsp/)
[![License: Custom Non-Commercial](https://img.shields.io/badge/license-Custom%20Non--Commercial-blue.svg)](https://github.com/CederGroupHub/AutoEMXSp/blob/main/LICENSE.txt)

**Automated Electron Microscopy X-Ray Spectroscopy for Compositional Characterization of Materials**

</div>

AutoEMXSp is a **fully automated framework** for SEM-EDS workflows â€” from spectral acquisition and quantification to data filtering and compositional analysis â€” all in **one click**.

ðŸŽ¥ Watch AutoEMXSp in action on a desktop SEM-EDS system at https://youtu.be/Bym58gNxlj0

ðŸ“– This work is described in:  
A. Giunto *et al.*, *Harnessing Automated SEM-EDS and Machine Learning to Unlock High-Throughput Compositional Characterization of Powder Materials*, 2025.  
DOI: [https://doi.org/10.21203/rs.3.rs-7837297/v1](https://doi.org/10.21203/rs.3.rs-7837297/v1)

### âœ¨ Key Features
- **Automated acquisition & quantification** of X-ray spectra using the peak-to-background method. Single spectrum quantification also available
- **Automated rule-based filtering** of compositions to discard poorly quantified spectra from the analysis
- **Automated machine learningâ€“based compositional analysis** to identify the compositions of individual phases in the sample  
- **Automated experimental standard collection** scripts included
- **Extensible architecture** â€” adaptable to other techniques such as  
  - Wavelength Dispersive Spectroscopy (WDS)  
  - Scanning Transmission Electron Microscopy (STEM) with EDS  
- **Extensible hardware support** â€” includes driver for ThermoFisher Phenom Desktop SEM series, and can be extended to any electron microscope with a Python API  

### ðŸ“Š Performance
- **Benchmarked** on 74 single-phase samples with compositions spanning **38 elements** (from nitrogen to bismuth), it achieved **<5â€“10% relative deviation** from expected values  
- **Machine learning** compositional analysis detects individual phase composition in **multi-phase samples**, including minor phases
- **Intermixed phases** can also be resolved

### ðŸ§ª Supported Use Cases
- Powder, bulk, and rough samples  
- Scanning Electron Microscopy (SEM) with Energy-Dispersive Spectroscopy (EDS)  

### âš™ï¸ Requirements
- Cross-platform: runs on **Linux, macOS, and Windows**
- Quick installation  
- Requires calibration for use with different electron microscopes  

---

## ðŸ“‘ Table of Contents
- [ðŸš€ Installation](#-installation)
- [ðŸ–¥ Quick Start](#-quick-start)
- [ðŸ“¦ Requirements](#-requirements)
- [ðŸ†• Coming Soon](#-coming-soon)
- [ðŸ“‚ Project Structure](#-project-structure)
- [ðŸ“ Scripts](#-scripts)
- [ðŸ¤ Contributing](#-contributing)
- [ðŸ“„ License](#-license)
- [ðŸ“– Citation](#-citation)
- [ðŸ“‚ Paper Data](#-paper-data)
- [ðŸ“¬ Contact](#-contact)


---

## ðŸš€ Installation

You can install **AutoEMXSp** in just one command.

### Using pip
```bash
pip install autoemxsp
```

### Or directly from GitHub:
```bash
pip install git+https://github.com/CederGroupHub/AutoEMXSp
```

---

## ðŸ–¥ Quick Start

AutoEMXSp supports three main automated workflows:

1. **Experimental Standard Collection** â€” acquire and fit X-ray spectra from known-composition samples to generate reference peak-to-background ratios.
2. **Sample Acquisition & Analysis** â€” acquire spectra from unknown samples, quantify them, and perform compositional phase analysis.
3. **Particle Size Statistical Analysis** -  search for particles and collect statistics on their size distribution.

---

### 1ï¸âƒ£ Acquire Experimental Standards
See **Run_Experimental_Standard_Collection.py** script

```python
from autoemxsp.runners import batch_acquire_experimental_stds

# Define standards(s) to analyse (additional options available):
# - 'ID': unique standard identifier
# - 'formula': standard composition
# - 'pos': stage position (x, y) in mm
# - 'sample_type': bulk or powder
# - 'is_manual_meas': Manually select spots if standard is not bulk, nor powder

std_list = [
    {
        'id': 'Al_std',
        'formula': 'Al',
        'pos': (0, 0),
        'sample_type': 'bulk',
        'is_manual_meas': False
    },
]

# Run experimental standard acquisition at the microscope computer
batch_acquire_experimental_stds(stds=std_list)
```

### 2ï¸âƒ£ Acquire & Analyse Samples
See **Run_Acquisition_Quant_Analysis.py** script

```python
from autoemxsp.runners import batch_acquire_and_analyze

# Define sample(s) to analyse (additional options available):
# - 'id': unique sample identifier
# - 'els': list of possible elements in the sample
# - 'pos': stage position (x, y) in mm
# - 'cnd' (optional): list of candidate phases/formulas

samples = [
    {
        'id': 'Anorthite_mineral',
        'els': ['Ca', 'Al', 'Si', 'O'],
        'pos': (-37.5, -37.5),
        'cnd': ['CaAl2Si2O8']
    },
]

# Run acquisition and analysis at the microscope computer
batch_acquire_and_analyze(samples)
```


### 3ï¸âƒ£ Particle Size Statistical Analysis
See **Collect_Particle_Statistics.py** script

```python
from autoemxsp.runners import collect_particle_statistics

# Define sample(s) to analyse (additional options available):
# - 'id': unique sample identifier
# - 'pos': stage position (x, y) in mm

samples = [
    {
        'id': 'Anorthite_mineral',
        'pos': (-37.5, -37.5),
    },
]

# Run acquisition and analysis at the microscope computer
collect_particle_statistics(samples)
```

---

## ðŸ“¦ Requirements

- **Python 3.11 or newer**  
- All dependencies are installed automatically via `pip` or `conda`.  
- Tested versions of dependencies are specified in `pyproject.toml`.  
  > The package **may work** with more recent versions, but these have **not been tested**.
  
---

### Electron Microscope Support
- âœ… Developed and tested for **Thermo Fisher Phenom Desktop SEMs**.  
- âœ… Compatible with any Phenom microscope equipped with **PPI (Phenom Programming Interface)**.  
- âš ï¸ For other microscope models, the driver must be adapted to the appropriate API commands.  


---

## ðŸ†• Coming Soon
Hereâ€™s whatâ€™s planned for future releases of **AutoEMXSp**:
- ðŸ Verify with the latest **Python** version for improved compatibility with current scientific libraries
- ðŸ“ New scripts for **spectral parameter calibration** to extend the `XSp_calibs` library to your own instrument.
- ðŸ¤– Integration of ML models for particle segmentation and improved size distribution analysis

---

## ðŸ“‚ Project Structure

The repository is organized as follows:

```text
AutoEMXSp/
â”œâ”€â”€ autoemxsp/                 # Main package source code
â”‚   â”œâ”€â”€ core/                   # Core objects and source code
â”‚   â”œâ”€â”€ runners/                # Runner functions calling on core objects
â”‚   â”œâ”€â”€ lib/                    # Libraries of X-ray data
â”‚   â”œâ”€â”€ tools/                  # Miscellaneous helper functions
â”‚   â”‚   â””â”€â”€ custom_fnctns.py        # Customizable clustering plot function
â”‚   â”œâ”€â”€ EM_driver/              # Electron Microscope driver (âš ï¸ adapt to your own instrument)
â”‚   â”œâ”€â”€ XSp_calibs/             # X-ray spectral calibrations (âš ï¸ adapt to your own instrument)
â”‚   â”œâ”€â”€ scripts/                # Helper scripts (see full list below)
â”‚   â””â”€â”€ Results/                # Example acquired data (used for unit tests)
â”‚
â”œâ”€â”€ examples/                  # Example scripts for fitting, quantification and compositional analysis of example data
â”œâ”€â”€ tests/                     # Unit tests for fitting, quantification, compositional analysis and image processing
â”‚                               # (Acquisition tests require proper EM drivers)
â”œâ”€â”€ paper_data/                # Raw paper data uploaded on Git LFS (Dowload instructions in Paper Data section below)
â”‚
â”œâ”€â”€ LICENSE.txt
â”œâ”€â”€ README.md
â””â”€â”€ pyproject.toml
```

---

## ðŸ“ Scripts

This repository includes a collection of scripts that streamline the use of **AutoEMXSp**.  
Each script is tailored for a specific task in spectral acquisition, calibration, quantification, or analysis.

### ðŸ”¬ Acquisition, Quantification & Analysis
- **Run_Acquisition_Quant_Analysis.py** â€” Acquire X-ray spectra and optionally perform quantification and composition analysis.  
- **Run_Quantification_Analysis.py** â€” Quantify acquired spectra (single or multiple samples) and perform machine-learning analysis.  
- **Run_Analysis.py** â€” Launch customized machine-learning analysis on previously quantified data.  

### ðŸ› ï¸ Miscellaneous
- **Collect_Particle_Statistics.py** - Analyse sample, collecting particle size statistics and distribution.
- **Fit_Quant_Single_Spectrum.py** â€” Fit and optionally quantify a single spectrum. Prints fitting parameters and plots fitted spectrum for detailed inspection of model performance.  
- **Run_Experimental_Standard_Collection.py** â€” Acquire and fit experimental standards.  
- **Run_SDD_Calibration.py** â€” Perform calibration of the SDD detector.

### âš—ï¸ Characterize Extent of Intermixing in Known Powder Mixtures  
*(see [Chem. Mater. 2015, 27, 20, 7084â€“7094](https://pubs.acs.org/doi/10.1021/acs.chemmater.5c01573) for example)*  
- **Run_Acquisition_PrecursorMix.py** â€” Acquire spectra for powder precursor mixtures.  
- **Run_Quantification_PrecursorMix.py** â€” Quantify spectra for one or multiple powder mixtures and run machine-learning analysis.
- Customized analysis can be performed using the **Run_Analysis.py** script

ðŸ‘‰ All scripts can be executed directly from the command line or imported into a Python environment, making them accessible from anywhere on your system.  

---

## ðŸ¤ Contributing

Contributions are welcome!

Open to collaborations to extend this package to different tools or to different types of samples, for example thin films.
Please contact me at agiunto@lbl.gov

---

## ðŸ“„ License

This project is licensed under a NON-COMMERCIAL USE ONLY,
LICENSE â€” see the LICENSE file for details.

---

## ðŸ“– Citation

If you use **AutoEMXSp** in your research, please cite the following publication:

> A. Giunto, Y. Fei, P. Nevatia, B. Rendy, N. Szymanski and G. Ceder;
> *Harnessing Automated SEM-EDS and Machine Learning to Unlock High-Throughput Compositional Characterization of Powder Materials*, 2025.  
> DOI: [https://doi.org/10.21203/rs.3.rs-7837297/v1](https://doi.org/10.21203/rs.3.rs-7837297/v1)

### BibTeX
```bibtex
@article{Giunto2025AutoEMXSp,
  author  = {Giunto, Andrea and Fei, Yuxing and Nevatia, Pragnay and Rendy, Bernardus and Szymanski, Nathan and Ceder, Gerbrand},
  title   = {Harnessing Automated SEM-EDS and Machine Learning to Unlock High-Throughput Compositional Characterization of Powder Materials},
  year    = {2025},
  doi     = {10.21203/rs.3.rs-7837297/v1},
  url     = {https://doi.org/10.21203/rs.3.rs-7837297/v1}
}
```

---

## ðŸ“‚ Paper Data

The raw data used in the associated publication is stored in the `paper_data/` directory.  
These files are tracked with **Git LFS** (Large File Storage).

### ðŸ”½ Download with Git LFS
If you cloned the repository without Git LFS, you may only see placeholder text files instead of the actual datasets.  
To download the full data, on the terminal go to the repo directory and:

```bash
# 1. Install Git LFS (only needed once per machine)
git lfs install

# 2. Fetch the data files
git lfs pull
```

Alternatively, download manually from the github repo Download button.

After downloading, move the raw paper data into the Results/ folder to analyze it with AutoEMXSp, or add the folder's path to 'results_dir' within the provided analysis and quantification scripts.

---

## ðŸ“¬ Contact

For questions or issues, please open an issue on GitHub.


---

