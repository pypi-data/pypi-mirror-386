Metadata-Version: 2.4
Name: pico-ioc
Version: 2.0.0
Summary: A minimalist, zero-dependency Inversion of Control (IoC) container for Python.
Author-email: David Perez Cabrera <dperezcabrera@gmail.com>
License: MIT License
        
        Copyright (c) 2025 David P√©rez Cabrera
        
        Permission is hereby granted, free of charge, to any person obtaining a copy
        of this software and associated documentation files (the "Software"), to deal
        in the Software without restriction, including without limitation the rights
        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
        copies of the Software, and to permit persons to whom the Software is
        furnished to do so, subject to the following conditions:
        
        The above copyright notice and this permission notice shall be included in all
        copies or substantial portions of the Software.
        
        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
        SOFTWARE.
        
Project-URL: Homepage, https://github.com/dperezcabrera/pico-ioc
Project-URL: Repository, https://github.com/dperezcabrera/pico-ioc
Project-URL: Issue Tracker, https://github.com/dperezcabrera/pico-ioc/issues
Keywords: ioc,di,dependency injection,inversion of control,decorator
Classifier: Development Status :: 4 - Beta
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3 :: Only
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Programming Language :: Python :: 3.14
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Dynamic: license-file

# üì¶ Pico-IoC: A Robust, Async-Native IoC Container for Python

[![PyPI](https://img.shields.io/pypi/v/pico-ioc.svg)](https://pypi.org/project/pico-ioc/)
[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/dperezcabrera/pico-ioc)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)
![CI (tox matrix)](https://github.com/dperezcabrera/pico-ioc/actions/workflows/ci.yml/badge.svg)
[![codecov](https://codecov.io/gh/dperezcabrera/pico-ioc/branch/main/graph/badge.svg)](https://codecov.io/gh/dperezcabrera/pico-ioc)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=dperezcabrera_pico-ioc&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=dperezcabrera_pico-ioc)
[![Duplicated Lines (%)](https://sonarcloud.io/api/project_badges/measure?project=dperezcabrera_pico-ioc&metric=duplicated_lines_density)](https://sonarcloud.io/summary/new_code?id=dperezcabrera_pico-ioc)
[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=dperezcabrera_pico-ioc&metric=sqale_rating)](https://sonarcloud.io/summary/new_code?id=dperezcabrera_pico-ioc)

**pico-ioc** is a **robust, async-native, decorator-based IoC container for Python**.
It helps you build loosely-coupled, testable, enterprise-grade applications without manual wiring. Inspired by the Spring ecosystem, but fully Pythonic.

> ‚ö†Ô∏è **Requires Python 3.10+** (due to extensive use of modern `typing` features).

---

## ‚öñÔ∏è Principles

* **Focus & Simplicity**: A declarative API for one job: managing dependencies. It avoids accidental complexity by doing one thing well.
* **Declarative & Explicit**: No magic. Behavior is deterministic, relying on explicit decorators (`@component`, `@factory`) and type hints.
* **Unified Composition Root**: The application is assembled from a single entry point (`init`) which defines a clear, predictable boundary.
* **Fail-Fast by Design**: Catches **circular dependencies** and **missing bindings** at startup, not at runtime. If the application runs, it's wired correctly.
* **Testability First**: Features like `@conditional`, profiles, and `overrides` are first-class citizens, enabling fast and isolated testing.
* **Async Native & Extensible**: Full `async`/`await` support, AOP (`@intercepted_by`), and a built-in `EventBus` are available out-of-the-box.
* **Framework Agnostic**: Zero hard dependencies (standard library only). It works with any Python application, from simple scripts to complex web servers.

---

## ‚ú® Why Pico-IoC?

`pico-ioc` exists to solve a common problem that arises as Python applications grow: managing how objects are created and connected becomes complex and brittle. This manual wiring, where a change deep in the application can cause a cascade of updates, makes the code hard to test and maintain.

`pico-ioc` introduces the principle of Inversion of Control (IoC) in a simple, Pythonic way. Instead of you creating and connecting every object, you declare your components with a simple `@component` decorator, and the container automatically wires them together based on their type hints. It brings the architectural robustness and testability of mature frameworks like Spring to the Python ecosystem, allowing you to build complex, loosely-coupled applications that remain simple to manage.

| Feature | Manual Wiring | With Pico-IoC |
| :--- | :--- | :--- |
| **Object Creation** | `service = Service(Repo(Config()))` | `svc = container.get(Service)` |
| **Testing** | Manual replacement or monkey-patching | `overrides={Repo: FakeRepo()}` |
| **Coupling** | High (code knows about constructors) | Low (code just asks for a type) |
| **Maintenance** | Brittle (changing a constructor breaks consumers) | Robust (changes are isolated) |
| **Learning Curve** | Ad-hoc, implicit patterns | Uniform, explicit, documented |

---

## üß© Features

### Core

* **Zero external dependencies** ‚Äî pure Python, framework-agnostic.
* **Decorator-based API** ‚Äî `@component`, `@factory`, `@provides`, `@configuration`.
* **Fail-fast Bootstrap** ‚Äî Detects **circular dependencies** and **missing bindings** at startup.
* **Async-Native Resolution** ‚Äî Full `async`/`await` support with `container.aget()`.
* **Sophisticated Scopes** ‚Äî `singleton`, `prototype`, and `ContextVar`-based scopes (e.g., `request`, `session`).
* **Typed Configuration** ‚Äî Injects `dataclasses` from environment/files via `@configuration`.
* **Test-Driven** ‚Äî Built-in `overrides` and `profiles` for easy mocking.

### Advanced

* **AOP / Interceptors** ‚Äî Intercept method calls with `@intercepted_by`.
* **Qualifiers** ‚Äî Inject subsets of components with `Annotated[List[T], Qualifier(...)]`.
* **Async Event Bus** ‚Äî Built-in `EventBus` for decoupled, event-driven architecture.
* **Conditional Registration** ‚Äî `@conditional` (by profile, env var) and `@on_missing` (fallbacks).
* **Lifecycle Hooks** ‚Äî `@configure` (post-init) and `@cleanup` (on shutdown).
* **Health Checks** ‚Äî Built-in `@health` decorator and `container.health_check()`.
* **Serializable Proxies** ‚Äî Lazy (`@lazy`) and AOP proxies are `pickle`-safe.

---

## üì¶ Installation

```bash
# Requires Python 3.10+
pip install pico-ioc
````

-----

## üöÄ Quick Start

```python
from pico_ioc import component, init, configuration
from dataclasses import dataclass

@configuration
@dataclass
class Config:
    url: str = "sqlite:///demo.db"

@component
class Repo:
    def __init__(self, cfg: Config):
        self.url = cfg.url
    def fetch(self): 
        return f"fetching from {self.url}"

@component
class Service:
    def __init__(self, repo: Repo):
        self.repo = repo
    def run(self): 
        return self.repo.fetch()

# Bootstrap the container by scanning modules
# We use __name__ to scan the current module
container = init(modules=[__name__])

# Resolve the service and run
svc = container.get(Service)
print(svc.run())
```

**Output:**

```
fetching from sqlite:///demo.db
```

-----

### Quick Overrides for Testing

The `init` function accepts `overrides` to replace any component for testing.

```python
import my_app_module
from pico_ioc import init

# Define a fake repository
class FakeRepo:
    def fetch(self): 
        return "fake-data"

# Initialize the container, overriding the real Repo
container = init(
    modules=[my_app_module],
    overrides={
        Repo: FakeRepo()  # Override by type
    }
)

# The service now receives FakeRepo instead of the real one
svc = container.get(Service)
assert svc.run() == "fake-data"
```

-----

## üìñ Documentation

  * **üöÄ New to pico-ioc? Start with the User Guide.**

      * [**guide.md**](.docs/guide.md) ‚Äî Learn with practical examples: testing, configuration, AOP, async, and web framework integration.

  * **üèóÔ∏è Want to understand the internals? See the Architecture.**

      * [**architecture.md**](./docs/architecture.md) ‚Äî A deep dive into the resolution algorithm, lifecycle, and internal design.

-----

## üß™ Development

```bash
pip install tox
tox
```

-----

## üìú Changelog

See [CHANGELOG.md](./CHANGELOG.md) for version history.

-----

## üìú License

MIT ‚Äî see [LICENSE](https://opensource.org/licenses/MIT)

```
```


