<?xml version="1.0" ?>
<odoo>
    <record id="act_window_change_coordinator" model="ir.actions.act_window">
        <field name="name">Change Coordinator</field>
        <field name="binding_model_id" ref="base.model_res_company" />
        <field name="res_model">change.coordinator.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field
      name="groups_id"
      eval="[(4,ref('energy_communities.group_platform_manager'))]"
    />
    </record>
    <record id="act_window_create_users_company" model="ir.actions.act_window">
        <field name="name">Build platform users from partner members</field>
        <field name="binding_model_id" ref="base.model_res_company" />
        <field name="res_model">create.users.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field
      name="groups_id"
      eval="[(4,ref('energy_communities.group_platform_manager'))]"
    />
    </record>
    <record id="view_company_form_ce_inherited" model="ir.ui.view">
        <field name="name">res.company.tree.ce.inherited</field>
        <field name="model">res.company</field>
        <field name="inherit_id" ref="base.view_company_form" />
        <field name="arch" type="xml">
            <xpath
        expr="//page[@name='general_info']//field[@name='parent_id']"
        position="attributes"
      >
                <attribute name="invisible">True</attribute>
            </xpath>
            <xpath expr="//sheet" position="before">
                <header>
                  <field name="landing_page_id" invisible="1" />
                  <field name="hierarchy_level" invisible="1" />
                  <field name="website_id" invisible="1" />
                  <button
                    name="action_create_website"
                    type="object"
                    string="Create odoo website"
                    attrs="{'invisible': [('website_id','!=',False)]}"
                  />
                  <button
                    name="action_create_landing"
                    type="object"
                    string="Create landing page"
                    attrs="{'invisible': [('landing_page_id','!=',False)]}"
                  />
                  <button
                    name="action_open_change_coordinator_wizard"
                    type="object"
                    string="Change coordinator"
                    groups="energy_communities.group_platform_manager"
                    attrs="{'invisible':[('hierarchy_level', '!=','community')]}"
                  />
                </header>
            </xpath>
            
            <xpath expr="//field[@name='logo']" position="before">
                <div class="oe_button_box" name="button_box">
                  <button
                    name="get_landing_page_form"
                    type="object"
                    string="My landing page"
                    class="oe_stat_button"
                    icon="fa-globe"
                    attrs="{'invisible': [('landing_page_id','=',False)]}"
                  />
                  <button
                    name="get_website_form"
                    type="object"
                    string="My website"
                    class="oe_stat_button"
                    icon="fa-globe"
                    attrs="{'invisible': [('landing_page_id','=',False)]}"
                  />
                </div>
                <field name="admins" invisible="True" />
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page string="Energy Communities">
                    <group>
                        <field name="account_fiscal_country_id" />
                        <field name="pricelist_id" />
                        <field name="hierarchy_level" />
                        <field name="parent_id_filtered_ids" invisible="True" />
                        <field
              name="parent_id"
              domain="[('id', 'in', parent_id_filtered_ids)]"
            />
                        <field
              name="notify_to_coord_child_ccee_submissions"
              attrs="{'invisible': [('hierarchy_level', '!=', 'coordinator')]}"
            />
                        <field name="legal_form" />
                        <field name="comercial_name" />
                        <field name="ce_status" />
                        <field name="community_energy_action_ids" widget="one2many">
                          <tree editable="top">
                              <field name="energy_action_id" />
                              <field name="public_status" />
                          </tree>
                        </field>
                        <field name="admins" />
                    </group>
                    <group>
                      <field name="foundation_date" />
                      <field name="allow_new_members" />
                      <field name="create_user_in_keycloak" />
                    </group>
                </page>
            </xpath>
            <xpath expr="//field[@name='social_instagram']" position="after">
                <field name="social_telegram" />
            </xpath>
            <!-- <xpath expr="//form" position="inside">
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" />
                    <field name="activity_ids" widget="mail_activity" />
                    <field name="message_ids" widget="mail_thread" />
                </div>
            </xpath> -->
        </field>
    </record>
    <record id="view_company_tree" model="ir.ui.view">
        <field name="name">res.company.tree</field>
        <field name="model">res.company</field>
        <field name="inherit_id" ref="base.view_company_tree" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <field name="hierarchy_level" />
                <field name="parent_id" />
            </xpath>
        </field>
    </record>
</odoo>
