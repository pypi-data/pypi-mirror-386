[meta]
name = "builtin-default"
version = 1
description = "Skip CPython stdlib internals, redact sensitive identifiers, and drop nothing by default."
labels = ["builtin", "default"]

[scope]
default_exec = "trace"
default_value_action = "allow"

[[scope.rules]]
selector = 'file:regex:.*[\\/](lib|Lib)[\\/]python\d+\.\d+[\/].*'
exec = "skip"
reason = "Skip Python standard library files"

[[scope.rules]]
selector = 'file:regex:.*[\\/](lib|Lib)[\\/]python\d+\.\d+[\/]site-packages[\/].*'
exec = "trace"
reason = "Allow third-party packages under site-packages"

[[scope.rules]]
selector = 'file:regex:.*[\\/]site-packages[\\/]_virtualenv\.py$'
exec = "skip"
reason = "Skip virtualenv bootstrap helper"

[[scope.rules]]
selector = 'pkg:regex:^(asyncio|selectors|concurrent|importlib|threading|multiprocessing)(\.|$)'
exec = "skip"
reason = "Skip noisy stdlib async/concurrency internals"

[[scope.rules]]
selector = 'pkg:literal:builtins'
exec = "skip"
reason = "Skip builtins module instrumentation"

[[scope.rules]]
selector = 'pkg:glob:*'
value_default = "allow"

[[scope.rules.value_patterns]]
selector = 'local:regex:(?i).*(pass(word)?|passwd|pwd|secret|token|session|cookie|auth|credential|creds|bearer|ssn|credit|card|iban|cvv|cvc|pan|api[_-]?key|private[_-]?key|secret[_-]?key|ssh[_-]?key|jwt|refresh[_-]?token|access[_-]?token).*'
action = "redact"
reason = "Redact sensitive locals"

[[scope.rules.value_patterns]]
selector = 'global:regex:(?i).*(pass(word)?|passwd|pwd|secret|token|session|cookie|auth|credential|creds|bearer|ssn|credit|card|iban|cvv|cvc|pan|api[_-]?key|private[_-]?key|secret[_-]?key|ssh[_-]?key|jwt|refresh[_-]?token|access[_-]?token).*'
action = "redact"
reason = "Redact sensitive globals"

[[scope.rules.value_patterns]]
selector = 'arg:regex:(?i).*(pass(word)?|passwd|pwd|secret|token|session|cookie|auth|credential|creds|bearer|ssn|credit|card|iban|cvv|cvc|pan|api[_-]?key|private[_-]?key|secret[_-]?key|ssh[_-]?key|jwt|refresh[_-]?token|access[_-]?token).*'
action = "redact"
reason = "Redact sensitive arguments"

[[scope.rules.value_patterns]]
selector = 'ret:regex:(?i).*(pass(word)?|passwd|pwd|secret|token|session|cookie|auth|credential|creds|bearer|ssn|credit|card|iban|cvv|cvc|pan|api[_-]?key|private[_-]?key|secret[_-]?key|ssh[_-]?key|jwt|refresh[_-]?token|access[_-]?token).*'
action = "redact"
reason = "Redact sensitive return values"

[[scope.rules.value_patterns]]
selector = 'attr:regex:(?i).*(pass(word)?|passwd|pwd|secret|token|session|cookie|auth|credential|creds|bearer|ssn|credit|card|iban|cvv|cvc|pan|api[_-]?key|private[_-]?key|secret[_-]?key|ssh[_-]?key|jwt|refresh[_-]?token|access[_-]?token).*'
action = "redact"
reason = "Redact sensitive attributes"
