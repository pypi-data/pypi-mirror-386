(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8245:function(e,t,n){Promise.resolve().then(n.bind(n,1054))},1054:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var s=n(9656);function i(){return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M3.33398 3.33334L12.6673 12.6667M12.6673 3.33334L3.33398 12.6667",stroke:"currentColor","stroke-width":"2","stroke-linecap":"square"})})}var a=n(664);function r(e){let t=(0,a.useRef)(null),[n,i]=(0,a.useState)(!1),r=(0,a.useRef)(!1);return["listening","thinking","speaking"].includes(e.state)&&!1==r.current&&(r.current=!0),(0,a.useEffect)(()=>("connecting"===e.state?t.current=window.setTimeout(()=>{"connecting"===e.state&&!1===r.current&&i(!0)},1e4):(t.current&&window.clearTimeout(t.current),i(!1)),()=>{t.current&&window.clearTimeout(t.current)}),[e.state]),(0,s.jsx)(s.Fragment,{children:n?(0,s.jsxs)("div",{className:"fixed text-sm left-1/2 max-w-[90vw] -translate-x-1/2 flex top-6 items-center gap-4 bg-[#1F1F1F] px-4 py-3 rounded-lg",children:[(0,s.jsx)("div",{children:(0,s.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.85068 3.63564C10.8197 2.00589 13.1793 2.00589 14.1484 3.63564L21.6323 16.2223C22.6232 17.8888 21.4223 20 19.4835 20H4.51555C2.57676 20 1.37584 17.8888 2.36671 16.2223L9.85068 3.63564ZM12 8.5C12.2761 8.5 12.5 8.72386 12.5 9V13.5C12.5 13.7761 12.2761 14 12 14C11.7239 14 11.5 13.7761 11.5 13.5V9C11.5 8.72386 11.7239 8.5 12 8.5ZM12.75 16C12.75 16.4142 12.4142 16.75 12 16.75C11.5858 16.75 11.25 16.4142 11.25 16C11.25 15.5858 11.5858 15.25 12 15.25C12.4142 15.25 12.75 15.5858 12.75 16Z",fill:"#666666"})})}),(0,s.jsx)("p",{className:"text-pretty w-max",children:"It's quiet... too quiet. Is your agent lost? Ensure your agent is properly configured and running on your machine."}),(0,s.jsx)("a",{href:"https://docs.livekit.io/agents/quickstarts/s2s/",target:"_blank",className:"underline whitespace-nowrap",children:"View guide"}),(0,s.jsx)("button",{onClick:()=>i(!1),children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M3.16602 3.16666L12.8327 12.8333M12.8327 3.16666L3.16602 12.8333",stroke:"#999999",strokeWidth:"1.5",strokeLinecap:"square"})})})]}):null})}var o=n(8227),l=n(7421);function c(){let e=function(){let{agentTranscriptions:e}=(0,o.V)(),t=function(){let{microphoneTrack:e,localParticipant:t}=(0,o.C)();return(0,a.useMemo)(()=>({participant:t,source:l.fQ.Source.Microphone,publication:e}),[t,e])}(),{segments:n}=(0,o.U)(t);return(0,a.useMemo)(()=>[...e.map(e=>({...e,role:"assistant"})),...n.map(e=>({...e,role:"user"}))].sort((e,t)=>e.firstReceivedTime-t.firstReceivedTime),[e,n])}(),t=a.useRef(null);return a.useEffect(()=>{t.current&&(t.current.scrollTop=t.current.scrollHeight)},[e]),(0,s.jsxs)("div",{className:"relative h-[200px] w-[512px] max-w-[90vw] mx-auto",children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 right-0 h-8 bg-gradient-to-b from-[var(--lk-bg)] to-transparent z-10 pointer-events-none"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-[var(--lk-bg)] to-transparent z-10 pointer-events-none"}),(0,s.jsx)("div",{ref:t,className:"h-full flex flex-col gap-2 overflow-y-auto px-4 py-8",children:e.map(e=>(0,s.jsx)("div",{id:e.id,className:"assistant"===e.role?"p-2 self-start fit-content":"bg-gray-800 rounded-md p-2 self-end fit-content",children:e.text},e.id))})]})}var d=n(7179),u=n(6984),p=n(303),x=n(3098),h=n(1704),f=n(591);function m(){let[e]=(0,a.useState)(new l.du),[t,n]=(0,a.useState)(""),[i,r]=(0,a.useState)(""),o=(0,a.useCallback)(async()=>{var n;r("");let s=new URL(null!==(n=f.env.NEXT_PUBLIC_CONN_DETAILS_ENDPOINT)&&void 0!==n?n:"/api/connection-details",window.location.origin);s.searchParams.set("password",t);let i=await fetch(s.toString());if(!i.ok){401===i.status?r("Invalid password"):r("Connection failed");return}let a=await i.json();await e.connect(a.serverUrl,a.participantToken),await e.localParticipant.setMicrophoneEnabled(!0)},[e,t]);return(0,a.useEffect)(()=>(e.on(l.TQ.MediaDevicesError,j),()=>{e.off(l.TQ.MediaDevicesError,j)}),[e]),(0,s.jsx)("main",{"data-lk-theme":"default",className:"h-full grid content-center bg-[var(--lk-bg)]",children:(0,s.jsx)(d.R.Provider,{value:e,children:(0,s.jsx)("div",{className:"lk-room-container max-w-[1024px] w-[90vw] mx-auto max-h-[90vh]",children:(0,s.jsx)(w,{onConnectButtonClicked:o,password:t,setPassword:n,error:i})})})})}function w(e){let{state:t}=(0,o.V)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(x.M,{mode:"wait",children:"disconnected"===t?(0,s.jsx)(h.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3,ease:[.09,1.04,.245,1.055]},className:"grid items-center justify-center h-full",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("input",{type:"password",placeholder:"Enter password",value:e.password,onChange:t=>e.setPassword(t.target.value),onKeyPress:t=>{"Enter"===t.key&&e.onConnectButtonClicked()},className:"px-4 py-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-white"}),e.error&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:e.error}),(0,s.jsx)(h.E.button,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.1},className:"uppercase px-4 py-2 bg-white text-black rounded-md",onClick:()=>e.onConnectButtonClicked(),children:"Start a conversation"})]})},"disconnected"):(0,s.jsxs)(h.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:[.09,1.04,.245,1.055]},className:"flex flex-col items-center gap-4 h-full",children:[(0,s.jsx)(g,{}),(0,s.jsx)("div",{className:"flex-1 w-full",children:(0,s.jsx)(c,{})}),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(v,{onConnectButtonClicked:e.onConnectButtonClicked})}),(0,s.jsx)(u.R,{}),(0,s.jsx)(r,{state:t})]},"connected")})})}function g(){let{state:e,videoTrack:t,audioTrack:n}=(0,o.V)();return t?(0,s.jsx)("div",{className:"h-[512px] w-[512px] rounded-lg overflow-hidden",children:(0,s.jsx)(u.V,{trackRef:t})}):(0,s.jsx)("div",{className:"h-[300px] w-full",children:(0,s.jsx)(u.B,{state:e,barCount:5,trackRef:n,className:"agent-visualizer",options:{minHeight:24}})})}function v(e){let{state:t}=(0,o.V)();return(0,s.jsxs)("div",{className:"relative h-[60px]",children:[(0,s.jsx)(x.M,{children:"disconnected"===t&&(0,s.jsx)(h.E.button,{initial:{opacity:0,top:0},animate:{opacity:1},exit:{opacity:0,top:"-10px"},transition:{duration:1,ease:[.09,1.04,.245,1.055]},className:"uppercase absolute left-1/2 -translate-x-1/2 px-4 py-2 bg-white text-black rounded-md",onClick:()=>e.onConnectButtonClicked(),children:"Start a conversation"})}),(0,s.jsx)(x.M,{children:"disconnected"!==t&&"connecting"!==t&&(0,s.jsxs)(h.E.div,{initial:{opacity:0,top:"10px"},animate:{opacity:1,top:0},exit:{opacity:0,top:"-10px"},transition:{duration:.4,ease:[.09,1.04,.245,1.055]},className:"flex h-8 absolute left-1/2 -translate-x-1/2  justify-center",children:[(0,s.jsx)(p.P6,{controls:{leave:!1}}),(0,s.jsx)(u.D,{children:(0,s.jsx)(i,{})})]})})]})}function j(e){console.error(e),alert("Error acquiring camera or microphone permissions. Please make sure you grant the necessary permissions in your browser and reload the tab")}}},function(e){e.O(0,[11,687,758,763,744],function(){return e(e.s=8245)}),_N_E=e.O()}]);