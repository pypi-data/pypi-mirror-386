         1296979 function calls (1276102 primitive calls) in 0.775 seconds

   Ordered by: cumulative time
   List reduced from 1953 to 50 due to restriction <50>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.004    0.004    0.775    0.775 /Users/jerryinyang/Code/bmad-dev/rustybt/scripts/benchmarks/profile_dataportal_isolated.py:45(profile_dataportal_history_calls)
     2000    0.002    0.000    0.453    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/data_portal.py:826(get_history_window)
     2000    0.005    0.000    0.448    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/data_portal.py:738(_get_history_daily_window)
        1    0.000    0.000    0.313    0.313 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/bundles/core.py:529(load)
        1    0.000    0.000    0.293    0.293 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/polars/parquet_bar_reader.py:62(__init__)
        2    0.000    0.000    0.293    0.146 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/utils/calendar_utils.py:27(get_calendar)
        2    0.000    0.000    0.293    0.146 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/calendar_utils.py:226(get_calendar)
        1    0.000    0.000    0.292    0.292 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/calendar_utils.py:204(_fabricate)
        1    0.000    0.000    0.292    0.292 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/exchange_calendar.py:287(__init__)
       54    0.000    0.000    0.161    0.003 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/indexes/datetimes.py:821(date_range)
       54    0.003    0.000    0.160    0.003 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/arrays/datetimes.py:399(_generate_range)
    13144    0.105    0.000    0.156    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/arrays/datetimes.py:2729(_generate_range)
     2002    0.009    0.000    0.150    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/frame.py:698(__init__)
      6/5    0.000    0.000    0.142    0.028 /Users/jerryinyang/.local/share/uv/python/cpython-3.13.1-macos-aarch64-none/lib/python3.13/functools.py:1023(__get__)
        4    0.000    0.000    0.140    0.035 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/tseries/holiday.py:443(holidays)
       53    0.001    0.000    0.137    0.003 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/tseries/holiday.py:249(dates)
     2000    0.001    0.000    0.134    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/data_portal.py:753(_get_history_daily_window_data)
     2000    0.005    0.000    0.133    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/data_portal.py:963(_get_daily_window_data)
     2001    0.011    0.000    0.125    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:237(ndarray_to_mgr)
     2000    0.006    0.000    0.124    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/history_loader.py:438(history)
        1    0.010    0.010    0.113    0.113 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/exchange_calendar.py:718(day)
     2000    0.005    0.000    0.102    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/utils/memoize.py:142(wrapper)
     2000    0.005    0.000    0.088    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/history_loader.py:334(_ensure_sliding_windows)
    10339    0.008    0.000    0.085    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py:5385(__getitem__)
     2001    0.001    0.000    0.084    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/internals/construction.py:742(_get_axes)
     4129    0.006    0.000    0.083    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py:7659(ensure_index)
     2087    0.011    0.000    0.079    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py:475(__new__)
       53    0.001    0.000    0.072    0.001 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/tseries/holiday.py:308(_reference_dates)
     2000    0.004    0.000    0.056    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/exchange_calendar.py:1660(minute_to_session)
     2000    0.001    0.000    0.055    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/utils/memoize.py:299(wrapper)
       53    0.000    0.000    0.053    0.001 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/tseries/holiday.py:343(_apply_rule)
     2000    0.002    0.000    0.053    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/rustybt/data/data_portal.py:725(_get_days_for_window)
    10357    0.010    0.000    0.052    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py:390(__getitem__)
  274/137    0.000    0.000    0.049    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/ops/common.py:62(new_method)
        2    0.000    0.000    0.049    0.024 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/exchange_calendar.py:2665(_special_dates)
        1    0.000    0.000    0.049    0.049 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/exchange_calendar.py:2744(_calculate_special_closes)
     2151    0.011    0.000    0.047    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/construction.py:517(sanitize_array)
       25    0.000    0.000    0.046    0.002 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/arrays/_mixins.py:78(method)
194088/193809    0.028    0.000    0.045    0.000 {built-in method builtins.isinstance}
       29    0.000    0.000    0.044    0.002 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/arraylike.py:98(__add__)
       29    0.000    0.000    0.044    0.002 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py:7293(_arith_method)
       29    0.000    0.000    0.044    0.002 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/base.py:1380(_arith_method)
       24    0.000    0.000    0.044    0.002 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py:3191(__iadd__)
       29    0.000    0.000    0.043    0.001 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/ops/array_ops.py:240(arithmetic_op)
       29    0.000    0.000    0.043    0.001 {built-in method _operator.add}
       29    0.000    0.000    0.042    0.001 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/arrays/datetimelike.py:1385(__add__)
       20    0.011    0.001    0.042    0.002 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/pandas/core/arrays/datetimes.py:795(_add_offset)
        5    0.000    0.000    0.038    0.008 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/utils/pandas_utils.py:10(days_at_time)
        4    0.000    0.000    0.038    0.009 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/exchange_calendars/exchange_calendar.py:83(_group_times)
     5698    0.009    0.000    0.038    0.000 /Users/jerryinyang/Code/bmad-dev/rustybt/.venv/lib/python3.13/site-packages/dateutil/relativedelta.py:528(__mul__)
