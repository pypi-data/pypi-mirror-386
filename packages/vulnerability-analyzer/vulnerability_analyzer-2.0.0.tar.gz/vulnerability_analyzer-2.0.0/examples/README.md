# Vulnerability Analyzer Examples

This directory contains comprehensive examples demonstrating vulnerability analysis capabilities with various packet analysis libraries and network data sources.

## Directory Structure

- **`sample_data/`** - Input files for testing
  - `nmap_example.xml` - Nmap scan results 
  - `vulnerable_traffic.pcap` - Network traffic sample
  - **`sample_output/`** - Example output files showing expected results
- **Analysis scripts** - Various methods for network analysis

## Sample Output

The `sample_data/sample_output/` directory contains example output files generated by the Vulnerability Analyzer:
- CSV and JSON formats for both Nmap and PCAP analysis
- Shows the structure and content you can expect from real analysis runs
- Useful for understanding output formats and testing integrations

## ✅ Validation Status

All examples have been tested and validated:
- **Method 1**: Nmap XML Analysis ✅ Working (357 vulnerabilities detected from 8 hosts)
- **Method 2**: PCAP Traffic Analysis ✅ Working (8 packets analyzed, 2 vulnerabilities found)
- **Method 3**: Command-line tshark ✅ Working (statistics and protocol analysis)
- **Method 4**: Scapy Analysis ✅ Working (4 IP packets, protocol breakdown)
- **Method 5**: PyShark Analysis ✅ Working (comprehensive protocol detection)
- **Method 6**: Live Scanning ⚠️ Requires nmap installation

**Sample Data Confirmed:**
- `nmap_example.xml` (64,615 bytes) - Multi-host scan results
- `vulnerable_traffic.pcap` (774 bytes) - Network traffic with HTTP/DNS/ICMP

## PCAP Analysis Scripts

### Library-Specific Implementations

#### **Scapy Analysis** (`pcap_analysis_scapy.py`)
- **GitHub**: https://github.com/secdev/scapy
- **Documentation**: https://scapy.readthedocs.io/
- **Features**: Pure Python packet manipulation, maximum flexibility
- **Installation**: `pip install scapy`
- **Best for**: Custom packet crafting, detailed packet analysis

#### **PyShark Analysis** (`pcap_analysis_pyshark.py`) 
- **Original**: https://github.com/KimiNewt/pyshark
- **Issues**: https://github.com/KimiNewt/pyshark/issues
- **Enhanced**: https://github.com/D14b0l1c/pyshark/tree/feature/pyshark-enhancements
- **Features**: Python wrapper for Wireshark's tshark, advanced protocol analysis
- **Installation**: `pip install pyshark` + Wireshark
- **Best for**: Leveraging Wireshark's protocol dissectors

#### **DPKT Analysis** (`pcap_analysis_dpkt.py`)
- **GitHub**: https://github.com/kbandla/dpkt
- **Documentation**: https://dpkt.readthedocs.io/
- **Features**: Fast, simple packet parsing, lightweight
- **Installation**: `pip install dpkt`
- **Best for**: High-performance packet processing

#### **Tshark Subprocess** (`pcap_analysis_tshark.py`)
- **GitHub**: https://github.com/wireshark/wireshark
- **Documentation**: https://www.wireshark.org/docs/man-pages/tshark.html
- **Features**: Command-line Wireshark integration via subprocess
- **Requirements**: Wireshark installation
- **Best for**: Powerful filtering and analysis capabilities

### **Comprehensive Comparison** (`pcap_analysis_comprehensive.py`)
- Tests all available libraries
- Performance benchmarking
- Feature comparison matrix
- GitHub repository references
- Vulnerability detection integration

### **Multi-Library Analysis** (`pcap_analysis.py`)
- General-purpose PCAP analysis
- Supports multiple parsing backends
- Unified vulnerability detection interface

## Vulnerability Analysis Examples

### Basic Examples
- `basic_usage.py` - Simple vulnerability scanning
- `sample_data_examples.py` - Working with sample datasets
- `vulnerability_analyzer_demo.py` - Core functionality demonstration

### Advanced Examples  
- `comprehensive_demo.py` - Full-featured analysis
- `complete_test.py` - Comprehensive testing suite
- `full_demo_with_pcap.py` - PCAP + vulnerability analysis integration

### 2. Comprehensive Demo
```bash
python examples/comprehensive_demo.py
```

This provides:
- [+] Advanced Nmap file parsing
- [+] PCAP traffic analysis
- [+] Full security assessment reports
- [+] JSON report generation

### 3. Interactive Usage
```python
import vulnerability_analyzer

# Initialize analyzer
analyzer = vulnerability_analyzer.VulnerabilityAnalyzer()

# Analyze services from Nmap results
services = [
 {'port': 22, 'service': 'ssh', 'product': 'OpenSSH', 'version': '6.2'},
 {'port': 80, 'service': 'http', 'product': 'Apache httpd', 'version': '2.4.16'}
]

results = analyzer.analyze_service_vulnerabilities('192.168.1.10', services)
print(f"Found {results['vulnerabilities_found']} vulnerabilities")
```

## [*] Expected Results

### Sample Service Analysis
When analyzing the services from the sample Nmap files:

```
[+] Analyzed host: 192.168.1.10
 Services checked: 4
 Vulnerabilities found: 15
 Risk score: 7.2/10
 
 Sample vulnerabilities:
 - CVE-2016-0777 (HIGH) affecting ssh
 - CVE-2017-7679 (MEDIUM) affecting http 
 - CVE-2012-2122 (CRITICAL) affecting mysql
```

### Sample Traffic Analysis 
When analyzing the PCAP file:

```
[+] Analyzed PCAP file: vulnerable_traffic.pcap
 Packets processed: 8
 Protocols found: HTTP, DNS, ICMP
 Unique flows: 4
 
 Suspicious patterns: 2
 [!] Threat Score: 8.5/10
 
 Detected Threats:
 - CVE Exploit Attempt (HIGH): CVE-2021-34527 in User-Agent
 - XSS Injection (MEDIUM): Script injection detected
```

## [*] Understanding the Results

### Risk Scoring
- **0-3**: Low risk
- **4-6**: Medium risk 
- **7-8**: High risk
- **9-10**: Critical risk

### Vulnerability Sources
- **ExploitDB**: 46,448 entries - Public exploit database
- **NVD**: 9,191 entries - National Vulnerability Database
- **RouterSploit**: 37 entries - Router-specific vulnerabilities
- **Index**: 36 entries - Additional indexed vulnerabilities

### Detection Capabilities
- [+] CVE vulnerability matching
- [+] Service version analysis
- [+] Network traffic inspection
- [+] Exploit pattern recognition
- [+] Comprehensive risk assessment

## [*] Customization

### Adding Your Own Data
1. Place Nmap XML files in `sample_data/`
2. Add PCAP files for traffic analysis
3. Update the example scripts to reference new files

### Extending Analysis
```python
# Custom service analysis
custom_services = [
 {'port': 443, 'service': 'https', 'product': 'nginx', 'version': '1.18.0'},
 {'port': 5432, 'service': 'postgresql', 'product': 'PostgreSQL', 'version': '13.0'}
]

results = analyzer.analyze_service_vulnerabilities('10.0.0.1', custom_services)
```

### Custom Traffic Patterns
```python
# Custom traffic analysis
traffic_patterns = [
 {
 'src_ip': '10.0.0.100',
 'dst_ip': '10.0.0.1',
## Sample Data

Place PCAP files in `sample_data/` directory:
- `vulnerable_traffic.pcap` - Main test file for all scripts
- `nmap_example.xml` - Example Nmap scan results
- `sample-nmap-output.xml` - Additional Nmap configurations
- Other packet captures for testing specific scenarios

## Installation

Install all dependencies:
```bash
# Core vulnerability analyzer
pip install vulnerability-analyzer

# Packet analysis libraries
pip install scapy pyshark dpkt

# Install Wireshark for tshark/pyshark support
# Windows: Download from https://www.wireshark.org/
# Linux: sudo apt install wireshark-cli
# macOS: brew install wireshark
```

## GitHub Repository References

### Main Project
- **Vulnerability Analyzer**: https://github.com/D14b0l1c/vulnerability-analyzer
- **PyPI Package**: https://pypi.org/project/vulnerability-analyzer/

### Packet Analysis Libraries
- **Scapy**: https://github.com/secdev/scapy
- **PyShark (Original)**: https://github.com/KimiNewt/pyshark  
- **PyShark (Enhanced)**: https://github.com/D14b0l1c/pyshark/tree/feature/pyshark-enhancements
- **DPKT**: https://github.com/kbandla/dpkt
- **Wireshark**: https://github.com/wireshark/wireshark

### Related Projects
- **ExploitDB**: https://github.com/offensive-security/exploit-database
- **NVD**: https://nvd.nist.gov/
- **RouterSploit**: https://github.com/threat9/routersploit

## Usage Examples

### Quick Start
```python
# Basic vulnerability analysis
python basic_usage.py

# PCAP analysis with specific library
python pcap_analysis_scapy.py
python pcap_analysis_pyshark.py  
python pcap_analysis_dpkt.py
python pcap_analysis_tshark.py

# Comprehensive comparison
python pcap_analysis_comprehensive.py
```

### Custom Analysis
```python
import vulnerability_analyzer

# Initialize analyzer
analyzer = vulnerability_analyzer.VulnerabilityAnalyzer()

# Analyze services from PCAP or network scan
services = [
    {
        'port': 22,
        'service': 'ssh', 
        'product': 'OpenSSH',
        'version': '6.2'
    }
]

# Get vulnerability results
results = analyzer.analyze_service_vulnerabilities('192.168.1.100', services)
print(f"Found {len(results['vulnerabilities_found'])} vulnerabilities")
```

## Performance Comparison

| Library | Speed | Memory | Features | Wireshark Integration |
|---------|-------|---------|----------|---------------------|
| Scapy   | Medium| High    | Maximum  | No                  |
| PyShark | Medium| Medium  | High     | Yes                 |
| DPKT    | Fast  | Low     | Basic    | No                  |
| Tshark  | Fast  | Low     | Maximum  | Direct              |

## Feature Matrix

| Feature              | Scapy | PyShark | DPKT | Tshark |
|---------------------|-------|---------|------|--------|
| Packet Creation     | Yes   | No      | Yes  | No     |
| Protocol Dissection | Yes   | Yes     | Yes  | Yes    |
| Display Filters     | No    | Yes     | No   | Yes    |
| Live Capture        | Yes   | Yes     | No   | Yes    |
| Pure Python         | Yes   | No      | Yes  | No     |
| Vulnerability Scan  | Yes   | Yes     | Yes  | Yes    |

## Contributing

1. Fork the repository
2. Create a feature branch
3. Add new examples or improve existing ones
4. Test with multiple PCAP files
5. Submit a pull request

## License

This project is licensed under the MIT License - see the LICENSE file for details.
 'suspicious_indicators': ['custom_pattern']
 }
]

threat_results = analyzer.analyze_network_traffic(traffic_patterns)
```

## [*] Performance Notes

- **Database Loading**: ~10-15 seconds (55,712 vulnerabilities)
- **Service Analysis**: ~1-3 seconds per host
- **Traffic Analysis**: ~2-5 seconds per PCAP file
- **Memory Usage**: ~200-400MB for full database

## [*] Additional Resources

- **GitHub**: https://github.com/D14b0l1c/vulnerability-analyzer
- **PyPI**: https://pypi.org/project/vulnerability-analyzer/
- **Documentation**: See README.md in project root
- **Issues**: Report bugs via GitHub Issues

## [*] Tips

1. **Large PCAP Files**: Use filters to process specific traffic types
2. **Many Hosts**: Batch process hosts for better performance 
3. **Custom Rules**: Extend the vulnerability matcher for organization-specific threats
4. **Report Generation**: Use the built-in report generators for formal assessments

---

*These sample files demonstrate the real-world capabilities of the Vulnerability Analyzer with actual network data and vulnerability intelligence.*