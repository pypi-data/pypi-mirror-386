# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: envoy/extensions/common/async_files/v3/async_file_manager.proto
# plugin: python-betterproto2
# This file has been @generated

__all__ = (
    "AsyncFileManagerConfig",
    "AsyncFileManagerConfigThreadPool",
)

import typing

import betterproto2
import pydantic
from pydantic import model_validator
from pydantic.dataclasses import dataclass

from ......message_pool import default_message_pool

_COMPILER_VERSION = "0.9.0"
betterproto2.check_compiler_version(_COMPILER_VERSION)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class AsyncFileManagerConfig(betterproto2.Message):
    """
    [#protodoc-title: AsyncFileManager configuration]

    Configuration to instantiate or select a singleton ``AsyncFileManager``.

    Oneofs:
        - manager_type:
    """

    id: "typing.Annotated[str, pydantic.AfterValidator(betterproto2.validators.validate_string)]" = betterproto2.field(
        1, betterproto2.TYPE_STRING
    )
    """
    An optional identifier for the manager. An empty string is a valid identifier
    for a common, default ``AsyncFileManager``.

    Reusing the same id with different configurations in the same envoy instance
    is an error.
    """

    thread_pool: "AsyncFileManagerConfigThreadPool | None" = betterproto2.field(
        2, betterproto2.TYPE_MESSAGE, optional=True, group="manager_type"
    )
    """
    Configuration for a thread-pool based async file manager.
    """

    @model_validator(mode="after")
    def check_oneof(cls, values):
        return cls._validate_field_groups(values)


default_message_pool.register_message(
    "envoy.extensions.common.async_files.v3",
    "AsyncFileManagerConfig",
    AsyncFileManagerConfig,
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class AsyncFileManagerConfigThreadPool(betterproto2.Message):
    thread_count: "typing.Annotated[int, pydantic.Field(ge=0, le=2**32 - 1)]" = (
        betterproto2.field(1, betterproto2.TYPE_UINT32)
    )
    """
    The number of threads to use. If unset or zero, will default to the number
    of concurrent threads the hardware supports. This default is subject to
    change if performance analysis suggests it.
    """


default_message_pool.register_message(
    "envoy.extensions.common.async_files.v3",
    "AsyncFileManagerConfig.ThreadPool",
    AsyncFileManagerConfigThreadPool,
)
