# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: envoy/extensions/filters/http/dynamic_modules/v3/dynamic_modules.proto
# plugin: python-betterproto2
# This file has been @generated

__all__ = (
    "DynamicModuleFilter",
    "DynamicModuleFilterPerRoute",
)

import typing

import betterproto2
import pydantic
from pydantic.dataclasses import dataclass

from .......message_pool import default_message_pool

_COMPILER_VERSION = "0.9.0"
betterproto2.check_compiler_version(_COMPILER_VERSION)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class DynamicModuleFilter(betterproto2.Message):
    """
    [#protodoc-title: HTTP filter for dynamic modules]
    [#extension: envoy.filters.http.dynamic_modules]

    Configuration of the HTTP filter for dynamic modules. This filter allows loading shared object files
    that can be loaded via dlopen by the HTTP filter.

    A module can be loaded by multiple HTTP filters, hence the program can be structured in a way that
    the module is loaded only once and shared across multiple filters providing multiple functionalities.

    A dynamic module HTTP filter can opt into being a terminal filter with no upstream by setting ``terminal_filter`` to
    true in the configuration. A terminal dynamic module can use ``send_`` ABI methods to send response headers,
    body and trailers to the downstream.
    """

    dynamic_module_config: "____dynamic_modules__v3__.DynamicModuleConfig | None" = (
        betterproto2.field(1, betterproto2.TYPE_MESSAGE, optional=True)
    )
    """
    Specifies the shared-object level configuration.
    """

    filter_name: "typing.Annotated[str, pydantic.AfterValidator(betterproto2.validators.validate_string)]" = betterproto2.field(
        2, betterproto2.TYPE_STRING
    )
    """
    The name for this filter configuration. This can be used to distinguish between different filter implementations
    inside a dynamic module. For example, a module can have completely different filter implementations.
    When Envoy receives this configuration, it passes the filter_name to the dynamic module's HTTP filter config init function
    together with the filter_config.
    That way a module can decide which in-module filter implementation to use based on the name at load time.
    """

    filter_config: "______google__protobuf__.Any | None" = betterproto2.field(
        3, betterproto2.TYPE_MESSAGE, optional=True
    )
    """
    The configuration for the filter chosen by filter_name. This is passed to the module's HTTP filter initialization function.
    Together with the filter_name, the module can decide which in-module filter implementation to use and
    fine-tune the behavior of the filter.

    For example, if a module has two filter implementations, one for logging and one for header manipulation,
    filter_name is used to choose either logging or header manipulation. The filter_config can be used to
    configure the logging level or the header manipulation behavior.

    ``google.protobuf.Struct`` is serialized as JSON before
    passing it to the plugin. ``google.protobuf.BytesValue`` and
    ``google.protobuf.StringValue`` are passed directly without the wrapper.

    .. code-block:: yaml

     # Passing in a string
     filter_config:
       "@type": "type.googleapis.com/google.protobuf.StringValue"
       value: hello

     # Passing in raw bytes
     filter_config:
       "@type": "type.googleapis.com/google.protobuf.BytesValue"
       value: aGVsbG8= # echo -n "hello" | base64
    """

    terminal_filter: "bool" = betterproto2.field(4, betterproto2.TYPE_BOOL)
    """
    Set true if the dynamic module is a terminal filter to use without an upstream.
    The dynamic module is responsible for creating and sending the response to downstream.
    """


default_message_pool.register_message(
    "envoy.extensions.filters.http.dynamic_modules.v3",
    "DynamicModuleFilter",
    DynamicModuleFilter,
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class DynamicModuleFilterPerRoute(betterproto2.Message):
    """
    Configuration of the HTTP per-route filter for dynamic modules. This filter allows loading shared object files
    that can be loaded via dlopen by the HTTP filter.
    """

    dynamic_module_config: "____dynamic_modules__v3__.DynamicModuleConfig | None" = (
        betterproto2.field(1, betterproto2.TYPE_MESSAGE, optional=True)
    )
    """
    Specifies the shared-object level configuration.
    """

    per_route_config_name: "typing.Annotated[str, pydantic.AfterValidator(betterproto2.validators.validate_string)]" = betterproto2.field(
        2, betterproto2.TYPE_STRING
    )
    """
    The name for this filter configuration. This can be used to distinguish between different filter implementations
    inside a dynamic module. For example, a module can have completely different filter implementations.
    When Envoy receives this configuration, it passes the filter_name to the dynamic module's HTTP per-route filter config init function
    together with the filter_config.
    That way a module can decide which in-module filter implementation to use based on the name at load time.
    """

    filter_config: "______google__protobuf__.Any | None" = betterproto2.field(
        3, betterproto2.TYPE_MESSAGE, optional=True
    )
    """
    The configuration for the filter chosen by filter_name. This is passed to the module's HTTP per-route filter initialization function.
    Together with the filter_name, the module can decide which in-module filter implementation to use and
    fine-tune the behavior of the filter on a specific route.

    For example, if a module has two filter implementations, one for logging and one for header manipulation,
    filter_name is used to choose either logging or header manipulation. The filter_config can be used to
    configure the logging level or the header manipulation behavior.

    ``google.protobuf.Struct`` is serialized as JSON before
    passing it to the plugin. ``google.protobuf.BytesValue`` and
    ``google.protobuf.StringValue`` are passed directly without the wrapper.

    .. code-block:: yaml

     # Passing in a string
     filter_config:
       "@type": "type.googleapis.com/google.protobuf.StringValue"
       value: hello

     # Passing in raw bytes
     filter_config:
       "@type": "type.googleapis.com/google.protobuf.BytesValue"
       value: aGVsbG8= # echo -n "hello" | base64
    """


default_message_pool.register_message(
    "envoy.extensions.filters.http.dynamic_modules.v3",
    "DynamicModuleFilterPerRoute",
    DynamicModuleFilterPerRoute,
)


from .......google import protobuf as ______google__protobuf__
from .....dynamic_modules import v3 as ____dynamic_modules__v3__
