# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: envoy/type/metadata/v3/metadata.proto
# plugin: python-betterproto2
# This file has been @generated

__all__ = (
    "MetadataKey",
    "MetadataKeyPathSegment",
    "MetadataKind",
    "MetadataKindCluster",
    "MetadataKindHost",
    "MetadataKindRequest",
    "MetadataKindRoute",
)

import typing

import betterproto2
import pydantic
from pydantic import model_validator
from pydantic.dataclasses import dataclass

from .....message_pool import default_message_pool

_COMPILER_VERSION = "0.9.0"
betterproto2.check_compiler_version(_COMPILER_VERSION)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKey(betterproto2.Message):
    """
    [#protodoc-title: Metadata]

    MetadataKey provides a way to retrieve values from
    :ref:`Metadata <envoy_v3_api_msg_config.core.v3.Metadata>` using a ``key`` and a ``path``.

    For example, consider the following Metadata:

    .. code-block:: yaml

       filter_metadata:
         envoy.xxx:
           prop:
             foo: bar
             xyz:
               hello: envoy

    The following MetadataKey would retrieve the string value "bar" from the Metadata:

    .. code-block:: yaml

       key: envoy.xxx
       path:
       - key: prop
       - key: foo
    """

    key: "typing.Annotated[str, pydantic.AfterValidator(betterproto2.validators.validate_string)]" = betterproto2.field(
        1, betterproto2.TYPE_STRING
    )
    """
    The key name of the Metadata from which to retrieve the Struct.
    This typically represents a builtin subsystem or custom extension.
    """

    path: "list[MetadataKeyPathSegment]" = betterproto2.field(
        2, betterproto2.TYPE_MESSAGE, repeated=True
    )
    """
    The path used to retrieve a specific Value from the Struct.
    This can be either a prefix or a full path, depending on the use case.
    For example, ``[prop, xyz]`` would retrieve a struct or ``[prop, foo]`` would retrieve a string
    in the example above.

    .. note::
      Since only key-type segments are supported, a path cannot specify a list
      unless the list is the last segment.
    """


default_message_pool.register_message(
    "envoy.type.metadata.v3", "MetadataKey", MetadataKey
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKeyPathSegment(betterproto2.Message):
    """
    Specifies a segment in a path for retrieving values from Metadata.
    Currently, only key-based segments (field names) are supported.

    Oneofs:
        - segment:
    """

    key: "typing.Annotated[str, pydantic.AfterValidator(betterproto2.validators.validate_string)] | None" = betterproto2.field(
        1, betterproto2.TYPE_STRING, optional=True, group="segment"
    )
    """
    If specified, use this key to retrieve the value in a Struct.
    """

    @model_validator(mode="after")
    def check_oneof(cls, values):
        return cls._validate_field_groups(values)


default_message_pool.register_message(
    "envoy.type.metadata.v3", "MetadataKey.PathSegment", MetadataKeyPathSegment
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKind(betterproto2.Message):
    """
    Describes different types of metadata sources.

    Oneofs:
        - kind:
    """

    request: "MetadataKindRequest | None" = betterproto2.field(
        1, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Request kind of metadata.
    """

    route: "MetadataKindRoute | None" = betterproto2.field(
        2, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Route kind of metadata.
    """

    cluster: "MetadataKindCluster | None" = betterproto2.field(
        3, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Cluster kind of metadata.
    """

    host: "MetadataKindHost | None" = betterproto2.field(
        4, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Host kind of metadata.
    """

    @model_validator(mode="after")
    def check_oneof(cls, values):
        return cls._validate_field_groups(values)


default_message_pool.register_message(
    "envoy.type.metadata.v3", "MetadataKind", MetadataKind
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindCluster(betterproto2.Message):
    """
    Represents metadata from :ref:`the upstream cluster<envoy_v3_api_field_config.cluster.v3.Cluster.metadata>`.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v3", "MetadataKind.Cluster", MetadataKindCluster
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindHost(betterproto2.Message):
    """
    Represents metadata from :ref:`the upstream
    host<envoy_v3_api_field_config.endpoint.v3.LbEndpoint.metadata>`.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v3", "MetadataKind.Host", MetadataKindHost
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindRequest(betterproto2.Message):
    """
    Represents dynamic metadata associated with the request.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v3", "MetadataKind.Request", MetadataKindRequest
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindRoute(betterproto2.Message):
    """
    Represents metadata from :ref:`the route<envoy_v3_api_field_config.route.v3.Route.metadata>`.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v3", "MetadataKind.Route", MetadataKindRoute
)
