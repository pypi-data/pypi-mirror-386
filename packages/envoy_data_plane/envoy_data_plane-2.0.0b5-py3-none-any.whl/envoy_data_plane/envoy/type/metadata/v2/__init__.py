# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: envoy/type/metadata/v2/metadata.proto
# plugin: python-betterproto2
# This file has been @generated

__all__ = (
    "MetadataKey",
    "MetadataKeyPathSegment",
    "MetadataKind",
    "MetadataKindCluster",
    "MetadataKindHost",
    "MetadataKindRequest",
    "MetadataKindRoute",
)

import typing

import betterproto2
import pydantic
from pydantic import model_validator
from pydantic.dataclasses import dataclass

from .....message_pool import default_message_pool

_COMPILER_VERSION = "0.9.0"
betterproto2.check_compiler_version(_COMPILER_VERSION)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKey(betterproto2.Message):
    """
    [#protodoc-title: Metadata]

    MetadataKey provides a general interface using `key` and `path` to retrieve value from
    :ref:`Metadata <envoy_api_msg_core.Metadata>`.

    For example, for the following Metadata:

    .. code-block:: yaml

       filter_metadata:
         envoy.xxx:
           prop:
             foo: bar
             xyz:
               hello: envoy

    The following MetadataKey will retrieve a string value "bar" from the Metadata.

    .. code-block:: yaml

       key: envoy.xxx
       path:
       - key: prop
       - key: foo
    """

    key: "typing.Annotated[str, pydantic.AfterValidator(betterproto2.validators.validate_string)]" = betterproto2.field(
        1, betterproto2.TYPE_STRING
    )
    """
    The key name of Metadata to retrieve the Struct from the metadata.
    Typically, it represents a builtin subsystem or custom extension.
    """

    path: "list[MetadataKeyPathSegment]" = betterproto2.field(
        2, betterproto2.TYPE_MESSAGE, repeated=True
    )
    """
    The path to retrieve the Value from the Struct. It can be a prefix or a full path,
    e.g. ``[prop, xyz]`` for a struct or ``[prop, foo]`` for a string in the example,
    which depends on the particular scenario.

    Note: Due to that only the key type segment is supported, the path can not specify a list
    unless the list is the last segment.
    """


default_message_pool.register_message(
    "envoy.type.metadata.v2", "MetadataKey", MetadataKey
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKeyPathSegment(betterproto2.Message):
    """
    Specifies the segment in a path to retrieve value from Metadata.
    Currently it is only supported to specify the key, i.e. field name, as one segment of a path.

    Oneofs:
        - segment:
    """

    key: "typing.Annotated[str, pydantic.AfterValidator(betterproto2.validators.validate_string)] | None" = betterproto2.field(
        1, betterproto2.TYPE_STRING, optional=True, group="segment"
    )
    """
    If specified, use the key to retrieve the value in a Struct.
    """

    @model_validator(mode="after")
    def check_oneof(cls, values):
        return cls._validate_field_groups(values)


default_message_pool.register_message(
    "envoy.type.metadata.v2", "MetadataKey.PathSegment", MetadataKeyPathSegment
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKind(betterproto2.Message):
    """
    Describes what kind of metadata.

    Oneofs:
        - kind:
    """

    request: "MetadataKindRequest | None" = betterproto2.field(
        1, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Request kind of metadata.
    """

    route: "MetadataKindRoute | None" = betterproto2.field(
        2, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Route kind of metadata.
    """

    cluster: "MetadataKindCluster | None" = betterproto2.field(
        3, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Cluster kind of metadata.
    """

    host: "MetadataKindHost | None" = betterproto2.field(
        4, betterproto2.TYPE_MESSAGE, optional=True, group="kind"
    )
    """
    Host kind of metadata.
    """

    @model_validator(mode="after")
    def check_oneof(cls, values):
        return cls._validate_field_groups(values)


default_message_pool.register_message(
    "envoy.type.metadata.v2", "MetadataKind", MetadataKind
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindCluster(betterproto2.Message):
    """
    Represents metadata from :ref:`the upstream cluster<envoy_api_field_Cluster.metadata>`.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v2", "MetadataKind.Cluster", MetadataKindCluster
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindHost(betterproto2.Message):
    """
    Represents metadata from :ref:`the upstream
    host<envoy_api_field_endpoint.LbEndpoint.metadata>`.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v2", "MetadataKind.Host", MetadataKindHost
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindRequest(betterproto2.Message):
    """
    Represents dynamic metadata associated with the request.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v2", "MetadataKind.Request", MetadataKindRequest
)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class MetadataKindRoute(betterproto2.Message):
    """
    Represents metadata from :ref:`the route<envoy_api_field_route.Route.metadata>`.
    """

    pass


default_message_pool.register_message(
    "envoy.type.metadata.v2", "MetadataKind.Route", MetadataKindRoute
)
