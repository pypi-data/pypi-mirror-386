const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-C630CivB.js","./main-CH82g4dw.js","./main-PWR3lu3V.css","./index-DqMpSPzc.js","./index-BDU4gvFg.js","./usePagination-CNS7-0k1.js","./Table-Rz-gL0vt.js","./addEventListener-DrXUXNAy.js","./index-BL_XwOQI.js","./Dropdown-B4TP4OlU.js","./index-C0dVCwMu.js","./index-B_L60N4-.js","./index-CweiUdAw.js","./UpOutlined-MKfWXv9S.js","./DeleteOutlined-CIV_DNOf.js","./index-ZaXfouA1.js","./index-BcI8WOZ3.js","./index-DOFo5PXu.js","./index-Pwpmen_B.js","./createForOfIteratorHelper-BSFJLzX3.js","./DeploymentUnitOutlined-WBguncE1.js","./UserSwitchOutlined-D2V22kEV.js","./AudioOutlined-Cdmej0V0.js","./ClearOutlined-CzC8yyS0.js","./TableOutlined-CZ_BS3k3.js","./NodeIndexOutlined-Cav4TyHH.js","./index-DTJd4Z3p.js","./RedoOutlined-DNpCn5kL.js","./UndoOutlined-BfseYVP6.js","./react-window-Bmvezp4W.js","./index-BKAfqOdf.js","./index-DH4f004y.js","./index-B6FNwvkQ.js","./index-BCx1q_2Y.css","./index-6IaXHF5K.js","./index-L_EWe7Ii.js","./index-B1-7HnQ_.js","./index-BtlAu1CQ.js","./index-BXUynQ4Q.js","./index-D4N7VkC-.js","./study-page-CyTzU1IC.js","./index-Cem7jUqj.js","./callSuper-wDHXj85E.js"])))=>i.map(i=>d[i]);
import{r as t,u as ee,V as se,ad as te,b as ae,ae as K,c as oe,j as e,R as ne,C as V,S as Q,E as W,F as q,B as A,x as re,a as H,U as G,Q as ie}from"./main-CH82g4dw.js";import le from"./index-B6FNwvkQ.js";import{u as ce}from"./useStickyTop-B1b0XRLa.js";import{C as $}from"./index-ZaXfouA1.js";import{R as de}from"./RedoOutlined-DNpCn5kL.js";import{T as pe}from"./index-BL_XwOQI.js";import"./index-Pwpmen_B.js";import"./addEventListener-DrXUXNAy.js";import"./index-B_L60N4-.js";import"./Dropdown-B4TP4OlU.js";const he=t.lazy(()=>G(()=>import("./index-C630CivB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]),import.meta.url)),me=t.lazy(()=>G(()=>import("./index-DH4f004y.js").then(r=>r.i),__vite__mapDeps([31,1,2,32,18,7,33,30,15,11,9,34,16,6,8,10,17,12,13,14,19,20,21,22,23,24,25,26,27,28,29,35,36,37,38,39,40,5,3,4,41,42]),import.meta.url)),Re=()=>{const[r,i]=t.useState(!1),{project:n,projectObj:o}=ee(s=>s.user),[m,F]=t.useState(),[g,y]=t.useState(),C=se(),k=new URLSearchParams(C.search),a=k.get("key"),l=k.get("project"),d=te(),{modal:c,openModal:S,closeModal:J}=ae(),[N,L]=t.useState(),[_,b]=t.useState(a),X=async()=>{const s=await H.get(`/project/find-by-project-id/${n}`);d(K({projectObj:s.data}))};t.useEffect(()=>{l&&l!=n&&d(K({project:l}))},[l]),t.useRef(null),oe();const w=(s,p)=>{const{pathname:h,search:P,hash:u}=window.location,f=new URLSearchParams(P||"");f.set(s,p);const R=u.startsWith("#/");let x="";if(R){const[v,E=""]=u.replace(/^#/,"").split("?"),j=new URLSearchParams(E);j.set(s,p),x=`#${v}?${j.toString()}`}else x=`${h}?${f.toString()}`;window.history.pushState({},"",x)},[D,I]=t.useState("analysis_result"),{ref:Z,top:U,isSticky:M}=ce(576),T=async()=>{var h,P,u,f,R,x,v,E,j,Y,B;i(!0);let s=await H.post("/list-analysis-tree",{is_report:!0,project:n});const p=s.data;if(F(s.data),!a&&s.data.length>0)(h=s.data[0])!=null&&h.children&&((P=s.data[0])==null?void 0:P.children.length)>0&&(y((u=s.data[0])==null?void 0:u.children[0]),b((R=(f=s.data[0])==null?void 0:f.children[0])==null?void 0:R.key),console.log((x=s.data[0])==null?void 0:x.children[0]),L((E=(v=s.data[0])==null?void 0:v.children[0])==null?void 0:E.component_type),w("project",n),w("key",(Y=(j=s.data[0])==null?void 0:j.children[0])==null?void 0:Y.key));else{const O=(B=p.flatMap(z=>z.children||[]).find(z=>z.key===a))==null?void 0:B.component_type;L(O)}i(!1)};return t.useEffect(()=>{T()},[n]),e.jsxs("div",{style:{maxWidth:"1800px",margin:"1rem auto"},children:[e.jsxs(ne,{gutter:[M?16:0,16],children:[e.jsxs(V,{lg:20,sm:20,xs:24,style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("div",{style:{flex:1,display:D==="analysis_result"?"block":"none",height:"100%"},children:_?e.jsx(t.Suspense,{fallback:e.jsx(Q,{active:!0}),children:N=="software"?e.jsx(e.Fragment,{children:e.jsx(he,{analysis_id:_})}):e.jsx(e.Fragment,{children:e.jsx(me,{overflowY:"auto",openPanel:I,loadTree:()=>{T()},analysis_id:_})})}):e.jsx(e.Fragment,{children:e.jsx($,{size:"small",variant:"borderless",children:e.jsx(W,{})})})}),D=="note"&&e.jsx("div",{children:e.jsx($,{style:{flex:1,display:"flex",flexDirection:"column",height:" 100%",boxShadow:"none"},styles:{body:{flex:1,display:"flex",flexDirection:"column",height:" 100%",padding:0,overflowY:"auto"}},variant:"borderless",size:"small",extra:e.jsxs(q,{gap:"small",children:[e.jsx(A,{size:"small",color:"primary",variant:"solid",onClick:()=>{I("analysis_result")},children:"Back"}),e.jsx(A,{size:"small",color:"cyan",variant:"solid",onClick:()=>{S("projectForm",{project_id:n})},children:"Edit"}),e.jsx(A,{size:"small",color:"cyan",variant:"solid",onClick:()=>{X()},children:"Refresh"})]}),children:o!=null&&o.description?e.jsx(le,{data:o==null?void 0:o.description}):e.jsx(Q,{active:!0})})})]}),e.jsx(V,{lg:4,sm:4,xs:24,ref:Z,style:M?{overflowY:"hidden",position:"sticky",top:`${U}px`,alignSelf:"flex-start",height:`calc(100vh - ${U}px - 1rem )`}:{},children:e.jsx($,{loading:r,title:o==null?void 0:o.project_name,size:"small",style:{flex:1,display:"flex",flexDirection:"column",height:" 100%"},styles:{body:{flex:1,overflowY:"auto"}},extra:e.jsx(q,{gap:"small",children:e.jsx(de,{style:{cursor:"pointer"},onClick:T})}),children:Array.isArray(m)&&m.length!=0?e.jsx(e.Fragment,{children:e.jsx(ye,{onSelect:s=>{var p,h;((p=s.node)==null?void 0:p.type)=="analysis"?(y(s.node),b(s.node.key),L(s.node.component_type),w("project",n),w("key",s.node.key)):((h=s.node)==null?void 0:h.type)=="components"&&console.log(s.node)},defaultSelectKey:_,treeData:m})}):e.jsx(e.Fragment,{children:e.jsx(W,{})})})})]}),e.jsx(re,{research:!0,params:c.params,visible:c.key=="projectForm"&&c.visible,onClose:J})]})},ye=({treeData:r,defaultSelectKey:i,onSelect:n})=>{const[o,m]=t.useState(i),[F,g]=t.useState([]),y=(a,l,d=[])=>{for(const c of l){if(c.key===a)return d;if(c.children){const S=y(a,c.children,[...d,c.key]);if(S.length)return S}}return[]};t.useEffect(()=>{if(i){const a=y(i,r);g(a),m(i)}},[i,r]);const C=(a,l)=>{if(a.length>0){n(l),m(a[0]);const d=y(a[0],r);g(d)}},k=a=>{g(a)};return e.jsx(e.Fragment,{children:e.jsx(pe,{selectedKeys:[o],showLine:!0,expandedKeys:F,onExpand:k,autoExpandParent:!0,switcherIcon:e.jsx(ie,{}),onSelect:C,treeData:r})})};export{Re as default};
