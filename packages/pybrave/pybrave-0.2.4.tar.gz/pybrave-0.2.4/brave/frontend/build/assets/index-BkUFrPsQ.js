import{d as bt,k as tt,r as x,j as v,M as ln,I as Yn,m as Ui,i as Gi,n as Lr,o as qi,f as de,B as xe,p as Ro,q as wt,F as Qt,t as $r,g as Ki,c as Zi,s as Qi,b as Ji,v as ea,u as ta,R as na,C as ko,l as jo,w as oa,x as ra,a as Xn,P as sa,y as ia,E as aa}from"./main-D6qHus43.js";import{U as Tr,A as Or,a as ca}from"./index-1laYOQoJ.js";import{c as la}from"./utils-D2B0dIuM.js";import{s as ua,a as da,C as fa,b as ga,d as ha}from"./index-C4HNXQqg.js";import{M as pa,B as ma,P as ya}from"./index-oyOmkC6S.js";import{D as xa}from"./index-Rr1JDP2t.js";import{f as va,u as ba,a as wa,M as Sa,B as Ca}from"./index-BF6Eov8l.js";import{O as Ea}from"./index-CkLVmzff.js";import{i as Po,a as Ma,s as un,p as zr,z as Hr,b as Na,d as Br,c as An,t as Da}from"./zoom-BGsqVsDF.js";import{c as Ia,i as _o,a as Lo}from"./rgb-BwIoVOhg.js";import{C as Wn}from"./index-D7dvcYwa.js";import{F as Aa}from"./Table-Pcm8h2F_.js";import Fr from"./index-WNIwdokR.js";import{u as Ra}from"./useStickyTop-DxJNUfyC.js";import{S as ka}from"./index-CScjzpru.js";import{S as ja}from"./index-BLl0dAbY.js";import{T as Pa}from"./index-gg_8jVgT.js";import"./index-CXgqoLfI.js";import"./index-CjmxhRai.js";import"./index-DOQLu3Xz.js";import"./index-CqzThpCE.js";import"./UpOutlined-DC7OgFJP.js";import"./DeleteOutlined-5gHEV1Sl.js";import"./Dropdown-CMUlroR_.js";import"./index-DUjGi303.js";import"./addEventListener-TTc5ki3v.js";import"./createForOfIteratorHelper-Cwfr5VEp.js";import"./DeploymentUnitOutlined-Bm7mxWYi.js";import"./UserSwitchOutlined-DxcFBqrp.js";import"./AudioOutlined-CPyhrC5-.js";import"./ClearOutlined-sPRC32yu.js";import"./TableOutlined-CS-DfnXV.js";import"./NodeIndexOutlined-GDqggOsJ.js";import"./RedoOutlined-DIIHLGCK.js";import"./UndoOutlined-CVmeWyj0.js";import"./react-window-CDDJu4Rx.js";import"./index-CoiYZhLe.js";import"./index-CYPnvC5G.js";import"./index-ChzQGd2Q.js";import"./usePagination-C3C4V5nb.js";import"./index-ytJ9UBRy.js";import"./index-D0Z8XcmH.js";import"./index-CSAVJvIu.js";import"./study-page-CTl0wbzh.js";import"./index-DyK7Pyu1.js";import"./callSuper-BOdF8PPo.js";import"./index-DjsvXEZy.js";import"./index-DIOsMt1p.js";function _a(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),r;return function(s){for(r=0;r<n;++r)o[r]=e[r]*(1-s)+t[r]*s;return o}}function La(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $a(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,r=new Array(o),s=new Array(n),i;for(i=0;i<o;++i)r[i]=St(e[i],t[i]);for(;i<n;++i)s[i]=t[i];return function(a){for(i=0;i<o;++i)s[i]=r[i](a);return s}}function Ta(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function Oa(e,t){var n={},o={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=St(e[r],t[r]):o[r]=t[r];return function(s){for(r in n)o[r]=n[r](s);return o}}function St(e,t){var n=typeof t,o;return t==null||n==="boolean"?Ia(t):(n==="number"?Po:n==="string"?(o=Lo(t))?(t=o,_o):Ma:t instanceof Lo?_o:t instanceof Date?Ta:La(t)?_a:Array.isArray(t)?$a:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Oa:Po)(e,t)}Yn.TextArea;const za=({visible:e,onClose:t,params:n})=>{var u;if(!e)return null;const[o]=bt.useForm(),{callback:r}=n,{messageApi:s}=tt(),{project:i,projectObj:a}=tt(),l=c=>{const g=c.metadata;return delete c.metadata,{...c,sample_id:n.sample_id,project:i,analysis_result_id:n.analysis_result_id,metadata:JSON.stringify(g)}},f=async()=>{const c=await va(n.sample_id);o.setFieldsValue(c.data)};x.useEffect(()=>{n.sample_id&&f()},[n==null?void 0:n.sample_id]);const d=async()=>{const c=await o.validateFields(),g=l(c);g.sample_id?(await ba(g),s.success("update successfully")):(await wa(g),s.success("add successfully")),r==null||r(),t()};return v.jsx(ln,{onOk:d,open:e,onClose:t,onCancel:t,title:`${n.sample_id?"Edit":"Add "} Metadata`,children:v.jsxs(bt,{form:o,children:[v.jsx(bt.Item,{label:"Sample Name",name:"sample_name",children:v.jsx(Yn,{})}),(a==null?void 0:a.metadata_form)&&Array.isArray(a==null?void 0:a.metadata_form)&&((u=a==null?void 0:a.metadata_form)==null?void 0:u.map(c=>v.jsx(bt.Item,{label:c.label,name:["metadata",c.name],children:v.jsx(Yn,{})},c.name))),v.jsx(Ui,{ghost:!0,items:[{key:"1",label:"More",children:v.jsx(v.Fragment,{children:v.jsx(bt.Item,{noStyle:!0,shouldUpdate:!0,children:()=>v.jsx(Gi,{children:v.jsx("pre",{children:JSON.stringify(l(o.getFieldsValue()),null,2)})})})})}]})]})})};function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ie(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const Pe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Dt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Vr=["Enter"," ","Escape"],Yr={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var ut;(function(e){e.Strict="strict",e.Loose="loose"})(ut||(ut={}));var et;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(et||(et={}));var It;(function(e){e.Partial="partial",e.Full="full"})(It||(It={}));const Xr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Ue;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ue||(Ue={}));var Jt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Jt||(Jt={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));const $o={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top};function Wr(e){return e===null?null:e?"valid":"invalid"}const Ur=e=>"id"in e&&"source"in e&&"target"in e,Ha=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),ro=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Lt=(e,t=[0,0])=>{const{width:n,height:o}=ze(e),r=e.origin??t,s=n*r[0],i=o*r[1];return{x:e.position.x-s,y:e.position.y-i}},Ba=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const s=typeof r=="string";let i=!t.nodeLookup&&!s?r:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(r):ro(r)?r:t.nodeLookup.get(r.id));const a=i?en(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return dn(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return fn(n)},$t=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){const r=en(o);n=dn(n,r)}}),fn(n)},so=(e,t,[n,o,r]=[0,0,1],s=!1,i=!1)=>{const a={...Tt(t,[n,o,r]),width:t.width/r,height:t.height/r},l=[];for(const f of e.values()){const{measured:d,selectable:u=!0,hidden:c=!1}=f;if(i&&!u||c)continue;const g=d.width??f.width??f.initialWidth??null,m=d.height??f.height??f.initialHeight??null,p=At(a,ft(f)),y=(g??0)*(m??0),b=s&&p>0;(!f.internals.handleBounds||b||p>=y||f.dragging)&&l.push(f)}return l},Fa=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Va(e,t){const n=new Map,o=t!=null&&t.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Ya({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=Va(e,i),l=$t(a),f=io(l,t,n,(i==null?void 0:i.minZoom)??r,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await o.setViewport(f,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function Gr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:l,y:f}=a?a.internals.positionAbsolute:{x:0,y:0},d=i.origin??o;let u=i.extent||r;if(i.extent==="parent"&&!i.expandParent)if(!a)s==null||s("005",Pe.error005());else{const g=a.measured.width,m=a.measured.height;g&&m&&(u=[[l,f],[l+g,f+m]])}else a&&gt(i.extent)&&(u=[[i.extent[0][0]+l,i.extent[0][1]+f],[i.extent[1][0]+l,i.extent[1][1]+f]]);const c=gt(u)?nt(t,u,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",Pe.error015())),{position:{x:c.x-l+(i.measured.width??0)*d[0],y:c.y-f+(i.measured.height??0)*d[1]},positionAbsolute:c}}async function Xa({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const s=new Set(e.map(c=>c.id)),i=[];for(const c of n){if(c.deletable===!1)continue;const g=s.has(c.id),m=!g&&c.parentId&&i.find(p=>p.id===c.parentId);(g||m)&&i.push(c)}const a=new Set(t.map(c=>c.id)),l=o.filter(c=>c.deletable!==!1),d=Fa(i,l);for(const c of l)a.has(c.id)&&!d.find(m=>m.id===c.id)&&d.push(c);if(!r)return{edges:d,nodes:i};const u=await r({nodes:i,edges:d});return typeof u=="boolean"?u?{edges:d,nodes:i}:{edges:[],nodes:[]}:u}const dt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),nt=(e={x:0,y:0},t,n)=>({x:dt(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:dt(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function qr(e,t,n){const{width:o,height:r}=ze(n),{x:s,y:i}=n.internals.positionAbsolute;return nt(e,[[s,i],[s+o,i+r]],t)}const To=(e,t,n)=>e<t?dt(Math.abs(e-t),1,t)/t:e>n?-dt(Math.abs(e-n),1,t)/t:0,Kr=(e,t,n=15,o=40)=>{const r=To(e.x,o,t.width-o)*n,s=To(e.y,o,t.height-o)*n;return[r,s]},dn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Un=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),fn=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),ft=(e,t=[0,0])=>{var r,s;const{x:n,y:o}=ro(e)?e.internals.positionAbsolute:Lt(e,t);return{x:n,y:o,width:((r=e.measured)==null?void 0:r.width)??e.width??e.initialWidth??0,height:((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0}},en=(e,t=[0,0])=>{var r,s;const{x:n,y:o}=ro(e)?e.internals.positionAbsolute:Lt(e,t);return{x:n,y:o,x2:n+(((r=e.measured)==null?void 0:r.width)??e.width??e.initialWidth??0),y2:o+(((s=e.measured)==null?void 0:s.height)??e.height??e.initialHeight??0)}},Zr=(e,t)=>fn(dn(Un(e),Un(t))),At=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Oo=e=>Ne(e.width)&&Ne(e.height)&&Ne(e.x)&&Ne(e.y),Ne=e=>!isNaN(e)&&isFinite(e),Wa=(e,t)=>{},gn=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Tt=({x:e,y:t},[n,o,r],s=!1,i=[1,1])=>{const a={x:(e-n)/r,y:(t-o)/r};return s?gn(a,i):a},tn=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function it(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Ua(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=it(e,n),r=it(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=it(e.top??e.y??0,n),r=it(e.bottom??e.y??0,n),s=it(e.left??e.x??0,t),i=it(e.right??e.x??0,t);return{top:o,right:i,bottom:r,left:s,x:s+i,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Ga(e,t,n,o,r,s){const{x:i,y:a}=tn(e,[t,n,o]),{x:l,y:f}=tn({x:e.x+e.width,y:e.y+e.height},[t,n,o]),d=r-l,u=s-f;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(u)}}const io=(e,t,n,o,r,s)=>{const i=Ua(s,t,n),a=(t-i.x)/e.width,l=(n-i.y)/e.height,f=Math.min(a,l),d=dt(f,o,r),u=e.x+e.width/2,c=e.y+e.height/2,g=t/2-u*d,m=n/2-c*d,p=Ga(e,g,m,d,t,n),y={left:Math.min(p.left-i.left,0),top:Math.min(p.top-i.top,0),right:Math.min(p.right-i.right,0),bottom:Math.min(p.bottom-i.bottom,0)};return{x:g-y.left+y.right,y:m-y.top+y.bottom,zoom:d}},nn=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function gt(e){return e!==void 0&&e!=="parent"}function ze(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Qr(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Jr(e,t={width:0,height:0},n,o,r){const s={...e},i=o.get(n);if(i){const a=i.origin||r;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function zo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function qa(){let e,t;return{promise:new Promise((o,r)=>{e=o,t=r}),resolve:e,reject:t}}function Ka(e){return{...Yr,...e||{}}}function Ct(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:s,y:i}=je(e),a=Tt({x:s-((r==null?void 0:r.left)??0),y:i-((r==null?void 0:r.top)??0)},o),{x:l,y:f}=n?gn(a,t):a;return{xSnapped:l,ySnapped:f,...a}}const ao=e=>({width:e.offsetWidth,height:e.offsetHeight}),es=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Za=["INPUT","SELECT","TEXTAREA"];function ts(e){var o,r;const t=((r=(o=e.composedPath)==null?void 0:o.call(e))==null?void 0:r[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Za.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ns=e=>"clientX"in e,je=(e,t)=>{var s,i;const n=ns(e),o=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,r=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:r-((t==null?void 0:t.top)??0)}},Ho=(e,t,n,o,r)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:r,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...ao(i)}})};function os({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:s,targetControlX:i,targetControlY:a}){const l=e*.125+r*.375+i*.375+n*.125,f=t*.125+s*.375+a*.375+o*.125,d=Math.abs(l-e),u=Math.abs(f-t);return[l,f,d,u]}function Xt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Bo({pos:e,x1:t,y1:n,x2:o,y2:r,c:s}){switch(e){case X.Left:return[t-Xt(t-o,s),n];case X.Right:return[t+Xt(o-t,s),n];case X.Top:return[t,n-Xt(n-r,s)];case X.Bottom:return[t,n+Xt(r-n,s)]}}function rs({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:s=X.Top,curvature:i=.25}){const[a,l]=Bo({pos:n,x1:e,y1:t,x2:o,y2:r,c:i}),[f,d]=Bo({pos:s,x1:o,y1:r,x2:e,y2:t,c:i}),[u,c,g,m]=os({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:f,targetControlY:d});return[`M${e},${t} C${a},${l} ${f},${d} ${o},${r}`,u,c,g,m]}function ss({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,s=n<e?n+r:n-r,i=Math.abs(o-t)/2,a=o<t?o+i:o-i;return[s,a,r,i]}function Qa({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o,elevateOnSelect:r=!1}){if(o!==void 0)return o;const s=r&&n?1e3:0,i=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return s+i}function Ja({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const s=dn(en(e),en(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return At(i,fn(s))>0}const ec=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,tc=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),is=(e,t)=>{if(!e.source||!e.target)return t;let n;return Ur(e)?n={...e}:n={...e,id:ec(e)},tc(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function as({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,s,i,a]=ss({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,s,i,a]}const Fo={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},nc=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Vo=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function oc({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:o=X.Top,center:r,offset:s,stepPosition:i}){const a=Fo[t],l=Fo[o],f={x:e.x+a.x*s,y:e.y+a.y*s},d={x:n.x+l.x*s,y:n.y+l.y*s},u=nc({source:f,sourcePosition:t,target:d}),c=u.x!==0?"x":"y",g=u[c];let m=[],p,y;const b={x:0,y:0},S={x:0,y:0},[,,h,w]=ss({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[c]*l[c]===-1){c==="x"?(p=r.x??f.x+(d.x-f.x)*i,y=r.y??(f.y+d.y)/2):(p=r.x??(f.x+d.x)/2,y=r.y??f.y+(d.y-f.y)*i);const E=[{x:p,y:f.y},{x:p,y:d.y}],N=[{x:f.x,y},{x:d.x,y}];a[c]===g?m=c==="x"?E:N:m=c==="x"?N:E}else{const E=[{x:f.x,y:d.y}],N=[{x:d.x,y:f.y}];if(c==="x"?m=a.x===g?N:E:m=a.y===g?E:N,t===o){const R=Math.abs(e[c]-n[c]);if(R<=s){const k=Math.min(s-1,s-R);a[c]===g?b[c]=(f[c]>e[c]?-1:1)*k:S[c]=(d[c]>n[c]?-1:1)*k}}if(t!==o){const R=c==="x"?"y":"x",k=a[c]===l[R],P=f[R]>d[R],_=f[R]<d[R];(a[c]===1&&(!k&&P||k&&_)||a[c]!==1&&(!k&&_||k&&P))&&(m=c==="x"?E:N)}const M={x:f.x+b.x,y:f.y+b.y},I={x:d.x+S.x,y:d.y+S.y},L=Math.max(Math.abs(M.x-m[0].x),Math.abs(I.x-m[0].x)),D=Math.max(Math.abs(M.y-m[0].y),Math.abs(I.y-m[0].y));L>=D?(p=(M.x+I.x)/2,y=m[0].y):(p=m[0].x,y=(M.y+I.y)/2)}return[[e,{x:f.x+b.x,y:f.y+b.y},...m,{x:d.x+S.x,y:d.y+S.y},n],p,y,h,w]}function rc(e,t,n,o){const r=Math.min(Vo(e,t)/2,Vo(t,n)/2,o),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const f=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${s+r*f},${i}Q ${s},${i} ${s},${i+r*d}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${s},${i+r*l}Q ${s},${i} ${s+r*a},${i}`}function Gn({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:s=X.Top,borderRadius:i=5,centerX:a,centerY:l,offset:f=20,stepPosition:d=.5}){const[u,c,g,m,p]=oc({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:s,center:{x:a,y:l},offset:f,stepPosition:d});return[u.reduce((b,S,h)=>{let w="";return h>0&&h<u.length-1?w=rc(u[h-1],S,u[h+1],i):w=`${h===0?"M":"L"}${S.x} ${S.y}`,b+=w,b},""),c,g,m,p]}function Yo(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function sc(e){var u;const{sourceNode:t,targetNode:n}=e;if(!Yo(t)||!Yo(n))return null;const o=t.internals.handleBounds||Xo(t.handles),r=n.internals.handleBounds||Xo(n.handles),s=Wo((o==null?void 0:o.source)??[],e.sourceHandle),i=Wo(e.connectionMode===ut.Strict?(r==null?void 0:r.target)??[]:((r==null?void 0:r.target)??[]).concat((r==null?void 0:r.source)??[]),e.targetHandle);if(!s||!i)return(u=e.onError)==null||u.call(e,"008",Pe.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(s==null?void 0:s.position)||X.Bottom,l=(i==null?void 0:i.position)||X.Top,f=Rt(t,s,a),d=Rt(n,i,l);return{sourceX:f.x,sourceY:f.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function Xo(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Rt(e,t,n=X.Left,o=!1){const r=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,s=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??ze(e);if(o)return{x:r+i/2,y:s+a/2};switch((t==null?void 0:t.position)??n){case X.Top:return{x:r+i/2,y:s};case X.Right:return{x:r+i,y:s+a/2};case X.Bottom:return{x:r+i/2,y:s+a};case X.Left:return{x:r,y:s+a/2}}}function Wo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function qn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function ic(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||o,a.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){const f=qn(l,t);s.has(f)||(i.push({id:f,color:l.color||n,...l}),s.add(f))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const co={nodeOrigin:[0,0],nodeExtent:Dt,elevateNodesOnSelect:!0,defaults:{}},ac={...co,checkEquality:!0};function lo(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function cc(e,t,n){const o=lo(co,n);for(const r of e.values())if(r.parentId)uo(r,e,t,o);else{const s=Lt(r,o.nodeOrigin),i=gt(r.extent)?r.extent:o.nodeExtent,a=nt(s,i,ze(r));r.internals.positionAbsolute=a}}function Kn(e,t,n,o){var l,f;const r=lo(ac,o);let s=e.length>0;const i=new Map(t),a=r!=null&&r.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const d of e){let u=i.get(d.id);if(r.checkEquality&&d===(u==null?void 0:u.internals.userNode))t.set(d.id,u);else{const c=Lt(d,r.nodeOrigin),g=gt(d.extent)?d.extent:r.nodeExtent,m=nt(c,g,ze(d));u={...r.defaults,...d,measured:{width:(l=d.measured)==null?void 0:l.width,height:(f=d.measured)==null?void 0:f.height},internals:{positionAbsolute:m,handleBounds:d.measured?u==null?void 0:u.internals.handleBounds:void 0,z:cs(d,a),userNode:d}},t.set(d.id,u)}(u.measured===void 0||u.measured.width===void 0||u.measured.height===void 0)&&!u.hidden&&(s=!1),d.parentId&&uo(u,t,n,o)}return s}function lc(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function uo(e,t,n,o){const{elevateNodesOnSelect:r,nodeOrigin:s,nodeExtent:i}=lo(co,o),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}lc(e,n);const f=r?1e3:0,{x:d,y:u,z:c}=uc(e,l,s,i,f),{positionAbsolute:g}=e.internals,m=d!==g.x||u!==g.y;(m||c!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:m?{x:d,y:u}:g,z:c}})}function cs(e,t){return(Ne(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function uc(e,t,n,o,r){const{x:s,y:i}=t.internals.positionAbsolute,a=ze(e),l=Lt(e,n),f=gt(e.extent)?nt(l,e.extent,a):l;let d=nt({x:s+f.x,y:i+f.y},o,a);e.extent==="parent"&&(d=qr(d,a,t));const u=cs(e,r),c=t.internals.z??0;return{x:d.x,y:d.y,z:c>=u?c+1:u}}function fo(e,t,n,o=[0,0]){var i;const r=[],s=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const f=((i=s.get(a.parentId))==null?void 0:i.expandedRect)??ft(l),d=Zr(f,a.rect);s.set(a.parentId,{expandedRect:d,parent:l})}return s.size>0&&s.forEach(({expandedRect:a,parent:l},f)=>{var h;const d=l.internals.positionAbsolute,u=ze(l),c=l.origin??o,g=a.x<d.x?Math.round(Math.abs(d.x-a.x)):0,m=a.y<d.y?Math.round(Math.abs(d.y-a.y)):0,p=Math.max(u.width,Math.round(a.width)),y=Math.max(u.height,Math.round(a.height)),b=(p-u.width)*c[0],S=(y-u.height)*c[1];(g>0||m>0||b||S)&&(r.push({id:f,type:"position",position:{x:l.position.x-g+b,y:l.position.y-m+S}}),(h=n.get(f))==null||h.forEach(w=>{e.some(C=>C.id===w.id)||r.push({id:w.id,type:"position",position:{x:w.position.x+g,y:w.position.y+m}})})),(u.width<a.width||u.height<a.height||g||m)&&r.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:p+(g?c[0]*g-b:0),height:y+(m?c[1]*m-S:0)}})}),r}function dc(e,t,n,o,r,s){const i=o==null?void 0:o.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const l=[],f=window.getComputedStyle(i),{m22:d}=new window.DOMMatrixReadOnly(f.transform),u=[];for(const c of e.values()){const g=t.get(c.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),a=!0;continue}const m=ao(c.nodeElement),p=g.measured.width!==m.width||g.measured.height!==m.height;if(!!(m.width&&m.height&&(p||!g.internals.handleBounds||c.force))){const b=c.nodeElement.getBoundingClientRect(),S=gt(g.extent)?g.extent:s;let{positionAbsolute:h}=g.internals;g.parentId&&g.extent==="parent"?h=qr(h,m,t.get(g.parentId)):S&&(h=nt(h,S,m));const w={...g,measured:m,internals:{...g.internals,positionAbsolute:h,handleBounds:{source:Ho("source",c.nodeElement,b,d,g.id),target:Ho("target",c.nodeElement,b,d,g.id)}}};t.set(g.id,w),g.parentId&&uo(w,t,n,{nodeOrigin:r}),a=!0,p&&(l.push({id:g.id,type:"dimensions",dimensions:m}),g.expandParent&&g.parentId&&u.push({id:g.id,parentId:g.parentId,rect:ft(w,r)}))}}if(u.length>0){const c=fo(u,t,n,r);l.push(...c)}return{changes:l,updatedInternals:a}}async function fc({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,s]],o),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function Uo(e,t,n,o,r,s){let i=r;const a=o.get(i)||new Map;o.set(i,a.set(n,t)),i=`${r}-${e}`;const l=o.get(i)||new Map;if(o.set(i,l.set(n,t)),s){i=`${r}-${e}-${s}`;const f=o.get(i)||new Map;o.set(i,f.set(n,t))}}function ls(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:s,sourceHandle:i=null,targetHandle:a=null}=o,l={edgeId:o.id,source:r,target:s,sourceHandle:i,targetHandle:a},f=`${r}-${i}--${s}-${a}`,d=`${s}-${a}--${r}-${i}`;Uo("source",l,d,e,r,i),Uo("target",l,f,e,s,a),t.set(o.id,o)}}function us(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:us(n,t):!1}function Go(e,t,n){var r;let o=e;do{if((r=o==null?void 0:o.matches)!=null&&r.call(o,t))return!0;if(o===n)return!1;o=o==null?void 0:o.parentElement}while(o);return!1}function gc(e,t,n,o){const r=new Map;for(const[s,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!us(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&r.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function Rn({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){var i,a,l;const r=[];for(const[f,d]of t){const u=(i=n.get(f))==null?void 0:i.internals.userNode;u&&r.push({...u,position:d.position,dragging:o})}if(!e)return[r[0],r];const s=(a=n.get(e))==null?void 0:a.internals.userNode;return[s?{...s,position:((l=t.get(e))==null?void 0:l.position)||s.position,dragging:o}:r[0],r]}function hc({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let s={x:null,y:null},i=0,a=new Map,l=!1,f={x:0,y:0},d=null,u=!1,c=null,g=!1,m=!1;function p({noDragClassName:b,handleSelector:S,domNode:h,isSelectable:w,nodeId:C,nodeClickDistance:E=0}){c=un(h);function N({x:D,y:R},k){const{nodeLookup:P,nodeExtent:_,snapGrid:$,snapToGrid:j,nodeOrigin:z,onNodeDrag:A,onSelectionDrag:T,onError:O,updateNodePositions:H}=t();s={x:D,y:R};let V=!1,W={x:0,y:0,x2:0,y2:0};if(a.size>1&&_){const Z=$t(a);W=Un(Z)}for(const[Z,G]of a){if(!P.has(Z))continue;let Q={x:D-G.distance.x,y:R-G.distance.y};j&&(Q=gn(Q,$));let B=[[_[0][0],_[0][1]],[_[1][0],_[1][1]]];if(a.size>1&&_&&!G.extent){const{positionAbsolute:J}=G.internals,Y=J.x-W.x+_[0][0],K=J.x+G.measured.width-W.x2+_[1][0],U=J.y-W.y+_[0][1],te=J.y+G.measured.height-W.y2+_[1][1];B=[[Y,U],[K,te]]}const{position:q,positionAbsolute:F}=Gr({nodeId:Z,nextPosition:Q,nodeLookup:P,nodeExtent:B,nodeOrigin:z,onError:O});V=V||G.position.x!==q.x||G.position.y!==q.y,G.position=q,G.internals.positionAbsolute=F}if(m=m||V,!!V&&(H(a,!0),k&&(o||A||!C&&T))){const[Z,G]=Rn({nodeId:C,dragItems:a,nodeLookup:P});o==null||o(k,a,Z,G),A==null||A(k,Z,G),C||T==null||T(k,G)}}async function M(){if(!d)return;const{transform:D,panBy:R,autoPanSpeed:k,autoPanOnNodeDrag:P}=t();if(!P){l=!1,cancelAnimationFrame(i);return}const[_,$]=Kr(f,d,k);(_!==0||$!==0)&&(s.x=(s.x??0)-_/D[2],s.y=(s.y??0)-$/D[2],await R({x:_,y:$})&&N(s,null)),i=requestAnimationFrame(M)}function I(D){var V;const{nodeLookup:R,multiSelectionActive:k,nodesDraggable:P,transform:_,snapGrid:$,snapToGrid:j,selectNodesOnDrag:z,onNodeDragStart:A,onSelectionDragStart:T,unselectNodesAndEdges:O}=t();u=!0,(!z||!w)&&!k&&C&&((V=R.get(C))!=null&&V.selected||O()),w&&z&&C&&(e==null||e(C));const H=Ct(D.sourceEvent,{transform:_,snapGrid:$,snapToGrid:j,containerBounds:d});if(s=H,a=gc(R,P,H,C),a.size>0&&(n||A||!C&&T)){const[W,Z]=Rn({nodeId:C,dragItems:a,nodeLookup:R});n==null||n(D.sourceEvent,a,W,Z),A==null||A(D.sourceEvent,W,Z),C||T==null||T(D.sourceEvent,Z)}}const L=Br().clickDistance(E).on("start",D=>{const{domNode:R,nodeDragThreshold:k,transform:P,snapGrid:_,snapToGrid:$}=t();d=(R==null?void 0:R.getBoundingClientRect())||null,g=!1,m=!1,k===0&&I(D),s=Ct(D.sourceEvent,{transform:P,snapGrid:_,snapToGrid:$,containerBounds:d}),f=je(D.sourceEvent,d)}).on("drag",D=>{const{autoPanOnNodeDrag:R,transform:k,snapGrid:P,snapToGrid:_,nodeDragThreshold:$,nodeLookup:j}=t(),z=Ct(D.sourceEvent,{transform:k,snapGrid:P,snapToGrid:_,containerBounds:d});if((D.sourceEvent.type==="touchmove"&&D.sourceEvent.touches.length>1||C&&!j.has(C))&&(g=!0),!g){if(!l&&R&&u&&(l=!0,M()),!u){const A=z.xSnapped-(s.x??0),T=z.ySnapped-(s.y??0);Math.sqrt(A*A+T*T)>$&&I(D)}(s.x!==z.xSnapped||s.y!==z.ySnapped)&&a&&u&&(f=je(D.sourceEvent,d),N(z,D.sourceEvent))}}).on("end",D=>{if(!(!u||g)&&(l=!1,u=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:R,updateNodePositions:k,onNodeDragStop:P,onSelectionDragStop:_}=t();if(m&&(k(a,!1),m=!1),r||P||!C&&_){const[$,j]=Rn({nodeId:C,dragItems:a,nodeLookup:R,dragging:!1});r==null||r(D.sourceEvent,a,$,j),P==null||P(D.sourceEvent,$,j),C||_==null||_(D.sourceEvent,j)}}}).filter(D=>{const R=D.target;return!D.button&&(!b||!Go(R,`.${b}`,h))&&(!S||Go(R,S,h))});c.call(L)}function y(){c==null||c.on(".drag",null)}return{update:p,destroy:y}}function pc(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())At(r,ft(s))>0&&o.push(s);return o}const mc=250;function yc(e,t,n,o){var a,l;let r=[],s=1/0;const i=pc(e,n,t+mc);for(const f of i){const d=[...((a=f.internals.handleBounds)==null?void 0:a.source)??[],...((l=f.internals.handleBounds)==null?void 0:l.target)??[]];for(const u of d){if(o.nodeId===u.nodeId&&o.type===u.type&&o.id===u.id)continue;const{x:c,y:g}=Rt(f,u,u.position,!0),m=Math.sqrt(Math.pow(c-e.x,2)+Math.pow(g-e.y,2));m>t||(m<s?(r=[{...u,x:c,y:g}],s=m):m===s&&r.push({...u,x:c,y:g}))}}if(!r.length)return null;if(r.length>1){const f=o.type==="source"?"target":"source";return r.find(d=>d.type===f)??r[0]}return r[0]}function ds(e,t,n,o,r,s=!1){var f,d,u;const i=o.get(e);if(!i)return null;const a=r==="strict"?(f=i.internals.handleBounds)==null?void 0:f[t]:[...((d=i.internals.handleBounds)==null?void 0:d.source)??[],...((u=i.internals.handleBounds)==null?void 0:u.target)??[]],l=(n?a==null?void 0:a.find(c=>c.id===n):a==null?void 0:a[0])??null;return l&&s?{...l,...Rt(i,l,l.position,!0)}:l}function fs(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function xc(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const gs=()=>!0;function vc(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:l,lib:f,autoPanOnConnect:d,flowId:u,panBy:c,cancelConnection:g,onConnectStart:m,onConnect:p,onConnectEnd:y,isValidConnection:b=gs,onReconnectEnd:S,updateConnection:h,getTransform:w,getFromHandle:C,autoPanSpeed:E,dragThreshold:N=1}){const M=es(e.target);let I=0,L;const{x:D,y:R}=je(e),k=M==null?void 0:M.elementFromPoint(D,R),P=fs(s,k),_=a==null?void 0:a.getBoundingClientRect();let $=!1;if(!_||!P)return;const j=ds(r,P,o,l,t);if(!j)return;let z=je(e,_),A=!1,T=null,O=!1,H=null;function V(){if(!d||!_)return;const[J,Y]=Kr(z,_,E);c({x:J,y:Y}),I=requestAnimationFrame(V)}const W={...j,nodeId:r,type:P,position:j.position},Z=l.get(r);let Q={inProgress:!0,isValid:null,from:Rt(Z,W,X.Left,!0),fromHandle:W,fromPosition:W.position,fromNode:Z,to:z,toHandle:null,toPosition:$o[W.position],toNode:null};function B(){$=!0,h(Q),m==null||m(e,{nodeId:r,handleId:o,handleType:P})}N===0&&B();function q(J){if(!$){const{x:te,y:oe}=je(J),ve=te-D,Le=oe-R;if(!(ve*ve+Le*Le>N*N))return;B()}if(!C()||!W){F(J);return}const Y=w();z=je(J,_),L=yc(Tt(z,Y,!1,[1,1]),n,l,W),A||(V(),A=!0);const K=hs(J,{handle:L,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:i?"target":"source",isValidConnection:b,doc:M,lib:f,flowId:u,nodeLookup:l});H=K.handleDomNode,T=K.connection,O=xc(!!L,K.isValid);const U={...Q,isValid:O,to:K.toHandle&&O?tn({x:K.toHandle.x,y:K.toHandle.y},Y):z,toHandle:K.toHandle,toPosition:O&&K.toHandle?K.toHandle.position:$o[W.position],toNode:K.toHandle?l.get(K.toHandle.nodeId):null};O&&L&&Q.toHandle&&U.toHandle&&Q.toHandle.type===U.toHandle.type&&Q.toHandle.nodeId===U.toHandle.nodeId&&Q.toHandle.id===U.toHandle.id&&Q.to.x===U.to.x&&Q.to.y===U.to.y||(h(U),Q=U)}function F(J){if($){(L||H)&&T&&O&&(p==null||p(T));const{inProgress:Y,...K}=Q,U={...K,toPosition:Q.toHandle?Q.toPosition:null};y==null||y(J,U),s&&(S==null||S(J,U))}g(),cancelAnimationFrame(I),A=!1,O=!1,T=null,H=null,M.removeEventListener("mousemove",q),M.removeEventListener("mouseup",F),M.removeEventListener("touchmove",q),M.removeEventListener("touchend",F)}M.addEventListener("mousemove",q),M.addEventListener("mouseup",F),M.addEventListener("touchmove",q),M.addEventListener("touchend",F)}function hs(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:s,doc:i,lib:a,flowId:l,isValidConnection:f=gs,nodeLookup:d}){const u=s==="target",c=t?i.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:g,y:m}=je(e),p=i.elementFromPoint(g,m),y=p!=null&&p.classList.contains(`${a}-flow__handle`)?p:c,b={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const S=fs(void 0,y),h=y.getAttribute("data-nodeid"),w=y.getAttribute("data-handleid"),C=y.classList.contains("connectable"),E=y.classList.contains("connectableend");if(!h||!S)return b;const N={source:u?h:o,sourceHandle:u?w:r,target:u?o:h,targetHandle:u?r:w};b.connection=N;const I=C&&E&&(n===ut.Strict?u&&S==="source"||!u&&S==="target":h!==o||w!==r);b.isValid=I&&f(N),b.toHandle=ds(h,S,w,d,n,!0)}return b}const Zn={onPointerDown:vc,isValid:hs};function bc({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=un(e);function s({translateExtent:a,width:l,height:f,zoomStep:d=10,pannable:u=!0,zoomable:c=!0,inversePan:g=!1}){const m=h=>{const w=n();if(h.sourceEvent.type!=="wheel"||!t)return;const C=-h.sourceEvent.deltaY*(h.sourceEvent.deltaMode===1?.05:h.sourceEvent.deltaMode?1:.002)*d,E=w[2]*Math.pow(2,C);t.scaleTo(E)};let p=[0,0];const y=h=>{(h.sourceEvent.type==="mousedown"||h.sourceEvent.type==="touchstart")&&(p=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY])},b=h=>{const w=n();if(h.sourceEvent.type!=="mousemove"&&h.sourceEvent.type!=="touchmove"||!t)return;const C=[h.sourceEvent.clientX??h.sourceEvent.touches[0].clientX,h.sourceEvent.clientY??h.sourceEvent.touches[0].clientY],E=[C[0]-p[0],C[1]-p[1]];p=C;const N=o()*Math.max(w[2],Math.log(w[2]))*(g?-1:1),M={x:w[0]-E[0]*N,y:w[1]-E[1]*N},I=[[0,0],[l,f]];t.setViewportConstrained({x:M.x,y:M.y,zoom:w[2]},I,a)},S=Hr().on("start",y).on("zoom",u?b:null).on("zoom.wheel",c?m:null);r.call(S,{})}function i(){r.on("zoom",null)}return{update:s,destroy:i,pointer:zr}}const wc=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,hn=e=>({x:e.x,y:e.y,zoom:e.k}),kn=({x:e,y:t,zoom:n})=>Na.translate(e,t).scale(n),at=(e,t)=>e.target.closest(`.${t}`),ps=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Sc=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,jn=(e,t=0,n=Sc,o=()=>{})=>{const r=typeof t=="number"&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},ms=e=>{const t=e.ctrlKey&&nn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Cc({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:f}){return d=>{if(at(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();const u=n.property("__zoom").k||1;if(d.ctrlKey&&i){const y=zr(d),b=ms(d),S=u*Math.pow(2,b);o.scaleTo(n,S,y,d);return}const c=d.deltaMode===1?20:1;let g=r===et.Vertical?0:d.deltaX*c,m=r===et.Horizontal?0:d.deltaY*c;!nn()&&d.shiftKey&&r!==et.Vertical&&(g=d.deltaY*c,m=0),o.translateBy(n,-(g/u)*s,-(m/u)*s,{internal:!0});const p=hn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(d,p)),e.isPanScrolling&&(l==null||l(d,p),e.panScrollTimeout=setTimeout(()=>{f==null||f(d,p),e.isPanScrolling=!1},150))}}function Ec({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const s=o.type==="wheel",i=!t&&s&&!o.ctrlKey,a=at(o,e);if(o.ctrlKey&&s&&a&&o.preventDefault(),i||a)return null;o.preventDefault(),n.call(this,o,r)}}function Mc({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{var s,i,a;if((s=o.sourceEvent)!=null&&s.internal)return;const r=hn(o.transform);e.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=r,((a=o.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(o.sourceEvent,r))}}function Nc({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return s=>{var i,a;e.usedRightMouseButton=!!(n&&ps(t,e.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||o([s.transform.x,s.transform.y,s.transform.k]),r&&!((a=s.sourceEvent)!=null&&a.internal)&&(r==null||r(s.sourceEvent,hn(s.transform)))}}function Dc({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:s}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,s&&ps(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),r&&wc(e.prevViewport,i.transform))){const l=hn(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r==null||r(i.sourceEvent,l)},n?150:0)}}}function Ic({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:l,lib:f}){return d=>{var m;const u=e||t,c=n&&d.ctrlKey;if(d.button===1&&d.type==="mousedown"&&(at(d,`${f}-flow__node`)||at(d,`${f}-flow__edge`)))return!0;if(!o&&!u&&!r&&!s&&!n||i||at(d,a)&&d.type==="wheel"||at(d,l)&&(d.type!=="wheel"||r&&d.type==="wheel"&&!e)||!n&&d.ctrlKey&&d.type==="wheel")return!1;if(!n&&d.type==="touchstart"&&((m=d.touches)==null?void 0:m.length)>1)return d.preventDefault(),!1;if(!u&&!r&&!c&&d.type==="wheel"||!o&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(o)&&!o.includes(d.button)&&d.type==="mousedown")return!1;const g=Array.isArray(o)&&o.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||d.type==="wheel")&&g}}function Ac({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:r,viewport:s,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:f}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),c=Hr().clickDistance(!Ne(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(r),g=un(e).call(c);h({x:s.x,y:s.y,zoom:dt(s.zoom,t,n)},[[0,0],[u.width,u.height]],r);const m=g.on("wheel.zoom"),p=g.on("dblclick.zoom");c.wheelDelta(ms);function y(R,k){return g?new Promise(P=>{c==null||c.interpolate((k==null?void 0:k.interpolate)==="linear"?St:An).transform(jn(g,k==null?void 0:k.duration,k==null?void 0:k.ease,()=>P(!0)),R)}):Promise.resolve(!1)}function b({noWheelClassName:R,noPanClassName:k,onPaneContextMenu:P,userSelectionActive:_,panOnScroll:$,panOnDrag:j,panOnScrollMode:z,panOnScrollSpeed:A,preventScrolling:T,zoomOnPinch:O,zoomOnScroll:H,zoomOnDoubleClick:V,zoomActivationKeyPressed:W,lib:Z,onTransformChange:G}){_&&!d.isZoomingOrPanning&&S();const B=$&&!W&&!_?Cc({zoomPanValues:d,noWheelClassName:R,d3Selection:g,d3Zoom:c,panOnScrollMode:z,panOnScrollSpeed:A,zoomOnPinch:O,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):Ec({noWheelClassName:R,preventScrolling:T,d3ZoomHandler:m});if(g.on("wheel.zoom",B,{passive:!1}),!_){const F=Mc({zoomPanValues:d,onDraggingChange:f,onPanZoomStart:a});c.on("start",F);const J=Nc({zoomPanValues:d,panOnDrag:j,onPaneContextMenu:!!P,onPanZoom:i,onTransformChange:G});c.on("zoom",J);const Y=Dc({zoomPanValues:d,panOnDrag:j,panOnScroll:$,onPaneContextMenu:P,onPanZoomEnd:l,onDraggingChange:f});c.on("end",Y)}const q=Ic({zoomActivationKeyPressed:W,panOnDrag:j,zoomOnScroll:H,panOnScroll:$,zoomOnDoubleClick:V,zoomOnPinch:O,userSelectionActive:_,noPanClassName:k,noWheelClassName:R,lib:Z});c.filter(q),V?g.on("dblclick.zoom",p):g.on("dblclick.zoom",null)}function S(){c.on("zoom",null)}async function h(R,k,P){const _=kn(R),$=c==null?void 0:c.constrain()(_,k,P);return $&&await y($),new Promise(j=>j($))}async function w(R,k){const P=kn(R);return await y(P,k),new Promise(_=>_(P))}function C(R){if(g){const k=kn(R),P=g.property("__zoom");(P.k!==R.zoom||P.x!==R.x||P.y!==R.y)&&(c==null||c.transform(g,k,null,{sync:!0}))}}function E(){const R=g?Da(g.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function N(R,k){return g?new Promise(P=>{c==null||c.interpolate((k==null?void 0:k.interpolate)==="linear"?St:An).scaleTo(jn(g,k==null?void 0:k.duration,k==null?void 0:k.ease,()=>P(!0)),R)}):Promise.resolve(!1)}function M(R,k){return g?new Promise(P=>{c==null||c.interpolate((k==null?void 0:k.interpolate)==="linear"?St:An).scaleBy(jn(g,k==null?void 0:k.duration,k==null?void 0:k.ease,()=>P(!0)),R)}):Promise.resolve(!1)}function I(R){c==null||c.scaleExtent(R)}function L(R){c==null||c.translateExtent(R)}function D(R){const k=!Ne(R)||R<0?0:R;c==null||c.clickDistance(k)}return{update:b,destroy:S,setViewport:w,setViewportConstrained:h,getViewport:E,scaleTo:N,scaleBy:M,setScaleExtent:I,setTranslateExtent:L,syncViewport:C,setClickDistance:D}}var ht;(function(e){e.Line="line",e.Handle="handle"})(ht||(ht={}));function Rc({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:s}){const i=e-t,a=n-o,l=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&r&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}function kc(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Ye(e,t){return Math.max(0,t-e)}function Xe(e,t){return Math.max(0,e-t)}function Wt(e,t,n){return Math.max(0,t-e,e-n)}function qo(e,t){return e?!t:t}function jc(e,t,n,o,r,s,i,a){let{affectsX:l,affectsY:f}=t;const{isHorizontal:d,isVertical:u}=t,c=d&&u,{xSnapped:g,ySnapped:m}=n,{minWidth:p,maxWidth:y,minHeight:b,maxHeight:S}=o,{x:h,y:w,width:C,height:E,aspectRatio:N}=e;let M=Math.floor(d?g-e.pointerX:0),I=Math.floor(u?m-e.pointerY:0);const L=C+(l?-M:M),D=E+(f?-I:I),R=-s[0]*C,k=-s[1]*E;let P=Wt(L,p,y),_=Wt(D,b,S);if(i){let z=0,A=0;l&&M<0?z=Ye(h+M+R,i[0][0]):!l&&M>0&&(z=Xe(h+L+R,i[1][0])),f&&I<0?A=Ye(w+I+k,i[0][1]):!f&&I>0&&(A=Xe(w+D+k,i[1][1])),P=Math.max(P,z),_=Math.max(_,A)}if(a){let z=0,A=0;l&&M>0?z=Xe(h+M,a[0][0]):!l&&M<0&&(z=Ye(h+L,a[1][0])),f&&I>0?A=Xe(w+I,a[0][1]):!f&&I<0&&(A=Ye(w+D,a[1][1])),P=Math.max(P,z),_=Math.max(_,A)}if(r){if(d){const z=Wt(L/N,b,S)*N;if(P=Math.max(P,z),i){let A=0;!l&&!f||l&&!f&&c?A=Xe(w+k+L/N,i[1][1])*N:A=Ye(w+k+(l?M:-M)/N,i[0][1])*N,P=Math.max(P,A)}if(a){let A=0;!l&&!f||l&&!f&&c?A=Ye(w+L/N,a[1][1])*N:A=Xe(w+(l?M:-M)/N,a[0][1])*N,P=Math.max(P,A)}}if(u){const z=Wt(D*N,p,y)/N;if(_=Math.max(_,z),i){let A=0;!l&&!f||f&&!l&&c?A=Xe(h+D*N+R,i[1][0])/N:A=Ye(h+(f?I:-I)*N+R,i[0][0])/N,_=Math.max(_,A)}if(a){let A=0;!l&&!f||f&&!l&&c?A=Ye(h+D*N,a[1][0])/N:A=Xe(h+(f?I:-I)*N,a[0][0])/N,_=Math.max(_,A)}}}I=I+(I<0?_:-_),M=M+(M<0?P:-P),r&&(c?L>D*N?I=(qo(l,f)?-M:M)/N:M=(qo(l,f)?-I:I)*N:d?(I=M/N,f=l):(M=I*N,l=f));const $=l?h+M:h,j=f?w+I:w;return{width:C+(l?-M:M),height:E+(f?-I:I),x:s[0]*M*(l?-1:1)+$,y:s[1]*I*(f?-1:1)+j}}const ys={width:0,height:0,x:0,y:0},Pc={...ys,pointerX:0,pointerY:0,aspectRatio:1};function _c(e){return[[0,0],[e.measured.width,e.measured.height]]}function Lc(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,l=n[1]*i;return[[o-a,r-l],[o+s-a,r+i-l]]}function $c({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const s=un(e);function i({controlPosition:l,boundaries:f,keepAspectRatio:d,resizeDirection:u,onResizeStart:c,onResize:g,onResizeEnd:m,shouldResize:p}){let y={...ys},b={...Pc};const S=kc(l);let h,w=null,C=[],E,N,M;const I=Br().on("start",L=>{const{nodeLookup:D,transform:R,snapGrid:k,snapToGrid:P,nodeOrigin:_,paneDomNode:$}=n();if(h=D.get(t),!h)return;w=($==null?void 0:$.getBoundingClientRect())??null;const{xSnapped:j,ySnapped:z}=Ct(L.sourceEvent,{transform:R,snapGrid:k,snapToGrid:P,containerBounds:w});y={width:h.measured.width??0,height:h.measured.height??0,x:h.position.x??0,y:h.position.y??0},b={...y,pointerX:j,pointerY:z,aspectRatio:y.width/y.height},E=void 0,h.parentId&&(h.extent==="parent"||h.expandParent)&&(E=D.get(h.parentId),N=E&&h.extent==="parent"?_c(E):void 0),C=[],M=void 0;for(const[A,T]of D)if(T.parentId===t&&(C.push({id:A,position:{...T.position},extent:T.extent}),T.extent==="parent"||T.expandParent)){const O=Lc(T,h,T.origin??_);M?M=[[Math.min(O[0][0],M[0][0]),Math.min(O[0][1],M[0][1])],[Math.max(O[1][0],M[1][0]),Math.max(O[1][1],M[1][1])]]:M=O}c==null||c(L,{...y})}).on("drag",L=>{const{transform:D,snapGrid:R,snapToGrid:k,nodeOrigin:P}=n(),_=Ct(L.sourceEvent,{transform:D,snapGrid:R,snapToGrid:k,containerBounds:w}),$=[];if(!h)return;const{x:j,y:z,width:A,height:T}=y,O={},H=h.origin??P,{width:V,height:W,x:Z,y:G}=jc(b,S,_,f,d,H,N,M),Q=V!==A,B=W!==T,q=Z!==j&&Q,F=G!==z&&B;if(!q&&!F&&!Q&&!B)return;if((q||F||H[0]===1||H[1]===1)&&(O.x=q?Z:y.x,O.y=F?G:y.y,y.x=O.x,y.y=O.y,C.length>0)){const U=Z-j,te=G-z;for(const oe of C)oe.position={x:oe.position.x-U+H[0]*(V-A),y:oe.position.y-te+H[1]*(W-T)},$.push(oe)}if((Q||B)&&(O.width=Q&&(!u||u==="horizontal")?V:y.width,O.height=B&&(!u||u==="vertical")?W:y.height,y.width=O.width,y.height=O.height),E&&h.expandParent){const U=H[0]*(O.width??0);O.x&&O.x<U&&(y.x=U,b.x=b.x-(O.x-U));const te=H[1]*(O.height??0);O.y&&O.y<te&&(y.y=te,b.y=b.y-(O.y-te))}const J=Rc({width:y.width,prevWidth:A,height:y.height,prevHeight:T,affectsX:S.affectsX,affectsY:S.affectsY}),Y={...y,direction:J};(p==null?void 0:p(L,Y))!==!1&&(g==null||g(L,Y),o(O,$))}).on("end",L=>{m==null||m(L,{...y}),r==null||r({...y})});s.call(I)}function a(){s.on(".drag",null)}return{update:i,destroy:a}}var Pn={exports:{}},_n={},Ln={exports:{}},$n={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ko;function Tc(){if(Ko)return $n;Ko=1;var e=Lr();function t(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var n=typeof Object.is=="function"?Object.is:t,o=e.useState,r=e.useEffect,s=e.useLayoutEffect,i=e.useDebugValue;function a(u,c){var g=c(),m=o({inst:{value:g,getSnapshot:c}}),p=m[0].inst,y=m[1];return s(function(){p.value=g,p.getSnapshot=c,l(p)&&y({inst:p})},[u,g,c]),r(function(){return l(p)&&y({inst:p}),u(function(){l(p)&&y({inst:p})})},[u]),i(g),g}function l(u){var c=u.getSnapshot;u=u.value;try{var g=c();return!n(u,g)}catch{return!0}}function f(u,c){return c()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:a;return $n.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,$n}var Zo;function Oc(){return Zo||(Zo=1,Ln.exports=Tc()),Ln.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qo;function zc(){if(Qo)return _n;Qo=1;var e=Lr(),t=Oc();function n(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var o=typeof Object.is=="function"?Object.is:n,r=t.useSyncExternalStore,s=e.useRef,i=e.useEffect,a=e.useMemo,l=e.useDebugValue;return _n.useSyncExternalStoreWithSelector=function(f,d,u,c,g){var m=s(null);if(m.current===null){var p={hasValue:!1,value:null};m.current=p}else p=m.current;m=a(function(){function b(E){if(!S){if(S=!0,h=E,E=c(E),g!==void 0&&p.hasValue){var N=p.value;if(g(N,E))return w=N}return w=E}if(N=w,o(h,E))return N;var M=c(E);return g!==void 0&&g(N,M)?(h=E,N):(h=E,w=M)}var S=!1,h,w,C=u===void 0?null:u;return[function(){return b(d())},C===null?void 0:function(){return b(C())}]},[d,u,c,g]);var y=r(f,m[0],m[1]);return i(function(){p.hasValue=!0,p.value=y},[y]),l(y),y},_n}var Jo;function Hc(){return Jo||(Jo=1,Pn.exports=zc()),Pn.exports}var Bc=Hc();const Fc=qi(Bc),Vc={},er=e=>{let t;const n=new Set,o=(d,u)=>{const c=typeof d=="function"?d(t):d;if(!Object.is(c,t)){const g=t;t=u??(typeof c!="object"||c===null)?c:Object.assign({},t,c),n.forEach(m=>m(t,g))}},r=()=>t,l={setState:o,getState:r,getInitialState:()=>f,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(Vc?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},f=t=e(o,r,l);return l},Yc=e=>e?er(e):er,{useDebugValue:Xc}=de,{useSyncExternalStoreWithSelector:Wc}=Fc,Uc=e=>e;function xs(e,t=Uc,n){const o=Wc(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Xc(o),o}const tr=(e,t)=>{const n=Yc(e),o=(r,s=t)=>xs(n,r,s);return Object.assign(o,n),o},Gc=(e,t)=>e?tr(e,t):tr;function se(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const pn=x.createContext(null),qc=pn.Provider,vs=Pe.error001();function ee(e,t){const n=x.useContext(pn);if(n===null)throw new Error(vs);return xs(n,e,t)}function re(){const e=x.useContext(pn);if(e===null)throw new Error(vs);return x.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const nr={display:"none"},Kc={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},bs="react-flow__node-desc",ws="react-flow__edge-desc",Zc="react-flow__aria-live",Qc=e=>e.ariaLiveMessage,Jc=e=>e.ariaLabelConfig;function el({rfId:e}){const t=ee(Qc);return v.jsx("div",{id:`${Zc}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Kc,children:t})}function tl({rfId:e,disableKeyboardA11y:t}){const n=ee(Jc);return v.jsxs(v.Fragment,{children:[v.jsx("div",{id:`${bs}-${e}`,style:nr,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),v.jsx("div",{id:`${ws}-${e}`,style:nr,children:n["edge.a11yDescription.default"]}),!t&&v.jsx(el,{rfId:e})]})}const mn=x.forwardRef(({position:e="top-left",children:t,className:n,style:o,...r},s)=>{const i=`${e}`.split("-");return v.jsx("div",{className:ie(["react-flow__panel",n,...i]),style:o,ref:s,...r,children:t})});mn.displayName="Panel";function nl({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:v.jsx(mn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:v.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const ol=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},Ut=e=>e.id;function rl(e,t){return se(e.selectedNodes.map(Ut),t.selectedNodes.map(Ut))&&se(e.selectedEdges.map(Ut),t.selectedEdges.map(Ut))}function sl({onSelectionChange:e}){const t=re(),{selectedNodes:n,selectedEdges:o}=ee(ol,rl);return x.useEffect(()=>{const r={nodes:n,edges:o};e==null||e(r),t.getState().onSelectionChangeHandlers.forEach(s=>s(r))},[n,o,e]),null}const il=e=>!!e.onSelectionChangeHandlers;function al({onSelectionChange:e}){const t=ee(il);return e||t?v.jsx(sl,{onSelectionChange:e}):null}const Ss=[0,0],cl={x:0,y:0,zoom:1},ll=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],or=[...ll,"rfId"],ul=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),rr={translateExtent:Dt,nodeOrigin:Ss,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function dl(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:f}=ee(ul,se),d=re();x.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{u.current=rr,a()}),[]);const u=x.useRef(rr);return x.useEffect(()=>{for(const c of or){const g=e[c],m=u.current[c];g!==m&&(typeof e[c]>"u"||(c==="nodes"?t(g):c==="edges"?n(g):c==="minZoom"?o(g):c==="maxZoom"?r(g):c==="translateExtent"?s(g):c==="nodeExtent"?i(g):c==="paneClickDistance"?f(g):c==="ariaLabelConfig"?d.setState({ariaLabelConfig:Ka(g)}):c==="fitView"?d.setState({fitViewQueued:g}):c==="fitViewOptions"?d.setState({fitViewOptions:g}):d.setState({[c]:g})))}u.current=e},or.map(c=>e[c])),null}function sr(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function fl(e){var o;const[t,n]=x.useState(e==="system"?null:e);return x.useEffect(()=>{if(e!=="system"){n(e);return}const r=sr(),s=()=>n(r!=null&&r.matches?"dark":"light");return s(),r==null||r.addEventListener("change",s),()=>{r==null||r.removeEventListener("change",s)}},[e]),t!==null?t:(o=sr())!=null&&o.matches?"dark":"light"}const ir=typeof document<"u"?document:null;function kt(e=null,t={target:ir,actInsideInputWithModifier:!0}){const[n,o]=x.useState(!1),r=x.useRef(!1),s=x.useRef(new Set([])),[i,a]=x.useMemo(()=>{if(e!==null){const f=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=f.reduce((u,c)=>u.concat(...c),[]);return[f,d]}return[[],[]]},[e]);return x.useEffect(()=>{const l=(t==null?void 0:t.target)??ir,f=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const d=g=>{var y,b;if(r.current=g.ctrlKey||g.metaKey||g.shiftKey||g.altKey,(!r.current||r.current&&!f)&&ts(g))return!1;const p=cr(g.code,a);if(s.current.add(g[p]),ar(i,s.current,!1)){const S=((b=(y=g.composedPath)==null?void 0:y.call(g))==null?void 0:b[0])||g.target,h=(S==null?void 0:S.nodeName)==="BUTTON"||(S==null?void 0:S.nodeName)==="A";t.preventDefault!==!1&&(r.current||!h)&&g.preventDefault(),o(!0)}},u=g=>{const m=cr(g.code,a);ar(i,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(g[m]),g.key==="Meta"&&s.current.clear(),r.current=!1},c=()=>{s.current.clear(),o(!1)};return l==null||l.addEventListener("keydown",d),l==null||l.addEventListener("keyup",u),window.addEventListener("blur",c),window.addEventListener("contextmenu",c),()=>{l==null||l.removeEventListener("keydown",d),l==null||l.removeEventListener("keyup",u),window.removeEventListener("blur",c),window.removeEventListener("contextmenu",c)}}},[e,o]),n}function ar(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function cr(e,t){return t.includes(e)?"code":"key"}const gl=()=>{const e=re();return x.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??s},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),l=io(t,o,r,s,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(l,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),f={x:t.x-a,y:t.y-l},d=n.snapGrid??r,u=n.snapToGrid??s;return Tt(f,o,u,d)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:s}=o.getBoundingClientRect(),i=tn(t,n);return{x:i.x+r,y:i.y+s}}}),[])};function Cs(e,t){const n=[],o=new Map,r=[];for(const s of e)if(s.type==="add"){r.push(s);continue}else if(s.type==="remove"||s.type==="replace")o.set(s.id,[s]);else{const i=o.get(s.id);i?i.push(s):o.set(s.id,[s])}for(const s of t){const i=o.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const l of i)hl(l,a);n.push(a)}return r.length&&r.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function hl(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Es(e,t){return Cs(e,t)}function Ms(e,t){return Cs(e,t)}function Je(e,t){return{id:e,type:"select",selected:t}}function ct(e,t=new Set,n=!1){const o=[];for(const[r,s]of e){const i=t.has(r);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),o.push(Je(s.id,i)))}return o}function lr({items:e=[],lookup:t}){var r;const n=[],o=new Map(e.map(s=>[s.id,s]));for(const[s,i]of e.entries()){const a=t.get(i.id),l=((r=a==null?void 0:a.internals)==null?void 0:r.userNode)??a;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:s})}for(const[s]of t)o.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function ur(e){return{id:e.id,type:"remove"}}const dr=e=>Ha(e),pl=e=>Ur(e);function Ns(e){return x.forwardRef(e)}const ml=typeof window<"u"?x.useLayoutEffect:x.useEffect;function fr(e){const[t,n]=x.useState(BigInt(0)),[o]=x.useState(()=>yl(()=>n(r=>r+BigInt(1))));return ml(()=>{const r=o.get();r.length&&(e(r),o.reset())},[t]),o}function yl(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Ds=x.createContext(null);function xl({children:e}){const t=re(),n=x.useCallback(a=>{const{nodes:l=[],setNodes:f,hasDefaultNodes:d,onNodesChange:u,nodeLookup:c,fitViewQueued:g}=t.getState();let m=l;for(const y of a)m=typeof y=="function"?y(m):y;const p=lr({items:m,lookup:c});d&&f(m),p.length>0?u==null||u(p):g&&window.requestAnimationFrame(()=>{const{fitViewQueued:y,nodes:b,setNodes:S}=t.getState();y&&S(b)})},[]),o=fr(n),r=x.useCallback(a=>{const{edges:l=[],setEdges:f,hasDefaultEdges:d,onEdgesChange:u,edgeLookup:c}=t.getState();let g=l;for(const m of a)g=typeof m=="function"?m(g):m;d?f(g):u&&u(lr({items:g,lookup:c}))},[]),s=fr(r),i=x.useMemo(()=>({nodeQueue:o,edgeQueue:s}),[]);return v.jsx(Ds.Provider,{value:i,children:e})}function vl(){const e=x.useContext(Ds);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const bl=e=>!!e.panZoom;function go(){const e=gl(),t=re(),n=vl(),o=ee(bl),r=x.useMemo(()=>{const s=u=>t.getState().nodeLookup.get(u),i=u=>{n.nodeQueue.push(u)},a=u=>{n.edgeQueue.push(u)},l=u=>{var b,S;const{nodeLookup:c,nodeOrigin:g}=t.getState(),m=dr(u)?u:c.get(u.id),p=m.parentId?Jr(m.position,m.measured,m.parentId,c,g):m.position,y={...m,position:p,width:((b=m.measured)==null?void 0:b.width)??m.width,height:((S=m.measured)==null?void 0:S.height)??m.height};return ft(y)},f=(u,c,g={replace:!1})=>{i(m=>m.map(p=>{if(p.id===u){const y=typeof c=="function"?c(p):c;return g.replace&&dr(y)?y:{...p,...y}}return p}))},d=(u,c,g={replace:!1})=>{a(m=>m.map(p=>{if(p.id===u){const y=typeof c=="function"?c(p):c;return g.replace&&pl(y)?y:{...p,...y}}return p}))};return{getNodes:()=>t.getState().nodes.map(u=>({...u})),getNode:u=>{var c;return(c=s(u))==null?void 0:c.internals.userNode},getInternalNode:s,getEdges:()=>{const{edges:u=[]}=t.getState();return u.map(c=>({...c}))},getEdge:u=>t.getState().edgeLookup.get(u),setNodes:i,setEdges:a,addNodes:u=>{const c=Array.isArray(u)?u:[u];n.nodeQueue.push(g=>[...g,...c])},addEdges:u=>{const c=Array.isArray(u)?u:[u];n.edgeQueue.push(g=>[...g,...c])},toObject:()=>{const{nodes:u=[],edges:c=[],transform:g}=t.getState(),[m,p,y]=g;return{nodes:u.map(b=>({...b})),edges:c.map(b=>({...b})),viewport:{x:m,y:p,zoom:y}}},deleteElements:async({nodes:u=[],edges:c=[]})=>{const{nodes:g,edges:m,onNodesDelete:p,onEdgesDelete:y,triggerNodeChanges:b,triggerEdgeChanges:S,onDelete:h,onBeforeDelete:w}=t.getState(),{nodes:C,edges:E}=await Xa({nodesToRemove:u,edgesToRemove:c,nodes:g,edges:m,onBeforeDelete:w}),N=E.length>0,M=C.length>0;if(N){const I=E.map(ur);y==null||y(E),S(I)}if(M){const I=C.map(ur);p==null||p(C),b(I)}return(M||N)&&(h==null||h({nodes:C,edges:E})),{deletedNodes:C,deletedEdges:E}},getIntersectingNodes:(u,c=!0,g)=>{const m=Oo(u),p=m?u:l(u),y=g!==void 0;return p?(g||t.getState().nodes).filter(b=>{const S=t.getState().nodeLookup.get(b.id);if(S&&!m&&(b.id===u.id||!S.internals.positionAbsolute))return!1;const h=ft(y?b:S),w=At(h,p);return c&&w>0||w>=h.width*h.height||w>=p.width*p.height}):[]},isNodeIntersecting:(u,c,g=!0)=>{const p=Oo(u)?u:l(u);if(!p)return!1;const y=At(p,c);return g&&y>0||y>=p.width*p.height},updateNode:f,updateNodeData:(u,c,g={replace:!1})=>{f(u,m=>{const p=typeof c=="function"?c(m):c;return g.replace?{...m,data:p}:{...m,data:{...m.data,...p}}},g)},updateEdge:d,updateEdgeData:(u,c,g={replace:!1})=>{d(u,m=>{const p=typeof c=="function"?c(m):c;return g.replace?{...m,data:p}:{...m,data:{...m.data,...p}}},g)},getNodesBounds:u=>{const{nodeLookup:c,nodeOrigin:g}=t.getState();return Ba(u,{nodeLookup:c,nodeOrigin:g})},getHandleConnections:({type:u,id:c,nodeId:g})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${g}-${u}${c?`-${c}`:""}`))==null?void 0:m.values())??[])},getNodeConnections:({type:u,handleId:c,nodeId:g})=>{var m;return Array.from(((m=t.getState().connectionLookup.get(`${g}${u?c?`-${u}-${c}`:`-${u}`:""}`))==null?void 0:m.values())??[])},fitView:async u=>{const c=t.getState().fitViewResolver??qa();return t.setState({fitViewQueued:!0,fitViewOptions:u,fitViewResolver:c}),n.nodeQueue.push(g=>[...g]),c.promise}}},[]);return x.useMemo(()=>({...r,...e,viewportInitialized:o}),[o])}const gr=e=>e.selected,wl=typeof window<"u"?window:void 0;function Sl({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=re(),{deleteElements:o}=go(),r=kt(e,{actInsideInputWithModifier:!1}),s=kt(t,{target:wl});x.useEffect(()=>{if(r){const{edges:i,nodes:a}=n.getState();o({nodes:a.filter(gr),edges:i.filter(gr)}),n.setState({nodesSelectionActive:!1})}},[r]),x.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function Cl(e){const t=re();x.useEffect(()=>{const n=()=>{var r,s;if(!e.current)return!1;const o=ao(e.current);(o.height===0||o.width===0)&&((s=(r=t.getState()).onError)==null||s.call(r,"004",Pe.error004())),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const yn={position:"absolute",width:"100%",height:"100%",top:0,left:0},El=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Ml({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:s=et.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:f,minZoom:d,maxZoom:u,zoomActivationKeyCode:c,preventScrolling:g=!0,children:m,noWheelClassName:p,noPanClassName:y,onViewportChange:b,isControlledViewport:S,paneClickDistance:h}){const w=re(),C=x.useRef(null),{userSelectionActive:E,lib:N}=ee(El,se),M=kt(c),I=x.useRef();Cl(C);const L=x.useCallback(D=>{b==null||b({x:D[0],y:D[1],zoom:D[2]}),S||w.setState({transform:D})},[b,S]);return x.useEffect(()=>{if(C.current){I.current=Ac({domNode:C.current,minZoom:d,maxZoom:u,translateExtent:f,viewport:l,paneClickDistance:h,onDraggingChange:P=>w.setState({paneDragging:P}),onPanZoomStart:(P,_)=>{const{onViewportChangeStart:$,onMoveStart:j}=w.getState();j==null||j(P,_),$==null||$(_)},onPanZoom:(P,_)=>{const{onViewportChange:$,onMove:j}=w.getState();j==null||j(P,_),$==null||$(_)},onPanZoomEnd:(P,_)=>{const{onViewportChangeEnd:$,onMoveEnd:j}=w.getState();j==null||j(P,_),$==null||$(_)}});const{x:D,y:R,zoom:k}=I.current.getViewport();return w.setState({panZoom:I.current,transform:[D,R,k],domNode:C.current.closest(".react-flow")}),()=>{var P;(P=I.current)==null||P.destroy()}}},[]),x.useEffect(()=>{var D;(D=I.current)==null||D.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:M,preventScrolling:g,noPanClassName:y,userSelectionActive:E,noWheelClassName:p,lib:N,onTransformChange:L})},[e,t,n,o,r,s,i,a,M,g,y,E,p,N,L]),v.jsx("div",{className:"react-flow__renderer",ref:C,style:yn,children:m})}const Nl=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Dl(){const{userSelectionActive:e,userSelectionRect:t}=ee(Nl,se);return e&&t?v.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Tn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Il=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Al({isSelecting:e,selectionKeyPressed:t,selectionMode:n=It.Full,panOnDrag:o,selectionOnDrag:r,onSelectionStart:s,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:f,onPaneMouseEnter:d,onPaneMouseMove:u,onPaneMouseLeave:c,children:g}){const m=re(),{userSelectionActive:p,elementsSelectable:y,dragging:b,connectionInProgress:S}=ee(Il,se),h=y&&(e||p),w=x.useRef(null),C=x.useRef(),E=x.useRef(new Set),N=x.useRef(new Set),M=x.useRef(!1),I=x.useRef(!1),L=j=>{if(M.current||S){M.current=!1;return}a==null||a(j),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},D=j=>{if(Array.isArray(o)&&(o!=null&&o.includes(2))){j.preventDefault();return}l==null||l(j)},R=f?j=>f(j):void 0,k=j=>{var H,V;const{resetSelectedElements:z,domNode:A}=m.getState();if(C.current=A==null?void 0:A.getBoundingClientRect(),!y||!e||j.button!==0||j.target!==w.current||!C.current)return;(V=(H=j.target)==null?void 0:H.setPointerCapture)==null||V.call(H,j.pointerId),I.current=!0,M.current=!1;const{x:T,y:O}=je(j.nativeEvent,C.current);z(),m.setState({userSelectionRect:{width:0,height:0,startX:T,startY:O,x:T,y:O}}),s==null||s(j)},P=j=>{const{userSelectionRect:z,transform:A,nodeLookup:T,edgeLookup:O,connectionLookup:H,triggerNodeChanges:V,triggerEdgeChanges:W,defaultEdgeOptions:Z}=m.getState();if(!C.current||!z)return;M.current=!0;const{x:G,y:Q}=je(j.nativeEvent,C.current),{startX:B,startY:q}=z,F={startX:B,startY:q,x:G<B?G:B,y:Q<q?Q:q,width:Math.abs(G-B),height:Math.abs(Q-q)},J=E.current,Y=N.current;E.current=new Set(so(T,F,A,n===It.Partial,!0).map(U=>U.id)),N.current=new Set;const K=(Z==null?void 0:Z.selectable)??!0;for(const U of E.current){const te=H.get(U);if(te)for(const{edgeId:oe}of te.values()){const ve=O.get(oe);ve&&(ve.selectable??K)&&N.current.add(oe)}}if(!zo(J,E.current)){const U=ct(T,E.current,!0);V(U)}if(!zo(Y,N.current)){const U=ct(O,N.current);W(U)}m.setState({userSelectionRect:F,userSelectionActive:!0,nodesSelectionActive:!1})},_=j=>{var A,T;if(j.button!==0||!I.current)return;(T=(A=j.target)==null?void 0:A.releasePointerCapture)==null||T.call(A,j.pointerId);const{userSelectionRect:z}=m.getState();!p&&z&&j.target===w.current&&(L==null||L(j)),m.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:E.current.size>0}),i==null||i(j),(t||r)&&(M.current=!1),I.current=!1},$=o===!0||Array.isArray(o)&&o.includes(0);return v.jsxs("div",{className:ie(["react-flow__pane",{draggable:$,dragging:b,selection:e}]),onClick:h?void 0:Tn(L,w),onContextMenu:Tn(D,w),onWheel:Tn(R,w),onPointerEnter:h?void 0:d,onPointerDown:h?k:u,onPointerMove:h?P:u,onPointerUp:h?_:void 0,onPointerLeave:c,ref:w,style:yn,children:[g,v.jsx(Dl,{})]})}function Qn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:l}=t.getState(),f=a.get(e);if(!f){l==null||l("012",Pe.error012(e));return}t.setState({nodesSelectionActive:!1}),f.selected?(n||f.selected&&i)&&(s({nodes:[f],edges:[]}),requestAnimationFrame(()=>{var d;return(d=o==null?void 0:o.current)==null?void 0:d.blur()})):r([e])}function Is({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:s,nodeClickDistance:i}){const a=re(),[l,f]=x.useState(!1),d=x.useRef();return x.useEffect(()=>{d.current=hc({getStoreItems:()=>a.getState(),onNodeMouseDown:u=>{Qn({id:u,store:a,nodeRef:e})},onDragStart:()=>{f(!0)},onDragStop:()=>{f(!1)}})},[]),x.useEffect(()=>{var u,c;if(t)(u=d.current)==null||u.destroy();else if(e.current)return(c=d.current)==null||c.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:s,nodeId:r,nodeClickDistance:i}),()=>{var g;(g=d.current)==null||g.destroy()}},[n,o,t,s,e,r]),l}const Rl=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function As(){const e=re();return x.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:f,nodeOrigin:d}=e.getState(),u=new Map,c=Rl(i),g=r?s[0]:5,m=r?s[1]:5,p=n.direction.x*g*n.factor,y=n.direction.y*m*n.factor;for(const[,b]of f){if(!c(b))continue;let S={x:b.internals.positionAbsolute.x+p,y:b.internals.positionAbsolute.y+y};r&&(S=gn(S,s));const{position:h,positionAbsolute:w}=Gr({nodeId:b.id,nextPosition:S,nodeLookup:f,nodeExtent:o,nodeOrigin:d,onError:a});b.position=h,b.internals.positionAbsolute=w,u.set(b.id,b)}l(u)},[])}const ho=x.createContext(null),kl=ho.Provider;ho.Consumer;const Rs=()=>x.useContext(ho),jl=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Pl=(e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:s,connection:i}=o,{fromHandle:a,toHandle:l,isValid:f}=i,d=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:d,clickConnecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.id)===t&&(r==null?void 0:r.type)===n,isPossibleEndHandle:s===ut.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:d&&f}};function _l({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:l,className:f,onMouseDown:d,onTouchStart:u,...c},g){var _,$;const m=i||null,p=e==="target",y=re(),b=Rs(),{connectOnClick:S,noPanClassName:h,rfId:w}=ee(jl,se),{connectingFrom:C,connectingTo:E,clickConnecting:N,isPossibleEndHandle:M,connectionInProcess:I,clickConnectionInProcess:L,valid:D}=ee(Pl(b,m,e),se);b||($=(_=y.getState()).onError)==null||$.call(_,"010",Pe.error010());const R=j=>{const{defaultEdgeOptions:z,onConnect:A,hasDefaultEdges:T}=y.getState(),O={...z,...j};if(T){const{edges:H,setEdges:V}=y.getState();V(is(O,H))}A==null||A(O),a==null||a(O)},k=j=>{if(!b)return;const z=ns(j.nativeEvent);if(r&&(z&&j.button===0||!z)){const A=y.getState();Zn.onPointerDown(j.nativeEvent,{autoPanOnConnect:A.autoPanOnConnect,connectionMode:A.connectionMode,connectionRadius:A.connectionRadius,domNode:A.domNode,nodeLookup:A.nodeLookup,lib:A.lib,isTarget:p,handleId:m,nodeId:b,flowId:A.rfId,panBy:A.panBy,cancelConnection:A.cancelConnection,onConnectStart:A.onConnectStart,onConnectEnd:A.onConnectEnd,updateConnection:A.updateConnection,onConnect:R,isValidConnection:n||A.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:A.autoPanSpeed,dragThreshold:A.connectionDragThreshold})}z?d==null||d(j):u==null||u(j)},P=j=>{const{onClickConnectStart:z,onClickConnectEnd:A,connectionClickStartHandle:T,connectionMode:O,isValidConnection:H,lib:V,rfId:W,nodeLookup:Z,connection:G}=y.getState();if(!b||!T&&!r)return;if(!T){z==null||z(j.nativeEvent,{nodeId:b,handleId:m,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:b,type:e,id:m}});return}const Q=es(j.target),B=n||H,{connection:q,isValid:F}=Zn.isValid(j.nativeEvent,{handle:{nodeId:b,id:m,type:e},connectionMode:O,fromNodeId:T.nodeId,fromHandleId:T.id||null,fromType:T.type,isValidConnection:B,flowId:W,doc:Q,lib:V,nodeLookup:Z});F&&q&&R(q);const J=structuredClone(G);delete J.inProgress,J.toPosition=J.toHandle?J.toHandle.position:null,A==null||A(j,J),y.setState({connectionClickStartHandle:null})};return v.jsx("div",{"data-handleid":m,"data-nodeid":b,"data-handlepos":t,"data-id":`${w}-${b}-${m}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",h,f,{source:!p,target:p,connectable:o,connectablestart:r,connectableend:s,clickconnecting:N,connectingfrom:C,connectingto:E,valid:D,connectionindicator:o&&(!I||M)&&(I||L?s:r)}]),onMouseDown:k,onTouchStart:k,onClick:S?P:void 0,ref:g,...c,children:l})}const Oe=x.memo(Ns(_l));function Ll({data:e,isConnectable:t,sourcePosition:n=X.Bottom}){return v.jsxs(v.Fragment,{children:[e==null?void 0:e.label,v.jsx(Oe,{type:"source",position:n,isConnectable:t})]})}function $l({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:o=X.Bottom}){return v.jsxs(v.Fragment,{children:[v.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,v.jsx(Oe,{type:"source",position:o,isConnectable:t})]})}function Tl(){return null}function Ol({data:e,isConnectable:t,targetPosition:n=X.Top}){return v.jsxs(v.Fragment,{children:[v.jsx(Oe,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const on={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},hr={input:Ll,default:$l,output:Ol,group:Tl};function zl(e){var t,n,o,r;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((o=e.style)==null?void 0:o.width),height:e.height??((r=e.style)==null?void 0:r.height)}}const Hl=e=>{const{width:t,height:n,x:o,y:r}=$t(e.nodeLookup,{filter:s=>!!s.selected});return{width:Ne(t)?t:null,height:Ne(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function Bl({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=re(),{width:r,height:s,transformString:i,userSelectionActive:a}=ee(Hl,se),l=As(),f=x.useRef(null);if(x.useEffect(()=>{var c;n||(c=f.current)==null||c.focus({preventScroll:!0})},[n]),Is({nodeRef:f}),a||!r||!s)return null;const d=e?c=>{const g=o.getState().nodes.filter(m=>m.selected);e(c,g)}:void 0,u=c=>{Object.prototype.hasOwnProperty.call(on,c.key)&&(c.preventDefault(),l({direction:on[c.key],factor:c.shiftKey?4:1}))};return v.jsx("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:v.jsx("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:u,style:{width:r,height:s}})})}const pr=typeof window<"u"?window:void 0,Fl=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function ks({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:f,selectionOnDrag:d,selectionMode:u,onSelectionStart:c,onSelectionEnd:g,multiSelectionKeyCode:m,panActivationKeyCode:p,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:S,zoomOnPinch:h,panOnScroll:w,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:N,panOnDrag:M,defaultViewport:I,translateExtent:L,minZoom:D,maxZoom:R,preventScrolling:k,onSelectionContextMenu:P,noWheelClassName:_,noPanClassName:$,disableKeyboardA11y:j,onViewportChange:z,isControlledViewport:A}){const{nodesSelectionActive:T,userSelectionActive:O}=ee(Fl),H=kt(f,{target:pr}),V=kt(p,{target:pr}),W=V||M,Z=V||w,G=d&&W!==!0,Q=H||O||G;return Sl({deleteKeyCode:l,multiSelectionKeyCode:m}),v.jsx(Ml,{onPaneContextMenu:s,elementsSelectable:b,zoomOnScroll:S,zoomOnPinch:h,panOnScroll:Z,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:N,panOnDrag:!H&&W,defaultViewport:I,translateExtent:L,minZoom:D,maxZoom:R,zoomActivationKeyCode:y,preventScrolling:k,noWheelClassName:_,noPanClassName:$,onViewportChange:z,isControlledViewport:A,paneClickDistance:a,children:v.jsxs(Al,{onSelectionStart:c,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:W,isSelecting:!!Q,selectionMode:u,selectionKeyPressed:H,selectionOnDrag:G,children:[e,T&&v.jsx(Bl,{onSelectionContextMenu:P,noPanClassName:$,disableKeyboardA11y:j})]})})}ks.displayName="FlowRenderer";const Vl=x.memo(ks),Yl=e=>t=>e?so(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Xl(e){return ee(x.useCallback(Yl(e),[e]),se)}const Wl=e=>e.updateNodeInternals;function Ul(){const e=ee(Wl),[t]=x.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const s=r.target.getAttribute("data-id");o.set(s,{id:s,nodeElement:r.target,force:!0})}),e(o)}));return x.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Gl({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const r=re(),s=x.useRef(null),i=x.useRef(null),a=x.useRef(e.sourcePosition),l=x.useRef(e.targetPosition),f=x.useRef(t),d=n&&!!e.internals.handleBounds;return x.useEffect(()=>{s.current&&!e.hidden&&(!d||i.current!==s.current)&&(i.current&&(o==null||o.unobserve(i.current)),o==null||o.observe(s.current),i.current=s.current)},[d,e.hidden]),x.useEffect(()=>()=>{i.current&&(o==null||o.unobserve(i.current),i.current=null)},[]),x.useEffect(()=>{if(s.current){const u=f.current!==t,c=a.current!==e.sourcePosition,g=l.current!==e.targetPosition;(u||c||g)&&(f.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function ql({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:l,nodesConnectable:f,nodesFocusable:d,resizeObserver:u,noDragClassName:c,noPanClassName:g,disableKeyboardA11y:m,rfId:p,nodeTypes:y,nodeClickDistance:b,onError:S}){const{node:h,internals:w,isParent:C}=ee(B=>{const q=B.nodeLookup.get(e),F=B.parentLookup.has(e);return{node:q,internals:q.internals,isParent:F}},se);let E=h.type||"default",N=(y==null?void 0:y[E])||hr[E];N===void 0&&(S==null||S("003",Pe.error003(E)),E="default",N=(y==null?void 0:y.default)||hr.default);const M=!!(h.draggable||a&&typeof h.draggable>"u"),I=!!(h.selectable||l&&typeof h.selectable>"u"),L=!!(h.connectable||f&&typeof h.connectable>"u"),D=!!(h.focusable||d&&typeof h.focusable>"u"),R=re(),k=Qr(h),P=Gl({node:h,nodeType:E,hasDimensions:k,resizeObserver:u}),_=Is({nodeRef:P,disabled:h.hidden||!M,noDragClassName:c,handleSelector:h.dragHandle,nodeId:e,isSelectable:I,nodeClickDistance:b}),$=As();if(h.hidden)return null;const j=ze(h),z=zl(h),A=I||M||t||n||o||r,T=n?B=>n(B,{...w.userNode}):void 0,O=o?B=>o(B,{...w.userNode}):void 0,H=r?B=>r(B,{...w.userNode}):void 0,V=s?B=>s(B,{...w.userNode}):void 0,W=i?B=>i(B,{...w.userNode}):void 0,Z=B=>{const{selectNodesOnDrag:q,nodeDragThreshold:F}=R.getState();I&&(!q||!M||F>0)&&Qn({id:e,store:R,nodeRef:P}),t&&t(B,{...w.userNode})},G=B=>{if(!(ts(B.nativeEvent)||m)){if(Vr.includes(B.key)&&I){const q=B.key==="Escape";Qn({id:e,store:R,unselect:q,nodeRef:P})}else if(M&&h.selected&&Object.prototype.hasOwnProperty.call(on,B.key)){B.preventDefault();const{ariaLabelConfig:q}=R.getState();R.setState({ariaLiveMessage:q["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),$({direction:on[B.key],factor:B.shiftKey?4:1})}}},Q=()=>{var U;if(m||!((U=P.current)!=null&&U.matches(":focus-visible")))return;const{transform:B,width:q,height:F,autoPanOnNodeFocus:J,setCenter:Y}=R.getState();if(!J)return;so(new Map([[e,h]]),{x:0,y:0,width:q,height:F},B,!0).length>0||Y(h.position.x+j.width/2,h.position.y+j.height/2,{zoom:B[2]})};return v.jsx("div",{className:ie(["react-flow__node",`react-flow__node-${E}`,{[g]:M},h.className,{selected:h.selected,selectable:I,parent:C,draggable:M,dragging:_}]),ref:P,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:A?"all":"none",visibility:k?"visible":"hidden",...h.style,...z},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:T,onMouseMove:O,onMouseLeave:H,onContextMenu:V,onClick:Z,onDoubleClick:W,onKeyDown:D?G:void 0,tabIndex:D?0:void 0,onFocus:D?Q:void 0,role:h.ariaRole??(D?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${bs}-${p}`,"aria-label":h.ariaLabel,...h.domAttributes,children:v.jsx(kl,{value:e,children:v.jsx(N,{id:e,data:h.data,type:E,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:h.selected??!1,selectable:I,draggable:M,deletable:h.deletable??!0,isConnectable:L,sourcePosition:h.sourcePosition,targetPosition:h.targetPosition,dragging:_,dragHandle:h.dragHandle,zIndex:w.z,parentId:h.parentId,...j})})})}const Kl=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function js(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:s}=ee(Kl,se),i=Xl(e.onlyRenderVisibleElements),a=Ul();return v.jsx("div",{className:"react-flow__nodes",style:yn,children:i.map(l=>v.jsx(ql,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:s},l))})}js.displayName="NodeRenderer";const Zl=x.memo(js);function Ql(e){return ee(x.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const s=n.nodeLookup.get(r.source),i=n.nodeLookup.get(r.target);s&&i&&Ja({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),se)}const Jl=({color:e="none",strokeWidth:t=1})=>v.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),eu=({color:e="none",strokeWidth:t=1})=>v.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),mr={[Jt.Arrow]:Jl,[Jt.ArrowClosed]:eu};function tu(e){const t=re();return x.useMemo(()=>{var r,s;return Object.prototype.hasOwnProperty.call(mr,e)?mr[e]:((s=(r=t.getState()).onError)==null||s.call(r,"009",Pe.error009(e)),null)},[e])}const nu=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=tu(t);return l?v.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:v.jsx(l,{color:n,strokeWidth:i})}):null},Ps=({defaultColor:e,rfId:t})=>{const n=ee(s=>s.edges),o=ee(s=>s.defaultEdgeOptions),r=x.useMemo(()=>ic(n,{id:t,defaultColor:e,defaultMarkerStart:o==null?void 0:o.markerStart,defaultMarkerEnd:o==null?void 0:o.markerEnd}),[n,o,t,e]);return r.length?v.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:v.jsx("defs",{children:r.map(s=>v.jsx(nu,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Ps.displayName="MarkerDefinitions";var ou=x.memo(Ps);function _s({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:f,...d}){const[u,c]=x.useState({x:1,y:0,width:0,height:0}),g=ie(["react-flow__edge-textwrapper",f]),m=x.useRef(null);return x.useEffect(()=>{if(m.current){const p=m.current.getBBox();c({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),n?v.jsxs("g",{transform:`translate(${e-u.width/2} ${t-u.height/2})`,className:g,visibility:u.width?"visible":"hidden",...d,children:[r&&v.jsx("rect",{width:u.width+2*i[0],x:-i[0],y:-i[1],height:u.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),v.jsx("text",{className:"react-flow__edge-text",y:u.height/2,dy:"0.3em",ref:m,style:o,children:n}),l]}):null}_s.displayName="EdgeText";const ru=x.memo(_s);function xn({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:f=20,...d}){return v.jsxs(v.Fragment,{children:[v.jsx("path",{...d,d:e,fill:"none",className:ie(["react-flow__edge-path",d.className])}),f&&v.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),o&&Ne(t)&&Ne(n)?v.jsx(ru,{x:t,y:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function yr({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===X.Left||e===X.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function Ls({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:s=X.Top}){const[i,a]=yr({pos:n,x1:e,y1:t,x2:o,y2:r}),[l,f]=yr({pos:s,x1:o,y1:r,x2:e,y2:t}),[d,u,c,g]=os({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:f});return[`M${e},${t} C${i},${a} ${l},${f} ${o},${r}`,d,u,c,g]}function $s(e){return x.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i,targetPosition:a,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:g,style:m,markerEnd:p,markerStart:y,interactionWidth:b})=>{const[S,h,w]=Ls({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a}),C=e.isInternal?void 0:t;return v.jsx(xn,{id:C,path:S,labelX:h,labelY:w,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:g,style:m,markerEnd:p,markerStart:y,interactionWidth:b})})}const su=$s({isInternal:!1}),Ts=$s({isInternal:!0});su.displayName="SimpleBezierEdge";Ts.displayName="SimpleBezierEdgeInternal";function Os(e){return x.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:u,style:c,sourcePosition:g=X.Bottom,targetPosition:m=X.Top,markerEnd:p,markerStart:y,pathOptions:b,interactionWidth:S})=>{const[h,w,C]=Gn({sourceX:n,sourceY:o,sourcePosition:g,targetX:r,targetY:s,targetPosition:m,borderRadius:b==null?void 0:b.borderRadius,offset:b==null?void 0:b.offset,stepPosition:b==null?void 0:b.stepPosition}),E=e.isInternal?void 0:t;return v.jsx(xn,{id:E,path:h,labelX:w,labelY:C,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:u,style:c,markerEnd:p,markerStart:y,interactionWidth:S})})}const zs=Os({isInternal:!1}),Hs=Os({isInternal:!0});zs.displayName="SmoothStepEdge";Hs.displayName="SmoothStepEdgeInternal";function Bs(e){return x.memo(({id:t,...n})=>{var r;const o=e.isInternal?void 0:t;return v.jsx(zs,{...n,id:o,pathOptions:x.useMemo(()=>{var s;return{borderRadius:0,offset:(s=n.pathOptions)==null?void 0:s.offset}},[(r=n.pathOptions)==null?void 0:r.offset])})})}const iu=Bs({isInternal:!1}),Fs=Bs({isInternal:!0});iu.displayName="StepEdge";Fs.displayName="StepEdgeInternal";function Vs(e){return x.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:u,style:c,markerEnd:g,markerStart:m,interactionWidth:p})=>{const[y,b,S]=as({sourceX:n,sourceY:o,targetX:r,targetY:s}),h=e.isInternal?void 0:t;return v.jsx(xn,{id:h,path:y,labelX:b,labelY:S,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:f,labelBgPadding:d,labelBgBorderRadius:u,style:c,markerEnd:g,markerStart:m,interactionWidth:p})})}const au=Vs({isInternal:!1}),Ys=Vs({isInternal:!0});au.displayName="StraightEdge";Ys.displayName="StraightEdgeInternal";function Xs(e){return x.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i=X.Bottom,targetPosition:a=X.Top,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:g,style:m,markerEnd:p,markerStart:y,pathOptions:b,interactionWidth:S})=>{const[h,w,C]=rs({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a,curvature:b==null?void 0:b.curvature}),E=e.isInternal?void 0:t;return v.jsx(xn,{id:E,path:h,labelX:w,labelY:C,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:g,style:m,markerEnd:p,markerStart:y,interactionWidth:S})})}const cu=Xs({isInternal:!1}),Ws=Xs({isInternal:!0});cu.displayName="BezierEdge";Ws.displayName="BezierEdgeInternal";const xr={default:Ws,straight:Ys,step:Fs,smoothstep:Hs,simplebezier:Ts},vr={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},lu=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,uu=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,br="react-flow__edgeupdater";function wr({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:s,onMouseOut:i,type:a}){return v.jsx("circle",{onMouseDown:r,onMouseEnter:s,onMouseOut:i,className:ie([br,`${br}-${a}`]),cx:lu(t,o,e),cy:uu(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function du({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:s,targetY:i,sourcePosition:a,targetPosition:l,onReconnect:f,onReconnectStart:d,onReconnectEnd:u,setReconnecting:c,setUpdateHover:g}){const m=re(),p=(w,C)=>{if(w.button!==0)return;const{autoPanOnConnect:E,domNode:N,isValidConnection:M,connectionMode:I,connectionRadius:L,lib:D,onConnectStart:R,onConnectEnd:k,cancelConnection:P,nodeLookup:_,rfId:$,panBy:j,updateConnection:z}=m.getState(),A=C.type==="target",T=(V,W)=>{c(!1),u==null||u(V,n,C.type,W)},O=V=>f==null?void 0:f(n,V),H=(V,W)=>{c(!0),d==null||d(w,n,C.type),R==null||R(V,W)};Zn.onPointerDown(w.nativeEvent,{autoPanOnConnect:E,connectionMode:I,connectionRadius:L,domNode:N,handleId:C.id,nodeId:C.nodeId,nodeLookup:_,isTarget:A,edgeUpdaterType:C.type,lib:D,flowId:$,cancelConnection:P,panBy:j,isValidConnection:M,onConnect:O,onConnectStart:H,onConnectEnd:k,onReconnectEnd:T,updateConnection:z,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold})},y=w=>p(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),b=w=>p(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),S=()=>g(!0),h=()=>g(!1);return v.jsxs(v.Fragment,{children:[(e===!0||e==="source")&&v.jsx(wr,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:y,onMouseEnter:S,onMouseOut:h,type:"source"}),(e===!0||e==="target")&&v.jsx(wr,{position:l,centerX:s,centerY:i,radius:t,onMouseDown:b,onMouseEnter:S,onMouseOut:h,type:"target"})]})}function fu({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:f,reconnectRadius:d,onReconnect:u,onReconnectStart:c,onReconnectEnd:g,rfId:m,edgeTypes:p,noPanClassName:y,onError:b,disableKeyboardA11y:S}){let h=ee(Y=>Y.edgeLookup.get(e));const w=ee(Y=>Y.defaultEdgeOptions);h=w?{...w,...h}:h;let C=h.type||"default",E=(p==null?void 0:p[C])||xr[C];E===void 0&&(b==null||b("011",Pe.error011(C)),C="default",E=(p==null?void 0:p.default)||xr.default);const N=!!(h.focusable||t&&typeof h.focusable>"u"),M=typeof u<"u"&&(h.reconnectable||n&&typeof h.reconnectable>"u"),I=!!(h.selectable||o&&typeof h.selectable>"u"),L=x.useRef(null),[D,R]=x.useState(!1),[k,P]=x.useState(!1),_=re(),{zIndex:$,sourceX:j,sourceY:z,targetX:A,targetY:T,sourcePosition:O,targetPosition:H}=ee(x.useCallback(Y=>{const K=Y.nodeLookup.get(h.source),U=Y.nodeLookup.get(h.target);if(!K||!U)return{zIndex:h.zIndex,...vr};const te=sc({id:e,sourceNode:K,targetNode:U,sourceHandle:h.sourceHandle||null,targetHandle:h.targetHandle||null,connectionMode:Y.connectionMode,onError:b});return{zIndex:Qa({selected:h.selected,zIndex:h.zIndex,sourceNode:K,targetNode:U,elevateOnSelect:Y.elevateEdgesOnSelect}),...te||vr}},[h.source,h.target,h.sourceHandle,h.targetHandle,h.selected,h.zIndex]),se),V=x.useMemo(()=>h.markerStart?`url('#${qn(h.markerStart,m)}')`:void 0,[h.markerStart,m]),W=x.useMemo(()=>h.markerEnd?`url('#${qn(h.markerEnd,m)}')`:void 0,[h.markerEnd,m]);if(h.hidden||j===null||z===null||A===null||T===null)return null;const Z=Y=>{var oe;const{addSelectedEdges:K,unselectNodesAndEdges:U,multiSelectionActive:te}=_.getState();I&&(_.setState({nodesSelectionActive:!1}),h.selected&&te?(U({nodes:[],edges:[h]}),(oe=L.current)==null||oe.blur()):K([e])),r&&r(Y,h)},G=s?Y=>{s(Y,{...h})}:void 0,Q=i?Y=>{i(Y,{...h})}:void 0,B=a?Y=>{a(Y,{...h})}:void 0,q=l?Y=>{l(Y,{...h})}:void 0,F=f?Y=>{f(Y,{...h})}:void 0,J=Y=>{var K;if(!S&&Vr.includes(Y.key)&&I){const{unselectNodesAndEdges:U,addSelectedEdges:te}=_.getState();Y.key==="Escape"?((K=L.current)==null||K.blur(),U({edges:[h]})):te([e])}};return v.jsx("svg",{style:{zIndex:$},children:v.jsxs("g",{className:ie(["react-flow__edge",`react-flow__edge-${C}`,h.className,y,{selected:h.selected,animated:h.animated,inactive:!I&&!r,updating:D,selectable:I}]),onClick:Z,onDoubleClick:G,onContextMenu:Q,onMouseEnter:B,onMouseMove:q,onMouseLeave:F,onKeyDown:N?J:void 0,tabIndex:N?0:void 0,role:h.ariaRole??(N?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":h.ariaLabel===null?void 0:h.ariaLabel||`Edge from ${h.source} to ${h.target}`,"aria-describedby":N?`${ws}-${m}`:void 0,ref:L,...h.domAttributes,children:[!k&&v.jsx(E,{id:e,source:h.source,target:h.target,type:h.type,selected:h.selected,animated:h.animated,selectable:I,deletable:h.deletable??!0,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,sourceX:j,sourceY:z,targetX:A,targetY:T,sourcePosition:O,targetPosition:H,data:h.data,style:h.style,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerStart:V,markerEnd:W,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth}),M&&v.jsx(du,{edge:h,isReconnectable:M,reconnectRadius:d,onReconnect:u,onReconnectStart:c,onReconnectEnd:g,sourceX:j,sourceY:z,targetX:A,targetY:T,sourcePosition:O,targetPosition:H,setUpdateHover:R,setReconnecting:P})]})})}const gu=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Us({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:f,onEdgeClick:d,reconnectRadius:u,onEdgeDoubleClick:c,onReconnectStart:g,onReconnectEnd:m,disableKeyboardA11y:p}){const{edgesFocusable:y,edgesReconnectable:b,elementsSelectable:S,onError:h}=ee(gu,se),w=Ql(t);return v.jsxs("div",{className:"react-flow__edges",children:[v.jsx(ou,{defaultColor:e,rfId:n}),w.map(C=>v.jsx(fu,{id:C,edgesFocusable:y,edgesReconnectable:b,elementsSelectable:S,noPanClassName:r,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:f,onClick:d,reconnectRadius:u,onDoubleClick:c,onReconnectStart:g,onReconnectEnd:m,rfId:n,onError:h,edgeTypes:o,disableKeyboardA11y:p},C))]})}Us.displayName="EdgeRenderer";const hu=x.memo(Us),pu=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function mu({children:e}){const t=ee(pu);return v.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function yu(e){const t=go(),n=x.useRef(!1);x.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const xu=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function vu(e){const t=ee(xu),n=re();return x.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function bu(e){return e.connection.inProgress?{...e.connection,to:Tt(e.connection.to,e.transform)}:{...e.connection}}function wu(e){return bu}function Su(e){const t=wu();return ee(t,se)}const Cu=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Eu({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:r,width:s,height:i,isValid:a,inProgress:l}=ee(Cu,se);return!(s&&r&&l)?null:v.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:v.jsx("g",{className:ie(["react-flow__connection",Wr(a)]),children:v.jsx(Gs,{style:t,type:n,CustomComponent:o,isValid:a})})})}const Gs=({style:e,type:t=Ue.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:s,fromNode:i,fromHandle:a,fromPosition:l,to:f,toNode:d,toHandle:u,toPosition:c}=Su();if(!r)return;if(n)return v.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:f.x,toY:f.y,fromPosition:l,toPosition:c,connectionStatus:Wr(o),toNode:d,toHandle:u});let g="";const m={sourceX:s.x,sourceY:s.y,sourcePosition:l,targetX:f.x,targetY:f.y,targetPosition:c};switch(t){case Ue.Bezier:[g]=rs(m);break;case Ue.SimpleBezier:[g]=Ls(m);break;case Ue.Step:[g]=Gn({...m,borderRadius:0});break;case Ue.SmoothStep:[g]=Gn(m);break;default:[g]=as(m)}return v.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};Gs.displayName="ConnectionLine";const Mu={};function Sr(e=Mu){x.useRef(e),re(),x.useEffect(()=>{},[e])}function Nu(){re(),x.useRef(!1),x.useEffect(()=>{},[])}function qs({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:f,onNodeContextMenu:d,onSelectionContextMenu:u,onSelectionStart:c,onSelectionEnd:g,connectionLineType:m,connectionLineStyle:p,connectionLineComponent:y,connectionLineContainerStyle:b,selectionKeyCode:S,selectionOnDrag:h,selectionMode:w,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:N,deleteKeyCode:M,onlyRenderVisibleElements:I,elementsSelectable:L,defaultViewport:D,translateExtent:R,minZoom:k,maxZoom:P,preventScrolling:_,defaultMarkerColor:$,zoomOnScroll:j,zoomOnPinch:z,panOnScroll:A,panOnScrollSpeed:T,panOnScrollMode:O,zoomOnDoubleClick:H,panOnDrag:V,onPaneClick:W,onPaneMouseEnter:Z,onPaneMouseMove:G,onPaneMouseLeave:Q,onPaneScroll:B,onPaneContextMenu:q,paneClickDistance:F,nodeClickDistance:J,onEdgeContextMenu:Y,onEdgeMouseEnter:K,onEdgeMouseMove:U,onEdgeMouseLeave:te,reconnectRadius:oe,onReconnect:ve,onReconnectStart:Le,onReconnectEnd:He,noDragClassName:ye,noWheelClassName:$e,noPanClassName:Ie,disableKeyboardA11y:Be,nodeExtent:ot,rfId:rt,viewport:Fe,onViewportChange:be}){return Sr(e),Sr(t),Nu(),yu(n),vu(Fe),v.jsx(Vl,{onPaneClick:W,onPaneMouseEnter:Z,onPaneMouseMove:G,onPaneMouseLeave:Q,onPaneContextMenu:q,onPaneScroll:B,paneClickDistance:F,deleteKeyCode:M,selectionKeyCode:S,selectionOnDrag:h,selectionMode:w,onSelectionStart:c,onSelectionEnd:g,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:N,elementsSelectable:L,zoomOnScroll:j,zoomOnPinch:z,zoomOnDoubleClick:H,panOnScroll:A,panOnScrollSpeed:T,panOnScrollMode:O,panOnDrag:V,defaultViewport:D,translateExtent:R,minZoom:k,maxZoom:P,onSelectionContextMenu:u,preventScrolling:_,noDragClassName:ye,noWheelClassName:$e,noPanClassName:Ie,disableKeyboardA11y:Be,onViewportChange:be,isControlledViewport:!!Fe,children:v.jsxs(mu,{children:[v.jsx(hu,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:i,onReconnect:ve,onReconnectStart:Le,onReconnectEnd:He,onlyRenderVisibleElements:I,onEdgeContextMenu:Y,onEdgeMouseEnter:K,onEdgeMouseMove:U,onEdgeMouseLeave:te,reconnectRadius:oe,defaultMarkerColor:$,noPanClassName:Ie,disableKeyboardA11y:Be,rfId:rt}),v.jsx(Eu,{style:p,type:m,component:y,containerStyle:b}),v.jsx("div",{className:"react-flow__edgelabel-renderer"}),v.jsx(Zl,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:f,onNodeContextMenu:d,nodeClickDistance:J,onlyRenderVisibleElements:I,noPanClassName:Ie,noDragClassName:ye,disableKeyboardA11y:Be,nodeExtent:ot,rfId:rt}),v.jsx("div",{className:"react-flow__viewport-portal"})]})})}qs.displayName="GraphView";const Du=x.memo(qs),Cr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:l=.5,maxZoom:f=2,nodeOrigin:d,nodeExtent:u}={})=>{const c=new Map,g=new Map,m=new Map,p=new Map,y=o??t??[],b=n??e??[],S=d??[0,0],h=u??Dt;ls(m,p,y);const w=Kn(b,c,g,{nodeOrigin:S,nodeExtent:h,elevateNodesOnSelect:!1});let C=[0,0,1];if(i&&r&&s){const E=$t(c,{filter:L=>!!((L.width||L.initialWidth)&&(L.height||L.initialHeight))}),{x:N,y:M,zoom:I}=io(E,r,s,l,f,(a==null?void 0:a.padding)??.1);C=[N,M,I]}return{rfId:"1",width:0,height:0,transform:C,nodes:b,nodesInitialized:w,nodeLookup:c,parentLookup:g,edges:y,edgeLookup:p,connectionLookup:m,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:l,maxZoom:f,translateExtent:Dt,nodeExtent:h,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:ut.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:S,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Xr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Wa,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Yr}},Iu=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:f,nodeOrigin:d,nodeExtent:u})=>Gc((c,g)=>{async function m(){const{nodeLookup:p,panZoom:y,fitViewOptions:b,fitViewResolver:S,width:h,height:w,minZoom:C,maxZoom:E}=g();y&&(await Ya({nodes:p,width:h,height:w,panZoom:y,minZoom:C,maxZoom:E},b),S==null||S.resolve(!0),c({fitViewResolver:null}))}return{...Cr({nodes:e,edges:t,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:f,nodeOrigin:d,nodeExtent:u,defaultNodes:n,defaultEdges:o}),setNodes:p=>{const{nodeLookup:y,parentLookup:b,nodeOrigin:S,elevateNodesOnSelect:h,fitViewQueued:w}=g(),C=Kn(p,y,b,{nodeOrigin:S,nodeExtent:u,elevateNodesOnSelect:h,checkEquality:!0});w&&C?(m(),c({nodes:p,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):c({nodes:p,nodesInitialized:C})},setEdges:p=>{const{connectionLookup:y,edgeLookup:b}=g();ls(y,b,p),c({edges:p})},setDefaultNodesAndEdges:(p,y)=>{if(p){const{setNodes:b}=g();b(p),c({hasDefaultNodes:!0})}if(y){const{setEdges:b}=g();b(y),c({hasDefaultEdges:!0})}},updateNodeInternals:p=>{const{triggerNodeChanges:y,nodeLookup:b,parentLookup:S,domNode:h,nodeOrigin:w,nodeExtent:C,debug:E,fitViewQueued:N}=g(),{changes:M,updatedInternals:I}=dc(p,b,S,h,w,C);I&&(cc(b,S,{nodeOrigin:w,nodeExtent:C}),N?(m(),c({fitViewQueued:!1,fitViewOptions:void 0})):c({}),(M==null?void 0:M.length)>0&&(E&&console.log("React Flow: trigger node changes",M),y==null||y(M)))},updateNodePositions:(p,y=!1)=>{const b=[],S=[],{nodeLookup:h,triggerNodeChanges:w}=g();for(const[C,E]of p){const N=h.get(C),M=!!(N!=null&&N.expandParent&&(N!=null&&N.parentId)&&(E!=null&&E.position)),I={id:C,type:"position",position:M?{x:Math.max(0,E.position.x),y:Math.max(0,E.position.y)}:E.position,dragging:y};M&&N.parentId&&b.push({id:C,parentId:N.parentId,rect:{...E.internals.positionAbsolute,width:E.measured.width??0,height:E.measured.height??0}}),S.push(I)}if(b.length>0){const{parentLookup:C,nodeOrigin:E}=g(),N=fo(b,h,C,E);S.push(...N)}w(S)},triggerNodeChanges:p=>{const{onNodesChange:y,setNodes:b,nodes:S,hasDefaultNodes:h,debug:w}=g();if(p!=null&&p.length){if(h){const C=Es(p,S);b(C)}w&&console.log("React Flow: trigger node changes",p),y==null||y(p)}},triggerEdgeChanges:p=>{const{onEdgesChange:y,setEdges:b,edges:S,hasDefaultEdges:h,debug:w}=g();if(p!=null&&p.length){if(h){const C=Ms(p,S);b(C)}w&&console.log("React Flow: trigger edge changes",p),y==null||y(p)}},addSelectedNodes:p=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:S,triggerNodeChanges:h,triggerEdgeChanges:w}=g();if(y){const C=p.map(E=>Je(E,!0));h(C);return}h(ct(S,new Set([...p]),!0)),w(ct(b))},addSelectedEdges:p=>{const{multiSelectionActive:y,edgeLookup:b,nodeLookup:S,triggerNodeChanges:h,triggerEdgeChanges:w}=g();if(y){const C=p.map(E=>Je(E,!0));w(C);return}w(ct(b,new Set([...p]))),h(ct(S,new Set,!0))},unselectNodesAndEdges:({nodes:p,edges:y}={})=>{const{edges:b,nodes:S,nodeLookup:h,triggerNodeChanges:w,triggerEdgeChanges:C}=g(),E=p||S,N=y||b,M=E.map(L=>{const D=h.get(L.id);return D&&(D.selected=!1),Je(L.id,!1)}),I=N.map(L=>Je(L.id,!1));w(M),C(I)},setMinZoom:p=>{const{panZoom:y,maxZoom:b}=g();y==null||y.setScaleExtent([p,b]),c({minZoom:p})},setMaxZoom:p=>{const{panZoom:y,minZoom:b}=g();y==null||y.setScaleExtent([b,p]),c({maxZoom:p})},setTranslateExtent:p=>{var y;(y=g().panZoom)==null||y.setTranslateExtent(p),c({translateExtent:p})},setPaneClickDistance:p=>{var y;(y=g().panZoom)==null||y.setClickDistance(p)},resetSelectedElements:()=>{const{edges:p,nodes:y,triggerNodeChanges:b,triggerEdgeChanges:S,elementsSelectable:h}=g();if(!h)return;const w=y.reduce((E,N)=>N.selected?[...E,Je(N.id,!1)]:E,[]),C=p.reduce((E,N)=>N.selected?[...E,Je(N.id,!1)]:E,[]);b(w),S(C)},setNodeExtent:p=>{const{nodes:y,nodeLookup:b,parentLookup:S,nodeOrigin:h,elevateNodesOnSelect:w,nodeExtent:C}=g();p[0][0]===C[0][0]&&p[0][1]===C[0][1]&&p[1][0]===C[1][0]&&p[1][1]===C[1][1]||(Kn(y,b,S,{nodeOrigin:h,nodeExtent:p,elevateNodesOnSelect:w,checkEquality:!1}),c({nodeExtent:p}))},panBy:p=>{const{transform:y,width:b,height:S,panZoom:h,translateExtent:w}=g();return fc({delta:p,panZoom:h,transform:y,translateExtent:w,width:b,height:S})},setCenter:async(p,y,b)=>{const{width:S,height:h,maxZoom:w,panZoom:C}=g();if(!C)return Promise.resolve(!1);const E=typeof(b==null?void 0:b.zoom)<"u"?b.zoom:w;return await C.setViewport({x:S/2-p*E,y:h/2-y*E,zoom:E},{duration:b==null?void 0:b.duration,ease:b==null?void 0:b.ease,interpolate:b==null?void 0:b.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{c({connection:{...Xr}})},updateConnection:p=>{c({connection:p})},reset:()=>c({...Cr()})}},Object.is);function Au({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:l,fitView:f,nodeOrigin:d,nodeExtent:u,children:c}){const[g]=x.useState(()=>Iu({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:f,minZoom:i,maxZoom:a,fitViewOptions:l,nodeOrigin:d,nodeExtent:u}));return v.jsx(qc,{value:g,children:v.jsx(xl,{children:c})})}function Ru({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:s,height:i,fitView:a,fitViewOptions:l,minZoom:f,maxZoom:d,nodeOrigin:u,nodeExtent:c}){return x.useContext(pn)?v.jsx(v.Fragment,{children:e}):v.jsx(Au,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:l,initialMinZoom:f,initialMaxZoom:d,nodeOrigin:u,nodeExtent:c,children:e})}const ku={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function ju({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:l,onInit:f,onMove:d,onMoveStart:u,onMoveEnd:c,onConnect:g,onConnectStart:m,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:b,onNodeMouseEnter:S,onNodeMouseMove:h,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:E,onNodeDragStart:N,onNodeDrag:M,onNodeDragStop:I,onNodesDelete:L,onEdgesDelete:D,onDelete:R,onSelectionChange:k,onSelectionDragStart:P,onSelectionDrag:_,onSelectionDragStop:$,onSelectionContextMenu:j,onSelectionStart:z,onSelectionEnd:A,onBeforeDelete:T,connectionMode:O,connectionLineType:H=Ue.Bezier,connectionLineStyle:V,connectionLineComponent:W,connectionLineContainerStyle:Z,deleteKeyCode:G="Backspace",selectionKeyCode:Q="Shift",selectionOnDrag:B=!1,selectionMode:q=It.Full,panActivationKeyCode:F="Space",multiSelectionKeyCode:J=nn()?"Meta":"Control",zoomActivationKeyCode:Y=nn()?"Meta":"Control",snapToGrid:K,snapGrid:U,onlyRenderVisibleElements:te=!1,selectNodesOnDrag:oe,nodesDraggable:ve,autoPanOnNodeFocus:Le,nodesConnectable:He,nodesFocusable:ye,nodeOrigin:$e=Ss,edgesFocusable:Ie,edgesReconnectable:Be,elementsSelectable:ot=!0,defaultViewport:rt=cl,minZoom:Fe=.5,maxZoom:be=2,translateExtent:Te=Dt,preventScrolling:qe=!0,nodeExtent:st,defaultMarkerColor:Ae="#b1b1b7",zoomOnScroll:Bt=!0,zoomOnPinch:Sn=!0,panOnScroll:Cn=!1,panOnScrollSpeed:xt=.5,panOnScrollMode:Ft=et.Free,zoomOnDoubleClick:En=!0,panOnDrag:Vt=!0,onPaneClick:Mn,onPaneMouseEnter:Nn,onPaneMouseMove:Dn,onPaneMouseLeave:le,onPaneScroll:fe,onPaneContextMenu:ge,paneClickDistance:Ee=0,nodeClickDistance:pe=0,children:he,onReconnect:we,onReconnectStart:Ve,onReconnectEnd:ae,onEdgeContextMenu:Re,onEdgeDoubleClick:Se,onEdgeMouseEnter:Me,onEdgeMouseMove:Ke,onEdgeMouseLeave:Ze,reconnectRadius:ke=10,onNodesChange:Qe,onEdgesChange:vt,noDragClassName:vi="nodrag",noWheelClassName:bi="nowheel",noPanClassName:Eo="nopan",fitView:Mo,fitViewOptions:No,connectOnClick:wi,attributionPosition:Si,proOptions:Ci,defaultEdgeOptions:Ei,elevateNodesOnSelect:Mi,elevateEdgesOnSelect:Ni,disableKeyboardA11y:Do=!1,autoPanOnConnect:Di,autoPanOnNodeDrag:Ii,autoPanSpeed:Ai,connectionRadius:Ri,isValidConnection:ki,onError:ji,style:Pi,id:Io,nodeDragThreshold:_i,connectionDragThreshold:Li,viewport:$i,onViewportChange:Ti,width:Oi,height:zi,colorMode:Hi="light",debug:Bi,onScroll:Yt,ariaLabelConfig:Fi,...Vi},Yi){const In=Io||"1",Xi=fl(Hi),Wi=x.useCallback(Ao=>{Ao.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Yt==null||Yt(Ao)},[Yt]);return v.jsx("div",{"data-testid":"rf__wrapper",...Vi,onScroll:Wi,style:{...Pi,...ku},ref:Yi,className:ie(["react-flow",r,Xi]),id:Io,role:"application",children:v.jsxs(Ru,{nodes:e,edges:t,width:Oi,height:zi,fitView:Mo,fitViewOptions:No,minZoom:Fe,maxZoom:be,nodeOrigin:$e,nodeExtent:st,children:[v.jsx(Du,{onInit:f,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:S,onNodeMouseMove:h,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:E,nodeTypes:s,edgeTypes:i,connectionLineType:H,connectionLineStyle:V,connectionLineComponent:W,connectionLineContainerStyle:Z,selectionKeyCode:Q,selectionOnDrag:B,selectionMode:q,deleteKeyCode:G,multiSelectionKeyCode:J,panActivationKeyCode:F,zoomActivationKeyCode:Y,onlyRenderVisibleElements:te,defaultViewport:rt,translateExtent:Te,minZoom:Fe,maxZoom:be,preventScrolling:qe,zoomOnScroll:Bt,zoomOnPinch:Sn,zoomOnDoubleClick:En,panOnScroll:Cn,panOnScrollSpeed:xt,panOnScrollMode:Ft,panOnDrag:Vt,onPaneClick:Mn,onPaneMouseEnter:Nn,onPaneMouseMove:Dn,onPaneMouseLeave:le,onPaneScroll:fe,onPaneContextMenu:ge,paneClickDistance:Ee,nodeClickDistance:pe,onSelectionContextMenu:j,onSelectionStart:z,onSelectionEnd:A,onReconnect:we,onReconnectStart:Ve,onReconnectEnd:ae,onEdgeContextMenu:Re,onEdgeDoubleClick:Se,onEdgeMouseEnter:Me,onEdgeMouseMove:Ke,onEdgeMouseLeave:Ze,reconnectRadius:ke,defaultMarkerColor:Ae,noDragClassName:vi,noWheelClassName:bi,noPanClassName:Eo,rfId:In,disableKeyboardA11y:Do,nodeExtent:st,viewport:$i,onViewportChange:Ti}),v.jsx(dl,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:g,onConnectStart:m,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:b,nodesDraggable:ve,autoPanOnNodeFocus:Le,nodesConnectable:He,nodesFocusable:ye,edgesFocusable:Ie,edgesReconnectable:Be,elementsSelectable:ot,elevateNodesOnSelect:Mi,elevateEdgesOnSelect:Ni,minZoom:Fe,maxZoom:be,nodeExtent:st,onNodesChange:Qe,onEdgesChange:vt,snapToGrid:K,snapGrid:U,connectionMode:O,translateExtent:Te,connectOnClick:wi,defaultEdgeOptions:Ei,fitView:Mo,fitViewOptions:No,onNodesDelete:L,onEdgesDelete:D,onDelete:R,onNodeDragStart:N,onNodeDrag:M,onNodeDragStop:I,onSelectionDrag:_,onSelectionDragStart:P,onSelectionDragStop:$,onMove:d,onMoveStart:u,onMoveEnd:c,noPanClassName:Eo,nodeOrigin:$e,rfId:In,autoPanOnConnect:Di,autoPanOnNodeDrag:Ii,autoPanSpeed:Ai,onError:ji,connectionRadius:Ri,isValidConnection:ki,selectNodesOnDrag:oe,nodeDragThreshold:_i,connectionDragThreshold:Li,onBeforeDelete:T,paneClickDistance:Ee,debug:Bi,ariaLabelConfig:Fi}),v.jsx(al,{onSelectionChange:k}),he,v.jsx(nl,{proOptions:Ci,position:Si}),v.jsx(tl,{rfId:In,disableKeyboardA11y:Do})]})})}var Pu=Ns(ju);function _u({dimensions:e,lineWidth:t,variant:n,className:o}){return v.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ie(["react-flow__background-pattern",n,o])})}function Lu({radius:e,className:t}){return v.jsx("circle",{cx:e,cy:e,r:e,className:ie(["react-flow__background-pattern","dots",t])})}var Ge;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ge||(Ge={}));const $u={[Ge.Dots]:1,[Ge.Lines]:1,[Ge.Cross]:6},Tu=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Ks({id:e,variant:t=Ge.Dots,gap:n=20,size:o,lineWidth:r=1,offset:s=0,color:i,bgColor:a,style:l,className:f,patternClassName:d}){const u=x.useRef(null),{transform:c,patternId:g}=ee(Tu,se),m=o||$u[t],p=t===Ge.Dots,y=t===Ge.Cross,b=Array.isArray(n)?n:[n,n],S=[b[0]*c[2]||1,b[1]*c[2]||1],h=m*c[2],w=Array.isArray(s)?s:[s,s],C=y?[h,h]:S,E=[w[0]*c[2]||1+C[0]/2,w[1]*c[2]||1+C[1]/2],N=`${g}${e||""}`;return v.jsxs("svg",{className:ie(["react-flow__background",f]),style:{...l,...yn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:u,"data-testid":"rf__background",children:[v.jsx("pattern",{id:N,x:c[0]%S[0],y:c[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:p?v.jsx(Lu,{radius:h/2,className:d}):v.jsx(_u,{dimensions:C,lineWidth:r,variant:t,className:d})}),v.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}Ks.displayName="Background";const Ou=x.memo(Ks);function zu(){return v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:v.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Hu(){return v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:v.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Bu(){return v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:v.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Fu(){return v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:v.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Vu(){return v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:v.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Gt({children:e,className:t,...n}){return v.jsx("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n,children:e})}const Yu=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Zs({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:f,children:d,position:u="bottom-left",orientation:c="vertical","aria-label":g}){const m=re(),{isInteractive:p,minZoomReached:y,maxZoomReached:b,ariaLabelConfig:S}=ee(Yu,se),{zoomIn:h,zoomOut:w,fitView:C}=go(),E=()=>{h(),s==null||s()},N=()=>{w(),i==null||i()},M=()=>{C(r),a==null||a()},I=()=>{m.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),l==null||l(!p)},L=c==="horizontal"?"horizontal":"vertical";return v.jsxs(mn,{className:ie(["react-flow__controls",L,f]),position:u,style:e,"data-testid":"rf__controls","aria-label":g??S["controls.ariaLabel"],children:[t&&v.jsxs(v.Fragment,{children:[v.jsx(Gt,{onClick:E,className:"react-flow__controls-zoomin",title:S["controls.zoomIn.ariaLabel"],"aria-label":S["controls.zoomIn.ariaLabel"],disabled:b,children:v.jsx(zu,{})}),v.jsx(Gt,{onClick:N,className:"react-flow__controls-zoomout",title:S["controls.zoomOut.ariaLabel"],"aria-label":S["controls.zoomOut.ariaLabel"],disabled:y,children:v.jsx(Hu,{})})]}),n&&v.jsx(Gt,{className:"react-flow__controls-fitview",onClick:M,title:S["controls.fitView.ariaLabel"],"aria-label":S["controls.fitView.ariaLabel"],children:v.jsx(Bu,{})}),o&&v.jsx(Gt,{className:"react-flow__controls-interactive",onClick:I,title:S["controls.interactive.ariaLabel"],"aria-label":S["controls.interactive.ariaLabel"],children:p?v.jsx(Vu,{}):v.jsx(Fu,{})}),d]})}Zs.displayName="Controls";const Xu=x.memo(Zs);function Wu({id:e,x:t,y:n,width:o,height:r,style:s,color:i,strokeColor:a,strokeWidth:l,className:f,borderRadius:d,shapeRendering:u,selected:c,onClick:g}){const{background:m,backgroundColor:p}=s||{},y=i||m||p;return v.jsx("rect",{className:ie(["react-flow__minimap-node",{selected:c},f]),x:t,y:n,rx:d,ry:d,width:o,height:r,style:{fill:y,stroke:a,strokeWidth:l},shapeRendering:u,onClick:g?b=>g(b,e):void 0})}const Uu=x.memo(Wu),Gu=e=>e.nodes.map(t=>t.id),On=e=>e instanceof Function?e:()=>e;function qu({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:s=Uu,onClick:i}){const a=ee(Gu,se),l=On(t),f=On(e),d=On(n),u=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return v.jsx(v.Fragment,{children:a.map(c=>v.jsx(Zu,{id:c,nodeColorFunc:l,nodeStrokeColorFunc:f,nodeClassNameFunc:d,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:s,onClick:i,shapeRendering:u},c))})}function Ku({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:l}){const{node:f,x:d,y:u,width:c,height:g}=ee(m=>{const{internals:p}=m.nodeLookup.get(e),y=p.userNode,{x:b,y:S}=p.positionAbsolute,{width:h,height:w}=ze(y);return{node:y,x:b,y:S,width:h,height:w}},se);return!f||f.hidden||!Qr(f)?null:v.jsx(a,{x:d,y:u,width:c,height:g,style:f.style,selected:!!f.selected,className:o(f),color:t(f),borderRadius:r,strokeColor:n(f),strokeWidth:s,shapeRendering:i,onClick:l,id:f.id})}const Zu=x.memo(Ku);var Qu=x.memo(qu);const Ju=200,ed=150,td=e=>!e.hidden,nd=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Zr($t(e.nodeLookup,{filter:td}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},od="react-flow__minimap-desc";function Qs({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:l,maskColor:f,maskStrokeColor:d,maskStrokeWidth:u,position:c="bottom-right",onClick:g,onNodeClick:m,pannable:p=!1,zoomable:y=!1,ariaLabel:b,inversePan:S,zoomStep:h=10,offsetScale:w=5}){const C=re(),E=x.useRef(null),{boundingRect:N,viewBB:M,rfId:I,panZoom:L,translateExtent:D,flowWidth:R,flowHeight:k,ariaLabelConfig:P}=ee(nd,se),_=(e==null?void 0:e.width)??Ju,$=(e==null?void 0:e.height)??ed,j=N.width/_,z=N.height/$,A=Math.max(j,z),T=A*_,O=A*$,H=w*A,V=N.x-(T-N.width)/2-H,W=N.y-(O-N.height)/2-H,Z=T+H*2,G=O+H*2,Q=`${od}-${I}`,B=x.useRef(0),q=x.useRef();B.current=A,x.useEffect(()=>{if(E.current&&L)return q.current=bc({domNode:E.current,panZoom:L,getTransform:()=>C.getState().transform,getViewScale:()=>B.current}),()=>{var K;(K=q.current)==null||K.destroy()}},[L]),x.useEffect(()=>{var K;(K=q.current)==null||K.update({translateExtent:D,width:R,height:k,inversePan:S,pannable:p,zoomStep:h,zoomable:y})},[p,y,S,h,D,R,k]);const F=g?K=>{var oe;const[U,te]=((oe=q.current)==null?void 0:oe.pointer(K))||[0,0];g(K,{x:U,y:te})}:void 0,J=m?x.useCallback((K,U)=>{const te=C.getState().nodeLookup.get(U).internals.userNode;m(K,te)},[]):void 0,Y=b??P["minimap.ariaLabel"];return v.jsx(mn,{position:c,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof u=="number"?u*A:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:ie(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:v.jsxs("svg",{width:_,height:$,viewBox:`${V} ${W} ${Z} ${G}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Q,ref:E,onClick:F,children:[Y&&v.jsx("title",{id:Q,children:Y}),v.jsx(Qu,{onClick:J,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:r,nodeStrokeWidth:i,nodeComponent:a}),v.jsx("path",{className:"react-flow__minimap-mask",d:`M${V-H},${W-H}h${Z+H*2}v${G+H*2}h${-Z-H*2}z
        M${M.x},${M.y}h${M.width}v${M.height}h${-M.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Qs.displayName="MiniMap";const rd=x.memo(Qs),sd=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,id={[ht.Line]:"right",[ht.Handle]:"bottom-right"};function ad({nodeId:e,position:t,variant:n=ht.Handle,className:o,style:r=void 0,children:s,color:i,minWidth:a=10,minHeight:l=10,maxWidth:f=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:u=!1,resizeDirection:c,autoScale:g=!0,shouldResize:m,onResizeStart:p,onResize:y,onResizeEnd:b}){const S=Rs(),h=typeof e=="string"?e:S,w=re(),C=x.useRef(null),E=n===ht.Handle,N=ee(x.useCallback(sd(E&&g),[E,g]),se),M=x.useRef(null),I=t??id[n];x.useEffect(()=>{if(!(!C.current||!h))return M.current||(M.current=$c({domNode:C.current,nodeId:h,getStoreItems:()=>{const{nodeLookup:D,transform:R,snapGrid:k,snapToGrid:P,nodeOrigin:_,domNode:$}=w.getState();return{nodeLookup:D,transform:R,snapGrid:k,snapToGrid:P,nodeOrigin:_,paneDomNode:$}},onChange:(D,R)=>{const{triggerNodeChanges:k,nodeLookup:P,parentLookup:_,nodeOrigin:$}=w.getState(),j=[],z={x:D.x,y:D.y},A=P.get(h);if(A&&A.expandParent&&A.parentId){const T=A.origin??$,O=D.width??A.measured.width??0,H=D.height??A.measured.height??0,V={id:A.id,parentId:A.parentId,rect:{width:O,height:H,...Jr({x:D.x??A.position.x,y:D.y??A.position.y},{width:O,height:H},A.parentId,P,T)}},W=fo([V],P,_,$);j.push(...W),z.x=D.x?Math.max(T[0]*O,D.x):void 0,z.y=D.y?Math.max(T[1]*H,D.y):void 0}if(z.x!==void 0&&z.y!==void 0){const T={id:h,type:"position",position:{...z}};j.push(T)}if(D.width!==void 0&&D.height!==void 0){const O={id:h,type:"dimensions",resizing:!0,setAttributes:c?c==="horizontal"?"width":"height":!0,dimensions:{width:D.width,height:D.height}};j.push(O)}for(const T of R){const O={...T,type:"position"};j.push(O)}k(j)},onEnd:({width:D,height:R})=>{const k={id:h,type:"dimensions",resizing:!1,dimensions:{width:D,height:R}};w.getState().triggerNodeChanges([k])}})),M.current.update({controlPosition:I,boundaries:{minWidth:a,minHeight:l,maxWidth:f,maxHeight:d},keepAspectRatio:u,resizeDirection:c,onResizeStart:p,onResize:y,onResizeEnd:b,shouldResize:m}),()=>{var D;(D=M.current)==null||D.destroy()}},[I,a,l,f,d,u,p,y,b,m]);const L=I.split("-");return v.jsx("div",{className:ie(["react-flow__resize-control","nodrag",...L,n,o]),ref:C,style:{...r,scale:N,...i&&{[E?"backgroundColor":"borderColor"]:i}},children:s})}x.memo(ad);const zn={width:10,height:10,bottom:-5};x.memo(({data:e,isConnectable:t})=>v.jsx(v.Fragment,{children:v.jsxs("div",{style:{padding:25},children:[v.jsx("div",{children:"Node"}),v.jsx(Oe,{type:"source",id:"red",position:X.Bottom,style:{...zn,left:"15%",background:"red"},onConnect:n=>console.log("handle onConnect",n),isConnectable:t}),v.jsx(Oe,{type:"source",position:X.Bottom,id:"blue",style:{...zn,left:"50%",background:"blue"},isConnectable:t}),v.jsx(Oe,{type:"target",position:X.Bottom,id:"orange",style:{...zn,left:"85%",background:"orange"},isConnectable:t})]})}));const cd={custom:ud};function ld({initialNodes:e,initialEdges:t,component:n}){const{messageApi:o}=tt(),[r,s]=x.useState(e),[i,a]=x.useState(t);x.useEffect(()=>{s(e)},[e]);const l=x.useCallback(c=>s(g=>Es(c,g)),[]),f=x.useCallback(c=>a(g=>Ms(c,g)),[]),d=x.useCallback(c=>a(g=>is(c,g)),[]),u=async()=>{const c=r.map(p=>({component_id:p.id,position:p.position})),g={position:JSON.stringify(c),edges:JSON.stringify(i),component_id:n.component_id},m=await ua(g);console.log(m),o.success("")};return v.jsx(Wn,{title:"",extra:v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:u,children:""}),bodyStyle:{padding:0},children:v.jsx("div",{style:{height:"40vh"},children:v.jsxs(Pu,{nodes:r,edges:i,nodeTypes:cd,onNodesChange:l,onEdgesChange:f,onConnect:d,fitView:!0,children:[v.jsx(Xu,{}),v.jsx(rd,{}),v.jsx(Ou,{gap:12,size:1})]})})})}function ud({data:e}){const t=e.inputs||[],n=e.outputs||[];return v.jsxs("div",{style:{background:e.color||"#1976d2",color:"white",padding:10,borderRadius:12,minWidth:150,position:"relative"},children:[v.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:e.label}),t.map((o,r)=>v.jsx(Ro,{content:v.jsx("div",{children:o.component_name}),children:v.jsx(Oe,{type:"target",position:X.Left,id:o.component_id,style:{top:30+r*20,background:"#555"}},o.component_id)})),n.map((o,r)=>v.jsx(Ro,{content:v.jsx("div",{children:o.component_name}),children:v.jsx(Oe,{type:"source",position:X.Right,id:o.component_id,style:{top:30+r*20,background:"#888"}},o.component_id)}))]})}function dd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return x.useMemo(()=>o=>{t.forEach(r=>r(o))},t)}const vn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function pt(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function po(e){return"nodeType"in e}function me(e){var t,n;return e?pt(e)?e:po(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function mo(e){const{Document:t}=me(e);return e instanceof t}function Ot(e){return pt(e)?!1:e instanceof me(e).HTMLElement}function Js(e){return e instanceof me(e).SVGElement}function mt(e){return e?pt(e)?e.document:po(e)?mo(e)?e:Ot(e)||Js(e)?e.ownerDocument:document:document:document}const _e=vn?x.useLayoutEffect:x.useEffect;function yo(e){const t=x.useRef(e);return _e(()=>{t.current=e}),x.useCallback(function(){for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t.current==null?void 0:t.current(...o)},[])}function fd(){const e=x.useRef(null),t=x.useCallback((o,r)=>{e.current=setInterval(o,r)},[]),n=x.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function jt(e,t){t===void 0&&(t=[e]);const n=x.useRef(e);return _e(()=>{n.current!==e&&(n.current=e)},t),n}function zt(e,t){const n=x.useRef();return x.useMemo(()=>{const o=e(n.current);return n.current=o,o},[...t])}function rn(e){const t=yo(e),n=x.useRef(null),o=x.useCallback(r=>{r!==n.current&&(t==null||t(r,n.current)),n.current=r},[]);return[n,o]}function Jn(e){const t=x.useRef();return x.useEffect(()=>{t.current=e},[e]),t.current}let Hn={};function Ht(e,t){return x.useMemo(()=>{if(t)return t;const n=Hn[e]==null?0:Hn[e]+1;return Hn[e]=n,e+"-"+n},[e,t])}function ei(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return o.reduce((s,i)=>{const a=Object.entries(i);for(const[l,f]of a){const d=s[l];d!=null&&(s[l]=d+e*f)}return s},{...t})}}const lt=ei(1),sn=ei(-1);function gd(e){return"clientX"in e&&"clientY"in e}function xo(e){if(!e)return!1;const{KeyboardEvent:t}=me(e.target);return t&&e instanceof t}function hd(e){if(!e)return!1;const{TouchEvent:t}=me(e.target);return t&&e instanceof t}function eo(e){if(hd(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return gd(e)?{x:e.clientX,y:e.clientY}:null}const Pt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Pt.Translate.toString(e),Pt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:o}=e;return t+" "+n+"ms "+o}}}),Er="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function pd(e){return e.matches(Er)?e:e.querySelector(Er)}const md={display:"none"};function yd(e){let{id:t,value:n}=e;return de.createElement("div",{id:t,style:md},n)}function xd(e){let{id:t,announcement:n,ariaLiveType:o="assertive"}=e;const r={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return de.createElement("div",{id:t,style:r,role:"status","aria-live":o,"aria-atomic":!0},n)}function vd(){const[e,t]=x.useState("");return{announce:x.useCallback(o=>{o!=null&&t(o)},[]),announcement:e}}const ti=x.createContext(null);function bd(e){const t=x.useContext(ti);x.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function wd(){const[e]=x.useState(()=>new Set),t=x.useCallback(o=>(e.add(o),()=>e.delete(o)),[e]);return[x.useCallback(o=>{let{type:r,event:s}=o;e.forEach(i=>{var a;return(a=i[r])==null?void 0:a.call(i,s)})},[e]),t]}const Sd={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Cd={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Ed(e){let{announcements:t=Cd,container:n,hiddenTextDescribedById:o,screenReaderInstructions:r=Sd}=e;const{announce:s,announcement:i}=vd(),a=Ht("DndLiveRegion"),[l,f]=x.useState(!1);if(x.useEffect(()=>{f(!0)},[]),bd(x.useMemo(()=>({onDragStart(u){let{active:c}=u;s(t.onDragStart({active:c}))},onDragMove(u){let{active:c,over:g}=u;t.onDragMove&&s(t.onDragMove({active:c,over:g}))},onDragOver(u){let{active:c,over:g}=u;s(t.onDragOver({active:c,over:g}))},onDragEnd(u){let{active:c,over:g}=u;s(t.onDragEnd({active:c,over:g}))},onDragCancel(u){let{active:c,over:g}=u;s(t.onDragCancel({active:c,over:g}))}}),[s,t])),!l)return null;const d=de.createElement(de.Fragment,null,de.createElement(yd,{id:o,value:r.draggable}),de.createElement(xd,{id:a,announcement:i}));return n?wt.createPortal(d,n):d}var ce;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ce||(ce={}));function an(){}function Md(e,t){return x.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Nd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return x.useMemo(()=>[...t].filter(o=>o!=null),[...t])}const De=Object.freeze({x:0,y:0});function Dd(e,t){let{data:{value:n}}=e,{data:{value:o}}=t;return o-n}function Id(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Ad(e,t){const n=Math.max(t.top,e.top),o=Math.max(t.left,e.left),r=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),i=r-o,a=s-n;if(o<r&&n<s){const l=t.width*t.height,f=e.width*e.height,d=i*a,u=d/(l+f-d);return Number(u.toFixed(4))}return 0}const Rd=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:o}=e;const r=[];for(const s of o){const{id:i}=s,a=n.get(i);if(a){const l=Ad(a,t);l>0&&r.push({id:i,data:{droppableContainer:s,value:l}})}}return r.sort(Dd)};function kd(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function ni(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:De}function jd(e){return function(n){for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>({...i,top:i.top+e*a.y,bottom:i.bottom+e*a.y,left:i.left+e*a.x,right:i.right+e*a.x}),{...n})}}const Pd=jd(1);function _d(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Ld(e,t,n){const o=_d(t);if(!o)return e;const{scaleX:r,scaleY:s,x:i,y:a}=o,l=e.left-i-(1-r)*parseFloat(n),f=e.top-a-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),d=r?e.width/r:e.width,u=s?e.height/s:e.height;return{width:d,height:u,top:f,right:l+d,bottom:f+u,left:l}}const $d={ignoreTransform:!1};function yt(e,t){t===void 0&&(t=$d);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:d}=me(e).getComputedStyle(e);f&&(n=Ld(n,f,d))}const{top:o,left:r,width:s,height:i,bottom:a,right:l}=n;return{top:o,left:r,width:s,height:i,bottom:a,right:l}}function Mr(e){return yt(e,{ignoreTransform:!0})}function Td(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Od(e,t){return t===void 0&&(t=me(e).getComputedStyle(e)),t.position==="fixed"}function zd(e,t){t===void 0&&(t=me(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(r=>{const s=t[r];return typeof s=="string"?n.test(s):!1})}function vo(e,t){const n=[];function o(r){if(t!=null&&n.length>=t||!r)return n;if(mo(r)&&r.scrollingElement!=null&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!Ot(r)||Js(r)||n.includes(r))return n;const s=me(e).getComputedStyle(r);return r!==e&&zd(r,s)&&n.push(r),Od(r,s)?n:o(r.parentNode)}return e?o(e):n}function oi(e){const[t]=vo(e,1);return t??null}function Bn(e){return!vn||!e?null:pt(e)?e:po(e)?mo(e)||e===mt(e).scrollingElement?window:Ot(e)?e:null:null}function ri(e){return pt(e)?e.scrollX:e.scrollLeft}function si(e){return pt(e)?e.scrollY:e.scrollTop}function to(e){return{x:ri(e),y:si(e)}}var ue;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ue||(ue={}));function ii(e){return!vn||!e?!1:e===document.scrollingElement}function ai(e){const t={x:0,y:0},n=ii(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},o={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},r=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,i=e.scrollTop>=o.y,a=e.scrollLeft>=o.x;return{isTop:r,isLeft:s,isBottom:i,isRight:a,maxScroll:o,minScroll:t}}const Hd={x:.2,y:.2};function Bd(e,t,n,o,r){let{top:s,left:i,right:a,bottom:l}=n;o===void 0&&(o=10),r===void 0&&(r=Hd);const{isTop:f,isBottom:d,isLeft:u,isRight:c}=ai(e),g={x:0,y:0},m={x:0,y:0},p={height:t.height*r.y,width:t.width*r.x};return!f&&s<=t.top+p.height?(g.y=ue.Backward,m.y=o*Math.abs((t.top+p.height-s)/p.height)):!d&&l>=t.bottom-p.height&&(g.y=ue.Forward,m.y=o*Math.abs((t.bottom-p.height-l)/p.height)),!c&&a>=t.right-p.width?(g.x=ue.Forward,m.x=o*Math.abs((t.right-p.width-a)/p.width)):!u&&i<=t.left+p.width&&(g.x=ue.Backward,m.x=o*Math.abs((t.left+p.width-i)/p.width)),{direction:g,speed:m}}function Fd(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:i}=window;return{top:0,left:0,right:s,bottom:i,width:s,height:i}}const{top:t,left:n,right:o,bottom:r}=e.getBoundingClientRect();return{top:t,left:n,right:o,bottom:r,width:e.clientWidth,height:e.clientHeight}}function ci(e){return e.reduce((t,n)=>lt(t,to(n)),De)}function Vd(e){return e.reduce((t,n)=>t+ri(n),0)}function Yd(e){return e.reduce((t,n)=>t+si(n),0)}function Xd(e,t){if(t===void 0&&(t=yt),!e)return;const{top:n,left:o,bottom:r,right:s}=t(e);oi(e)&&(r<=0||s<=0||n>=window.innerHeight||o>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Wd=[["x",["left","right"],Vd],["y",["top","bottom"],Yd]];class bo{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const o=vo(n),r=ci(o);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,i,a]of Wd)for(const l of i)Object.defineProperty(this,l,{get:()=>{const f=a(o),d=r[s]-f;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Et{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var o;return(o=this.target)==null?void 0:o.removeEventListener(...n)})},this.target=t}add(t,n,o){var r;(r=this.target)==null||r.addEventListener(t,n,o),this.listeners.push([t,n,o])}}function Ud(e){const{EventTarget:t}=me(e);return e instanceof t?e:mt(e)}function Fn(e,t){const n=Math.abs(e.x),o=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+o**2)>t:"x"in t&&"y"in t?n>t.x&&o>t.y:"x"in t?n>t.x:"y"in t?o>t.y:!1}var Ce;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ce||(Ce={}));function Nr(e){e.preventDefault()}function Gd(e){e.stopPropagation()}var ne;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(ne||(ne={}));const li={start:[ne.Space,ne.Enter],cancel:[ne.Esc],end:[ne.Space,ne.Enter,ne.Tab]},qd=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case ne.Right:return{...n,x:n.x+25};case ne.Left:return{...n,x:n.x-25};case ne.Down:return{...n,y:n.y+25};case ne.Up:return{...n,y:n.y-25}}};class ui{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Et(mt(n)),this.windowListeners=new Et(me(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ce.Resize,this.handleCancel),this.windowListeners.add(Ce.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ce.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,o=t.node.current;o&&Xd(o),n(De)}handleKeyDown(t){if(xo(t)){const{active:n,context:o,options:r}=this.props,{keyboardCodes:s=li,coordinateGetter:i=qd,scrollBehavior:a="smooth"}=r,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:f}=o.current,d=f?{x:f.left,y:f.top}:De;this.referenceCoordinates||(this.referenceCoordinates=d);const u=i(t,{active:n,context:o.current,currentCoordinates:d});if(u){const c=sn(u,d),g={x:0,y:0},{scrollableAncestors:m}=o.current;for(const p of m){const y=t.code,{isTop:b,isRight:S,isLeft:h,isBottom:w,maxScroll:C,minScroll:E}=ai(p),N=Fd(p),M={x:Math.min(y===ne.Right?N.right-N.width/2:N.right,Math.max(y===ne.Right?N.left:N.left+N.width/2,u.x)),y:Math.min(y===ne.Down?N.bottom-N.height/2:N.bottom,Math.max(y===ne.Down?N.top:N.top+N.height/2,u.y))},I=y===ne.Right&&!S||y===ne.Left&&!h,L=y===ne.Down&&!w||y===ne.Up&&!b;if(I&&M.x!==u.x){const D=p.scrollLeft+c.x,R=y===ne.Right&&D<=C.x||y===ne.Left&&D>=E.x;if(R&&!c.y){p.scrollTo({left:D,behavior:a});return}R?g.x=p.scrollLeft-D:g.x=y===ne.Right?p.scrollLeft-C.x:p.scrollLeft-E.x,g.x&&p.scrollBy({left:-g.x,behavior:a});break}else if(L&&M.y!==u.y){const D=p.scrollTop+c.y,R=y===ne.Down&&D<=C.y||y===ne.Up&&D>=E.y;if(R&&!c.x){p.scrollTo({top:D,behavior:a});return}R?g.y=p.scrollTop-D:g.y=y===ne.Down?p.scrollTop-C.y:p.scrollTop-E.y,g.y&&p.scrollBy({top:-g.y,behavior:a});break}}this.handleMove(t,lt(sn(u,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:o}=this.props;t.preventDefault(),o(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ui.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:o=li,onActivation:r}=t,{active:s}=n;const{code:i}=e.nativeEvent;if(o.start.includes(i)){const a=s.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),r==null||r({event:e.nativeEvent}),!0)}return!1}}];function Dr(e){return!!(e&&"distance"in e)}function Ir(e){return!!(e&&"delay"in e)}class wo{constructor(t,n,o){var r;o===void 0&&(o=Ud(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:i}=s;this.props=t,this.events=n,this.document=mt(i),this.documentListeners=new Et(this.document),this.listeners=new Et(o),this.windowListeners=new Et(me(i)),this.initialCoordinates=(r=eo(s))!=null?r:De,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:o}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ce.Resize,this.handleCancel),this.windowListeners.add(Ce.DragStart,Nr),this.windowListeners.add(Ce.VisibilityChange,this.handleCancel),this.windowListeners.add(Ce.ContextMenu,Nr),this.documentListeners.add(Ce.Keydown,this.handleKeydown),n){if(o!=null&&o({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Ir(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Dr(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:o,onPending:r}=this.props;r(o,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ce.Click,Gd,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ce.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:o,initialCoordinates:r,props:s}=this,{onMove:i,options:{activationConstraint:a}}=s;if(!r)return;const l=(n=eo(t))!=null?n:De,f=sn(r,l);if(!o&&a){if(Dr(a)){if(a.tolerance!=null&&Fn(f,a.tolerance))return this.handleCancel();if(Fn(f,a.distance))return this.handleStart()}if(Ir(a)&&Fn(f,a.tolerance))return this.handleCancel();this.handlePending(a,f);return}t.cancelable&&t.preventDefault(),i(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===ne.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Kd={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class So extends wo{constructor(t){const{event:n}=t,o=mt(n.target);super(t,Kd,o)}}So.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:o}=t;return!n.isPrimary||n.button!==0?!1:(o==null||o({event:n}),!0)}}];const Zd={move:{name:"mousemove"},end:{name:"mouseup"}};var no;(function(e){e[e.RightClick=2]="RightClick"})(no||(no={}));class Qd extends wo{constructor(t){super(t,Zd,mt(t.event.target))}}Qd.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:o}=t;return n.button===no.RightClick?!1:(o==null||o({event:n}),!0)}}];const Vn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Jd extends wo{constructor(t){super(t,Vn)}static setup(){return window.addEventListener(Vn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Vn.move.name,t)};function t(){}}}Jd.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:o}=t;const{touches:r}=n;return r.length>1?!1:(o==null||o({event:n}),!0)}}];var Mt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Mt||(Mt={}));var cn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(cn||(cn={}));function ef(e){let{acceleration:t,activator:n=Mt.Pointer,canScroll:o,draggingRect:r,enabled:s,interval:i=5,order:a=cn.TreeOrder,pointerCoordinates:l,scrollableAncestors:f,scrollableAncestorRects:d,delta:u,threshold:c}=e;const g=nf({delta:u,disabled:!s}),[m,p]=fd(),y=x.useRef({x:0,y:0}),b=x.useRef({x:0,y:0}),S=x.useMemo(()=>{switch(n){case Mt.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Mt.DraggableRect:return r}},[n,r,l]),h=x.useRef(null),w=x.useCallback(()=>{const E=h.current;if(!E)return;const N=y.current.x*b.current.x,M=y.current.y*b.current.y;E.scrollBy(N,M)},[]),C=x.useMemo(()=>a===cn.TreeOrder?[...f].reverse():f,[a,f]);x.useEffect(()=>{if(!s||!f.length||!S){p();return}for(const E of C){if((o==null?void 0:o(E))===!1)continue;const N=f.indexOf(E),M=d[N];if(!M)continue;const{direction:I,speed:L}=Bd(E,M,S,t,c);for(const D of["x","y"])g[D][I[D]]||(L[D]=0,I[D]=0);if(L.x>0||L.y>0){p(),h.current=E,m(w,i),y.current=L,b.current=I;return}}y.current={x:0,y:0},b.current={x:0,y:0},p()},[t,w,o,p,s,i,JSON.stringify(S),JSON.stringify(g),m,f,C,d,JSON.stringify(c)])}const tf={x:{[ue.Backward]:!1,[ue.Forward]:!1},y:{[ue.Backward]:!1,[ue.Forward]:!1}};function nf(e){let{delta:t,disabled:n}=e;const o=Jn(t);return zt(r=>{if(n||!o||!r)return tf;const s={x:Math.sign(t.x-o.x),y:Math.sign(t.y-o.y)};return{x:{[ue.Backward]:r.x[ue.Backward]||s.x===-1,[ue.Forward]:r.x[ue.Forward]||s.x===1},y:{[ue.Backward]:r.y[ue.Backward]||s.y===-1,[ue.Forward]:r.y[ue.Forward]||s.y===1}}},[n,t,o])}function of(e,t){const n=t!=null?e.get(t):void 0,o=n?n.node.current:null;return zt(r=>{var s;return t==null?null:(s=o??r)!=null?s:null},[o,t])}function rf(e,t){return x.useMemo(()=>e.reduce((n,o)=>{const{sensor:r}=o,s=r.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,o)}));return[...n,...s]},[]),[e,t])}var _t;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(_t||(_t={}));var oo;(function(e){e.Optimized="optimized"})(oo||(oo={}));const Ar=new Map;function sf(e,t){let{dragging:n,dependencies:o,config:r}=t;const[s,i]=x.useState(null),{frequency:a,measure:l,strategy:f}=r,d=x.useRef(e),u=y(),c=jt(u),g=x.useCallback(function(b){b===void 0&&(b=[]),!c.current&&i(S=>S===null?b:S.concat(b.filter(h=>!S.includes(h))))},[c]),m=x.useRef(null),p=zt(b=>{if(u&&!n)return Ar;if(!b||b===Ar||d.current!==e||s!=null){const S=new Map;for(let h of e){if(!h)continue;if(s&&s.length>0&&!s.includes(h.id)&&h.rect.current){S.set(h.id,h.rect.current);continue}const w=h.node.current,C=w?new bo(l(w),w):null;h.rect.current=C,C&&S.set(h.id,C)}return S}return b},[e,s,n,u,l]);return x.useEffect(()=>{d.current=e},[e]),x.useEffect(()=>{u||g()},[n,u]),x.useEffect(()=>{s&&s.length>0&&i(null)},[JSON.stringify(s)]),x.useEffect(()=>{u||typeof a!="number"||m.current!==null||(m.current=setTimeout(()=>{g(),m.current=null},a))},[a,u,g,...o]),{droppableRects:p,measureDroppableContainers:g,measuringScheduled:s!=null};function y(){switch(f){case _t.Always:return!1;case _t.BeforeDragging:return n;default:return!n}}}function di(e,t){return zt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function af(e,t){return di(e,t)}function cf(e){let{callback:t,disabled:n}=e;const o=yo(t),r=x.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(o)},[o,n]);return x.useEffect(()=>()=>r==null?void 0:r.disconnect(),[r]),r}function bn(e){let{callback:t,disabled:n}=e;const o=yo(t),r=x.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(o)},[n]);return x.useEffect(()=>()=>r==null?void 0:r.disconnect(),[r]),r}function lf(e){return new bo(yt(e),e)}function Rr(e,t,n){t===void 0&&(t=lf);const[o,r]=x.useState(null);function s(){r(l=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=l??n)!=null?f:null}const d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}const i=cf({callback(l){if(e)for(const f of l){const{type:d,target:u}=f;if(d==="childList"&&u instanceof HTMLElement&&u.contains(e)){s();break}}}}),a=bn({callback:s});return _e(()=>{s(),e?(a==null||a.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),i==null||i.disconnect())},[e]),o}function uf(e){const t=di(e);return ni(e,t)}const kr=[];function df(e){const t=x.useRef(e),n=zt(o=>e?o&&o!==kr&&e&&t.current&&e.parentNode===t.current.parentNode?o:vo(e):kr,[e]);return x.useEffect(()=>{t.current=e},[e]),n}function ff(e){const[t,n]=x.useState(null),o=x.useRef(e),r=x.useCallback(s=>{const i=Bn(s.target);i&&n(a=>a?(a.set(i,to(i)),new Map(a)):null)},[]);return x.useEffect(()=>{const s=o.current;if(e!==s){i(s);const a=e.map(l=>{const f=Bn(l);return f?(f.addEventListener("scroll",r,{passive:!0}),[f,to(f)]):null}).filter(l=>l!=null);n(a.length?new Map(a):null),o.current=e}return()=>{i(e),i(s)};function i(a){a.forEach(l=>{const f=Bn(l);f==null||f.removeEventListener("scroll",r)})}},[r,e]),x.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,i)=>lt(s,i),De):ci(e):De,[e,t])}function jr(e,t){t===void 0&&(t=[]);const n=x.useRef(null);return x.useEffect(()=>{n.current=null},t),x.useEffect(()=>{const o=e!==De;o&&!n.current&&(n.current=e),!o&&n.current&&(n.current=null)},[e]),n.current?sn(e,n.current):De}function gf(e){x.useEffect(()=>{if(!vn)return;const t=e.map(n=>{let{sensor:o}=n;return o.setup==null?void 0:o.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function hf(e,t){return x.useMemo(()=>e.reduce((n,o)=>{let{eventName:r,handler:s}=o;return n[r]=i=>{s(i,t)},n},{}),[e,t])}function fi(e){return x.useMemo(()=>e?Td(e):null,[e])}const Pr=[];function pf(e,t){t===void 0&&(t=yt);const[n]=e,o=fi(n?me(n):null),[r,s]=x.useState(Pr);function i(){s(()=>e.length?e.map(l=>ii(l)?o:new bo(t(l),l)):Pr)}const a=bn({callback:i});return _e(()=>{a==null||a.disconnect(),i(),e.forEach(l=>a==null?void 0:a.observe(l))},[e]),r}function mf(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ot(t)?t:e}function yf(e){let{measure:t}=e;const[n,o]=x.useState(null),r=x.useCallback(f=>{for(const{target:d}of f)if(Ot(d)){o(u=>{const c=t(d);return u?{...u,width:c.width,height:c.height}:c});break}},[t]),s=bn({callback:r}),i=x.useCallback(f=>{const d=mf(f);s==null||s.disconnect(),d&&(s==null||s.observe(d)),o(d?t(d):null)},[t,s]),[a,l]=rn(i);return x.useMemo(()=>({nodeRef:a,rect:n,setRef:l}),[n,a,l])}const xf=[{sensor:So,options:{}},{sensor:ui,options:{}}],vf={current:{}},Zt={draggable:{measure:Mr},droppable:{measure:Mr,strategy:_t.WhileDragging,frequency:oo.Optimized},dragOverlay:{measure:yt}};class Nt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,o;return(n=(o=this.get(t))==null?void 0:o.node.current)!=null?n:void 0}}const bf={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Nt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:an},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Zt,measureDroppableContainers:an,windowRect:null,measuringScheduled:!1},wf={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:an,draggableNodes:new Map,over:null,measureDroppableContainers:an},wn=x.createContext(wf),gi=x.createContext(bf);function Sf(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Nt}}}function Cf(e,t){switch(t.type){case ce.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ce.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ce.DragEnd:case ce.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ce.RegisterDroppable:{const{element:n}=t,{id:o}=n,r=new Nt(e.droppable.containers);return r.set(o,n),{...e,droppable:{...e.droppable,containers:r}}}case ce.SetDroppableDisabled:{const{id:n,key:o,disabled:r}=t,s=e.droppable.containers.get(n);if(!s||o!==s.key)return e;const i=new Nt(e.droppable.containers);return i.set(n,{...s,disabled:r}),{...e,droppable:{...e.droppable,containers:i}}}case ce.UnregisterDroppable:{const{id:n,key:o}=t,r=e.droppable.containers.get(n);if(!r||o!==r.key)return e;const s=new Nt(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function Ef(e){let{disabled:t}=e;const{active:n,activatorEvent:o,draggableNodes:r}=x.useContext(wn),s=Jn(o),i=Jn(n==null?void 0:n.id);return x.useEffect(()=>{if(!t&&!o&&s&&i!=null){if(!xo(s)||document.activeElement===s.target)return;const a=r.get(i);if(!a)return;const{activatorNode:l,node:f}=a;if(!l.current&&!f.current)return;requestAnimationFrame(()=>{for(const d of[l.current,f.current]){if(!d)continue;const u=pd(d);if(u){u.focus();break}}})}},[o,t,r,i,s]),null}function Mf(e,t){let{transform:n,...o}=t;return e!=null&&e.length?e.reduce((r,s)=>s({transform:r,...o}),n):n}function Nf(e){return x.useMemo(()=>({draggable:{...Zt.draggable,...e==null?void 0:e.draggable},droppable:{...Zt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Zt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Df(e){let{activeNode:t,measure:n,initialRect:o,config:r=!0}=e;const s=x.useRef(!1),{x:i,y:a}=typeof r=="boolean"?{x:r,y:r}:r;_e(()=>{if(!i&&!a||!t){s.current=!1;return}if(s.current||!o)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const d=n(f),u=ni(d,o);if(i||(u.x=0),a||(u.y=0),s.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){const c=oi(f);c&&c.scrollBy({top:u.y,left:u.x})}},[t,i,a,o,n])}const hi=x.createContext({...De,scaleX:1,scaleY:1});var We;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(We||(We={}));const If=x.memo(function(t){var n,o,r,s;let{id:i,accessibility:a,autoScroll:l=!0,children:f,sensors:d=xf,collisionDetection:u=Rd,measuring:c,modifiers:g,...m}=t;const p=x.useReducer(Cf,void 0,Sf),[y,b]=p,[S,h]=wd(),[w,C]=x.useState(We.Uninitialized),E=w===We.Initialized,{draggable:{active:N,nodes:M,translate:I},droppable:{containers:L}}=y,D=N!=null?M.get(N):null,R=x.useRef({initial:null,translated:null}),k=x.useMemo(()=>{var le;return N!=null?{id:N,data:(le=D==null?void 0:D.data)!=null?le:vf,rect:R}:null},[N,D]),P=x.useRef(null),[_,$]=x.useState(null),[j,z]=x.useState(null),A=jt(m,Object.values(m)),T=Ht("DndDescribedBy",i),O=x.useMemo(()=>L.getEnabled(),[L]),H=Nf(c),{droppableRects:V,measureDroppableContainers:W,measuringScheduled:Z}=sf(O,{dragging:E,dependencies:[I.x,I.y],config:H.droppable}),G=of(M,N),Q=x.useMemo(()=>j?eo(j):null,[j]),B=Dn(),q=af(G,H.draggable.measure);Df({activeNode:N!=null?M.get(N):null,config:B.layoutShiftCompensation,initialRect:q,measure:H.draggable.measure});const F=Rr(G,H.draggable.measure,q),J=Rr(G?G.parentElement:null),Y=x.useRef({activatorEvent:null,active:null,activeNode:G,collisionRect:null,collisions:null,droppableRects:V,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),K=L.getNodeFor((n=Y.current.over)==null?void 0:n.id),U=yf({measure:H.dragOverlay.measure}),te=(o=U.nodeRef.current)!=null?o:G,oe=E?(r=U.rect)!=null?r:F:null,ve=!!(U.nodeRef.current&&U.rect),Le=uf(ve?null:F),He=fi(te?me(te):null),ye=df(E?K??G:null),$e=pf(ye),Ie=Mf(g,{transform:{x:I.x-Le.x,y:I.y-Le.y,scaleX:1,scaleY:1},activatorEvent:j,active:k,activeNodeRect:F,containerNodeRect:J,draggingNodeRect:oe,over:Y.current.over,overlayNodeRect:U.rect,scrollableAncestors:ye,scrollableAncestorRects:$e,windowRect:He}),Be=Q?lt(Q,I):null,ot=ff(ye),rt=jr(ot),Fe=jr(ot,[F]),be=lt(Ie,rt),Te=oe?Pd(oe,Ie):null,qe=k&&Te?u({active:k,collisionRect:Te,droppableRects:V,droppableContainers:O,pointerCoordinates:Be}):null,st=Id(qe,"id"),[Ae,Bt]=x.useState(null),Sn=ve?Ie:lt(Ie,Fe),Cn=kd(Sn,(s=Ae==null?void 0:Ae.rect)!=null?s:null,F),xt=x.useRef(null),Ft=x.useCallback((le,fe)=>{let{sensor:ge,options:Ee}=fe;if(P.current==null)return;const pe=M.get(P.current);if(!pe)return;const he=le.nativeEvent,we=new ge({active:P.current,activeNode:pe,event:he,options:Ee,context:Y,onAbort(ae){if(!M.get(ae))return;const{onDragAbort:Se}=A.current,Me={id:ae};Se==null||Se(Me),S({type:"onDragAbort",event:Me})},onPending(ae,Re,Se,Me){if(!M.get(ae))return;const{onDragPending:Ze}=A.current,ke={id:ae,constraint:Re,initialCoordinates:Se,offset:Me};Ze==null||Ze(ke),S({type:"onDragPending",event:ke})},onStart(ae){const Re=P.current;if(Re==null)return;const Se=M.get(Re);if(!Se)return;const{onDragStart:Me}=A.current,Ke={activatorEvent:he,active:{id:Re,data:Se.data,rect:R}};wt.unstable_batchedUpdates(()=>{Me==null||Me(Ke),C(We.Initializing),b({type:ce.DragStart,initialCoordinates:ae,active:Re}),S({type:"onDragStart",event:Ke}),$(xt.current),z(he)})},onMove(ae){b({type:ce.DragMove,coordinates:ae})},onEnd:Ve(ce.DragEnd),onCancel:Ve(ce.DragCancel)});xt.current=we;function Ve(ae){return async function(){const{active:Se,collisions:Me,over:Ke,scrollAdjustedTranslate:Ze}=Y.current;let ke=null;if(Se&&Ze){const{cancelDrop:Qe}=A.current;ke={activatorEvent:he,active:Se,collisions:Me,delta:Ze,over:Ke},ae===ce.DragEnd&&typeof Qe=="function"&&await Promise.resolve(Qe(ke))&&(ae=ce.DragCancel)}P.current=null,wt.unstable_batchedUpdates(()=>{b({type:ae}),C(We.Uninitialized),Bt(null),$(null),z(null),xt.current=null;const Qe=ae===ce.DragEnd?"onDragEnd":"onDragCancel";if(ke){const vt=A.current[Qe];vt==null||vt(ke),S({type:Qe,event:ke})}})}}},[M]),En=x.useCallback((le,fe)=>(ge,Ee)=>{const pe=ge.nativeEvent,he=M.get(Ee);if(P.current!==null||!he||pe.dndKit||pe.defaultPrevented)return;const we={active:he};le(ge,fe.options,we)===!0&&(pe.dndKit={capturedBy:fe.sensor},P.current=Ee,Ft(ge,fe))},[M,Ft]),Vt=rf(d,En);gf(d),_e(()=>{F&&w===We.Initializing&&C(We.Initialized)},[F,w]),x.useEffect(()=>{const{onDragMove:le}=A.current,{active:fe,activatorEvent:ge,collisions:Ee,over:pe}=Y.current;if(!fe||!ge)return;const he={active:fe,activatorEvent:ge,collisions:Ee,delta:{x:be.x,y:be.y},over:pe};wt.unstable_batchedUpdates(()=>{le==null||le(he),S({type:"onDragMove",event:he})})},[be.x,be.y]),x.useEffect(()=>{const{active:le,activatorEvent:fe,collisions:ge,droppableContainers:Ee,scrollAdjustedTranslate:pe}=Y.current;if(!le||P.current==null||!fe||!pe)return;const{onDragOver:he}=A.current,we=Ee.get(st),Ve=we&&we.rect.current?{id:we.id,rect:we.rect.current,data:we.data,disabled:we.disabled}:null,ae={active:le,activatorEvent:fe,collisions:ge,delta:{x:pe.x,y:pe.y},over:Ve};wt.unstable_batchedUpdates(()=>{Bt(Ve),he==null||he(ae),S({type:"onDragOver",event:ae})})},[st]),_e(()=>{Y.current={activatorEvent:j,active:k,activeNode:G,collisionRect:Te,collisions:qe,droppableRects:V,draggableNodes:M,draggingNode:te,draggingNodeRect:oe,droppableContainers:L,over:Ae,scrollableAncestors:ye,scrollAdjustedTranslate:be},R.current={initial:oe,translated:Te}},[k,G,qe,Te,M,te,oe,V,L,Ae,ye,be]),ef({...B,delta:I,draggingRect:Te,pointerCoordinates:Be,scrollableAncestors:ye,scrollableAncestorRects:$e});const Mn=x.useMemo(()=>({active:k,activeNode:G,activeNodeRect:F,activatorEvent:j,collisions:qe,containerNodeRect:J,dragOverlay:U,draggableNodes:M,droppableContainers:L,droppableRects:V,over:Ae,measureDroppableContainers:W,scrollableAncestors:ye,scrollableAncestorRects:$e,measuringConfiguration:H,measuringScheduled:Z,windowRect:He}),[k,G,F,j,qe,J,U,M,L,V,Ae,W,ye,$e,H,Z,He]),Nn=x.useMemo(()=>({activatorEvent:j,activators:Vt,active:k,activeNodeRect:F,ariaDescribedById:{draggable:T},dispatch:b,draggableNodes:M,over:Ae,measureDroppableContainers:W}),[j,Vt,k,F,b,T,M,Ae,W]);return de.createElement(ti.Provider,{value:h},de.createElement(wn.Provider,{value:Nn},de.createElement(gi.Provider,{value:Mn},de.createElement(hi.Provider,{value:Cn},f)),de.createElement(Ef,{disabled:(a==null?void 0:a.restoreFocus)===!1})),de.createElement(Ed,{...a,hiddenTextDescribedById:T}));function Dn(){const le=(_==null?void 0:_.autoScrollEnabled)===!1,fe=typeof l=="object"?l.enabled===!1:l===!1,ge=E&&!le&&!fe;return typeof l=="object"?{...l,enabled:ge}:{enabled:ge}}}),Af=x.createContext(null),_r="button",Rf="Draggable";function kf(e){let{id:t,data:n,disabled:o=!1,attributes:r}=e;const s=Ht(Rf),{activators:i,activatorEvent:a,active:l,activeNodeRect:f,ariaDescribedById:d,draggableNodes:u,over:c}=x.useContext(wn),{role:g=_r,roleDescription:m="draggable",tabIndex:p=0}=r??{},y=(l==null?void 0:l.id)===t,b=x.useContext(y?hi:Af),[S,h]=rn(),[w,C]=rn(),E=hf(i,t),N=jt(n);_e(()=>(u.set(t,{id:t,key:s,node:S,activatorNode:w,data:N}),()=>{const I=u.get(t);I&&I.key===s&&u.delete(t)}),[u,t]);const M=x.useMemo(()=>({role:g,tabIndex:p,"aria-disabled":o,"aria-pressed":y&&g===_r?!0:void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[o,g,p,y,m,d.draggable]);return{active:l,activatorEvent:a,activeNodeRect:f,attributes:M,isDragging:y,listeners:o?void 0:E,node:S,over:c,setNodeRef:h,setActivatorNodeRef:C,transform:b}}function jf(){return x.useContext(gi)}const Pf="Droppable",_f={timeout:25};function Lf(e){let{data:t,disabled:n=!1,id:o,resizeObserverConfig:r}=e;const s=Ht(Pf),{active:i,dispatch:a,over:l,measureDroppableContainers:f}=x.useContext(wn),d=x.useRef({disabled:n}),u=x.useRef(!1),c=x.useRef(null),g=x.useRef(null),{disabled:m,updateMeasurementsFor:p,timeout:y}={..._f,...r},b=jt(p??o),S=x.useCallback(()=>{if(!u.current){u.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{f(Array.isArray(b.current)?b.current:[b.current]),g.current=null},y)},[y]),h=bn({callback:S,disabled:m||!i}),w=x.useCallback((M,I)=>{h&&(I&&(h.unobserve(I),u.current=!1),M&&h.observe(M))},[h]),[C,E]=rn(w),N=jt(t);return x.useEffect(()=>{!h||!C.current||(h.disconnect(),u.current=!1,h.observe(C.current))},[C,h]),x.useEffect(()=>(a({type:ce.RegisterDroppable,element:{id:o,key:s,disabled:n,node:C,rect:c,data:N}}),()=>a({type:ce.UnregisterDroppable,key:s,id:o})),[o]),x.useEffect(()=>{n!==d.current.disabled&&(a({type:ce.SetDroppableDisabled,id:o,key:s,disabled:n}),d.current.disabled=n)},[o,s,n,a]),{active:i,rect:c,isOver:(l==null?void 0:l.id)===o,node:C,over:l,setNodeRef:E}}const $f=e=>{let{transform:t}=e;return{...t,x:0}};function Co(e,t,n){const o=e.slice();return o.splice(n<0?o.length+n:n,0,o.splice(t,1)[0]),o}function Tf(e,t){return e.reduce((n,o,r)=>{const s=t.get(o);return s&&(n[r]=s),n},Array(e.length))}function qt(e){return e!==null&&e>=0}function Of(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function zf(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const pi=e=>{let{rects:t,activeIndex:n,overIndex:o,index:r}=e;const s=Co(t,o,n),i=t[r],a=s[r];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},Kt={scaleX:1,scaleY:1},Hf=e=>{var t;let{activeIndex:n,activeNodeRect:o,index:r,rects:s,overIndex:i}=e;const a=(t=s[n])!=null?t:o;if(!a)return null;if(r===n){const f=s[i];return f?{x:0,y:n<i?f.top+f.height-(a.top+a.height):f.top-a.top,...Kt}:null}const l=Bf(s,r,n);return r>n&&r<=i?{x:0,y:-a.height-l,...Kt}:r<n&&r>=i?{x:0,y:a.height+l,...Kt}:{x:0,y:0,...Kt}};function Bf(e,t,n){const o=e[t],r=e[t-1],s=e[t+1];return o?n<t?r?o.top-(r.top+r.height):s?s.top-(o.top+o.height):0:s?s.top-(o.top+o.height):r?o.top-(r.top+r.height):0:0}const mi="Sortable",yi=de.createContext({activeIndex:-1,containerId:mi,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:pi,disabled:{draggable:!1,droppable:!1}});function Ff(e){let{children:t,id:n,items:o,strategy:r=pi,disabled:s=!1}=e;const{active:i,dragOverlay:a,droppableRects:l,over:f,measureDroppableContainers:d}=jf(),u=Ht(mi,n),c=a.rect!==null,g=x.useMemo(()=>o.map(E=>typeof E=="object"&&"id"in E?E.id:E),[o]),m=i!=null,p=i?g.indexOf(i.id):-1,y=f?g.indexOf(f.id):-1,b=x.useRef(g),S=!Of(g,b.current),h=y!==-1&&p===-1||S,w=zf(s);_e(()=>{S&&m&&d(g)},[S,g,m,d]),x.useEffect(()=>{b.current=g},[g]);const C=x.useMemo(()=>({activeIndex:p,containerId:u,disabled:w,disableTransforms:h,items:g,overIndex:y,useDragOverlay:c,sortedRects:Tf(g,l),strategy:r}),[p,u,w.draggable,w.droppable,h,g,y,l,c,r]);return de.createElement(yi.Provider,{value:C},t)}const Vf=e=>{let{id:t,items:n,activeIndex:o,overIndex:r}=e;return Co(n,o,r).indexOf(t)},Yf=e=>{let{containerId:t,isSorting:n,wasDragging:o,index:r,items:s,newIndex:i,previousItems:a,previousContainerId:l,transition:f}=e;return!f||!o||a!==s&&r===i?!1:n?!0:i!==r&&t===l},Xf={duration:200,easing:"ease"},xi="transform",Wf=Pt.Transition.toString({property:xi,duration:0,easing:"linear"}),Uf={roleDescription:"sortable"};function Gf(e){let{disabled:t,index:n,node:o,rect:r}=e;const[s,i]=x.useState(null),a=x.useRef(n);return _e(()=>{if(!t&&n!==a.current&&o.current){const l=r.current;if(l){const f=yt(o.current,{ignoreTransform:!0}),d={x:l.left-f.left,y:l.top-f.top,scaleX:l.width/f.width,scaleY:l.height/f.height};(d.x||d.y)&&i(d)}}n!==a.current&&(a.current=n)},[t,n,o,r]),x.useEffect(()=>{s&&i(null)},[s]),s}function qf(e){let{animateLayoutChanges:t=Yf,attributes:n,disabled:o,data:r,getNewIndex:s=Vf,id:i,strategy:a,resizeObserverConfig:l,transition:f=Xf}=e;const{items:d,containerId:u,activeIndex:c,disabled:g,disableTransforms:m,sortedRects:p,overIndex:y,useDragOverlay:b,strategy:S}=x.useContext(yi),h=Kf(o,g),w=d.indexOf(i),C=x.useMemo(()=>({sortable:{containerId:u,index:w,items:d},...r}),[u,r,w,d]),E=x.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:N,node:M,isOver:I,setNodeRef:L}=Lf({id:i,data:C,disabled:h.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...l}}),{active:D,activatorEvent:R,activeNodeRect:k,attributes:P,setNodeRef:_,listeners:$,isDragging:j,over:z,setActivatorNodeRef:A,transform:T}=kf({id:i,data:C,attributes:{...Uf,...n},disabled:h.draggable}),O=dd(L,_),H=!!D,V=H&&!m&&qt(c)&&qt(y),W=!b&&j,Z=W&&V?T:null,Q=V?Z??(a??S)({rects:p,activeNodeRect:k,activeIndex:c,overIndex:y,index:w}):null,B=qt(c)&&qt(y)?s({id:i,items:d,activeIndex:c,overIndex:y}):w,q=D==null?void 0:D.id,F=x.useRef({activeId:q,items:d,newIndex:B,containerId:u}),J=d!==F.current.items,Y=t({active:D,containerId:u,isDragging:j,isSorting:H,id:i,index:w,items:d,newIndex:F.current.newIndex,previousItems:F.current.items,previousContainerId:F.current.containerId,transition:f,wasDragging:F.current.activeId!=null}),K=Gf({disabled:!Y,index:w,node:M,rect:N});return x.useEffect(()=>{H&&F.current.newIndex!==B&&(F.current.newIndex=B),u!==F.current.containerId&&(F.current.containerId=u),d!==F.current.items&&(F.current.items=d)},[H,B,u,d]),x.useEffect(()=>{if(q===F.current.activeId)return;if(q!=null&&F.current.activeId==null){F.current.activeId=q;return}const te=setTimeout(()=>{F.current.activeId=q},50);return()=>clearTimeout(te)},[q]),{active:D,activeIndex:c,attributes:P,data:C,rect:N,index:w,newIndex:B,items:d,isOver:I,isSorting:H,isDragging:j,listeners:$,node:M,overIndex:y,over:z,setNodeRef:O,setActivatorNodeRef:A,setDroppableNodeRef:L,setDraggableNodeRef:_,transform:K??Q,transition:U()};function U(){if(K||J&&F.current.newIndex===w)return Wf;if(!(W&&!xo(R)||!f)&&(H||Y))return Pt.Transition.toString({...f,property:xi})}}function Kf(e,t){var n,o;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(o=e==null?void 0:e.droppable)!=null?o:t.droppable}}ne.Down,ne.Right,ne.Up,ne.Left;const Zf=[{title:"component_name",dataIndex:"component_name",render:(e,t)=>v.jsx($r,{placement:"right",title:v.jsx(v.Fragment,{children:v.jsxs("ul",{children:[v.jsxs("li",{children:["component_id: ",t.component_id]}),v.jsxs("li",{children:["relation_id: ",t.relation_id]})]})}),children:t.component_name})}],Qf=e=>{const{attributes:t,listeners:n,setNodeRef:o,transform:r,transition:s,isDragging:i}=qf({id:e["data-row-key"]}),a={...e.style,transform:Pt.Translate.toString(r),transition:s,cursor:"move",...i?{position:"relative",zIndex:9999}:{}};return v.jsx("tr",{...e,ref:o,style:a,...t,...n})},Jf=({data:e,callback:t})=>{const[n,o]=x.useState(e),{messageApi:r}=tt(),s=Nd(Md(So,{activationConstraint:{distance:1}})),i=async()=>{const l=n.map((f,d)=>({order_index:d,relation_id:f.relation_id}));await da(l),r.success(""),t&&t()},a=({active:l,over:f})=>{l.id!==(f==null?void 0:f.id)&&o(d=>{const u=d.findIndex(g=>g.key===l.id),c=d.findIndex(g=>g.key===(f==null?void 0:f.id));return Co(d,u,c)})};return v.jsx(If,{sensors:s,modifiers:[$f],onDragEnd:a,children:v.jsx(Ff,{items:n.map(l=>l.key),strategy:Hf,children:v.jsx(Aa,{pagination:!1,size:"small",components:{body:{row:Qf}},rowKey:"key",columns:Zf,dataSource:n,footer:()=>v.jsx(Qt,{justify:"end",children:v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:i,children:""})})})})})},eg=({visible:e,onClose:t,params:n,callback:o})=>e?v.jsx(ln,{footer:null,open:e,onCancel:t,title:"",children:v.jsx(Jf,{data:n.software.map(r=>({...r,key:r.component_id})),callback:o})}):null,tg=({visible:e,onClose:t,params:n,callback:o})=>e?v.jsx(ln,{title:"Illustrate",width:"50%",onCancel:t,onClose:t,open:e,footer:!1,children:v.jsx(Fr,{data:n})}):null,oh=({})=>{console.log("Pipeline");const{component_type:e,component_id:t}=Ki(),[n,o]=x.useState(),r=Zi(),[s,i]=x.useState(!0),[a,l]=x.useState(!0),[f,d]=Qi.useMessage(),u={inputFile:x.useRef(null),outputFile:x.useRef(null)},{modal:c,openModal:g,closeModal:m}=Ji(),{modals:p,openModals:y,closeModals:b}=ea(["modalD","metadataModal","bindSample"]),{project:S}=ta(I=>I.user),{ref:h,top:w,isSticky:C}=Ra(576),E=async()=>{i(!0);let I=`/get-pipeline-v2/${t}?component_type=${e}`;e=="script"&&(I=`/get-component-parent/${t}?component_type=${e}`);let D=(await Xn.get(I)).data;"content"in D&&(D={...JSON.parse(D.content),...D}),D.tags&&(D.tags=JSON.parse(D.tags)),o(D),i(!1),console.log(D)},M={deletePipelineRelation:async I=>{try{const L=await ha(I);f.success("!"),E()}catch(L){console.log(L),f.error(`${L.response.data.detail}`)}},openModal:g,openModals:y};return x.useEffect(()=>{E()},[]),v.jsxs("div",{style:{maxWidth:"1800px",margin:"1rem auto"},children:[v.jsx(ka,{spinning:s,children:v.jsxs(na,{gutter:[C?16:0,16],children:[v.jsx(ko,{lg:18,sm:18,xs:24,style:{display:"flex",flexDirection:"column",height:"100%"},children:v.jsx(Wn,{size:"small",style:{flex:1,display:"flex",flexDirection:"column",height:" 100%"},styles:{body:{padding:0,flex:1,overflowY:"auto"}},title:v.jsxs(v.Fragment,{children:[n==null?void 0:n.component_name,(n==null?void 0:n.category)&&v.jsx(jo,{style:{marginLeft:"0.5rem"},color:"blue",children:n==null?void 0:n.category})]}),extra:v.jsx(Qt,{justify:"space-between",align:"center",gap:"small",children:v.jsxs(Qt,{gap:"small",wrap:!0,children:[e=="pipeline"&&v.jsx(v.Fragment,{children:v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:()=>{g("sortSoftware",{software:n.software})},children:"Update Sorting"})}),v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:()=>{g("publishModal",{...n,component_type:e})},children:"Publish"}),v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:()=>{M.openModal("projectForm",{project_id:S})},children:"Edit Project"}),v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:()=>{M.openModal("modalG",n)},children:"View Dependencies"}),v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:()=>{y("metadataModal",{...n,operatePipeline:M})},children:"Metadata"}),v.jsxs(xe,{size:"small",color:"cyan",variant:"solid",onClick:()=>{g("modalC",{data:n,structure:{component_type:e}})},children:["Update ",e]}),v.jsx(xe,{size:"small",color:"cyan",variant:"solid",onClick:E,children:"Refresh"}),v.jsx(xe,{size:"small",color:"primary",variant:"solid",onClick:()=>r(`/${e}-card`),children:"Back"})]})}),children:v.jsx(rg,{component_type:e||"",component:n,tableRef:u,operatePipeline:M})})}),v.jsx(ko,{lg:6,sm:6,xs:24,ref:h,style:C?{overflow:"hidden",position:"sticky",top:`${w}px`,alignSelf:"flex-start",height:`calc(100vh - ${w}px - 1rem )`}:{},children:v.jsxs(Wn,{title:"Description",extra:v.jsx(v.Fragment,{}),style:{flex:1,display:"flex",flexDirection:"column",height:" 100%"},styles:{body:{flex:1,overflowY:"auto"}},size:"small",children:[(n==null?void 0:n.tags)&&Array.isArray(n.tags)&&n.tags.map((I,L)=>v.jsx(jo,{style:{marginTop:"0.5rem"},color:la[L],children:I},L)),(n==null?void 0:n.description)&&v.jsx(v.Fragment,{children:v.jsx(Fr,{data:n==null?void 0:n.description})})]})})]})}),d,v.jsx(pa,{visible:c.key=="modalB"&&c.visible,onClose:m,callback:E,params:c.params}),v.jsx(fa,{callback:E,visible:c.key=="modalA"&&c.visible,onClose:m,params:{...c.params,namespace:n==null?void 0:n.namespace}}),v.jsx(ga,{callback:E,visible:c.key=="modalC"&&c.visible,onClose:m,params:c.params}),v.jsx(ma,{visible:c.key=="modalE"&&c.visible,onClose:m,params:c.params}),v.jsx(ya,{visible:c.key=="modalF"&&c.visible,onClose:m,params:c.params}),v.jsx(xa,{visible:c.key=="modalG"&&c.visible,onClose:m,callback:E,params:c.params}),v.jsx(oa,{visible:c.key=="modalH"&&c.visible,onClose:m,value:c.params}),v.jsx(Sa,{visible:p.metadataModal.visible,onClose:()=>b("metadataModal"),params:p.metadataModal.params}),v.jsx(za,{visible:c.key=="metadataForm"&&c.visible,onClose:m,params:c.params}),v.jsx(Ca,{visible:p.bindSample.visible,onClose:()=>b("bindSample"),operatePipeline:M,params:p.bindSample.params}),v.jsx(ra,{params:c.params,visible:c.key=="projectForm"&&c.visible,onClose:m}),v.jsx(Ea,{visible:c.key=="openFile"&&c.visible,onClose:m,params:c.params}),v.jsx(eg,{visible:c.key=="sortSoftware"&&c.visible,onClose:m,params:c.params,callback:E}),v.jsx(tg,{visible:c.key=="descriptionModal"&&c.visible,onClose:m,params:c.params,callback:E}),v.jsx(ng,{visible:c.key=="publishModal"&&c.visible,onClose:m,params:c.params})]})},ng=({visible:e,onClose:t,params:n})=>{const[o,r]=x.useState([]),[s,i]=x.useState(!1),[a,l]=x.useState(!1),f=ia(),d=async()=>{try{i(!0);const c=await Xn.get("/component-store/list-stores?address=local");r(c.data),i(!1)}catch{}},u=async(c,g=void 0)=>{try{i(!0);const m=await Xn.post("/publish-component",{component_id:c,store_path:g,force:a});f.success("Published successfully"),i(!1),t()}catch{i(!1)}};return x.useEffect(()=>{e&&d()},[e]),v.jsx(ln,{loading:s,title:v.jsxs(v.Fragment,{children:[`Publish ${n==null?void 0:n.component_name} (${n==null?void 0:n.component_type})`,v.jsx(ja,{style:{marginLeft:"1rem"},checked:a,onChange:c=>{l(c)}})," Force"]}),open:e,onCancel:t,footer:null,children:v.jsx(Qt,{gap:"small",style:{marginBottom:"1rem"},children:o.map((c,g)=>v.jsx($r,{title:c.store_path,children:v.jsx(sa,{title:"pubpish?",onConfirm:()=>u(n==null?void 0:n.component_id,c.store_path),children:v.jsx(xe,{size:"small",color:"cyan",variant:"solid",children:c.name})})},g))})})},og=({component_type:e,operatePipeline:t,component:n,...o})=>{if(!e||!n)return null;const s={pipeline:cg,software:sg,file:ig,script:ag,module:"module-card"}[e];return s?v.jsx(s,{operatePipeline:t,component:n,...o}):null},rg=de.memo(og,(e,t)=>JSON.stringify(e)===JSON.stringify(t)),sg=({operatePipeline:e,component:t,...n})=>v.jsx(v.Fragment,{children:v.jsx(Or,{...t,operatePipeline:e})}),ig=({operatePipeline:e,component:t,...n})=>{const{project:o}=tt();return v.jsx(v.Fragment,{children:v.jsx(Tr,{...t,analysisMethod:[t],operatePipeline:e,project:o})})},ag=({operatePipeline:e,component:t,...n})=>{const{project:o}=tt();return v.jsx(v.Fragment,{children:v.jsx(Tr,{component_type:t.component_type,script:t,analysisMethod:t.parent||[],operatePipeline:e,project:o})})},cg=({operatePipeline:e,component:t,...n})=>{const[o,r]=x.useState([]),{project:s}=tt(),i=f=>{const d=f.software;return d?d.map((u,c)=>({key:u.component_id,label:u.component_name||u.component_id,children:v.jsx(Or,{...n,...u,hiddenUpstreamAnalysis:!0,pipeline:{component_id:f.component_id},operatePipeline:e})})):[]},a=f=>{const d=f.software;if(!d)return[];const c=(JSON.parse(f.position)||[]).reduce((m,p)=>(m[p.component_id]=p.position,m),{});return d.map((m,p)=>{const y=m.component_name,b=(m.inputFile||[]).map(h=>h),S=(m.outputFile||[]).map(h=>h);return{id:m.component_id,type:"custom",position:c[m.component_id]||{x:p*300,y:100},data:{label:y,color:"#"+((1<<24)*Math.random()|0).toString(16),inputs:b,outputs:S}}})||[]},l=f=>JSON.parse(f.edges)||[];return x.useEffect(()=>{t&&r(i(t))},[JSON.stringify(t)]),console.log("--->PipelineComponent"),v.jsxs(v.Fragment,{children:[v.jsx(ld,{initialEdges:l(t),initialNodes:a(t),component:t}),v.jsx("div",{style:{marginTop:"1rem"}}),v.jsx(ca,{...t,project:s,operatePipeline:e,inputAnalysisMethod:t.inputFile}),t&&Array.isArray(t==null?void 0:t.software)?v.jsx(Pa,{destroyInactiveTabPane:!0,items:o}):v.jsxs(aa,{children:[v.jsx(xe,{style:{marginRight:"0.5rem"},color:"cyan",variant:"solid",onClick:()=>{e.openModal("modalC",{data:void 0,structure:{component_type:"software",relation_type:"pipeline_software",parent_component_id:t.component_id,pipeline_id:t.component_id}})},children:""}),v.jsx(xe,{color:"cyan",variant:"solid",onClick:()=>{e.openModal("modalA",{data:void 0,pipelineStructure:{relation_type:"pipeline_software",parent_component_id:t.component_id,pipeline_id:t.component_id}})},children:""})]})]})};export{oh as default};
