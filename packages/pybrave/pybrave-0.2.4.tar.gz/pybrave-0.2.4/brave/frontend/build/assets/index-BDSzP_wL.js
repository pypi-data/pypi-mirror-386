import{d,r as a,h as Y,j as e,i as G,B as T,M as P,I as F,e as $,g as O,a as C,R as M,C as _,k as V,D as J}from"./main-D6qHus43.js";import{R as B}from"./index-CXgqoLfI.js";import{S as H,F as N}from"./Table-Pcm8h2F_.js";import{I}from"./index-DUjGi303.js";import{S as q}from"./index-CScjzpru.js";import{T as z}from"./index-gg_8jVgT.js";import"./index-CjmxhRai.js";import"./index-DOQLu3Xz.js";import"./index-CqzThpCE.js";import"./UpOutlined-DC7OgFJP.js";import"./DeleteOutlined-5gHEV1Sl.js";import"./index-BLl0dAbY.js";import"./Dropdown-CMUlroR_.js";import"./createForOfIteratorHelper-Cwfr5VEp.js";import"./DeploymentUnitOutlined-Bm7mxWYi.js";import"./UserSwitchOutlined-DxcFBqrp.js";import"./AudioOutlined-CPyhrC5-.js";import"./ClearOutlined-sPRC32yu.js";import"./TableOutlined-CS-DfnXV.js";import"./NodeIndexOutlined-GDqggOsJ.js";import"./RedoOutlined-DIIHLGCK.js";import"./UndoOutlined-CVmeWyj0.js";import"./react-window-CDDJu4Rx.js";import"./index-D7dvcYwa.js";import"./index-CoiYZhLe.js";import"./addEventListener-TTc5ki3v.js";const U=({value:s,onChange:r,multiple:i=!0})=>{const[t]=d.useForm(),[l,x]=a.useState(s),[u,m]=Y.useNotification(),[p,f]=a.useState(),[y,b]=a.useState(!1),[v,w]=a.useState(!1),k=[{title:"分析名称",dataIndex:"analysis_name",key:"analysis_name",ellipsis:!0},{title:"id",dataIndex:"id",key:"id"},{title:"分析方法",dataIndex:"analysis_method",key:"analysis_method"},{title:"project",dataIndex:"project",key:"project"},{title:"control",dataIndex:"control",key:"control"},{title:"treatment",dataIndex:"treatment",key:"treatment"},{title:"software",dataIndex:"software",key:"software"},{title:"rank",dataIndex:"rank",key:"rank"},{title:"创建时间",dataIndex:"create_date",key:"create_date"},{title:"操作",key:"action",fixed:"right",width:200,render:(h,c)=>e.jsx(H,{size:"middle",children:e.jsx("a",{onClick:()=>{w(!0),f(c),t.setFieldValue("id",c.id),t.setFieldValue("label",c.analysisName),t.setFieldValue("contentPath",c.content),console.log(c),c.analysis_method=="abundance-venn"?t.setFieldValue("name",`${c.software}-${c.rank}-${c.analysis_method}`):t.setFieldValue("name",`${c.software}-${c.rank}-${c.analysis_method}(${c.treatment} - ${c.control})`)},children:"添加"})})}],j={difference:[{label:"table#`P-value`<0.05",value:"table#`P-value`<0.05"}],prevalence:[{label:"table#type=='Prevalent in both sites'",value:"table#type=='Prevalent in both sites'"},{label:"table#type=='Prevalent in oral cavity' or type=='Prevalent in both sites'",value:"table#type=='Prevalent in oral cavity' or type=='Prevalent in both sites'"},{label:"table#type=='Prevalent in gut'",value:"table#type=='Prevalent in gut'"},{label:"table#type=='Prevalent in gut' or type=='Prevalent in both sites'",value:"table#type=='Prevalent in gut' or type=='Prevalent in both sites'"}],"abundance-venn":[{label:"regions#unique#taxonomy",value:"regions#unique#taxonomy"},{label:"regions#11#taxonomy",value:"regions#11#taxonomy"}]};return e.jsxs(e.Fragment,{children:[s?e.jsxs(e.Fragment,{children:[e.jsx(G,{style:{cursor:"pointer"},onClick:()=>b(!0),children:e.jsx("pre",{children:JSON.stringify(s,null,2)})}),e.jsx("a",{onClick:()=>{r(void 0),x(void 0)},children:"清除"})]}):e.jsx(e.Fragment,{children:e.jsx(T,{onClick:()=>b(!0),children:"添加数据"})}),e.jsxs(P,{footer:e.jsx(e.Fragment,{children:e.jsx(T,{type:"primary",onClick:()=>b(!1),children:"关闭"})}),width:"60%",onOk:async()=>{r(l)},title:p?`${p.software}-${p.rank}-${p.analysis_method}(${p.treatment} - ${p.control})`:"",open:y,onCancel:()=>b(!1),children:[e.jsx(B,{columnsParamsALL:k,shouldTrigger:!0,form:t}),v&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{form:t,children:[e.jsx(d.Item,{name:"contentPath",label:"路径",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx(F,{disabled:!0})}),e.jsx(d.Item,{name:"label",label:"标签",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx(F,{})}),e.jsx(d.Item,{name:"name",label:"名称",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx(F,{})}),e.jsx(d.Item,{name:"query",label:"条件",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx($,{allowClear:!0,options:j[p==null?void 0:p.analysis_method]})}),e.jsx(d.Item,{name:"id",style:{display:"none"},children:e.jsx(F,{disabled:!0})})]}),e.jsx(T,{onClick:async()=>{const h=await t.validateFields();if(i){if(Array.isArray(l)){if(l.length>3){u.error({message:"目前只支持3个对象的韦恩图!"});return}if(l.filter(n=>n.name==h.name&&n.query==h.query).length>0){u.error({message:`已经存在name:${h.name};query:${h.query}`});return}l.push(h),x(l),r(l)}else x([h]),r([h]);t.resetFields()}else x(h),r(h);w(!1)},children:"确认"}),e.jsx(T,{onClick:()=>{x([]),w(!1),r(l)},children:"清除"})]}),e.jsx("div",{children:l&&Array.isArray(l)?l.map((h,c)=>e.jsxs("div",{children:[e.jsx(G,{children:e.jsx("pre",{children:JSON.stringify(h,null,2)})}),e.jsx("a",{onClick:()=>{const n=l.filter(o=>o.id!=h.id);x(n),r(n)},children:"删除"})]},c)):e.jsxs(e.Fragment,{children:[e.jsx(G,{children:e.jsx("pre",{children:JSON.stringify(l,null,2)})}),e.jsx("a",{onClick:()=>{r(void 0),x(void 0)},children:"清除"})]})})]}),m]})},E=({form:s,children:r})=>{const{project:i,sampleComposition:t}=O(),[l,x]=a.useState([]),u=d.useWatch("column",s),m=async()=>{const y=(await C.get(`/api/get-group?column=${u}&project=${i}&sample_composition=${t}`)).data.map(b=>({label:`${b.group_name}(${b.count})`,value:b.group_name}));console.log(y),x(y)};a.useEffect(()=>{u&&m()},[u]);const p=d.useWatch(f=>f.id,s);return e.jsxs(e.Fragment,{children:[e.jsxs(d,{form:s,children:[e.jsx(d.Item,{label:"分析id",name:"id",style:{display:"none"},children:e.jsx(F,{})}),e.jsx(d.Item,{label:"分析名称",name:"analysisName",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx(F,{})}),e.jsx(d.Item,{initialValue:"metaphlan",name:"software",label:"分析软件",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx($,{allowClear:!0,options:[{label:"metaphlan",value:"metaphlan"},{label:"kraken",value:"kraken"}]})}),e.jsx(d.Item,{initialValue:"sample_group",name:"column",label:"分组列",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx($,{allowClear:!0,options:[{label:"sample_composition",value:"sample_composition"},{label:"host_disease",value:"host_disease"},{label:"sample_group",value:"sample_group"}]})}),e.jsx(d.Item,{label:"处理组",name:"treatment",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx($,{allowClear:!0,options:l})}),e.jsx(d.Item,{label:"对照组",name:"control",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx($,{allowClear:!0,options:l})}),e.jsx(d.Item,{initialValue:"SPECIES",label:"rank",name:"rank",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx($,{allowClear:!0,options:[{label:"SGB",value:"SGB"},{label:"SPECIES",value:"SPECIES"},{label:"GENUS",value:"GENUS"},{label:"FAMILY",value:"FAMILY"},{label:"ORDER",value:"ORDER"},{label:"CLASS",value:"CLASS"},{label:"PHYLUM",value:"PHYLUM"}]})}),r]}),p?e.jsxs(e.Fragment,{children:[e.jsx("a",{onClick:()=>s.setFieldValue("id",void 0),children:"更新"}),e.jsx("a",{onClick:()=>s.resetFields(),children:"清除"})]}):e.jsx(e.Fragment,{children:"新增"})]})},W=({form:s})=>{const{project:r,sampleComposition:i}=O(),[t,l]=a.useState([]),x=d.useWatch("column",s);a.useEffect(()=>{},[x]);const u=d.useWatch(m=>m.id,s);return e.jsxs(e.Fragment,{children:[e.jsxs(d,{form:s,children:[e.jsx(d.Item,{label:"分析id",name:"id",style:{display:"none"},children:e.jsx(F,{})}),e.jsx(d.Item,{label:"分析名称",name:"analysisName",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx(F,{})}),e.jsx(d.Item,{initialValue:"SPECIES",label:"rank",name:"rank",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx($,{allowClear:!0,options:[{label:"SGB",value:"SGB"},{label:"SPECIES",value:"SPECIES"},{label:"GENUS",value:"GENUS"},{label:"FAMILY",value:"FAMILY"},{label:"ORDER",value:"ORDER"},{label:"CLASS",value:"CLASS"},{label:"PHYLUM",value:"PHYLUM"}]})}),e.jsx(d.Item,{name:"params",label:"params",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx(U,{})})]}),u?e.jsxs(e.Fragment,{children:[e.jsx("a",{onClick:()=>s.setFieldValue("id",void 0),children:"更新"}),e.jsx("a",{onClick:()=>s.resetFields(),children:"清除"})]}):e.jsx(e.Fragment,{children:"新增"})]})},K=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState({}),{project:x}=O(),[u,m]=a.useState(!1),[p,f]=a.useState(""),[y,b]=a.useState(""),[v,w]=a.useState(!1),[k,j]=a.useState([]),{Search:h}=F,c=async()=>{const S=await s.validateFields();console.log(S),i(!0);const L=await C.post("/jupyter/get--compare-abundance",{...S,project:x});l(L.data),j(L.data.table),i(!1),console.log(L)},n=S=>{l(S),j(S.table)},o=async S=>{const L=await s.validateFields();f(S),w(!0);const D=await C.post("/jupyter/abundance-boxplot",{project:x,taxonomy:S,...L});b(D.data),w(!1)},g=[{title:"taxonomy",dataIndex:"taxonomy",key:"taxonomy",render:(S,L)=>e.jsx(e.Fragment,{children:e.jsx("a",{href:"javascript:;",onClick:()=>{o(L.taxonomy),m(!0)},children:L.taxonomy})})},{title:"tax_id",dataIndex:"tax_id",key:"tax_id",render:(S,L)=>e.jsx(e.Fragment,{children:e.jsx("a",{href:`https://www.ncbi.nlm.nih.gov/datasets/taxonomy/${L.tax_id}/`,target:"__blank",children:L.tax_id})})},{title:"rank",dataIndex:"rank",key:"rank"},{title:"Statistic",dataIndex:"Statistic",key:"Statistic"},{title:"P-value",dataIndex:"P-value",key:"P-value"},{title:"log2foldchange",dataIndex:"log2foldchange",key:"log2foldchange"},{title:"fdr_bh",dataIndex:"fdr_bh",key:"fdr_bh"},{title:"AdjustedP-value",dataIndex:"AdjustedP-value",key:"AdjustedP-value"}],A=()=>{const S=t==null?void 0:t.table.filter(R=>R["P-value"]<.05),L=S.filter(R=>R.log2foldchange>0),D=S.filter(R=>R.log2foldchange<0);return`总共有${S.length}个分类，其中上调的有${L.length}个，下调的有${D.length}多个`};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(E,{form:s}),e.jsx(T,{onClick:c,children:"提交"}),e.jsx(B,{analysisMethod:"difference",shouldTrigger:!r,form:s,setTableLoading:i,setTabletData:n})]}),e.jsxs(_,{lg:12,sm:24,xs:24,children:[(t==null?void 0:t.img)&&e.jsx(e.Fragment,{children:e.jsx(I,{width:"50%",src:t==null?void 0:t.img})}),e.jsx("p",{children:(t==null?void 0:t.table)&&e.jsxs(e.Fragment,{children:["一共鉴定到",t==null?void 0:t.table.length,"个分类，其中根据pvalue 小于 0.05筛选，",A()]})}),e.jsx(h,{placeholder:"input search text",allowClear:!0,onSearch:S=>{const L=t==null?void 0:t.table.filter(D=>D.taxonomy.includes(S)||D.tax_id&&D.tax_id.includes(S));j(L)},style:{width:304}}),e.jsx(N,{pagination:{pageSize:30},loading:r,scroll:{x:"max-content",y:55*5},columns:g,dataSource:k})]}),e.jsx(P,{loading:v,title:p,width:"50%",open:u,footer:e.jsx(e.Fragment,{}),onCancel:()=>m(!1),children:e.jsx(I,{width:"100%",src:y})})]})})},Q=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState(),{project:x}=V(),[u,m]=a.useState(!1),[p,f]=a.useState(""),[y,b]=a.useState(""),[v,w]=a.useState(!1),{Search:k}=F,j=async()=>{const n=await s.validateFields();console.log(n),i(!0);const o=await C.post("/jupyter/abundance-roc",{...n,project:x});l(o.data),i(!1),console.log(o)},h=[{title:"taxonomy",dataIndex:"taxonomy",key:"taxonomy",render:(n,o)=>e.jsx(e.Fragment,{children:e.jsx("a",{href:"javascript:;",onClick:()=>{c(o.taxonomy),m(!0)},children:o.taxonomy})})},{title:"tax_id",dataIndex:"tax_id",key:"tax_id",render:(n,o)=>e.jsx(e.Fragment,{children:e.jsx("a",{href:`https://www.ncbi.nlm.nih.gov/datasets/taxonomy/${o.tax_id}/`,target:"__blank",children:o.tax_id})})},{title:"rank",dataIndex:"rank",key:"rank"},{title:"Importance",dataIndex:"Importance",key:"Importance"}],c=async n=>{const o=await s.validateFields();f(n),w(!0);const g=await C.post("/jupyter/abundance-boxplot",{project:x,taxonomy:n,...o});b(g.data),w(!1)};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(E,{form:s}),e.jsx(T,{onClick:j,children:"提交"}),e.jsx(B,{analysisMethod:"roc",shouldTrigger:!0,form:s,setTableLoading:i,setTabletData:n=>{l(n)}})]}),e.jsx(_,{lg:12,sm:24,xs:24,children:e.jsx(q,{spinning:r,tip:"正在计算中...",children:t?e.jsx(e.Fragment,{children:e.jsx(z,{items:[{key:"roc",label:"roc",children:e.jsx(I,{width:"100%",src:t==null?void 0:t.img})},{key:"importance",label:"importance",children:e.jsxs(e.Fragment,{children:[e.jsx(N,{pagination:{pageSize:30},loading:r,scroll:{x:"max-content"},columns:h,dataSource:t.importance?t.importance:[]}),e.jsx("p",{children:e.jsx("ol",{children:e.jsx("li",{children:"Importance: 特征重要性反映每个特征在决策树分裂时对降低不纯度的平均贡献。权重值越大，表示该特征对分类的影响越显著。"})})}),e.jsx("p",{})]})}]})}):e.jsx("div",{style:{height:"100px"}})})}),e.jsx(P,{loading:v,title:p,width:"50%",open:u,footer:e.jsx(e.Fragment,{}),onCancel:()=>m(!1),children:e.jsx(I,{width:"100%",src:y})})]})})},X=()=>{const[s,r]=a.useState([]),[i,t]=a.useState(!1),{project:l}=V(),[x,u]=a.useState(!1),[m,p]=a.useState(),[f,y]=a.useState(!1),[b,v]=a.useState([]),{Search:w}=F,k=async()=>{t(!0);const n=await C.get(`/api/abundance?project=${l}`);console.log(n),t(!1),r(n.data)},j=async n=>{y(!0);const o=await C.get(`/api/read-hdfs?path=${n}`);console.log(o.data),v(o.data),y(!1)},h=[{title:"Sample Name",dataIndex:"sample_name",key:"sample_name"},{title:"Data Verison",dataIndex:"data_version",key:"data_version"},{title:"software",dataIndex:"software",key:"software"},{title:"sample_composition",dataIndex:"sample_composition",key:"sample_composition"},{title:"host_disease",dataIndex:"host_disease",key:"host_disease"},{title:"sample_group",dataIndex:"sample_group",key:"sample_group"},{title:"Project",dataIndex:"project",key:"project"},{title:"Action",key:"action",fixed:"left",width:100,render:(n,o)=>e.jsx(H,{size:"middle",children:e.jsx("a",{onClick:()=>{p(o),j(o.content),u(!0)},children:"View"})})}],c=[{title:"taxonomy",dataIndex:"taxonomy",key:"taxonomy"},{title:"relative_abundance",dataIndex:"relative_abundance",key:"relative_abundance"},{title:"tax_id",dataIndex:"tax_id",key:"tax_id"},{title:"rank",dataIndex:"rank",key:"rank"},{title:"additional_species",dataIndex:"additional_species",key:"additional_species"}];return a.useEffect(()=>{k()},[]),e.jsxs(e.Fragment,{children:[s&&e.jsxs(e.Fragment,{children:["鉴定丰度的样本数量",s.length]}),e.jsx(T,{onClick:k,children:"刷新"}),e.jsx(N,{pagination:{pageSize:30},loading:i,scroll:{x:"max-content"},columns:h,dataSource:s}),e.jsxs(J,{extra:e.jsx(e.Fragment,{children:e.jsx(T,{onClick:()=>j(m==null?void 0:m.content_path),children:"刷新"})}),loading:f,title:m?m.sample_name:"",open:x,onClose:()=>u(!1),width:"80%",children:[e.jsx(w,{placeholder:"input search text",allowClear:!0,onSearch:n=>{const o=b.filter(g=>g.taxonomy.includes(n));v(o)},style:{width:304}}),e.jsx(N,{pagination:{pageSize:30},loading:f,scroll:{x:"max-content"},columns:c,dataSource:b})]})]})},Z=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState(),{project:x}=O(),[u,m]=a.useState(!1),[p,f]=a.useState(""),[y,b]=a.useState(""),[v,w]=a.useState(!1),{Search:k}=F,j=async()=>{const h=await s.validateFields();console.log(h),i(!0);const c=await C.post("/jupyter/abundance-diversity",{...h,project:x});l(c.data),i(!1),console.log(c)};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(E,{form:s}),e.jsx(T,{onClick:j,children:"提交"}),e.jsx(B,{analysisMethod:"diversity-alpha",shouldTrigger:!0,form:s,setTableLoading:i,setTabletData:h=>{l(h)}})]}),e.jsx(_,{lg:12,sm:24,xs:24,children:e.jsx(q,{spinning:r,tip:"正在计算中...",children:t?e.jsx(e.Fragment,{children:e.jsx(z,{items:[{key:"roc",label:"roc",children:e.jsx(I,{width:"100%",src:t==null?void 0:t.img})}]})}):e.jsx("div",{style:{height:"100px"}})})}),e.jsx(P,{loading:v,title:p,width:"50%",open:u,footer:e.jsx(e.Fragment,{}),onCancel:()=>m(!1),children:e.jsx(I,{width:"100%",src:y})})]})})},ee=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState(),{project:x}=O(),[u,m]=a.useState(!1),[p,f]=a.useState(""),[y,b]=a.useState(""),[v,w]=a.useState(!1),[k,j]=a.useState(!0),{Search:h}=F,c=async()=>{const n=await s.validateFields();console.log(n),i(!0),j(!1);const o=await C.post("/jupyter/abundance-diversity-beta",{...n,project:x});l(o.data),j(!0),i(!1),console.log(o)};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(E,{form:s}),e.jsx(T,{onClick:c,children:"提交"}),e.jsx(B,{analysisMethod:"diversity-beta",shouldTrigger:k,form:s,setTableLoading:i,setTabletData:n=>{l(n)}})]}),e.jsx(_,{lg:12,sm:24,xs:24,children:e.jsx(q,{spinning:r,tip:"正在计算中...",children:t?e.jsx(e.Fragment,{children:e.jsx(z,{items:[{key:"roc",label:"roc",children:e.jsx(I,{width:"100%",src:t==null?void 0:t.img})}]})}):e.jsx("div",{style:{height:"100px"}})})}),e.jsx(P,{loading:v,title:p,width:"50%",open:u,footer:e.jsx(e.Fragment,{}),onCancel:()=>m(!1),children:e.jsx(I,{width:"100%",src:y})})]})})},te=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState({}),[x,u]=a.useState([]),{project:m}=V(),[p,f]=a.useState(!1),[y,b]=a.useState(""),[v,w]=a.useState(""),[k,j]=a.useState(!1),{Search:h}=F,c=async()=>{const g=await s.validateFields();console.log(g),i(!0);const A=await C.post("/jupyter/abundance-prevalence ",{...g,project:m});l(A.data),u(A.data.table),i(!1)},n=async g=>{const A=await s.validateFields();b(g),j(!0);const S=await C.post("/jupyter/abundance-boxplot",{project:m,taxonomy:g,...A});w(S.data),j(!1)},o=[{title:"taxonomy",dataIndex:"taxonomy",key:"taxonomy",render:(g,A)=>e.jsx(e.Fragment,{children:e.jsx("a",{href:"javascript:;",onClick:()=>{n(A.taxonomy),f(!0)},children:A.taxonomy})})},{title:"tax_id",dataIndex:"tax_id",key:"tax_id",render:(g,A)=>e.jsx(e.Fragment,{children:e.jsx("a",{href:`https://www.ncbi.nlm.nih.gov/datasets/taxonomy/${A.tax_id}/`,target:"__blank",children:A.tax_id})})},{title:"rank",dataIndex:"rank",key:"rank"},{title:"oral_prev",dataIndex:"oral_prev",key:"oral_prev"},{title:"faeces_prev",dataIndex:"faeces_prev",key:"faeces_prev"},{title:"类型",dataIndex:"type",key:"type"}];return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(E,{form:s}),e.jsx(T,{onClick:c,children:"提交"}),e.jsx(B,{analysisMethod:"prevalence",shouldTrigger:!0,form:s,setTableLoading:i,setTabletData:g=>{l(g),u(g.table)}})]}),e.jsxs(_,{lg:12,sm:24,xs:24,children:[(t==null?void 0:t.img)&&e.jsx(e.Fragment,{children:e.jsx(I,{width:"50%",src:t==null?void 0:t.img})}),e.jsx("p",{children:t!=null&&t.desc?t.desc:""}),e.jsx("div",{children:e.jsx(h,{placeholder:"input search text",allowClear:!0,onSearch:g=>{const A=t.table.filter(S=>S.type.includes(g)||S.taxonomy.includes(g));u(A)},style:{width:304}})}),e.jsx(N,{pagination:{pageSize:30},loading:r,scroll:{x:"max-content",y:55*5},columns:o,dataSource:x})]}),e.jsx(P,{loading:k,title:y,width:"50%",open:p,footer:e.jsx(e.Fragment,{}),onCancel:()=>f(!1),children:e.jsx(I,{width:"100%",src:v})})]})})},ae=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState(),{project:x}=V(),[u,m]=a.useState(!1),[p,f]=a.useState(""),[y,b]=a.useState(""),[v,w]=a.useState(!1),[k,j]=a.useState(!0),{Search:h}=F,c=async()=>{const n=await s.validateFields();console.log(n),i(!0),j(!1);const o=await C.post("/jupyter/abundance-stacked-diagram",{...n,project:x});l(o.data),j(!0),i(!1),console.log(o)};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(E,{form:s,children:e.jsx(d.Item,{name:"params",label:"params",children:e.jsx(U,{multiple:!1})})}),e.jsx(T,{onClick:c,children:"提交"}),e.jsx(B,{analysisMethod:"stacked-diagram",shouldTrigger:k,form:s,setTableLoading:i,setTabletData:n=>{l(n)}})]}),e.jsx(_,{lg:12,sm:24,xs:24,children:e.jsx(q,{spinning:r,tip:"正在计算中...",children:t?e.jsxs(e.Fragment,{children:[e.jsx(I,{width:"100%",src:t==null?void 0:t.img}),"A total of ",t.table.length," records",e.jsx(N,{pagination:{pageSize:30},loading:r,scroll:{x:"max-content",y:55*5},columns:[{title:"taxonomy",dataIndex:"taxonomy",key:"taxonomy"}],dataSource:t.table})]}):e.jsx("div",{style:{height:"100px"}})})}),e.jsx(P,{loading:v,title:p,width:"50%",open:u,footer:e.jsx(e.Fragment,{}),onCancel:()=>m(!1),children:e.jsx(I,{width:"100%",src:y})})]})})},se=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState(),{project:x}=O(),[u,m]=a.useState(!1),[p,f]=a.useState(""),[y,b]=a.useState(""),[v,w]=a.useState(!1),[k,j]=a.useState(!0),{Search:h}=F,c=async()=>{const n=await s.validateFields();console.log(n),i(!0),j(!1);const o=await C.post("/jupyter/abundance-pie",{...n,project:x});l(o.data),j(!0),i(!1),console.log(o)};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(E,{form:s}),e.jsx(T,{onClick:c,children:"提交"}),e.jsx(B,{analysisMethod:"abundance-pie",shouldTrigger:k,form:s,setTableLoading:i,setTabletData:n=>{l(n)}})]}),e.jsx(_,{lg:12,sm:24,xs:24,children:e.jsx(q,{spinning:r,tip:"正在计算中...",children:t?e.jsx(e.Fragment,{children:e.jsx(I,{width:"100%",src:t==null?void 0:t.img})}):e.jsx("div",{style:{height:"100px"}})})}),e.jsx(P,{loading:v,title:p,width:"50%",open:u,footer:e.jsx(e.Fragment,{}),onCancel:()=>m(!1),children:e.jsx(I,{width:"100%",src:y})})]})})},ne=()=>{const[s,r]=a.useState(!1),[i,t]=a.useState(),{project:l}=V(),[x,u]=a.useState(!1),[m,p]=a.useState({}),[f,y]=a.useState([]),{Search:b}=F,[v,w]=Y.useNotification(),[k,j]=a.useState(!0),[h]=d.useForm(),[c]=d.useForm(),n=async()=>{const o=await c.validateFields();r(!0),j(!1);const g=await C.post("/jupyter/abundance-venn",{...o,project:l});j(!0),t(g.data),r(!1)};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(W,{form:c}),e.jsx(T,{onClick:n,children:"提交"}),e.jsx(B,{analysisMethod:"abundance-venn",shouldTrigger:k,form:c,setTableLoading:r,setTabletData:o=>{t(o)}})]}),e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsx(q,{spinning:s,tip:"正在计算中...",children:i?e.jsxs(e.Fragment,{children:[e.jsx(I,{width:"50%",src:i==null?void 0:i.img}),e.jsxs("table",{className:"result-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"binary_code"}),e.jsx("th",{children:"label"}),e.jsx("th",{children:"count"}),e.jsx("th",{children:"操作"})]})}),e.jsx("tbody",{children:i.regions.map((o,g)=>e.jsxs("tr",{children:[e.jsx("td",{children:o.binary_code}),e.jsx("td",{children:o.label}),e.jsx("td",{children:o.count}),e.jsx("td",{children:e.jsx("a",{onClick:()=>{y(o.elements)},style:{whiteSpace:"nowrap"},children:"查看元素"})})]},g))})]}),f.length>0&&e.jsx(e.Fragment,{children:e.jsxs("table",{className:"result-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"index"}),e.jsx("th",{children:"name"})]})}),e.jsx("tbody",{children:f.map((o,g)=>e.jsxs("tr",{children:[e.jsx("td",{children:g+1}),e.jsx("td",{children:e.jsx("a",{onClick:()=>{p({project:l,taxonomy:o.taxonomy,column:"sample_group",rank:"SPECIES",software:"metaphlan"}),u(!0)},children:o.taxonomy})})]},g))})]})})]}):e.jsx("div",{style:{height:"100px"}})}),e.jsx(le,{boxplotParam:m,open:x,setOpen:u})]})]})})},le=({boxplotParam:s,open:r,setOpen:i})=>{const[t,l]=a.useState(""),[x,u]=a.useState(!1),m=async()=>{u(!0);const p=await C.post("/jupyter/abundance-boxplot",{...s});l(p.data),u(!1)};return a.useEffect(()=>{r&&m()},[r]),e.jsx(e.Fragment,{children:e.jsxs(P,{loading:x,title:"箱线图",width:"50%",open:r,footer:e.jsx(e.Fragment,{}),onCancel:()=>i(!1),children:[e.jsx(I,{width:"100%",src:t}),e.jsx(G,{children:e.jsx("pre",{children:JSON.stringify(s,null,2)})})]})})},oe=()=>{const[s]=d.useForm(),[r,i]=a.useState(!1),[t,l]=a.useState(),{project:x}=O(),[u,m]=a.useState(!1),[p,f]=a.useState(""),[y,b]=a.useState(""),[v,w]=a.useState(!1),[k,j]=a.useState(!0),{Search:h}=F,c=async()=>{const n=await s.validateFields();console.log(n),i(!0),j(!1);const o=await C.post("/jupyter/abundance-cumulative-abundance",{...n,project:x});l(o.data),j(!0),i(!1),console.log(o)};return e.jsx(e.Fragment,{children:e.jsxs(M,{children:[e.jsxs(_,{lg:12,sm:24,xs:24,children:[e.jsxs(E,{form:s,children:[e.jsx(d.Item,{label:"累积类型",name:"yType",children:e.jsx($,{options:[{label:"sum",value:"sum"},{label:"count",value:"count"}]})}),e.jsx(d.Item,{name:"params",label:"params",rules:[{required:!0,message:"该字段不能为空!"}],children:e.jsx(U,{multiple:!0})})]}),e.jsx(T,{onClick:c,children:"提交"}),e.jsx(B,{analysisMethod:"cumulative-abundance",shouldTrigger:k,form:s,setTableLoading:i,setTabletData:n=>{l(n)}})]}),e.jsx(_,{lg:12,sm:24,xs:24,children:e.jsx(q,{spinning:r,tip:"正在计算中...",children:t?e.jsxs(e.Fragment,{children:[e.jsx(I,{width:"100%",src:t==null?void 0:t.img}),(t==null?void 0:t.describe)&&e.jsx("p",{children:t==null?void 0:t.describe})]}):e.jsx("div",{style:{height:"100px"}})})}),e.jsx(P,{loading:v,title:p,width:"50%",open:u,footer:e.jsx(e.Fragment,{}),onCancel:()=>m(!1),children:e.jsx(I,{width:"100%",src:y})})]})})},Be=()=>e.jsx(e.Fragment,{children:e.jsx(z,{items:[{key:"diversity-alphattmp",label:"alpha多样性",children:e.jsx(Z,{})},{key:"diversity-beta",label:"beta多样性",children:e.jsx(ee,{})},{key:"stacked-diagram",label:"堆叠图",children:e.jsx(ae,{})},{key:"pie",label:"饼图",children:e.jsx(se,{})},{key:"difference",label:"差异分析",children:e.jsx(K,{})},{key:"roc",label:"ROC分析",children:e.jsx(Q,{})},{key:"prevalence",label:"流行率分析",children:e.jsx(te,{})},{key:"cumulative-abundance",label:"累积丰度",children:e.jsx(oe,{})},{key:"venn",label:"集合分析",children:e.jsx(ne,{})},{key:"abundanceTable",label:"丰度表格",children:e.jsx(X,{})}]})});export{Be as default};
