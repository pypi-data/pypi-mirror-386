import{d as p,r as s,j as e,F as _,l as b,av as m,I as F,R as w,C as k,t as j,bn as u,a as I}from"./main-D6qHus43.js";import{C}from"./index-D7dvcYwa.js";import{y as v,S as E}from"./Table-Pcm8h2F_.js";import{R as D}from"./ClearOutlined-sPRC32yu.js";import{R as T}from"./UndoOutlined-CVmeWyj0.js";import"./index-gg_8jVgT.js";import"./Dropdown-CMUlroR_.js";import"./addEventListener-TTc5ki3v.js";import"./index-CScjzpru.js";const L=({close:r,height:h,graphOpt:d,queryParams:t,...i})=>{const[c]=p.useForm(),[l,a]=s.useState([]);s.useEffect(()=>{t!=null&&t.nodes&&Array.isArray(t==null?void 0:t.nodes)&&a(t==null?void 0:t.nodes.map(o=>({value:o,name:o})))},[t==null?void 0:t.nodes]),s.useEffect(()=>{c.setFieldsValue(t==null?void 0:t.nodes_dict)},[]);const f=()=>{const o=c.getFieldsValue();console.log(o),d.updateQueryParam("nodes_dict",o)};return e.jsxs(C,{title:e.jsx(e.Fragment,{children:`${i==null?void 0:i.label}`}),styles:{body:{padding:0,height:"100%",overflowY:"auto"}},size:"small",extra:e.jsxs(_,{gap:"small",children:[e.jsx(b,{style:{cursor:"pointer"},onClick:()=>{(t==null?void 0:t.nodes_dict_condition)=="OR"?d.updateQueryParam("nodes_dict_condition","AND"):d.updateQueryParam("nodes_dict_condition","OR")},children:t==null?void 0:t.nodes_dict_condition}),e.jsx(m,{onClick:r})]}),style:{borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",padding:"0.5rem",overflow:"hidden",height:h},children:[e.jsx("div",{style:{marginTop:"1rem"}}),e.jsx(p.Provider,{onFormChange:f,children:e.jsx(p,{form:c,children:l.map((o,x)=>e.jsx(p.Item,{name:o.value,label:o.name,noStyle:!0,children:e.jsx($,{title:o.name,label:o.value})},x))})})]})},$=({title:r,label:h,value:d,onChange:t})=>{const[i,c]=s.useState(!1),[l,a]=s.useState(""),[f,o]=s.useState(!1),[x,S]=s.useState([]),g=async()=>{o(!0);const n=await I.post("/entity/query-nodes",{label:h,keyword:l});S(n.data),o(!1)};return s.useEffect(()=>{g()},[l]),e.jsx(e.Fragment,{children:e.jsxs(C,{size:"small",loading:f,title:r,style:{marginBottom:"1rem"},extra:e.jsxs(E,{children:[e.jsx(j,{title:"Search",children:e.jsx(u,{style:{cursor:"pointer"},onClick:()=>{c(!i),i&&a("")}})}),e.jsx(j,{title:"Clear Selection",children:e.jsx(D,{style:{cursor:"pointer"},onClick:()=>{t(void 0)}})}),e.jsx(j,{title:"Refresh",children:e.jsx(T,{style:{cursor:"pointer"},onClick:g})})]}),children:[i&&e.jsx(F.Search,{allowClear:!0,onSearch:n=>a(n),style:{marginBottom:"0.5rem"}}),e.jsx("div",{style:{overflowY:"auto",maxHeight:"240px"},children:e.jsx(v.Group,{style:{width:"100%"},value:d,onChange:t,children:e.jsx(w,{children:x&&x.length>0&&x.filter(n=>l?n.entity_name.includes(l):!0).map((n,R)=>e.jsx(k,{span:24,style:{marginTop:"0.3em"},children:e.jsx(v,{value:n.entity_id,children:n.entity_name})},R))})})})]})})};export{L as default};
