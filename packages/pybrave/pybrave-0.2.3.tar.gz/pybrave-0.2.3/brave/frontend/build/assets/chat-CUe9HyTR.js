var Ht=Object.defineProperty;var Dt=(e,t,n)=>t in e?Ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var V=(e,t,n)=>Dt(e,typeof t!="symbol"?t+"":t,n);import{r as l,Z as qt,$ as ke,a0 as Xt,a1 as Ft,ap as Vt,X as st,ai as Ut,aj as Gt,ak as Wt,cG as at,L,cj as Kt,a3 as Yt,a4 as Zt,p as Qt,f,dt as Jt,a7 as $e,a9 as Te,ab as H,aa as U,eh as en,bv as tn,ei as Ce,a8 as re,ch as it,ej as ct,_ as lt,ek as nn,el as rn,em as on,en as sn,da as ze,eo as an,ep as cn,eq as ln,bT as un,ao as dn,B as ut,av as dt,b3 as K,G as xe,bR as ft,I as fn,Y as mt,bN as mn,F as pt,j as W,bq as Ve}from"./main-D6qHus43.js";import{R as pn}from"./ClearOutlined-sPRC32yu.js";import{R as hn,a as gn,b as vn}from"./AudioOutlined-CPyhrC5-.js";import{C as yn}from"./index-D7dvcYwa.js";import"./index-gg_8jVgT.js";import"./Dropdown-CMUlroR_.js";const je=l.createContext({}),Sn=e=>{const{antCls:t,componentCls:n,iconCls:r,avatarBg:o,avatarColor:s,containerSize:a,containerSizeLG:i,containerSizeSM:c,textFontSize:d,textFontSizeLG:u,textFontSizeSM:p,borderRadius:m,borderRadiusLG:C,borderRadiusSM:T,lineWidth:S,lineType:R}=e,E=(g,h,v)=>({width:g,height:g,borderRadius:"50%",[`&${n}-square`]:{borderRadius:v},[`&${n}-icon`]:{fontSize:h,[`> ${r}`]:{margin:0}}});return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},Xt(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:s,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:o,border:`${Ft(S)} ${R} transparent`,"&-image":{background:"transparent"},[`${t}-image-img`]:{display:"block"}}),E(a,d,m)),{"&-lg":Object.assign({},E(i,u,C)),"&-sm":Object.assign({},E(c,p,T)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},Cn=e=>{const{componentCls:t,groupBorderColor:n,groupOverlapping:r,groupSpace:o}=e;return{[`${t}-group`]:{display:"inline-flex",[t]:{borderColor:n},"> *:not(:first-child)":{marginInlineStart:r}},[`${t}-group-popover`]:{[`${t} + ${t}`]:{marginInlineStart:o}}}},xn=e=>{const{controlHeight:t,controlHeightLG:n,controlHeightSM:r,fontSize:o,fontSizeLG:s,fontSizeXL:a,fontSizeHeading3:i,marginXS:c,marginXXS:d,colorBorderBg:u}=e;return{containerSize:t,containerSizeLG:n,containerSizeSM:r,textFontSize:Math.round((s+a)/2),textFontSizeLG:i,textFontSizeSM:o,groupSpace:d,groupOverlapping:-c,groupBorderColor:u}},ht=qt("Avatar",e=>{const{colorTextLightSolid:t,colorTextPlaceholder:n}=e,r=ke(e,{avatarBg:n,avatarColor:t});return[Sn(r),Cn(r)]},xn);var bn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};const gt=l.forwardRef((e,t)=>{const{prefixCls:n,shape:r,size:o,src:s,srcSet:a,icon:i,className:c,rootClassName:d,style:u,alt:p,draggable:m,children:C,crossOrigin:T,gap:S=4,onError:R}=e,E=bn(e,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","style","alt","draggable","children","crossOrigin","gap","onError"]),[g,h]=l.useState(1),[v,y]=l.useState(!1),[I,M]=l.useState(!0),j=l.useRef(null),b=l.useRef(null),x=Vt(t,j),{getPrefixCls:w,avatar:N}=l.useContext(st),$=l.useContext(je),_=()=>{if(!b.current||!j.current)return;const q=b.current.offsetWidth,k=j.current.offsetWidth;q!==0&&k!==0&&S*2<k&&h(k-S*2<q?(k-S*2)/q:1)};l.useEffect(()=>{y(!0)},[]),l.useEffect(()=>{M(!0),h(1)},[s]),l.useEffect(_,[S]);const P=()=>{(R==null?void 0:R())!==!1&&M(!1)},A=Ut(q=>{var k,oe;return(oe=(k=o??($==null?void 0:$.size))!==null&&k!==void 0?k:q)!==null&&oe!==void 0?oe:"default"}),O=Object.keys(typeof A=="object"?A||{}:{}).some(q=>["xs","sm","md","lg","xl","xxl"].includes(q)),z=Gt(O),G=l.useMemo(()=>{if(typeof A!="object")return{};const q=Wt.find(oe=>z[oe]),k=A[q];return k?{width:k,height:k,fontSize:k&&(i||C)?k/2:18}:{}},[z,A]),D=w("avatar",n),Q=at(D),[J,ie,ce]=ht(D,Q),ee=L({[`${D}-lg`]:A==="large",[`${D}-sm`]:A==="small"}),F=l.isValidElement(s),te=r||($==null?void 0:$.shape)||"circle",Y=L(D,ee,N==null?void 0:N.className,`${D}-${te}`,{[`${D}-image`]:F||s&&I,[`${D}-icon`]:!!i},ce,Q,c,d,ie),Me=typeof A=="number"?{width:A,height:A,fontSize:i?A/2:18}:{};let Z;if(typeof s=="string"&&I)Z=l.createElement("img",{src:s,draggable:m,srcSet:a,onError:P,alt:p,crossOrigin:T});else if(F)Z=s;else if(i)Z=i;else if(v||g!==1){const q=`scale(${g})`,k={msTransform:q,WebkitTransform:q,transform:q};Z=l.createElement(Kt,{onResize:_},l.createElement("span",{className:`${D}-string`,ref:b,style:Object.assign({},k)},C))}else Z=l.createElement("span",{className:`${D}-string`,style:{opacity:0},ref:b},C);return J(l.createElement("span",Object.assign({},E,{style:Object.assign(Object.assign(Object.assign(Object.assign({},Me),G),N==null?void 0:N.style),u),className:Y,ref:x}),Z))}),Ue=e=>{const{size:t,shape:n}=l.useContext(je),r=l.useMemo(()=>({size:e.size||t,shape:e.shape||n}),[e.size,e.shape,t,n]);return l.createElement(je.Provider,{value:r},e.children)},En=e=>{var t,n,r,o;const{getPrefixCls:s,direction:a}=l.useContext(st),{prefixCls:i,className:c,rootClassName:d,style:u,maxCount:p,maxStyle:m,size:C,shape:T,maxPopoverPlacement:S,maxPopoverTrigger:R,children:E,max:g}=e,h=s("avatar",i),v=`${h}-group`,y=at(h),[I,M,j]=ht(h,y),b=L(v,{[`${v}-rtl`]:a==="rtl"},j,y,c,d,M),x=Yt(E).map(($,_)=>Zt($,{key:`avatar-key-${_}`})),w=(g==null?void 0:g.count)||p,N=x.length;if(w&&w<N){const $=x.slice(0,w),_=x.slice(w,N),P=(g==null?void 0:g.style)||m,A=((t=g==null?void 0:g.popover)===null||t===void 0?void 0:t.trigger)||R||"hover",O=((n=g==null?void 0:g.popover)===null||n===void 0?void 0:n.placement)||S||"top",z=Object.assign(Object.assign({content:_},g==null?void 0:g.popover),{classNames:{root:L(`${v}-popover`,(o=(r=g==null?void 0:g.popover)===null||r===void 0?void 0:r.classNames)===null||o===void 0?void 0:o.root)},placement:O,trigger:A});return $.push(l.createElement(Qt,Object.assign({key:"avatar-popover-key",destroyTooltipOnHide:!0},z),l.createElement(gt,{style:P},`+${N-w}`))),I(l.createElement(Ue,{shape:T,size:C},l.createElement("div",{className:b,style:u},$)))}return I(l.createElement(Ue,{shape:T,size:C},l.createElement("div",{className:b,style:u},x)))},vt=gt;vt.Group=En;const Rn="1.6.0",$n=f.createContext({}),Tn={classNames:{},styles:{},className:"",style:{}},yt=e=>{const t=f.useContext($n);return f.useMemo(()=>({...Tn,...t[e]}),[t[e]])};function he(){const{getPrefixCls:e,direction:t,csp:n,iconPrefixCls:r,theme:o}=f.useContext(Jt.ConfigContext);return{theme:o,getPrefixCls:e,direction:t,csp:n,iconPrefixCls:r}}var wn="%";function Le(e){return e.join(wn)}var In=function(){function e(t){Te(this,e),H(this,"instanceId",void 0),H(this,"cache",new Map),H(this,"extracted",new Set),this.instanceId=t}return $e(e,[{key:"get",value:function(n){return this.opGet(Le(n))}},{key:"opGet",value:function(n){return this.cache.get(n)||null}},{key:"update",value:function(n,r){return this.opUpdate(Le(n),r)}},{key:"opUpdate",value:function(n,r){var o=this.cache.get(n),s=r(o);s===null?this.cache.delete(n):this.cache.set(n,s)}}]),e}(),He="data-token-hash",me="data-css-hash",ae="__cssinjs_instance__";function Mn(){var e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var t=document.body.querySelectorAll("style[".concat(me,"]"))||[],n=document.head.firstChild;Array.from(t).forEach(function(o){o[ae]=o[ae]||e,o[ae]===e&&document.head.insertBefore(o,n)});var r={};Array.from(document.querySelectorAll("style[".concat(me,"]"))).forEach(function(o){var s=o.getAttribute(me);if(r[s]){if(o[ae]===e){var a;(a=o.parentNode)===null||a===void 0||a.removeChild(o)}}else r[s]=!0})}return new In(e)}var St=l.createContext({hashPriority:"low",cache:Mn(),defaultCache:!0});function _n(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var De=function(){function e(){Te(this,e),H(this,"cache",void 0),H(this,"keys",void 0),H(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return $e(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(n){var r,o,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a={map:this.cache};return n.forEach(function(i){if(!a)a=void 0;else{var c;a=(c=a)===null||c===void 0||(c=c.map)===null||c===void 0?void 0:c.get(i)}}),(r=a)!==null&&r!==void 0&&r.value&&s&&(a.value[1]=this.cacheCallTimes++),(o=a)===null||o===void 0?void 0:o.value}},{key:"get",value:function(n){var r;return(r=this.internalGet(n,!0))===null||r===void 0?void 0:r[0]}},{key:"has",value:function(n){return!!this.internalGet(n)}},{key:"set",value:function(n,r){var o=this;if(!this.has(n)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var s=this.keys.reduce(function(d,u){var p=U(d,2),m=p[1];return o.internalGet(u)[1]<m?[u,o.internalGet(u)[1]]:d},[this.keys[0],this.cacheCallTimes]),a=U(s,1),i=a[0];this.delete(i)}this.keys.push(n)}var c=this.cache;n.forEach(function(d,u){if(u===n.length-1)c.set(d,{value:[r,o.cacheCallTimes++]});else{var p=c.get(d);p?p.map||(p.map=new Map):c.set(d,{map:new Map}),c=c.get(d).map}})}},{key:"deleteByPath",value:function(n,r){var o=n.get(r[0]);if(r.length===1){var s;return o.map?n.set(r[0],{map:o.map}):n.delete(r[0]),(s=o.value)===null||s===void 0?void 0:s[0]}var a=this.deleteByPath(o.map,r.slice(1));return(!o.map||o.map.size===0)&&!o.value&&n.delete(r[0]),a}},{key:"delete",value:function(n){if(this.has(n))return this.keys=this.keys.filter(function(r){return!_n(r,n)}),this.deleteByPath(this.cache,n)}}]),e}();H(De,"MAX_CACHE_SIZE",20);H(De,"MAX_CACHE_OFFSET",5);var Ge=0,Ct=function(){function e(t){Te(this,e),H(this,"derivatives",void 0),H(this,"id",void 0),this.derivatives=Array.isArray(t)?t:[t],this.id=Ge,t.length===0&&en(t.length>0),Ge+=1}return $e(e,[{key:"getDerivativeToken",value:function(n){return this.derivatives.reduce(function(r,o){return o(n,r)},void 0)}}]),e}(),Ne=new De;function An(e){var t=Array.isArray(e)?e:[e];return Ne.has(t)||Ne.set(t,new Ct(t)),Ne.get(t)}var Nn=new WeakMap,Pe={};function Pn(e,t){for(var n=Nn,r=0;r<t.length;r+=1){var o=t[r];n.has(o)||n.set(o,new WeakMap),n=n.get(o)}return n.has(Pe)||n.set(Pe,e()),n.get(Pe)}var We=new WeakMap;function pe(e){var t=We.get(e)||"";return t||(Object.keys(e).forEach(function(n){var r=e[n];t+=n,r instanceof Ct?t+=r.id:r&&tn(r)==="object"?t+=pe(r):t+=r}),t=Ce(t),We.set(e,t)),t}function Ke(e,t){return Ce("".concat(t,"_").concat(pe(e)))}function be(e){return typeof e=="number"?"".concat(e,"px"):e}function Ee(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(o)return e;var s=re(re({},r),{},H(H({},He,t),me,n)),a=Object.keys(s).map(function(i){var c=s[i];return c?"".concat(i,'="').concat(c,'"'):null}).filter(function(i){return i}).join(" ");return"<style ".concat(a,">").concat(e,"</style>")}var Bn=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(n?"".concat(n,"-"):"").concat(t).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},zn=function(t,n,r){return Object.keys(t).length?".".concat(n).concat(r!=null&&r.scope?".".concat(r.scope):"","{").concat(Object.entries(t).map(function(o){var s=U(o,2),a=s[0],i=s[1];return"".concat(a,":").concat(i,";")}).join(""),"}"):""},jn=function(t,n,r){var o={},s={};return Object.entries(t).forEach(function(a){var i,c,d=U(a,2),u=d[0],p=d[1];if(r!=null&&(i=r.preserve)!==null&&i!==void 0&&i[u])s[u]=p;else if((typeof p=="string"||typeof p=="number")&&!(r!=null&&(c=r.ignore)!==null&&c!==void 0&&c[u])){var m,C=Bn(u,r==null?void 0:r.prefix);o[C]=typeof p=="number"&&!(r!=null&&(m=r.unitless)!==null&&m!==void 0&&m[u])?"".concat(p,"px"):String(p),s[u]="var(".concat(C,")")}}),[s,zn(o,n,{scope:r==null?void 0:r.scope})]},Ln=re({},ct),Ye=Ln.useInsertionEffect,On=function(t,n,r){l.useMemo(t,r),it(function(){return n(!0)},r)},kn=Ye?function(e,t,n){return Ye(function(){return e(),t()},n)}:On,Hn=re({},ct),Dn=Hn.useInsertionEffect,qn=function(t){var n=[],r=!1;function o(s){r||n.push(s)}return l.useEffect(function(){return r=!1,function(){r=!0,n.length&&n.forEach(function(s){return s()})}},t),o},Xn=function(){return function(t){t()}},Fn=typeof Dn<"u"?qn:Xn;function Vn(e,t,n,r,o){var s=l.useContext(St),a=s.cache,i=[e].concat(lt(t)),c=Le(i),d=Fn([c]),u=function(T){a.opUpdate(c,function(S){var R=S||[void 0,void 0],E=U(R,2),g=E[0],h=g===void 0?0:g,v=E[1],y=v,I=y||n(),M=[h,I];return T?T(M):M})};l.useMemo(function(){u()},[c]);var p=a.opGet(c),m=p[1];return kn(function(){o==null||o(m)},function(C){return u(function(T){var S=U(T,2),R=S[0],E=S[1];return C&&R===0&&(o==null||o(m)),[R+1,E]}),function(){a.opUpdate(c,function(T){var S=T||[],R=U(S,2),E=R[0],g=E===void 0?0:E,h=R[1],v=g-1;return v===0?(d(function(){(C||!a.opGet(c))&&(r==null||r(h,!1))}),null):[g-1,h]})}},[c]),m}var Un={},Gn="css",ne=new Map;function Wn(e){ne.set(e,(ne.get(e)||0)+1)}function Kn(e,t){if(typeof document<"u"){var n=document.querySelectorAll("style[".concat(He,'="').concat(e,'"]'));n.forEach(function(r){if(r[ae]===t){var o;(o=r.parentNode)===null||o===void 0||o.removeChild(r)}})}}var Yn=0;function Zn(e,t){ne.set(e,(ne.get(e)||0)-1);var n=new Set;ne.forEach(function(r,o){r<=0&&n.add(o)}),ne.size-n.size>Yn&&n.forEach(function(r){Kn(r,t),ne.delete(r)})}var Qn=function(t,n,r,o){var s=r.getDerivativeToken(t),a=re(re({},s),n);return o&&(a=o(a)),a},xt="token";function Jn(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=l.useContext(St),o=r.cache.instanceId,s=r.container,a=n.salt,i=a===void 0?"":a,c=n.override,d=c===void 0?Un:c,u=n.formatToken,p=n.getComputedToken,m=n.cssVar,C=Pn(function(){return Object.assign.apply(Object,[{}].concat(lt(t)))},t),T=pe(C),S=pe(d),R=m?pe(m):"",E=Vn(xt,[i,e.id,T,S,R],function(){var g,h=p?p(C,d,e):Qn(C,d,e,u),v=re({},h),y="";if(m){var I=jn(h,m.key,{prefix:m.prefix,ignore:m.ignore,unitless:m.unitless,preserve:m.preserve}),M=U(I,2);h=M[0],y=M[1]}var j=Ke(h,i);h._tokenKey=j,v._tokenKey=Ke(v,i);var b=(g=m==null?void 0:m.key)!==null&&g!==void 0?g:j;h._themeKey=b,Wn(b);var x="".concat(Gn,"-").concat(Ce(j));return h._hashId=x,[h,x,v,y,(m==null?void 0:m.key)||""]},function(g){Zn(g[0]._themeKey,o)},function(g){var h=U(g,4),v=h[0],y=h[3];if(m&&y){var I=nn(y,Ce("css-variables-".concat(v._themeKey)),{mark:me,prepend:"queue",attachTo:s,priority:-999});I[ae]=o,I.setAttribute(He,v._themeKey)}});return E}var er=function(t,n,r){var o=U(t,5),s=o[2],a=o[3],i=o[4],c=r||{},d=c.plain;if(!a)return null;var u=s._tokenKey,p=-999,m={"data-rc-order":"prependQueue","data-rc-priority":"".concat(p)},C=Ee(a,i,u,m,d);return[p,u,C]};function tr(e){var t=rn(sn(e),on);return t.replace(/\{%%%\:[^;];}/g,";")}var nr="style",rr=function(t,n,r){var o=U(t,6),s=o[0],a=o[1],i=o[2],c=o[3],d=o[4],u=o[5],p=r||{},m=p.plain;if(d)return null;var C=s,T={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)};return C=Ee(s,a,i,T,m),c&&Object.keys(c).forEach(function(S){if(!n[S]){n[S]=!0;var R=tr(c[S]),E=Ee(R,a,"_effect-".concat(S),T,m);S.startsWith("@layer")?C=E+C:C+=E}}),[u,i,C]},or="cssVar",sr=function(t,n,r){var o=U(t,4),s=o[1],a=o[2],i=o[3],c=r||{},d=c.plain;if(!s)return null;var u=-999,p={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)},m=Ee(s,i,a,p,d);return[u,a,m]};H(H(H({},nr,rr),xt,er),or,sr);var bt=function(){function e(t,n){Te(this,e),H(this,"name",void 0),H(this,"style",void 0),H(this,"_keyframe",!0),this.name=t,this.style=n}return $e(e,[{key:"getName",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return n?"".concat(n,"-").concat(this.name):this.name}}]),e}();function se(e){return e.notSplit=!0,e}se(["borderTop","borderBottom"]),se(["borderTop"]),se(["borderBottom"]),se(["borderLeft","borderRight"]),se(["borderLeft"]),se(["borderRight"]);const ar=An(ze.defaultAlgorithm),ir={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},Et=(e,t,n)=>{const r=n.getDerivativeToken(e),{override:o,...s}=t;let a={...r,override:o};return a=ln(a),s&&Object.entries(s).forEach(([i,c])=>{const{theme:d,...u}=c;let p=u;d&&(p=Et({...a,...u},{override:u},d)),a[i]=p}),a};function cr(){const{token:e,hashed:t,theme:n=ar,override:r,cssVar:o}=f.useContext(ze._internalContext),[s,a,i]=Jn(n,[ze.defaultSeed,e],{salt:`${Rn}-${t||""}`,override:r,getComputedToken:Et,cssVar:o&&{prefix:o.prefix,key:o.key,unitless:cn,ignore:an,preserve:ir}});return[n,i,t?a:"",s,o]}const{genStyleHooks:Rt,genComponentStyleHook:uo,genSubStyleComponent:fo}=un({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:t}=he();return{iconPrefixCls:t,rootPrefixCls:e()}},useToken:()=>{const[e,t,n,r,o]=cr();return{theme:e,realToken:t,hashId:n,token:r,cssVar:o}},useCSP:()=>{const{csp:e}=he();return e??{}},layer:{name:"antdx",dependencies:["antd"]}});function lr(e,t){return l.useImperativeHandle(e,()=>{const n=t(),{nativeElement:r}=n;return new Proxy(r,{get(o,s){return n[s]?n[s]:Reflect.get(o,s)}})})}const $t=l.createContext({}),Ze=()=>({height:0}),Qe=e=>({height:e.scrollHeight});function ur(e){const{title:t,onOpenChange:n,open:r,children:o,className:s,style:a,classNames:i={},styles:c={},closable:d,forceRender:u}=e,{prefixCls:p}=l.useContext($t),m=`${p}-header`;return l.createElement(dn,{motionEnter:!0,motionLeave:!0,motionName:`${m}-motion`,leavedClassName:`${m}-motion-hidden`,onEnterStart:Ze,onEnterActive:Qe,onLeaveStart:Qe,onLeaveActive:Ze,visible:r,forceRender:u},({className:C,style:T})=>l.createElement("div",{className:L(m,C,s),style:{...T,...a}},(d!==!1||t)&&l.createElement("div",{className:L(`${m}-header`,i.header),style:{...c.header}},l.createElement("div",{className:`${m}-title`},t),d!==!1&&l.createElement("div",{className:`${m}-close`},l.createElement(ut,{type:"text",icon:l.createElement(dt,null),size:"small",onClick:()=>{n==null||n(!r)}}))),o&&l.createElement("div",{className:L(`${m}-content`,i.content),style:{...c.content}},o)))}const we=l.createContext(null);function dr(e,t){const{className:n,action:r,onClick:o,...s}=e,a=l.useContext(we),{prefixCls:i,disabled:c}=a,d=s.disabled??c??a[`${r}Disabled`];return l.createElement(ut,K({type:"text"},s,{ref:t,onClick:u=>{var p;d||((p=a[r])==null||p.call(a),o==null||o(u))},className:L(i,n,{[`${i}-disabled`]:d})}))}const Ie=l.forwardRef(dr);function fr(e,t){return l.createElement(Ie,K({icon:l.createElement(pn,null)},e,{action:"onClear",ref:t}))}const mr=l.forwardRef(fr),pr=l.memo(e=>{const{className:t}=e;return f.createElement("svg",{color:"currentColor",viewBox:"0 0 1000 1000",xmlns:"http://www.w3.org/2000/svg",className:t},f.createElement("title",null,"Stop Loading"),f.createElement("rect",{fill:"currentColor",height:"250",rx:"24",ry:"24",width:"250",x:"375",y:"375"}),f.createElement("circle",{cx:"500",cy:"500",fill:"none",r:"450",stroke:"currentColor",strokeWidth:"100",opacity:"0.45"}),f.createElement("circle",{cx:"500",cy:"500",fill:"none",r:"450",stroke:"currentColor",strokeWidth:"100",strokeDasharray:"600 9999999"},f.createElement("animateTransform",{attributeName:"transform",dur:"1s",from:"0 500 500",repeatCount:"indefinite",to:"360 500 500",type:"rotate"})))});function hr(e,t){const{prefixCls:n}=l.useContext(we),{className:r}=e;return l.createElement(Ie,K({icon:null,color:"primary",variant:"text",shape:"circle"},e,{className:L(r,`${n}-loading-button`),action:"onCancel",ref:t}),l.createElement(pr,{className:`${n}-loading-icon`}))}const Tt=l.forwardRef(hr);function gr(e,t){return l.createElement(Ie,K({icon:l.createElement(hn,null),type:"primary",shape:"circle"},e,{action:"onSend",ref:t}))}const wt=l.forwardRef(gr),de=1e3,fe=4,Se=140,Je=Se/2,ge=250,et=500,ve=.8;function vr({className:e}){return f.createElement("svg",{color:"currentColor",viewBox:`0 0 ${de} ${de}`,xmlns:"http://www.w3.org/2000/svg",className:e},f.createElement("title",null,"Speech Recording"),Array.from({length:fe}).map((t,n)=>{const r=(de-Se*fe)/(fe-1),o=n*(r+Se),s=de/2-ge/2,a=de/2-et/2;return f.createElement("rect",{fill:"currentColor",rx:Je,ry:Je,height:ge,width:Se,x:o,y:s,key:n},f.createElement("animate",{attributeName:"height",values:`${ge}; ${et}; ${ge}`,keyTimes:"0; 0.5; 1",dur:`${ve}s`,begin:`${ve/fe*n}s`,repeatCount:"indefinite"}),f.createElement("animate",{attributeName:"y",values:`${s}; ${a}; ${s}`,keyTimes:"0; 0.5; 1",dur:`${ve}s`,begin:`${ve/fe*n}s`,repeatCount:"indefinite"}))}))}function yr(e,t){const{speechRecording:n,onSpeechDisabled:r,prefixCls:o}=l.useContext(we);let s=null;return n?s=l.createElement(vr,{className:`${o}-recording-icon`}):r?s=l.createElement(gn,null):s=l.createElement(vn,null),l.createElement(Ie,K({icon:s,color:"primary",variant:"text"},e,{action:"onSpeech",ref:t}))}const It=l.forwardRef(yr),Sr=e=>{const{componentCls:t,calc:n}=e,r=`${t}-header`;return{[t]:{[r]:{borderBottomWidth:e.lineWidth,borderBottomStyle:"solid",borderBottomColor:e.colorBorder,"&-header":{background:e.colorFillAlter,fontSize:e.fontSize,lineHeight:e.lineHeight,paddingBlock:n(e.paddingSM).sub(e.lineWidthBold).equal(),paddingInlineStart:e.padding,paddingInlineEnd:e.paddingXS,display:"flex",borderRadius:{_skip_check_:!0,value:n(e.borderRadius).mul(2).equal()},borderEndStartRadius:0,borderEndEndRadius:0,[`${r}-title`]:{flex:"auto"}},"&-content":{padding:e.padding},"&-motion":{transition:["height","border"].map(o=>`${o} ${e.motionDurationSlow}`).join(","),overflow:"hidden","&-enter-start, &-leave-active":{borderBottomColor:"transparent"},"&-hidden":{display:"none"}}}}}},Cr=e=>{const{componentCls:t,padding:n,paddingSM:r,paddingXS:o,paddingXXS:s,lineWidth:a,lineWidthBold:i,calc:c}=e;return{[t]:{position:"relative",width:"100%",boxSizing:"border-box",boxShadow:`${e.boxShadowTertiary}`,transition:`background ${e.motionDurationSlow}`,borderRadius:{_skip_check_:!0,value:c(e.borderRadius).mul(2).equal()},borderColor:e.colorBorder,borderWidth:0,borderStyle:"solid","&:after":{content:'""',position:"absolute",inset:0,pointerEvents:"none",transition:`border-color ${e.motionDurationSlow}`,borderRadius:{_skip_check_:!0,value:"inherit"},borderStyle:"inherit",borderColor:"inherit",borderWidth:a},"&:focus-within":{boxShadow:`${e.boxShadowSecondary}`,borderColor:e.colorPrimary,"&:after":{borderWidth:i}},"&-disabled":{background:e.colorBgContainerDisabled},[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{display:"flex",gap:o,width:"100%",paddingBlock:r,paddingInlineStart:n,paddingInlineEnd:r,boxSizing:"border-box",alignItems:"flex-end"},[`${t}-prefix`]:{flex:"none"},[`${t}-input`]:{padding:0,borderRadius:0,flex:"auto",alignSelf:"center",minHeight:"auto"},[`${t}-actions-list`]:{flex:"none",display:"flex","&-presets":{gap:e.paddingXS}},[`${t}-actions-btn`]:{"&-disabled":{opacity:.45},"&-loading-button":{padding:0,border:0},"&-loading-icon":{height:e.controlHeight,width:e.controlHeight,verticalAlign:"top"},"&-recording-icon":{height:"1.2em",width:"1.2em",verticalAlign:"top"}},[`${t}-footer`]:{paddingInlineStart:n,paddingInlineEnd:r,paddingBlockEnd:r,paddingBlockStart:s,boxSizing:"border-box"}}}},xr=()=>({}),br=Rt("Sender",e=>{const{paddingXS:t,calc:n}=e,r=ke(e,{SenderContentMaxWidth:`calc(100% - ${be(n(t).add(32).equal())})`});return[Cr(r),Sr(r)]},xr);let Re;!Re&&typeof window<"u"&&(Re=window.SpeechRecognition||window.webkitSpeechRecognition);function Er(e,t){const n=xe(e),[r,o,s]=f.useMemo(()=>typeof t=="object"?[t.recording,t.onRecordingChange,typeof t.recording=="boolean"]:[void 0,void 0,!1],[t]),[a,i]=f.useState(null);f.useEffect(()=>{if(typeof navigator<"u"&&"permissions"in navigator){let S=null;return navigator.permissions.query({name:"microphone"}).then(R=>{i(R.state),R.onchange=function(){i(this.state)},S=R}),()=>{S&&(S.onchange=null)}}},[]);const c=Re&&a!=="denied",d=f.useRef(null),[u,p]=ft(!1,{value:r}),m=f.useRef(!1),C=()=>{if(c&&!d.current){const S=new Re;S.onstart=()=>{p(!0)},S.onend=()=>{p(!1)},S.onresult=R=>{var E,g,h;if(!m.current){const v=(h=(g=(E=R.results)==null?void 0:E[0])==null?void 0:g[0])==null?void 0:h.transcript;n(v)}m.current=!1},d.current=S}},T=xe(S=>{S&&!u||(m.current=S,s?o==null||o(!u):(C(),d.current&&(u?(d.current.stop(),o==null||o(!1)):(d.current.start(),o==null||o(!0)))))});return[c,T,u]}function Rr(e,t,n){return mn(e,t)||n}const tt={SendButton:wt,ClearButton:mr,LoadingButton:Tt,SpeechButton:It},$r=f.forwardRef((e,t)=>{const{prefixCls:n,styles:r={},classNames:o={},className:s,rootClassName:a,style:i,defaultValue:c,value:d,readOnly:u,submitType:p="enter",onSubmit:m,loading:C,components:T,onCancel:S,onChange:R,actions:E,onKeyPress:g,onKeyDown:h,disabled:v,allowSpeech:y,prefix:I,footer:M,header:j,onPaste:b,onPasteFile:x,autoSize:w={maxRows:8},...N}=e,{direction:$,getPrefixCls:_}=he(),P=_("sender",n),A=f.useRef(null),O=f.useRef(null);lr(t,()=>{var B,X;return{nativeElement:A.current,focus:(B=O.current)==null?void 0:B.focus,blur:(X=O.current)==null?void 0:X.blur}});const z=yt("sender"),G=`${P}-input`,[D,Q,J]=br(P),ie=L(P,z.className,s,a,Q,J,{[`${P}-rtl`]:$==="rtl",[`${P}-disabled`]:v}),ce=`${P}-actions-btn`,ee=`${P}-actions-list`,[F,te]=ft(c||"",{value:d}),Y=(B,X)=>{te(B),R&&R(B,X)},[Me,Z,q]=Er(B=>{Y(`${F} ${B}`)},y),k=Rr(T,["input"],fn.TextArea),Nt={...mt(N,{attr:!0,aria:!0,data:!0}),ref:O},_e=()=>{F&&m&&!C&&m(F)},Pt=()=>{Y("")},Ae=f.useRef(!1),Bt=()=>{Ae.current=!0},zt=()=>{Ae.current=!1},jt=B=>{const X=B.key==="Enter"&&!Ae.current;switch(p){case"enter":X&&!B.shiftKey&&(B.preventDefault(),_e());break;case"shiftEnter":X&&B.shiftKey&&(B.preventDefault(),_e());break}g==null||g(B)},Lt=B=>{var ue;const X=(ue=B.clipboardData)==null?void 0:ue.files;X!=null&&X.length&&x&&(x(X[0],X),B.preventDefault()),b==null||b(B)},Ot=B=>{var X,ue;B.target!==((X=A.current)==null?void 0:X.querySelector(`.${G}`))&&B.preventDefault(),(ue=O.current)==null||ue.focus()};let le=f.createElement(pt,{className:`${ee}-presets`},y&&f.createElement(It,null),C?f.createElement(Tt,null):f.createElement(wt,null));typeof E=="function"?le=E(le,{components:tt}):(E||E===!1)&&(le=E);const kt={prefixCls:ce,onSend:_e,onSendDisabled:!F,onClear:Pt,onClearDisabled:!F,onCancel:S,onCancelDisabled:!C,onSpeech:()=>Z(!1),onSpeechDisabled:!Me,speechRecording:q,disabled:v},Fe=typeof M=="function"?M({components:tt}):M||null;return D(f.createElement("div",{ref:A,className:ie,style:{...z.style,...i}},j&&f.createElement($t.Provider,{value:{prefixCls:P}},j),f.createElement(we.Provider,{value:kt},f.createElement("div",{className:`${P}-content`,onMouseDown:Ot},I&&f.createElement("div",{className:L(`${P}-prefix`,z.classNames.prefix,o.prefix),style:{...z.styles.prefix,...r.prefix}},I),f.createElement(k,K({},Nt,{disabled:v,style:{...z.styles.input,...r.input},className:L(G,z.classNames.input,o.input),autoSize:w,value:F,onChange:B=>{Y(B.target.value,B),Z(!0)},onPressEnter:jt,onCompositionStart:Bt,onCompositionEnd:zt,onKeyDown:h,onPaste:Lt,variant:"borderless",readOnly:u})),le&&f.createElement("div",{className:L(ee,z.classNames.actions,o.actions),style:{...z.styles.actions,...r.actions}},le)),Fe&&f.createElement("div",{className:L(`${P}-footer`,z.classNames.footer,o.footer),style:{...z.styles.footer,...r.footer}},Fe))))}),Mt=$r;Mt.Header=ur;function ye(e){return typeof e=="string"}const Tr=(e,t,n,r)=>{const o=l.useRef(""),[s,a]=l.useState(1),i=t&&ye(e);return it(()=>{!i&&ye(e)?a(e.length):ye(e)&&ye(o.current)&&e.indexOf(o.current)!==0&&a(1),o.current=e},[e]),l.useEffect(()=>{if(i&&s<e.length){const d=setTimeout(()=>{a(u=>u+n)},r);return()=>{clearTimeout(d)}}},[s,t,e]),[i?e.slice(0,s):e,i&&s<e.length]};function wr(e){return l.useMemo(()=>{if(!e)return[!1,0,0,null];let t={step:1,interval:50,suffix:null};return typeof e=="object"&&(t={...t,...e}),[!0,t.step,t.interval,t.suffix]},[e])}const Ir=({prefixCls:e})=>f.createElement("span",{className:`${e}-dot`},f.createElement("i",{className:`${e}-dot-item`,key:"item-1"}),f.createElement("i",{className:`${e}-dot-item`,key:"item-2"}),f.createElement("i",{className:`${e}-dot-item`,key:"item-3"})),Mr=e=>{const{componentCls:t,paddingSM:n,padding:r}=e;return{[t]:{[`${t}-content`]:{"&-filled,&-outlined,&-shadow":{padding:`${be(n)} ${be(r)}`,borderRadius:e.borderRadiusLG},"&-filled":{backgroundColor:e.colorFillContent},"&-outlined":{border:`1px solid ${e.colorBorderSecondary}`},"&-shadow":{boxShadow:e.boxShadowTertiary}}}}},_r=e=>{const{componentCls:t,fontSize:n,lineHeight:r,paddingSM:o,padding:s,calc:a}=e,i=a(n).mul(r).div(2).add(o).equal(),c=`${t}-content`;return{[t]:{[c]:{"&-round":{borderRadius:{_skip_check_:!0,value:i},paddingInline:a(s).mul(1.25).equal()}},[`&-start ${c}-corner`]:{borderStartStartRadius:e.borderRadiusXS},[`&-end ${c}-corner`]:{borderStartEndRadius:e.borderRadiusXS}}}},Ar=e=>{const{componentCls:t,padding:n}=e;return{[`${t}-list`]:{display:"flex",flexDirection:"column",gap:n,overflowY:"auto","&::-webkit-scrollbar":{width:8,backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:e.colorTextTertiary,borderRadius:e.borderRadiusSM},"&":{scrollbarWidth:"thin",scrollbarColor:`${e.colorTextTertiary} transparent`}}}},Nr=new bt("loadingMove",{"0%":{transform:"translateY(0)"},"10%":{transform:"translateY(4px)"},"20%":{transform:"translateY(0)"},"30%":{transform:"translateY(-4px)"},"40%":{transform:"translateY(0)"}}),Pr=new bt("cursorBlink",{"0%":{opacity:1},"50%":{opacity:0},"100%":{opacity:1}}),Br=e=>{const{componentCls:t,fontSize:n,lineHeight:r,paddingSM:o,colorText:s,calc:a}=e;return{[t]:{display:"flex",columnGap:o,[`&${t}-end`]:{justifyContent:"end",flexDirection:"row-reverse",[`& ${t}-content-wrapper`]:{alignItems:"flex-end"}},[`&${t}-rtl`]:{direction:"rtl"},[`&${t}-typing ${t}-content:last-child::after`]:{content:'"|"',fontWeight:900,userSelect:"none",opacity:1,marginInlineStart:"0.1em",animationName:Pr,animationDuration:"0.8s",animationIterationCount:"infinite",animationTimingFunction:"linear"},[`& ${t}-avatar`]:{display:"inline-flex",justifyContent:"center",alignSelf:"flex-start"},[`& ${t}-header, & ${t}-footer`]:{fontSize:n,lineHeight:r,color:e.colorText},[`& ${t}-header`]:{marginBottom:e.paddingXXS},[`& ${t}-footer`]:{marginTop:o},[`& ${t}-content-wrapper`]:{flex:"auto",display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:0,maxWidth:"100%"},[`& ${t}-content`]:{position:"relative",boxSizing:"border-box",minWidth:0,maxWidth:"100%",color:s,fontSize:e.fontSize,lineHeight:e.lineHeight,minHeight:a(o).mul(2).add(a(r).mul(n)).equal(),wordBreak:"break-word",[`& ${t}-dot`]:{position:"relative",height:"100%",display:"flex",alignItems:"center",columnGap:e.marginXS,padding:`0 ${be(e.paddingXXS)}`,"&-item":{backgroundColor:e.colorPrimary,borderRadius:"100%",width:4,height:4,animationName:Nr,animationDuration:"2s",animationIterationCount:"infinite",animationTimingFunction:"linear","&:nth-child(1)":{animationDelay:"0s"},"&:nth-child(2)":{animationDelay:"0.2s"},"&:nth-child(3)":{animationDelay:"0.4s"}}}}}}},zr=()=>({}),_t=Rt("Bubble",e=>{const t=ke(e,{});return[Br(t),Ar(t),Mr(t),_r(t)]},zr),At=f.createContext({}),jr=(e,t)=>{const{prefixCls:n,className:r,rootClassName:o,style:s,classNames:a={},styles:i={},avatar:c,placement:d="start",loading:u=!1,loadingRender:p,typing:m,content:C="",messageRender:T,variant:S="filled",shape:R,onTypingComplete:E,header:g,footer:h,_key:v,...y}=e,{onUpdate:I}=f.useContext(At),M=f.useRef(null);f.useImperativeHandle(t,()=>({nativeElement:M.current}));const{direction:j,getPrefixCls:b}=he(),x=b("bubble",n),w=yt("bubble"),[N,$,_,P]=wr(m),[A,O]=Tr(C,N,$,_);f.useEffect(()=>{I==null||I()},[A]);const z=f.useRef(!1);f.useEffect(()=>{!O&&!u?z.current||(z.current=!0,E==null||E()):z.current=!1},[O,u]);const[G,D,Q]=_t(x),J=L(x,o,w.className,r,D,Q,`${x}-${d}`,{[`${x}-rtl`]:j==="rtl",[`${x}-typing`]:O&&!u&&!T&&!P}),ie=f.useMemo(()=>f.isValidElement(c)?c:f.createElement(vt,c),[c]),ce=f.useMemo(()=>T?T(A):A,[A,T]),ee=Y=>typeof Y=="function"?Y(A,{key:v}):Y;let F;u?F=p?p():f.createElement(Ir,{prefixCls:x}):F=f.createElement(f.Fragment,null,ce,O&&P);let te=f.createElement("div",{style:{...w.styles.content,...i.content},className:L(`${x}-content`,`${x}-content-${S}`,R&&`${x}-content-${R}`,w.classNames.content,a.content)},F);return(g||h)&&(te=f.createElement("div",{className:`${x}-content-wrapper`},g&&f.createElement("div",{className:L(`${x}-header`,w.classNames.header,a.header),style:{...w.styles.header,...i.header}},ee(g)),te,h&&f.createElement("div",{className:L(`${x}-footer`,w.classNames.footer,a.footer),style:{...w.styles.footer,...i.footer}},ee(h)))),G(f.createElement("div",K({style:{...w.style,...s},className:J},y,{ref:M}),c&&f.createElement("div",{style:{...w.styles.avatar,...i.avatar},className:L(`${x}-avatar`,w.classNames.avatar,a.avatar)},ie),te))},qe=f.forwardRef(jr);function Lr(e,t){const n=l.useCallback((r,o)=>typeof t=="function"?t(r,o):t?t[r.role]||{}:{},[t]);return l.useMemo(()=>(e||[]).map((r,o)=>{const s=r.key??`preset_${o}`;return{...n(r,o),...r,key:s}}),[e,n])}const Or=({_key:e,...t},n)=>l.createElement(qe,K({},t,{_key:e,ref:r=>{var o;r?n.current[e]=r:(o=n.current)==null||delete o[e]}})),kr=l.memo(l.forwardRef(Or)),Hr=1,Dr=(e,t)=>{const{prefixCls:n,rootClassName:r,className:o,items:s,autoScroll:a=!0,roles:i,onScroll:c,...d}=e,u=mt(d,{attr:!0,aria:!0}),p=l.useRef(null),m=l.useRef({}),{getPrefixCls:C}=he(),T=C("bubble",n),S=`${T}-list`,[R,E,g]=_t(T),[h,v]=l.useState(!1);l.useEffect(()=>(v(!0),()=>{v(!1)}),[]);const y=Lr(s,i),[I,M]=l.useState(!0),[j,b]=l.useState(0),x=$=>{const _=$.target;M(_.scrollHeight-Math.abs(_.scrollTop)-_.clientHeight<=Hr),c==null||c($)};l.useEffect(()=>{a&&p.current&&I&&p.current.scrollTo({top:p.current.scrollHeight})},[j]),l.useEffect(()=>{var $;if(a){const _=($=y[y.length-2])==null?void 0:$.key,P=m.current[_];if(P){const{nativeElement:A}=P,{top:O,bottom:z}=A.getBoundingClientRect(),{top:G,bottom:D}=p.current.getBoundingClientRect();O<D&&z>G&&(b(J=>J+1),M(!0))}}},[y.length]),l.useImperativeHandle(t,()=>({nativeElement:p.current,scrollTo:({key:$,offset:_,behavior:P="smooth",block:A})=>{if(typeof _=="number")p.current.scrollTo({top:_,behavior:P});else if($!==void 0){const O=m.current[$];if(O){const z=y.findIndex(G=>G.key===$);M(z===y.length-1),O.nativeElement.scrollIntoView({behavior:P,block:A})}}}}));const w=xe(()=>{a&&b($=>$+1)}),N=l.useMemo(()=>({onUpdate:w}),[]);return R(l.createElement(At.Provider,{value:N},l.createElement("div",K({},u,{className:L(S,r,o,E,g,{[`${S}-reach-end`]:I}),ref:p,onScroll:x}),y.map(({key:$,..._})=>l.createElement(kr,K({},_,{key:$,_key:$,ref:m,typing:h?_.typing:!1}))))))},qr=l.forwardRef(Dr);qe.List=qr;function Xr(e){const[,t]=f.useState(0),n=f.useRef(typeof e=="function"?e():e),r=f.useCallback(s=>{n.current=typeof s=="function"?s(n.current):s,t(a=>a+1)},[]),o=f.useCallback(()=>n.current,[]);return[n.current,r,o]}function Fr(e){return Array.isArray(e)?e:[e]}function Vr(e){const{defaultMessages:t,agent:n,requestFallback:r,requestPlaceholder:o,parser:s,transformMessage:a,transformStream:i,resolveAbortController:c}=e,d=f.useRef(0),[u,p,m]=Xr(()=>(t||[]).map((h,v)=>({id:`default_${v}`,status:"local",...h}))),C=(h,v)=>{const y={id:`msg_${d.current}`,message:h,status:v};return d.current+=1,y},T=f.useMemo(()=>{const h=[];return u.forEach(v=>{const y=s?s(v.message):v.message,I=Fr(y);I.forEach((M,j)=>{let b=v.id;I.length>1&&(b=`${b}_${j}`),h.push({id:b,message:M,status:v.status})})}),h},[u]),S=h=>h.filter(v=>v.status!=="loading"&&v.status!=="error").map(v=>v.message),R=()=>S(m()),E=h=>{const{chunk:v,chunks:y,originMessage:I}=h;if(typeof a=="function")return a(h);if(v)return v;if(Array.isArray(y)){const M=(y==null?void 0:y.length)>0?y==null?void 0:y[(y==null?void 0:y.length)-1]:void 0;return I||M}return y};return{onRequest:xe(h=>{if(!n)throw new Error("The agent parameter is required when using the onRequest method in an agent generated by useXAgent.");let v=null,y,I={};if(h&&typeof h=="object"&&"message"in h){const{message:b,...x}=h;y=b,I=x}else y=h;p(b=>{let x=[...b,C(y,"local")];if(o){let w;typeof o=="function"?w=o(y,{messages:S(x)}):w=o;const N=C(w,"loading");v=N.id,x=[...x,N]}return x});let M=null;const j=(b,x,w)=>{let N=m().find($=>$.id===M);if(N)p($=>$.map(_=>{if(_.id===M){const P=E({originMessage:_.message,chunk:x,chunks:w,status:b});return{..._,message:P,status:b}}return _}));else{const $=E({chunk:x,status:b,chunks:w});N=C($,b),p(_=>[..._.filter(A=>A.id!==v),N]),M=N.id}return N};n.request({message:y,messages:R(),...I},{onUpdate:b=>{j("loading",b,[])},onSuccess:b=>{j("success",void 0,b)},onError:async b=>{if(r){let x;typeof r=="function"?x=await r(y,{error:b,messages:R()}):x=r,p(w=>[...w.filter(N=>N.id!==v&&N.id!==M),C(x,"error")])}else p(x=>x.filter(w=>w.id!==v&&w.id!==M))},onStream:b=>{c==null||c(b)}},i)}),messages:u,parsedMessages:T,setMessages:p}}const Ur=`

`,Gr=`
`,nt=":",Oe=e=>(e??"").trim()!=="";function Wr(){let e="";return new TransformStream({transform(t,n){e+=t;const r=e.split(Ur);r.slice(0,-1).forEach(o=>{Oe(o)&&n.enqueue(o)}),e=r[r.length-1]},flush(t){Oe(e)&&t.enqueue(e)}})}function Kr(){return new TransformStream({transform(e,t){const r=e.split(Gr).reduce((o,s)=>{const a=s.indexOf(nt);if(a===-1)throw new Error(`The key-value separator "${nt}" is not found in the sse line chunk!`);const i=s.slice(0,a);if(!Oe(i))return o;const c=s.slice(a+1);return{...o,[i]:c}},{});Object.keys(r).length!==0&&t.enqueue(r)}})}function rt(e){const{readableStream:t,transformStream:n}=e;if(!(t instanceof ReadableStream))throw new Error("The options.readableStream must be an instance of ReadableStream.");const r=new TextDecoderStream,o=n?t.pipeThrough(r).pipeThrough(n):t.pipeThrough(r).pipeThrough(Wr()).pipeThrough(Kr());return o[Symbol.asyncIterator]=async function*(){const s=this.getReader();for(;;){const{done:a,value:i}=await s.read();if(a)break;i&&(yield i)}},o}const Yr=async(e,t={})=>{const{fetch:n=globalThis.fetch,middlewares:r={},...o}=t;if(typeof n!="function")throw new Error("The options.fetch must be a typeof fetch function!");let s=[e,o];typeof r.onRequest=="function"&&(s=await r.onRequest(...s));let a=await n(...s);if(typeof r.onResponse=="function"){const i=await r.onResponse(a);if(!(i instanceof Response))throw new Error("The options.onResponse must return a Response instance!");a=i}if(!a.ok)throw new Error(`Fetch failed with status ${a.status}`);if(!a.body)throw new Error("The response body is empty.");return a};class Xe{constructor(t){V(this,"baseURL");V(this,"model");V(this,"defaultHeaders");V(this,"customOptions");V(this,"create",async(t,n,r)=>{var a,i;const o=new AbortController,s={method:"POST",body:JSON.stringify({model:this.model,...t}),headers:this.defaultHeaders,signal:o.signal};(a=n==null?void 0:n.onStream)==null||a.call(n,o);try{const c=await Yr(this.baseURL,{fetch:this.customOptions.fetch,...s});if(r){await this.customResponseHandler(c,n,r);return}const d=c.headers.get("content-type")||"";switch(d.split(";")[0].trim()){case"text/event-stream":await this.sseResponseHandler(c,n);break;case"application/json":await this.jsonResponseHandler(c,n);break;default:throw new Error(`The response content-type: ${d} is not support!`)}}catch(c){const d=c instanceof Error?c:new Error("Unknown error!");throw(i=n==null?void 0:n.onError)==null||i.call(n,d),d}});V(this,"customResponseHandler",async(t,n,r)=>{var s,a;const o=[];for await(const i of rt({readableStream:t.body,transformStream:r}))o.push(i),(s=n==null?void 0:n.onUpdate)==null||s.call(n,i);(a=n==null?void 0:n.onSuccess)==null||a.call(n,o)});V(this,"sseResponseHandler",async(t,n)=>{var s,a;const r=[],o=rt({readableStream:t.body});for await(const i of o)r.push(i),(s=n==null?void 0:n.onUpdate)==null||s.call(n,i);(a=n==null?void 0:n.onSuccess)==null||a.call(n,r)});V(this,"jsonResponseHandler",async(t,n)=>{var o,s;const r=await t.json();(o=n==null?void 0:n.onUpdate)==null||o.call(n,r),(s=n==null?void 0:n.onSuccess)==null||s.call(n,[r])});const{baseURL:n,model:r,dangerouslyApiKey:o,...s}=t;this.baseURL=t.baseURL,this.model=t.model,this.defaultHeaders={"Content-Type":"application/json",...t.dangerouslyApiKey&&{Authorization:t.dangerouslyApiKey}},this.customOptions=s}static init(t){if(!t.baseURL||typeof t.baseURL!="string")throw new Error("The baseURL is not valid!");return new Xe(t)}}const Zr=Xe.init;let ot=0;class Qr{constructor(t){V(this,"config");V(this,"requestingMap",{});V(this,"request",(t,n,r)=>{const{request:o}=this.config,{onUpdate:s,onSuccess:a,onError:i,onStream:c}=n,d=ot;ot+=1,this.requestingMap[d]=!0,o==null||o(t,{onStream:u=>{this.requestingMap[d]&&(c==null||c(u))},onUpdate:u=>{this.requestingMap[d]&&s(u)},onSuccess:u=>{this.requestingMap[d]&&(a(u),this.finishRequest(d))},onError:u=>{this.requestingMap[d]&&(i(u),this.finishRequest(d))}},r)});this.config=t}finishRequest(t){delete this.requestingMap[t]}isRequesting(){return Object.keys(this.requestingMap).length>0}}function Jr(e){const{request:t,...n}=e;return f.useMemo(()=>[new Qr({request:t||Zr({baseURL:n.baseURL,model:n.model,dangerouslyApiKey:n.dangerouslyApiKey}).create,...n})],[e==null?void 0:e.baseURL,e==null?void 0:e.dangerouslyApiKey,e==null?void 0:e.model])}const eo=()=>new Promise(e=>setTimeout(e,1e3)),to={ai:{placement:"start",avatar:{icon:W.jsx(Ve,{}),style:{background:"#fde3cf"}},typing:{step:5,interval:20},style:{maxWidth:600}},local:{placement:"end",avatar:{icon:W.jsx(Ve,{}),style:{background:"#87d068"}}}};let Be=!1;const no=()=>{const[e,t]=f.useState(""),[n]=Jr({request:async({message:s},{onSuccess:a,onError:i})=>{await eo(),Be=!Be,Be&&a([`Mock success return. You said: ${s}`]),i(new Error("Mock request failed"))}}),{onRequest:r,messages:o}=Vr({agent:n,requestPlaceholder:"Waiting...",requestFallback:"Mock failed return. Please try again later."});return W.jsxs(pt,{vertical:!0,gap:"middle",children:[W.jsx(qe.List,{roles:to,style:{maxHeight:300},items:o.map(({id:s,message:a,status:i})=>({key:s,loading:i==="loading",role:i==="local"?"local":"ai",content:a}))}),W.jsx(Mt,{loading:n.isRequesting(),value:e,onChange:t,onSubmit:s=>{r(s),t("")}})]})},mo=({close:e})=>W.jsx(yn,{styles:{body:{padding:"0.5rem"}},size:"small",extra:W.jsx(W.Fragment,{children:W.jsx(dt,{onClick:e})}),style:{borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",padding:"0.5rem",overflow:"hidden"},children:W.jsx(no,{})});export{mo as default};
