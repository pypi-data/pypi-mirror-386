{#
Copyright (c) 2024 The Eclipse Foundation

This program and the accompanying materials are made available under the
terms of the Eclipse Public License 2.0 which is available at
http://www.eclipse.org/legal/epl-2.0.

SPDX-License-Identifier: EPL-2.0

Contributors:
    asgomes - Initial definition
#}
<!--
  ~ Copyright (c) {{ year }} The Eclipse Foundation
  ~
  ~ This program and the accompanying materials are made available under the
  ~ terms of the Eclipse Public License 2.0 which is available at
  ~ http://www.eclipse.org/legal/epl-2.0.
  ~
  ~ SPDX-License-Identifier: EPL-2.0
  -->

<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IP Analysis Report</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.0/dist/bootstrap-table.min.css" rel="stylesheet">
</head>
<body>
<div class="container" style="width: 80vw;">
    <h1>IP Analysis Report</h1>

    <div id="toolbar">
        <select class="form-control">
            <option value="all">Export All</option>
            <option value="selected">Export Selected</option>
        </select>
    </div>

    <table id="table"
           data-show-columns="true"
           data-show-toggle="true"
           data-show-export="true"
           data-click-to-select="true"
           data-pagination="true"
           data-search="true"
           data-filter-control="true"
           data-sort-select-options="true"
           data-toolbar="#toolbar">
        <thead>
        <tr>
            <th data-field="state" data-checkbox="true"></th>
            <th data-field="location" data-filter-control="select" data-sortable="true"
                data-tableexport-value="Location">Location
            </th>
            <th data-field="name" data-filter-control="select" data-sortable="true" data-tableexport-value="Name">Name
            </th>
            <th data-field="declared_license" data-filter-control="select" data-sortable="true" data-tableexport-value="Declared License">
                Declared License
            </th>
            <th data-field="license" data-filter-control="select" data-sortable="true" data-tableexport-value="License">
                License
            </th>
            <th data-field="status" data-filter-control="select" data-sortable="true" data-tableexport-value="Status">
                Status
            </th>
            <th data-field="authority" data-filter-control="select" data-sortable="true"
                data-tableexport-value="Authority">Authority
            </th>
        </tr>
        </thead>
        <tbody>
{{ trows }}
        </tbody>
    </table>
</div>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.33.0/tableExport.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.33.0/libs/js-xlsx/xlsx.core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.33.0/libs/jsPDF/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.33.0/libs/pdfmake/pdfmake.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.33.0/libs/pdfmake/vfs_fonts.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.0/dist/bootstrap-table.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.0/dist/extensions/export/bootstrap-table-export.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.23.0/dist/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>
<script>
    $('#table').bootstrapTable({
        exportOptions: {
            fileName: 'IP Analysis Report',
            pdfmake: {
                enabled: true,
                docDefinition: {
                    pageMargins: [20, 20, 20, 20]
                }
            }
        }
    });

</script>
<script>
    let $table = $('#table')

    $(function () {
        $('#toolbar').find('select').change(function () {
            $table.bootstrapTable('destroy').bootstrapTable({
                exportDataType: $(this).val(),
                exportTypes: ['json', 'xml', 'csv', 'txt', 'sql', 'xlsx', 'pdf'],
                columns: [
                    {
                        field: 'state',
                        checkbox: true,
                        visible: $(this).val() === 'selected'
                    },
                    {
                        field: 'location',
                        title: 'Location'
                    },
                    {
                        field: 'name',
                        title: 'Name'
                    },
                    {
                        field: 'declared_license',
                        title: 'Declared License'
                    },
                    {
                        field: 'license',
                        title: 'License'
                    },
                    {
                        field: 'status',
                        title: 'Status'
                    },
                    {
                        field: 'authority',
                        title: 'Authority'
                    }
                ]
            })
        }).trigger('change')
    })
</script>
</body>
</html>
