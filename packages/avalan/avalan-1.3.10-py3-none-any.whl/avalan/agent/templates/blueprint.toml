[agent]
{% if orchestrator.agent_config.get('name') %}
name = "{{ orchestrator.agent_config['name'] }}"
{% endif %}
{% if orchestrator.agent_config.get('system') %}
system = """
{{ orchestrator.agent_config['system'] | indent(4) }}
"""
{% endif %}
{% if orchestrator.agent_config.get('developer') %}
developer = """
{{ orchestrator.agent_config['developer'] | indent(4) }}
"""
{% endif %}
{% if orchestrator.agent_config.get('role') %}
role = """
{{ orchestrator.agent_config['role'] | indent(4) }}
"""
{% endif %}
{% if orchestrator.agent_config.get('task') %}
task = """
{{ orchestrator.agent_config['task'] | indent(4) }}
"""
{% endif %}
{% if orchestrator.agent_config.get('instructions') %}
instructions = """
{{ orchestrator.agent_config['instructions'] | indent(4) }}
"""
{% endif %}
{% if orchestrator.agent_config.get('user') %}
user = """
{{ orchestrator.agent_config['user'] | indent(4) }}
"""
{% endif %}
{% if orchestrator.agent_config.get('user_template') %}
user_template = "{{ orchestrator.agent_config['user_template'] }}"
{% endif %}

[memory]
recent = {{ orchestrator.memory_recent | lower }}
{% if orchestrator.memory_permanent_message %}
permanent_message = "{{ orchestrator.memory_permanent_message }}"
{% endif %}

[memory.engine]
model_id = "{{ orchestrator.sentence_model_id }}"
max_tokens = {{ orchestrator.sentence_model_max_tokens }}
overlap_size = {{ orchestrator.sentence_model_overlap_size }}
window_size = {{ orchestrator.sentence_model_window_size }}

[engine]
uri = "{{ orchestrator.uri }}"

[run]
max_new_tokens = {{ orchestrator.call_options['max_new_tokens'] }}
skip_special_tokens = {{ orchestrator.call_options['skip_special_tokens'] | lower }}
{% if orchestrator.call_options.get('temperature') is not none %}
temperature = {{ orchestrator.call_options['temperature'] }}
{% endif %}
{% if orchestrator.call_options.get('top_k') is not none %}
top_k = {{ orchestrator.call_options['top_k'] }}
{% endif %}
{% if orchestrator.call_options.get('top_p') is not none %}
top_p = {{ orchestrator.call_options['top_p'] }}
{% endif %}
{% if orchestrator.call_options.get('use_cache') is not none %}
use_cache = {{ orchestrator.call_options['use_cache'] | lower }}
{% endif %}
{% if orchestrator.call_options.get('cache_strategy') %}
cache_strategy = "{{ orchestrator.call_options['cache_strategy'] }}"
{% endif %}
{% if orchestrator.call_options.get('chat_settings') %}

[run.chat]
{% for key, value in orchestrator.call_options['chat_settings'].items() %}
{% if value is boolean %}{{ key }} = {{ value | lower }}
{% elif value is number %}{{ key }} = {{ value }}
{% else %}{{ key }} = "{{ value }}"
{% endif %}
{% endfor %}
{% endif %}

{% if orchestrator.tools or tool_format %}
[tool]
{% if tool_format %}format = "{{ tool_format }}"
{% endif %}
{% if orchestrator.tools %}enable = [
{% for tool in orchestrator.tools %}    "{{ tool }}"{% if not loop.last %},{% endif %}
{% endfor %}
]
{% endif %}
{% endif %}

{% if browser_tool %}
[tool.browser.open]
{% for k, v in browser_tool.items() %}
{% if v is boolean %}
{{ k }} = {{ v | lower }}
{% elif v is number %}
{{ k }} = {{ v }}
{% elif v is string %}
{{ k }} = "{{ v }}"
{% endif %}
{% endfor %}
{% endif %}

{% if database_tool %}
[tool.database]
{% for k, v in database_tool.items() %}
{% if v is number %}
{{ k }} = {{ v }}
{% else %}
{{ k }} = "{{ v }}"
{% endif %}
{% endfor %}
{% endif %}
