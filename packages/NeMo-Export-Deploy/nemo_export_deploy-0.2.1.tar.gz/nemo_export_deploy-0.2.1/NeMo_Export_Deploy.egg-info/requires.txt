megatron-core<0.15.0,>=0.14.0a0
megatron-bridge<0.2.0,>=0.1.0a0
accelerate
fastapi
pydantic-settings
ray
ray[serve]
uvicorn
tensorstore
zarr<3.0.0,>=2.18.2
cloudpickle
fiddle
hydra-core<=1.3.2,>1.3
lightning
omegaconf>=2.3.0
peft
torch==2.7.1
torchvision
torchmetrics>=0.11.0
wandb
webdataset>=0.2.86
pyparsing>2.0.2
sentencepiece
tiktoken
einops
ijson
pyarrow<21.0.0

[:platform_system != "Darwin"]
nvidia-pytriton
flashinfer-python>=0.2.5

[:platform_system != "Darwin" and platform_machine != "aarch64"]
Pillow
decord

[:sys_platform != "darwin"]
nvidia-modelopt[torch]<0.34.0,>=0.33.0a0
nvidia-resiliency-ext<0.5.0,>=0.4.0a0
transformer-engine[pytorch]<2.7.0,>=2.6.0a0

[inframework]

[trt-onnx]
tensorrt==10.11.0.33
onnx==1.18.0
transformers==4.51.3

[trtllm]
tensorrt-llm<1.1.0,>=1.0.0a0,>=1.0.0rc6
cuda-python~=12.8.0

[vllm]
vllm~=0.10.1.0
pandas
timm
