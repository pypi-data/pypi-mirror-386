Metadata-Version: 2.4
Name: wxauto4
Version: 40.1.3
Summary: wxauto for 4.0 client
Author: Cluic
Author-email: tikic@qq.com
Requires-Python: >=3.9,<3.14
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Requires-Dist: colorama
Requires-Dist: comtypes
Requires-Dist: pillow
Requires-Dist: psutil
Requires-Dist: pyperclip
Requires-Dist: pywin32
Requires-Dist: tenacity
Description-Content-Type: text/markdown

# wxauto4 - WeChatè‡ªåŠ¨åŒ–å·¥å…·

<p align="center">
  <img src="https://img.shields.io/badge/Version-40.1.1-blue.svg" alt="Version">
  <img src="https://img.shields.io/badge/Python-3.9%2B-blue.svg" alt="Python">
  <img src="https://img.shields.io/badge/Platform-Windows10+-lightgrey.svg" alt="Platform">
  <img src="https://img.shields.io/badge/WeChat-4.0.5-green.svg" alt="WeChat">
</p>

wxauto4 æ˜¯ä¸€ä¸ªé€‚ç”¨äºå¾®ä¿¡4.0å®¢æˆ·ç«¯çš„ Python è‡ªåŠ¨åŒ–åº“ï¼Œæä¾›å¾®ä¿¡è‡ªåŠ¨åŒ–æ“ä½œæ¥å£ï¼ŒåŒ…æ‹¬æ¶ˆæ¯å‘é€ã€æ–‡ä»¶ä¼ è¾“ç­‰åŠŸèƒ½ã€‚

## é‡è¦å£°æ˜

<font color='red'>**ç›®å‰ä»…é€‚ç”¨äºå¾®ä¿¡ 4.0.5 ç‰ˆæœ¬å®¢æˆ·ç«¯**</font>

ä¸‹è½½é“¾æ¥ï¼š[ç‚¹å‡»è·³è½¬](https://github.com/SiverKing/wechat4.0-windows-versions/releases)

> [!Warning]
> è¯·å‹¿ç›´æ¥ç‚¹å‡»Download URLï¼Œæ‰¾åˆ°ç›¸åº”ç‰ˆæœ¬ï¼Œå±•å¼€Assetsç‚¹å‡»exeä¸‹è½½


## å®‰è£…æ–¹å¼

### ä½¿ç”¨ pip å®‰è£…ï¼ˆæ¨èï¼‰

```bash
pip install wxauto4
```
æˆ–è€…é€šè¿‡Github

```bash
pip install git+https://github.com/cluic/wxauto4.git
```

### ä»æºç å®‰è£…

```bash
git clone https://github.com/cluic/wxauto4.git
cd wxauto4
pip install -e .
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

```python
from wxauto4 import WeChat

# åˆ›å»ºå¾®ä¿¡å®ä¾‹
wx = WeChat()

# å‘é€æ¶ˆæ¯
wx.SendMsg('ä½ å¥½ï¼Œä¸–ç•Œï¼', 'å¥½å‹æ˜µç§°')

# å‘é€æ–‡ä»¶
wx.SendFiles(r'C:\path\to\file.txt', 'å¥½å‹æ˜µç§°')

# è·å–æ¶ˆæ¯
messages = wx.GetAllMessage()
for msg in messages:
    print(msg.content)
```


## æ–‡æ¡£

### 1. è·å–å¾®ä¿¡å®ä¾‹

```python
from wxauto4 import WeChat

# åˆ›å»ºå¾®ä¿¡ä¸»çª—å£å®ä¾‹
wx = WeChat()
```

### 2. å‘é€æ¶ˆæ¯ - SendMsg

```python
# åŸºç¡€æ¶ˆæ¯å‘é€
wx.SendMsg('Hello!', 'ç›®æ ‡ç”¨æˆ·')
```

**å‚æ•°è¯´æ˜ï¼š**
- `msg` (str): æ¶ˆæ¯å†…å®¹
- `who` (str, optional): å‘é€å¯¹è±¡ï¼Œä¸æŒ‡å®šåˆ™å‘é€ç»™å½“å‰èŠå¤©å¯¹è±¡
- `clear` (bool, optional): å‘é€åæ˜¯å¦æ¸…ç©ºç¼–è¾‘æ¡†ï¼Œé»˜è®¤ True
- `at` (Union[str, List[str]], optional): @å¯¹è±¡ï¼Œæ”¯æŒå­—ç¬¦ä¸²æˆ–åˆ—è¡¨
- `exact` (bool, optional): æ˜¯å¦ç²¾ç¡®åŒ¹é…ç”¨æˆ·åï¼Œé»˜è®¤ False

### 3. å‘é€æ–‡ä»¶ - SendFiles

```python
# å‘é€å•ä¸ªæ–‡ä»¶
wx.SendFiles(r'C:\path\to\file.txt', 'ç›®æ ‡ç”¨æˆ·')

# å‘é€å¤šä¸ªæ–‡ä»¶
files = [
    r'C:\path\to\file1.txt',
    r'C:\path\to\file2.jpg',
    r'C:\path\to\file3.pdf'
]
wx.SendFiles(files, 'ç›®æ ‡ç”¨æˆ·')

# å‘å½“å‰èŠå¤©çª—å£å‘é€æ–‡ä»¶
wx.SendFiles(r'C:\path\to\file.txt')
```

**å‚æ•°è¯´æ˜ï¼š**
- `filepath` (str|list): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæ”¯æŒå•ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶åˆ—è¡¨
- `who` (str, optional): å‘é€å¯¹è±¡ï¼Œä¸æŒ‡å®šåˆ™å‘é€ç»™å½“å‰èŠå¤©å¯¹è±¡
- `exact` (bool, optional): æ˜¯å¦ç²¾ç¡®åŒ¹é…ç”¨æˆ·åï¼Œé»˜è®¤ False

### 4. è·å–æ¶ˆæ¯ - GetAllMessage

```python
# è·å–å½“å‰èŠå¤©çª—å£çš„æ‰€æœ‰æ¶ˆæ¯
all_messages = wx.GetAllMessage()
```

**è¿”å›å€¼ï¼š**
- `List[Message]`: æ¶ˆæ¯åˆ—è¡¨ï¼Œæ¯ä¸ªæ¶ˆæ¯å¯¹è±¡åŒ…å«å‘é€è€…ã€å†…å®¹ã€æ—¶é—´ã€ç±»å‹ç­‰ä¿¡æ¯

### 5. ç›‘å¬æ¶ˆæ¯ - AddListenChat

```python
def on_message(msg, chat):
    """æ¶ˆæ¯å›è°ƒå‡½æ•°"""
    print(f'æ”¶åˆ°æ¥è‡ª {chat} çš„æ¶ˆæ¯: {msg.content}', flush=True)
    
    # è‡ªåŠ¨å›å¤
    if msg.content == 'hello':
        chat.SendMsg('Hello! æˆ‘æ˜¯xxx')

# æ·»åŠ æ¶ˆæ¯ç›‘å¬
wx.AddListenChat('å¥½å‹æ˜µç§°', on_message)
```

**å‚æ•°è¯´æ˜ï¼š**
- `who` (str|List[str]): ç›‘å¬å¯¹è±¡ï¼Œæ”¯æŒå•ä¸ªæˆ–å¤šä¸ª
- `callback` (Callable): å›è°ƒå‡½æ•°ï¼Œæ¥æ”¶ `(msg, chat)` ä¸¤ä¸ªå‚æ•°

### 6. ç§»é™¤ç›‘å¬ - RemoveListenChat

```python
# ç§»é™¤ç‰¹å®šå¯¹è±¡çš„ç›‘å¬
wx.RemoveListenChat('å¥½å‹æ˜µç§°')

# åœæ­¢æ‰€æœ‰ç›‘å¬
wx.StopListening()
```

### 7. åˆ‡æ¢èŠå¤©çª—å£ - ChatWith

```python
# åˆ‡æ¢åˆ°æŒ‡å®šèŠå¤©çª—å£
wx.ChatWith('å¥½å‹æ˜µç§°')
```

**å‚æ•°è¯´æ˜ï¼š**
- `who` (str): è¦åˆ‡æ¢åˆ°çš„èŠå¤©å¯¹è±¡
- `exact` (bool, optional): æ˜¯å¦ç²¾ç¡®åŒ¹é…åç§°

### 8. è·å–å­çª—å£å®ä¾‹ - GetSubWindow

```python
# è·å–æŒ‡å®šèŠå¤©çš„å­çª—å£
chat_window = wx.GetSubWindow('å¥½å‹æ˜µç§°')

# é€šè¿‡å­çª—å£å‘é€æ¶ˆæ¯ï¼ˆä¸ä¼šåˆ‡æ¢ä¸»çª—å£ï¼‰
chat_window.SendMsg('è¿™æ˜¯é€šè¿‡å­çª—å£å‘é€çš„æ¶ˆæ¯')

# è·å–å­çª—å£ä¿¡æ¯
info = chat_window.ChatInfo()
print(f'èŠå¤©å¯¹è±¡: {info["chat_name"]}')

# å…³é—­å­çª—å£
chat_window.Close()
```

### 9. è·å–æ‰€æœ‰å­çª—å£å®ä¾‹ - GetAllSubWindow

```python
# è·å–æ‰€æœ‰æ‰“å¼€çš„å­çª—å£
all_windows = wx.GetAllSubWindow()

for window in all_windows:
    print(f'çª—å£: {window.who}')
    # å¯ä»¥å¯¹æ¯ä¸ªçª—å£è¿›è¡Œæ“ä½œ
    window.SendMsg('æ‰¹é‡æ¶ˆæ¯å‘é€')
    
# å…³é—­æ‰€æœ‰å­çª—å£
for window in all_windows:
    window.Close()
```

### 10. åœæ­¢ç›‘å¬ - StopListening

```python
# åœæ­¢æ‰€æœ‰æ¶ˆæ¯ç›‘å¬
wx.StopListening()

# ç¨‹åºç»“æŸå‰å»ºè®®åœæ­¢ç›‘å¬
try:
    wx.SendMsg('ç¨‹åºå³å°†ç»“æŸ', 'ç®¡ç†å‘˜')
finally:
    wx.StopListening()
```

### 11. å…³é—­æ›´æ–°çª—å£

```python
from wxauto4.ui.component import UpdateWindow

if update_window := UpdateWindow():
    update_window.ignore()
```
---

**å…è´£å£°æ˜**: æœ¬å·¥å…·ä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ï¼Œä½¿ç”¨è€…åº”å½“éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œä½œè€…ä¸æ‰¿æ‹…ä»»ä½•å› ä½¿ç”¨æœ¬å·¥å…·è€Œäº§ç”Ÿçš„æ³•å¾‹è´£ä»»ã€‚
