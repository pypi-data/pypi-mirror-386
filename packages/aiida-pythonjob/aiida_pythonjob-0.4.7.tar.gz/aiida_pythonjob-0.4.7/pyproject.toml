[build-system]
requires = ["setuptools>=68", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "aiida-pythonjob"
dynamic = ["version"]  # read from src/aiida_pythonjob/__init__.py via setuptools
description = "Run Python functions on a remote computer."
authors = [{name = "Xing Wang", email = "xingwang1991@gmail.com"}]
readme = "README.md"
license = {file = "LICENSE"}
classifiers = [
    "Programming Language :: Python",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: MIT License",
    "Natural Language :: English",
    "Development Status :: 3 - Alpha",
    "Framework :: AiiDA"
]
keywords = ["aiida", "plugin"]
requires-python = ">=3.9"
dependencies = [
    "aiida-core>=2.7.1,<3",
    "ase",
    "node-graph~=0.4.0",
]

[project.optional-dependencies]
test = [
  "pgtest~=1.3,>=1.3.1",
  "coverage~=7.0",
  "pytest~=7.0",
  "pytest-cov~=4.1",
  "ipdb"
]
pre-commit = [
  "pre-commit~=3.5",
]
docs = [
  "sphinx_rtd_theme",
  "sphinx",
  "sphinxcontrib-contentui",
  "sphinxcontrib-details-directive",
  "sphinx-gallery",
  "furo",
  "markupsafe<2.1",
  "nbsphinx"
]

[project.urls]
Source = "https://github.com/aiidateam/aiida-pythonjob"

[project.entry-points."aiida.data"]
"pythonjob.jsonable_data" = "aiida_pythonjob.data.jsonable_data:JsonableData"
"pythonjob.ase.atoms.Atoms" = "aiida_pythonjob.data.atoms:AtomsData"
"pythonjob.builtins.NoneType" = "aiida_pythonjob.data.common_data:NoneData"
"pythonjob.datetime.datetime" = "aiida_pythonjob.data.common_data:DateTimeData"

[project.entry-points."aiida.calculations"]
"pythonjob.pythonjob" = "aiida_pythonjob.calculations.pythonjob:PythonJob"

[project.entry-points."aiida.parsers"]
"pythonjob.pythonjob" = "aiida_pythonjob.parsers.pythonjob:PythonJobParser"

[tool.setuptools]
package-dir = {"" = "src"}

[tool.setuptools.packages.find]
where = ["src"]
include = ["aiida_pythonjob*"]

[tool.setuptools.dynamic]
version = {attr = "aiida_pythonjob.__version__"}

[tool.pytest.ini_options]
python_files = "test_*.py example_*.py"
addopts = "--pdbcls=IPython.terminal.debugger:TerminalPdb"
filterwarnings = [
  "ignore::DeprecationWarning:aiida:",
  "ignore:Creating AiiDA configuration folder:",
  "ignore::DeprecationWarning:plumpy:",
  "ignore::DeprecationWarning:yaml:",
]

[tool.coverage.run]
source = ["src/aiida_pythonjob"]

[tool.ruff]
line-length = 121

[tool.ruff.lint]
ignore = [
  "F403",
  "F405",
  "F821",
  "F722",
  "E203",
  "PLR0911",
  "PLR0912",
  "PLR0913",
  "PLR0915",
  "PLR2004",
  "RUF005",
  "RUF012"
]
select = ["E", "W", "F", "I", "N", "PLC", "PLE", "PLR", "PLW", "RUF"]
