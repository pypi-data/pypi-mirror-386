"""Audio loading and normalization utilities using librosa."""

# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/librosa.ipynb.

# %% auto 0
__all__ = ['load_audio']

# %% ../nbs/librosa.ipynb 3
from typing import Tuple
import librosa
import numpy as np

# %% ../nbs/librosa.ipynb 4
def load_audio(
    audio_path: str,  # Path to the audio file to load
    target_sr: int = 16000  # Target sample rate for resampling
) -> Tuple[np.ndarray, int]:  # Tuple of (normalized audio array, sample rate)
    """Load and normalize audio file"""
    y, sr = librosa.load(audio_path, sr=target_sr, mono=True)
    # Normalize lightly
    peak = np.max(np.abs(y)) if len(y) else 0.0
    if peak > 0:
        y = y / peak
    return y.astype(np.float32), sr
