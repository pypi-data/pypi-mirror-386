# B31_MCPãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆã‚¬ã‚¤ãƒ‰

æœ€çµ‚æ›´æ–°: 2025-09-02
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: v1.0.0
å¯¾è±¡: ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºè€…ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ

## ğŸ“‹ æ¦‚è¦

å°èª¬åŸ·ç­†æ”¯æ´ã‚·ã‚¹ãƒ†ãƒ ã«ãŠã‘ã‚‹MCPãƒ„ãƒ¼ãƒ«ã®ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–è¨­è¨ˆåŸå‰‡ã¨å®Ÿè£…æŒ‡é‡ã€‚å˜ä¸€è²¬ä»»ãƒ»ç‹¬ç«‹å®Ÿè¡Œãƒ»å†å®Ÿè¡Œå¯èƒ½æ€§ã‚’æ ¸ã¨ã—ãŸåŠ¹ç‡çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­è¨ˆã‚¬ã‚¤ãƒ‰ã€‚

### ğŸ¯ è¨­è¨ˆç›®çš„

- **LLMãƒ„ãƒ¼ãƒ«é¸æŠç²¾åº¦ã®å‘ä¸Š**: ç›®çš„æ˜ç¢ºãªãƒ„ãƒ¼ãƒ«åã«ã‚ˆã‚‹é©åˆ‡ãªé¸æŠ
- **ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«ã®åŠ¹ç‡åŒ–**: ãƒã‚§ãƒƒã‚¯â†’ä¿®æ­£â†’å†ãƒã‚§ãƒƒã‚¯ã®æœ€é©åŒ–
- **ä¸¦åˆ—å®Ÿè¡Œã«ã‚ˆã‚‹é«˜é€ŸåŒ–**: ç‹¬ç«‹æ€§ã‚’æ´»ã‹ã—ãŸä¸¦åˆ—å‡¦ç†
- **æ‹¡å¼µæ€§ã®ç¢ºä¿**: æ–°æ©Ÿèƒ½è¿½åŠ ã®å®¹æ˜“æ€§

---

## ğŸ—ï¸ è¨­è¨ˆåŸå‰‡ï¼ˆSPEC-MCP-001æº–æ‹ ï¼‰

### 1. ã‚³ã‚¢åŸå‰‡

#### 1.1 å˜ä¸€è²¬ä»»åŸå‰‡ï¼ˆSingle Responsibility Principleï¼‰
```
âŒ æ‚ªã„ä¾‹: check_all â†’ å…¨ãƒã‚§ãƒƒã‚¯ã‚’1ã¤ã®ãƒ„ãƒ¼ãƒ«ã§å®Ÿè¡Œ
âœ… è‰¯ã„ä¾‹: check_basic, check_story_elements, check_writing_expression â†’ å„ã€…ãŒå°‚é–€çš„ãªãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
```

**ãƒ¡ãƒªãƒƒãƒˆ**:
- LLMãŒæ­£ç¢ºã«ãƒ„ãƒ¼ãƒ«ã‚’é¸æŠã§ãã‚‹
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®å½±éŸ¿ç¯„å›²ãŒé™å®šã•ã‚Œã‚‹
- å€‹åˆ¥ã®æ”¹å–„ãƒ»æ‹¡å¼µãŒå®¹æ˜“

#### 1.2 ç‹¬ç«‹æ€§ï¼ˆIndependenceï¼‰
```python
# å„ãƒ„ãƒ¼ãƒ«ã¯ç‹¬ç«‹ã—ã¦å®Ÿè¡Œå¯èƒ½
mcp__noveler__check_story_elements(episode=3)  # ä»–ã®ãƒ„ãƒ¼ãƒ«ã«ä¾å­˜ã—ãªã„
mcp__noveler__check_writing_expression(episode=3)  # ç‹¬ç«‹ã—ã¦å®Ÿè¡Œå¯èƒ½
```

**å®Ÿè£…è¦ä»¶**:
- ä»–ã®ãƒ„ãƒ¼ãƒ«ã®å®Ÿè¡ŒçŠ¶æ…‹ã«ä¾å­˜ã—ãªã„
- å¿…è¦ãªæƒ…å ±ã¯å¼•æ•°ã§æ˜ç¤ºçš„ã«å—ã‘å–ã‚‹
- å…±æœ‰çŠ¶æ…‹ã¸ã®ä¾å­˜ã‚’æœ€å°åŒ–

#### 1.3 å†å®Ÿè¡Œå¯èƒ½æ€§ï¼ˆIdempotencyï¼‰
```python
# åŒã˜å…¥åŠ›ã«å¯¾ã—ã¦åŒã˜çµæœã‚’è¿”ã™ï¼ˆå†ªç­‰æ€§ï¼‰
result1 = mcp__noveler__check_basic(episode=1)
result2 = mcp__noveler__check_basic(episode=1)
assert result1.issues == result2.issues  # åŒã˜å•é¡Œã‚’æ¤œå‡º
```

#### 1.4 æ®µéšçš„ä¿®æ­£å¯¾å¿œï¼ˆIncremental Correctionï¼‰
```python
# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¾‹
issues = mcp__noveler__noveler_check(episode=1)  # å…¨å•é¡Œã‚’ç™ºè¦‹
mcp__noveler__check_fix(episode=1, fix_level="safe")  # å®‰å…¨ãªä¿®æ­£ã®ã¿
remaining = mcp__noveler__check_basic(episode=1)  # åŸºæœ¬å•é¡Œã®å†ãƒã‚§ãƒƒã‚¯
```

### 2. å‘½åè¦å‰‡

#### 2.1 ä¸»è¦ãƒ„ãƒ¼ãƒ«
- **å‹•ä½œ**ã‚’è¡¨ã™å‹•è©ã‚’ä½¿ç”¨
- ã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ã„åå‰

```
noveler_write  # åŸ·ç­†ï¼ˆ19ã‚¹ãƒ†ãƒƒãƒ—ä¸€æ‹¬ï¼šæ§‹é€ è¨­è¨ˆâ†’å“è³ªä¿è¨¼ï¼‰
noveler_check  # å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆ3æ®µéšï¼‰
noveler_plot   # ãƒ—ãƒ­ãƒƒãƒˆç”Ÿæˆ
status         # çŠ¶æ³ç¢ºèª
noveler_complete # å®Œäº†å‡¦ç†
```

#### 2.2 å°‚é–€ãƒ„ãƒ¼ãƒ«
- **æ©Ÿèƒ½**_**å¯¾è±¡**å½¢å¼
- ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã§æ©Ÿèƒ½ã¨å¯¾è±¡ã‚’åˆ†é›¢

```
write_stage             # åŸ·ç­†_ã‚¹ãƒ†ãƒ¼ã‚¸
write_resume            # åŸ·ç­†_å†é–‹
check_basic             # ãƒã‚§ãƒƒã‚¯_åŸºæœ¬
check_story_elements    # ãƒã‚§ãƒƒã‚¯_å°èª¬è¦ç´ 
check_writing_expression# ãƒã‚§ãƒƒã‚¯_æ–‡ç« è¡¨ç¾
check_story_structure   # ãƒã‚§ãƒƒã‚¯_æ§‹æˆ
```

> `plot_generate` / `plot_validate` / `init` ã¯ 2025-09-18 ã«å»ƒæ­¢ã•ã‚Œã€`noveler_plot` ã¨å“è³ªãƒã‚§ãƒƒã‚¯ç³»ãƒ„ãƒ¼ãƒ«ã¸å½¹å‰²ãŒçµ±åˆã•ã‚Œã¾ã—ãŸã€‚

#### 2.3 ä¿®æ­£ç³»ãƒ„ãƒ¼ãƒ«
- çµ±åˆçš„ãªä¿®æ­£æ©Ÿèƒ½
- ãƒ¬ãƒ™ãƒ«æŒ‡å®šã«ã‚ˆã‚‹åˆ¶å¾¡

```
check_fix  # ä¿®æ­£ï¼ˆsafe/standard/aggressiveãƒ¬ãƒ™ãƒ«å¯¾å¿œï¼‰
```

---

## ğŸ”§ å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 1. ãƒ„ãƒ¼ãƒ«åˆ†é¡ä½“ç³»

```
MCPãƒ„ãƒ¼ãƒ«ï¼ˆ17å€‹ï¼‰
â”œâ”€â”€ åŸ·ç­†é–¢é€£ï¼ˆ3å€‹ï¼‰
â”‚   â”œâ”€â”€ noveler_write  # ãƒ¡ã‚¤ãƒ³åŸ·ç­†ï¼ˆ19ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
â”‚   â”œâ”€â”€ write_stage    # éƒ¨åˆ†åŸ·ç­†
â”‚   â””â”€â”€ write_resume   # å†é–‹
â”œâ”€â”€ å“è³ªãƒã‚§ãƒƒã‚¯é–¢é€£ï¼ˆ7å€‹ï¼‰
â”‚   â”œâ”€â”€ noveler_check  # å®Œå…¨ãƒã‚§ãƒƒã‚¯
â”‚   â”œâ”€â”€ check_basic    # åŸºæœ¬ãƒã‚§ãƒƒã‚¯
â”‚   â”œâ”€â”€ check_story_elements     # å°èª¬è¦ç´ ï¼ˆ68é …ç›®ï¼‰
â”‚   â”œâ”€â”€ check_story_structure    # ã‚¹ãƒˆãƒ¼ãƒªãƒ¼æ§‹æˆ
â”‚   â”œâ”€â”€ check_writing_expression # æ–‡ç« è¡¨ç¾
â”‚   â”œâ”€â”€ check_rhythm   # æ–‡ç« ãƒªã‚ºãƒ 
â”‚   â””â”€â”€ check_fix      # è‡ªå‹•ä¿®æ­£
â”œâ”€â”€ ãƒ—ãƒ­ãƒƒãƒˆé–¢é€£ï¼ˆ1å€‹ï¼‰
â”‚   â””â”€â”€ noveler_plot   # ãƒ—ãƒ­ãƒƒãƒˆç”Ÿæˆ
â”œâ”€â”€ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ï¼ˆ2å€‹ï¼‰
â”‚   â”œâ”€â”€ status         # çŠ¶æ³ç¢ºèª
â”‚   â””â”€â”€ noveler_complete # å®Œäº†å‡¦ç†
â””â”€â”€ JSONå¤‰æ›ï¼ˆ3å€‹ï¼‰
    â”œâ”€â”€ convert_cli_to_json
    â”œâ”€â”€ validate_json_response
    â””â”€â”€ get_file_reference_info
```

> **åŸ·ç­†ãƒ„ãƒ¼ãƒ«ã®LLMåˆ¶å¾¡**: `noveler_write` ã¨é–¢é€£ã‚¹ãƒ†ãƒƒãƒ—ã¯ `defaults.writing_steps.use_llm`ï¼ˆconfig/novel_config.yamlï¼‰ã§ LLM ä½¿ç”¨å¯å¦ã‚’åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã€‚ãƒ¢ãƒƒã‚¯å®Ÿè¡Œæ™‚ã¯ `false`ã€æœ¬ç•ªç’°å¢ƒã¯ `true` ã‚’æ¨å¥¨ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å¿…é ˆã‚­ãƒ¼ã¨æ§‹é€ ã¯ `docs/technical/prompt_template_schema_v2.md` ã‚’æº€ãŸã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### 2. ãƒ„ãƒ¼ãƒ«ä»•æ§˜ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```python
@self.server.tool(
    name="tool_name",
    description="""å…·ä½“çš„ãªæ©Ÿèƒ½èª¬æ˜ - ä½•ã‚’ãƒã‚§ãƒƒã‚¯/å®Ÿè¡Œã™ã‚‹ã‹ã‚’æ˜è¨˜:
    â€¢ é …ç›®1: å…·ä½“çš„ãªå†…å®¹
    â€¢ é …ç›®2: å…·ä½“çš„ãªå†…å®¹
    â€¢ é …ç›®3: å…·ä½“çš„ãªå†…å®¹""",
)
def tool_function(
    episode: int,                    # å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    optional_param: bool = False,    # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    project_root: str | None = None  # å…±é€šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
) -> str:
    """ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œé–¢æ•°"""
    try:
        # å®Ÿè£…ãƒ­ã‚¸ãƒƒã‚¯
        result = self._execute_noveler_command(cmd, project_root)
        return self._format_tool_result(result, "æ“ä½œå")
    except Exception as e:
        self.logger.exception("ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°")
        return f"ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {e}"
```

### 3. å…±é€šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­è¨ˆ

#### 3.1 å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
```json
{
  "episode": {
    "type": "integer",
    "description": "å¯¾è±¡ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ç•ªå·",
    "required": true
  }
}
```

#### 3.2 ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
```json
{
  "project_root": {
    "type": "string",
    "description": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ï¼ˆçœç•¥æ™‚ã¯ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰",
    "required": false
  },
  "auto_fix": {
    "type": "boolean",
    "default": false,
    "description": "è‡ªå‹•ä¿®æ­£ã‚’æœ‰åŠ¹åŒ–"
  },
  "fix_level": {
    "type": "string",
    "enum": ["safe", "standard", "aggressive"],
    "default": "safe",
    "description": "ä¿®æ­£ã®ç©æ¥µæ€§ãƒ¬ãƒ™ãƒ«"
  }
}
```

### 4. ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼çµ±ä¸€

```json
{
  "success": "boolean",
  "command": "string",
  "output": "string",
  "stderr": "string",
  "execution_time_seconds": "number",
  "project_root": "string"
}
```

---

## ğŸ“Š å“è³ªãƒã‚§ãƒƒã‚¯é …ç›®è¨­è¨ˆ

### 1. éšå±¤æ§‹é€ 

```
å“è³ªãƒã‚§ãƒƒã‚¯
â”œâ”€â”€ Level 1: åŸºæœ¬ãƒã‚§ãƒƒã‚¯ï¼ˆcheck_basicï¼‰
â”‚   â”œâ”€â”€ æ–‡å­—æ•°ãƒã‚§ãƒƒã‚¯
â”‚   â”œâ”€â”€ ç¦æ­¢è¡¨ç¾æ¤œå‡º
â”‚   â”œâ”€â”€ åŸºæœ¬çš„ãªæ–‡ç« æ§‹é€ 
â”‚   â””â”€â”€ èª¤å­—è„±å­—å¯èƒ½æ€§
â”œâ”€â”€ Level 2: å°èª¬è¦ç´ ãƒã‚§ãƒƒã‚¯ï¼ˆcheck_story_elementsï¼‰
â”‚   â”œâ”€â”€ æ„Ÿæƒ…æå†™ï¼ˆ12é …ç›®ï¼‰
â”‚   â”œâ”€â”€ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼ˆ12é …ç›®ï¼‰
â”‚   â”œâ”€â”€ ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å±•é–‹ï¼ˆ12é …ç›®ï¼‰
â”‚   â”œâ”€â”€ æ–‡ç« è¡¨ç¾ï¼ˆ12é …ç›®ï¼‰
â”‚   â”œâ”€â”€ ä¸–ç•Œè¦³ãƒ»è¨­å®šï¼ˆ10é …ç›®ï¼‰
â”‚   â””â”€â”€ èª­è€…ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆï¼ˆ10é …ç›®ï¼‰
â”œâ”€â”€ Level 3: å°‚é–€ãƒã‚§ãƒƒã‚¯
â”‚   â”œâ”€â”€ ã‚¹ãƒˆãƒ¼ãƒªãƒ¼æ§‹æˆï¼ˆcheck_story_structureï¼‰
â”‚   â”œâ”€â”€ æ–‡ç« è¡¨ç¾åŠ›ï¼ˆcheck_writing_expressionï¼‰
â”‚   â””â”€â”€ æ–‡ç« ãƒªã‚ºãƒ ï¼ˆcheck_rhythmï¼‰
â””â”€â”€ Level 4: è‡ªå‹•ä¿®æ­£ï¼ˆcheck_fixï¼‰
```

### 2. ãƒã‚§ãƒƒã‚¯é …ç›®è©³ç´°è¨­è¨ˆ

#### æ„Ÿæƒ…æå†™ï¼ˆ12é …ç›®ï¼‰ã®ä¾‹
```yaml
emotion_expression:
  items:
    - name: "æ„Ÿæƒ…è¡¨ç¾ã®å…·ä½“æ€§"
      description: "ã€Œæ€’ã‚Šã€ã€Œå–œã³ã€ç­‰ã®æ„Ÿæƒ…ãŒå…·ä½“çš„ã«è¡¨ç¾ã•ã‚Œã¦ã„ã‚‹ã‹"
      weight: 8.5
    - name: "èª­è€…å…±æ„Ÿæ€§"
      description: "èª­è€…ãŒå…±æ„Ÿã§ãã‚‹æ„Ÿæƒ…æå†™ã«ãªã£ã¦ã„ã‚‹ã‹"
      weight: 9.0
    - name: "æ„Ÿæƒ…å¤‰åŒ–ã®è«–ç†æ€§"
      description: "æ„Ÿæƒ…å¤‰åŒ–ã«è«–ç†æ€§ãŒã‚ã‚‹ã‹"
      weight: 7.5
    # ... æ®‹ã‚Š9é …ç›®
```

---

## ğŸš€ å®Ÿè£…æ‰‹é †

### 1. æ–°è¦ãƒ„ãƒ¼ãƒ«è¿½åŠ æ‰‹é †

#### Step 1: æ©Ÿèƒ½è¦ä»¶å®šç¾©
```markdown
## æ–°ãƒ„ãƒ¼ãƒ«: check_dialogue_naturalness
**ç›®çš„**: ä¼šè©±æ–‡ã®è‡ªç„¶ã•ã‚’ãƒã‚§ãƒƒã‚¯
**å¯¾è±¡**: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®å°è©ãƒ»ä¼šè©±ã®æµã‚Œ
**ãƒã‚§ãƒƒã‚¯é …ç›®**:
- å£èª¿ã®ä¸€è²«æ€§
- è©±ã—æ–¹ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ€§
- ä¼šè©±ã®è‡ªç„¶ãªæµã‚Œ
```

#### Step 2: ãƒ„ãƒ¼ãƒ«å®Ÿè£…
```python
@self.server.tool(
    name="check_dialogue_naturalness",
    description="""ä¼šè©±æ–‡ã®è‡ªç„¶ã•ãƒã‚§ãƒƒã‚¯ - ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å°è©ã®å“è³ªã‚’è©•ä¾¡:
    â€¢ å£èª¿ã®ä¸€è²«æ€§: ãã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚‰ã—ã„è©±ã—æ–¹ãŒç¶­æŒã•ã‚Œã¦ã„ã‚‹ã‹
    â€¢ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ€§: å€‹æ€§çš„ã§é­…åŠ›çš„ãªè©±ã—æ–¹ã«ãªã£ã¦ã„ã‚‹ã‹
    â€¢ ä¼šè©±ã®æµã‚Œ: è‡ªç„¶ã§ç¾å®Ÿçš„ãªä¼šè©±ã®å±•é–‹ã«ãªã£ã¦ã„ã‚‹ã‹""",
)
def check_dialogue_naturalness(episode: int, character_focus: str | None = None, project_root: str | None = None) -> str:
    # å®Ÿè£…
```

#### Step 3: ãƒ†ã‚¹ãƒˆä½œæˆ
```python
def test_check_dialogue_naturalness():
    result = mcp__noveler__check_dialogue_naturalness(episode=1)
    assert result.success
    assert len(result.issues) >= 0
```

#### Step 4: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- SPEC-MCP-001.mdã®æä¾›ãƒ„ãƒ¼ãƒ«ä¸€è¦§ã«è¿½åŠ 
- B33_MCPãƒ„ãƒ¼ãƒ«çµ±åˆã‚¬ã‚¤ãƒ‰.mdã«ä½¿ç”¨ä¾‹ã‚’è¿½åŠ 

### 2. æ—¢å­˜ãƒ„ãƒ¼ãƒ«æ”¹è‰¯æ‰‹é †

#### Step 1: æ”¹è‰¯è¦ä»¶å®šç¾©
#### Step 2: å¾Œæ–¹äº’æ›æ€§ç¢ºèª
#### Step 3: æ®µéšçš„ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ
#### Step 4: æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³å»ƒæ­¢äºˆå‘Š

---

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶

### 1. å®Ÿè¡Œæ™‚é–“è¦ä»¶

| ãƒ„ãƒ¼ãƒ«åˆ†é¡ | ç›®æ¨™å®Ÿè¡Œæ™‚é–“ | æœ€å¤§è¨±å®¹æ™‚é–“ |
|-----------|-------------|-------------|
| åŸºæœ¬ãƒã‚§ãƒƒã‚¯ | 1ç§’ä»¥ä¸‹ | 3ç§’ |
| å°èª¬è¦ç´ ãƒã‚§ãƒƒã‚¯ | 2ç§’ä»¥ä¸‹ | 5ç§’ |
| å°‚é–€ãƒã‚§ãƒƒã‚¯ | 2ç§’ä»¥ä¸‹ | 5ç§’ |
| åŸ·ç­†ãƒ„ãƒ¼ãƒ« | 30ç§’ä»¥ä¸‹ | 60ç§’ |
| ãƒ—ãƒ­ãƒƒãƒˆç”Ÿæˆ | 10ç§’ä»¥ä¸‹ | 20ç§’ |

### 2. ä¸¦åˆ—å®Ÿè¡Œè¨­è¨ˆ

```python
# è¤‡æ•°ãƒã‚§ãƒƒã‚¯ã®ä¸¦åˆ—å®Ÿè¡Œ
import asyncio

async def parallel_quality_check(episode: int):
    tasks = [
        check_basic_async(episode),
        check_story_elements_async(episode),
        check_rhythm_async(episode)
    ]
    results = await asyncio.gather(*tasks)
    return combine_results(results)
```

### 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

```python
# çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
@lru_cache(maxsize=128)
def cached_check_basic(episode: int, content_hash: str):
    # åŒã˜ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å¯¾ã™ã‚‹é‡è¤‡ãƒã‚§ãƒƒã‚¯ã‚’å›é¿
```

---

## ğŸ” ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### 1. ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

```python
class TestMCPTools:
    def test_tool_independence(self):
        """å„ãƒ„ãƒ¼ãƒ«ã®ç‹¬ç«‹æ€§ãƒ†ã‚¹ãƒˆ"""
        result1 = mcp__noveler__check_basic(episode=1)
        result2 = mcp__noveler__check_story_elements(episode=1)
        # äº’ã„ã«å½±éŸ¿ã—ãªã„ã“ã¨ã‚’ç¢ºèª

    def test_idempotency(self):
        """å†ªç­‰æ€§ãƒ†ã‚¹ãƒˆ"""
        result1 = mcp__noveler__check_basic(episode=1)
        result2 = mcp__noveler__check_basic(episode=1)
        assert result1 == result2
```

### 2. çµ±åˆãƒ†ã‚¹ãƒˆ

```python
def test_workflow_integration():
    """ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆ"""
    # 1. åŸºæœ¬ãƒã‚§ãƒƒã‚¯
    basic_result = mcp__noveler__check_basic(episode=1)

    # 2. å•é¡Œä¿®æ­£
    if not basic_result.success:
        mcp__noveler__check_fix(episode=1, fix_level="safe")

    # 3. å†ãƒã‚§ãƒƒã‚¯
    recheck_result = mcp__noveler__check_basic(episode=1)
    assert recheck_result.issues_count < basic_result.issues_count
```

---

## ğŸ“š æ‹¡å¼µã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### 1. æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã®åˆ¤æ–­åŸºæº–

#### æ–°ãƒ„ãƒ¼ãƒ«ä½œæˆæ¡ä»¶
- å˜ä¸€ã®æ˜ç¢ºãªè²¬ä»»ã‚’æŒã¤
- æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã§ã¯å¯¾å¿œã§ããªã„å°‚é–€æ€§
- ç‹¬ç«‹ã—ã¦ä¾¡å€¤ã‚’æä¾›ã§ãã‚‹

#### æ—¢å­˜ãƒ„ãƒ¼ãƒ«æ‹¡å¼µæ¡ä»¶
- æ—¢å­˜ã®è²¬ä»»ç¯„å›²å†…
- å¾Œæ–¹äº’æ›æ€§ã‚’ç¶­æŒå¯èƒ½
- è¤‡é›‘åº¦ãŒè‘—ã—ãå¢—åŠ ã—ãªã„

### 2. APIè¨­è¨ˆæŒ‡é‡

#### RESTfulè¨­è¨ˆã®é©ç”¨
```
GET    /check/{episode}           # ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
POST   /fix/{episode}             # ä¿®æ­£å®Ÿè¡Œ
GET    /status/{project}          # çŠ¶æ³ç¢ºèª
POST   /init/{project_name}       # åˆæœŸåŒ–
```

#### ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æˆ¦ç•¥
```python
# ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°
v1.0.0  # ãƒ¡ã‚¸ãƒ£ãƒ¼.ãƒã‚¤ãƒŠãƒ¼.ãƒ‘ãƒƒãƒ
v2.0.0  # å¾Œæ–¹äº’æ›æ€§ã‚’ç ´ã‚‹å¤‰æ›´
v1.1.0  # æ–°æ©Ÿèƒ½è¿½åŠ ï¼ˆå¾Œæ–¹äº’æ›ã‚ã‚Šï¼‰
v1.0.1  # ãƒã‚°ä¿®æ­£
```

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **SPEC-MCP-001.md**: è©³ç´°ä»•æ§˜æ›¸
- **B33_MCPãƒ„ãƒ¼ãƒ«çµ±åˆã‚¬ã‚¤ãƒ‰.md**: å®Ÿç”¨ã‚¬ã‚¤ãƒ‰
- **A32_åŸ·ç­†ã‚³ãƒãƒ³ãƒ‰ã‚¬ã‚¤ãƒ‰.md**: ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

---

**æœ€çµ‚æ›´æ–°**: 2025-09-02
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0.0
**è²¬ä»»è€…**: ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ
