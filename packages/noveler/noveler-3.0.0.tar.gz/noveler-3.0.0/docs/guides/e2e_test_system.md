# E2Eãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ é‹ç”¨ã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æ§‹ç¯‰ã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ï¼ˆE2Eï¼‰ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®é‹ç”¨ã‚¬ã‚¤ãƒ‰ã§ã™ã€‚å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æƒ³å®šã—ãŸåŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã§ã™ã€‚

## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

### ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
E2Eãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ /
â”œâ”€â”€ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å±¤/                   # å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ test_workflow_integration_e2e.py    # çµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
â”‚   â”œâ”€â”€ test_quality_workflow_e2e.py        # å“è³ªä¿è¨¼ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
â”‚   â”œâ”€â”€ test_scenario_integration_e2e.py    # è¤‡é›‘ã‚·ãƒŠãƒªã‚ªçµ±åˆ
â”‚   â””â”€â”€ test_performance_stress_e2e.py      # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹
â”œâ”€â”€ å®Ÿè¡ŒåŸºç›¤å±¤/                        # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¤ãƒ³ãƒ•ãƒ©
â”‚   â”œâ”€â”€ conftest.py                         # pytestè¨­å®šãƒ»ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
â”‚   â”œâ”€â”€ pytest_e2e.ini                     # E2Eå°‚ç”¨pytestè¨­å®š
â”‚   â””â”€â”€ BaseE2ETestCase                     # å…±é€šãƒ†ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹
â”œâ”€â”€ å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆå±¤/                   # å®Ÿè¡Œãƒ»åˆ¶å¾¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ run_e2e_tests.sh/.bat              # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ generate_e2e_report.sh             # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ Makefile.e2e                       # Makeçµ±åˆ
â””â”€â”€ åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆå±¤/                   # çµæœåˆ†æãƒ»å¯è¦–åŒ–
    â”œâ”€â”€ analyze_e2e_coverage.py            # ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æ
    â”œâ”€â”€ HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ                    # è¦–è¦šçš„ãªãƒ¬ãƒãƒ¼ãƒˆ
    â””â”€â”€ JSON APIå‡ºåŠ›                       # æ©Ÿæ¢°å¯èª­ãªçµæœ
```

### ğŸ§ª ãƒ†ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒª

1. **çµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ** (`test_workflow_integration_e2e.py`)
   - å®Œå…¨åŸ·ç­†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆâ†’ãƒ—ãƒ­ãƒƒãƒˆâ†’åŸ·ç­†â†’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   - å“è³ªä¿è¨¼ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼šåŸ·ç­†â†’å“è³ªãƒã‚§ãƒƒã‚¯â†’ä¿®æ­£â†’æ¤œè¨¼
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼šä½œæˆâ†’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹â†’ãƒ˜ãƒ«ã‚¹â†’ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

2. **å“è³ªä¿è¨¼ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ** (`test_quality_workflow_e2e.py`)
   - å“è³ªãƒã‚§ãƒƒã‚¯â†’å•é¡Œæ¤œå‡ºâ†’ä¿®æ­£ææ¡ˆâ†’å†ãƒã‚§ãƒƒã‚¯
   - é©å¿œçš„å“è³ªåŸºæº–ã®æ®µéšçš„å‘ä¸Š
   - é•·æœŸå“è³ªãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ

3. **ã‚·ãƒŠãƒªã‚ªçµ±åˆãƒ†ã‚¹ãƒˆ** (`test_scenario_integration_e2e.py`)
   - æ–°è¦å°èª¬åŸ·ç­†å®Œå…¨ãƒ•ãƒ­ãƒ¼
   - ç¶™ç¶šåŸ·ç­†ä½œæ¥­ãƒ•ãƒ­ãƒ¼
   - ã‚¨ãƒ©ãƒ¼å›å¾©ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

4. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ** (`test_performance_stress_e2e.py`)
   - å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†æ€§èƒ½
   - ä¸¦è¡Œå‡¦ç†ã®ç«¶åˆçŠ¶æ…‹
   - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã¨ãƒªãƒ¼ã‚¯æ¤œå‡º
   - é•·æ™‚é–“å®Ÿè¡Œå®‰å®šæ€§

## ğŸš€ åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•

### ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# 1. ä»®æƒ³ç’°å¢ƒã®æœ‰åŠ¹åŒ–
source venv/bin/activate  # Linux/Mac
# ã¾ãŸã¯
venv\Scripts\activate     # Windows

# 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
make -f Makefile.e2e e2e-setup

# 3. ç’°å¢ƒç¢ºèª
make -f Makefile.e2e e2e-env-check
```

### åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆï¼ˆåŸºæœ¬æ©Ÿèƒ½ç¢ºèªï¼‰
make -f Makefile.e2e e2e-smoke

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆ
make -f Makefile.e2e e2e-workflow

# å“è³ªä¿è¨¼ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ
make -f Makefile.e2e e2e-quality

# å…¨ã¦ã®E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
make -f Makefile.e2e e2e-all
```

### ç›´æ¥å®Ÿè¡Œï¼ˆè©³ç´°åˆ¶å¾¡ï¼‰

```bash
# Linux/Mac
./bin/run_e2e_tests.sh --smoke --verbose
./bin/run_e2e_tests.sh --workflow --performance
./bin/run_e2e_tests.sh --all --report

# Windows
bin\run_e2e_tests.bat --smoke --verbose
bin\run_e2e_tests.bat --workflow --performance
```

## ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

### åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æã®ã¿
make -f Makefile.e2e e2e-coverage

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ+ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
make -f Makefile.e2e e2e-report

# ãƒ•ãƒ«æ©Ÿèƒ½ãƒ¬ãƒãƒ¼ãƒˆï¼ˆãƒ†ã‚¹ãƒˆ+ã‚«ãƒãƒ¬ãƒƒã‚¸+çµ±åˆãƒ¬ãƒãƒ¼ãƒˆï¼‰
make -f Makefile.e2e e2e-full-report
```

### ç”Ÿæˆã•ã‚Œã‚‹ãƒ¬ãƒãƒ¼ãƒˆ

1. **HTMLãƒ¬ãƒãƒ¼ãƒˆ**
   - `temp/reports/e2e_*/integrated_e2e_report.html`
   - ãƒ†ã‚¹ãƒˆçµæœã€ã‚«ãƒãƒ¬ãƒƒã‚¸ã€çµ±è¨ˆæƒ…å ±ã‚’çµ±åˆ

2. **ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ**
   - `temp/reports/e2e_*/e2e_coverage_report.html`
   - ã‚³ãƒãƒ³ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ã€ã‚·ãƒŠãƒªã‚ªã‚«ãƒãƒ¬ãƒƒã‚¸ã€ä¸è¶³é …ç›®

3. **JSONãƒ¬ãƒãƒ¼ãƒˆ**
   - `temp/reports/e2e_*/e2e_coverage_report.json`
   - æ©Ÿæ¢°å¯èª­ãªè©³ç´°ãƒ‡ãƒ¼ã‚¿

4. **JUnit XML**
   - `temp/reports/e2e_*/e2e_test_results.xml`
   - CI/CDçµ±åˆç”¨

## âš¡ é«˜åº¦ãªä½¿ç”¨æ–¹æ³•

### ç‰¹å®šãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œ

```bash
# ç‰¹å®šãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å®Ÿè¡Œ
make -f Makefile.e2e e2e-workflow-integration
make -f Makefile.e2e e2e-quality-workflow
make -f Makefile.e2e e2e-scenario-integration
make -f Makefile.e2e e2e-performance-stress
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ

```bash
# ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ä»˜ãå®Ÿè¡Œ
make -f Makefile.e2e e2e-profile

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆã®ã¿
make -f Makefile.e2e e2e-performance
make -f Makefile.e2e e2e-stress
```

### ä¸¦åˆ—å®Ÿè¡Œï¼ˆæ³¨æ„: ãƒªã‚½ãƒ¼ã‚¹ç«¶åˆã®å¯èƒ½æ€§ï¼‰

```bash
# ä¸¦åˆ—å®Ÿè¡Œ
./bin/run_e2e_tests.sh --workflow --parallel

# ã¾ãŸã¯
make -f Makefile.e2e e2e-parallel
```

### ãƒ‡ãƒãƒƒã‚°å®Ÿè¡Œ

```bash
# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
./bin/run_e2e_tests.sh --smoke --debug

# ã¾ãŸã¯
make -f Makefile.e2e e2e-debug
```

## ğŸ”§ é«˜åº¦ãªè¨­å®š

### pytestè¨­å®šã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

`tests/e2e/pytest_e2e.ini`ã‚’ç·¨é›†ï¼š

```ini
[tool:pytest]
# ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆèª¿æ•´
timeout = 300

# è©³ç´°å‡ºåŠ›ãƒ¬ãƒ™ãƒ«
addopts = [
    "--tb=long",              # è©³ç´°ãƒˆãƒ¬ãƒ¼ã‚¹ãƒãƒƒã‚¯
    "--durations=20",         # é…ã„ãƒ†ã‚¹ãƒˆä¸Šä½20å€‹è¡¨ç¤º
    "--maxfail=3",           # 3å€‹å¤±æ•—ã§åœæ­¢
]

# ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ã‚«ãƒ¼è¿½åŠ 
markers = [
    "custom_scenario: ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ",
]
```

### GUIDE_ROOTã§ã®å®Ÿè¡Œã¨ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè§£æ±º

GUIDE_ROOTï¼ˆã“ã®ãƒªãƒã‚¸ãƒˆãƒªç›´ä¸‹ï¼‰ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã€å®Ÿåœ¨ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«å°èª¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åŸºç‚¹ã«E2Eã‚’æµã—ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã®è§£æ±ºé †ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

- å„ªå…ˆé †ï¼ˆä¸Šã»ã©å„ªå…ˆï¼‰
  1) ç’°å¢ƒå¤‰æ•° `PROJECT_ROOT` ã¾ãŸã¯ `NOVELER_TEST_PROJECT_ROOT`
  2) è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« `config/novel_config.yaml` ã® `paths.samples.root`
  3) ç’°å¢ƒå¤‰æ•° `NOVELER_SAMPLES_ROOT`ï¼ˆã‚µãƒ³ãƒ—ãƒ«è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã¾ãŸã¯æ—¢å®šã‚µãƒ³ãƒ—ãƒ«
  4) æœ€çµ‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ`cwd`ï¼‰

- æ—¢å®šï¼ˆæœ¬ãƒªãƒã‚¸ãƒˆãƒªã§ã¯è¨­å®šæ¸ˆã¿ï¼‰
  - `config/novel_config.yaml` ã«ä»¥ä¸‹ã‚’è¿½è¨˜æ¸ˆã¿ã§ã™ã€‚
    ```yaml
    paths:
      samples:
        root: "/mnt/c/Users/bamboocity/OneDrive/Documents/9_å°èª¬/10_Fãƒ©ãƒ³ã‚¯é­”æ³•ä½¿ã„ã¯DEBUGãƒ­ã‚°ã‚’èª­ã‚€"
    ```

- ä¸Šæ›¸ãã—ãŸã„å ´åˆ
  - ä¸€æ™‚çš„ã«ç’°å¢ƒå¤‰æ•°ã‚’åˆ©ç”¨:
    ```bash
    export PROJECT_ROOT="/path/to/your/sample-project"
    pytest -c tests/e2e/pytest_e2e.ini -q
    ```
  - æ’ä¹…çš„ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´:
    ```yaml
    # config/novel_config.yaml
    paths:
      samples:
        root: "/absolute/path/to/sample-project"
    ```

- å®Ÿè¡Œä¾‹
  ```bash
  # GUIDE_ROOTç›´ä¸‹ã§
  pytest -c tests/e2e/pytest_e2e.ini -m e2e -q
  # ã‚‚ã—ãã¯Makefile.e2eã‹ã‚‰
  make -f tests/e2e/Makefile.e2e e2e-workflow
  ```

### ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹åˆ¶å¾¡

```bash
# ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆèª¿æ•´
export E2E_TIMEOUT=600

# è©³ç´°å‡ºåŠ›åˆ¶å¾¡
export E2E_VERBOSE=1

# ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›å…ˆå¤‰æ›´
export E2E_REPORT_DIR=/path/to/custom/reports
```

### ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªã®è¿½åŠ 

æ–°ã—ã„E2Eãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š

```python
#!/usr/bin/env python3
"""ã‚«ã‚¹ã‚¿ãƒ E2Eãƒ†ã‚¹ãƒˆ"""

import pytest
from scripts.tests.unit.infrastructure.test_base import BaseE2ETestCase

class TestCustomE2E(BaseE2ETestCase):
    """ã‚«ã‚¹ã‚¿ãƒ E2Eãƒ†ã‚¹ãƒˆ"""

    @pytest.mark.e2e
    @pytest.mark.custom_scenario
    def test_custom_workflow(self):
        """ã‚«ã‚¹ã‚¿ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ"""
        # ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆãƒ­ã‚¸ãƒƒã‚¯
        pass
```

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾å‡¦æ³•

#### 1. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

```bash
# ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå€¤ã‚’å¢—åŠ 
./bin/run_e2e_tests.sh --smoke --timeout 600
```

#### 2. ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼

```bash
# è»½é‡ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
make -f Makefile.e2e e2e-fast

# ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆã‚’é™¤å¤–
./bin/run_e2e_tests.sh --workflow --fast
```

#### 3. ä¸¦è¡Œå®Ÿè¡Œã§ã®ç«¶åˆã‚¨ãƒ©ãƒ¼

```bash
# ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«å®Ÿè¡Œã«å¤‰æ›´
./bin/run_e2e_tests.sh --workflow  # --parallel ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é™¤å»
```

#### 4. æ¨©é™ã‚¨ãƒ©ãƒ¼ï¼ˆLinux/Macï¼‰

```bash
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
chmod +x bin/run_e2e_tests.sh
chmod +x bin/generate_e2e_report.sh
chmod +x bin/analyze_e2e_coverage.py
```

### ç’°å¢ƒè¨ºæ–­

```bash
# åŒ…æ‹¬çš„ãªç’°å¢ƒè¨ºæ–­
make -f Makefile.e2e e2e-troubleshoot

# çµ±è¨ˆæƒ…å ±ç¢ºèª
make -f Makefile.e2e e2e-stats
```

### ãƒ­ã‚°ã®ç¢ºèª

```bash
# æœ€æ–°ã®E2Eãƒ†ã‚¹ãƒˆãƒ­ã‚°
ls -la temp/logs/e2e_test_*

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®å†…å®¹ç¢ºèª
tail -n 50 temp/logs/e2e_test_*.log
```

## ğŸ“ˆ CI/CDçµ±åˆ

### GitHub Actionsçµ±åˆä¾‹

```yaml
name: E2E Tests

on: [push, pull_request]

jobs:
  e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: make -f Makefile.e2e e2e-setup

      - name: Run E2E tests
        run: make -f Makefile.e2e e2e-ci

      - name: Upload reports
        uses: actions/upload-artifact@v3
        with:
          name: e2e-reports
          path: temp/reports/
```

### Jenkinsçµ±åˆä¾‹

```groovy
pipeline {
    agent any
    stages {
        stage('E2E Tests') {
            steps {
                sh 'make -f Makefile.e2e e2e-setup'
                sh 'make -f Makefile.e2e e2e-ci'
            }
            post {
                always {
                    publishHTML([
                        allowMissing: false,
                        alwaysLinkToLastBuild: true,
                        keepAll: true,
                        reportDir: 'temp/reports/',
                        reportFiles: 'integrated_e2e_report.html',
                        reportName: 'E2E Test Report'
                    ])
                }
            }
        }
    }
}
```

## ğŸ¯ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ãƒ†ã‚¹ãƒˆä½œæˆã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

1. **ãƒ†ã‚¹ãƒˆåˆ†é›¢ã®ç¢ºä¿**
   - å„ãƒ†ã‚¹ãƒˆã¯ç‹¬ç«‹ã—ã¦å®Ÿè¡Œå¯èƒ½ã§ã‚ã‚‹ã“ã¨
   - ãƒ†ã‚¹ãƒˆé–“ã§ã®ãƒ‡ãƒ¼ã‚¿å…±æœ‰ã‚’é¿ã‘ã‚‹
   - å°‚ç”¨ã®ãƒ†ãƒ³ãƒãƒ©ãƒªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½¿ç”¨

2. **é©åˆ‡ãªã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š**
   - è»½é‡ãƒ†ã‚¹ãƒˆ: 30ç§’ä»¥å†…
   - çµ±åˆãƒ†ã‚¹ãƒˆ: 2åˆ†ä»¥å†…
   - ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ: 10åˆ†ä»¥å†…

3. **ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã®ç®¡ç†**
   - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç›£è¦–
   - CPUä½¿ç”¨ç‡ã®åˆ¶é™
   - ä¸¦è¡Œå®Ÿè¡Œæ™‚ã®ç«¶åˆå›é¿

4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
   - äºˆæƒ³ã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
   - é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ¤œè¨¼
   - å¾©æ—§å‡¦ç†ã®ãƒ†ã‚¹ãƒˆ

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

1. **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åº**
   - ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆâ†’çµ±åˆãƒ†ã‚¹ãƒˆâ†’ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ
   - å¤±æ•—ã—ã‚„ã™ã„ãƒ†ã‚¹ãƒˆã‚’æ—©æœŸã«å®Ÿè¡Œ
   - é‡ã„ãƒ†ã‚¹ãƒˆã¯æœ€å¾Œã«å®Ÿè¡Œ

2. **ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**
   - ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®é©åˆ‡ãªå®Ÿè¡Œ
   - ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®é©åˆ‡ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
   - ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã®ç›£è¦–

3. **ä¸¦åˆ—å®Ÿè¡Œã®åˆ¶å¾¡**
   - ãƒªã‚½ãƒ¼ã‚¹ç«¶åˆã®å›é¿
   - é©åˆ‡ãªãƒ¯ãƒ¼ã‚«ãƒ¼æ•°ã®è¨­å®š
   - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒƒã‚¯ã®é©åˆ‡ãªä½¿ç”¨

## ğŸš¦ é‹ç”¨ç›£è¦–

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†

- ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“ã®è¿½è·¡
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç›£è¦–
- æˆåŠŸç‡ã®è¿½è·¡
- ã‚«ãƒãƒ¬ãƒƒã‚¸ã®æ¨ç§»

### ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

- ãƒ†ã‚¹ãƒˆæˆåŠŸç‡ã®ä½ä¸‹ï¼ˆ80%ã‚’ä¸‹å›ã‚‹ï¼‰
- å®Ÿè¡Œæ™‚é–“ã®ç•°å¸¸ãªå¢—åŠ ï¼ˆå‰å›ã®1.5å€ä»¥ä¸Šï¼‰
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç•°å¸¸ãªå¢—åŠ ï¼ˆ500MBä»¥ä¸Šï¼‰

### å®šæœŸçš„ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

- å¤ã„ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
- ãƒ†ãƒ³ãƒãƒ©ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®è¦‹ç›´ã—ã¨æ›´æ–°

---

ã“ã®E2Eãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚Šã€å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«è¿‘ã„åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã«ãªã‚Šã€ã‚·ã‚¹ãƒ†ãƒ ã®å“è³ªã¨å®‰å®šæ€§ã‚’ç¢ºä¿ã§ãã¾ã™ã€‚


### Fail-only NDJSONï¼ˆCIæ—¢å®šONï¼‰

- CIã§ã¯ `LLM_REPORT_STREAM_FAIL=1` ã‚’æ—¢å®šæœ‰åŠ¹åŒ–ã—ã€å¤±æ•—ãƒ•ã‚§ãƒ¼ã‚ºã®ã¿ã‚’NDJSONã§é€æ¬¡è¨˜éŒ²ã—ã¾ã™ã€‚
  - ãƒ¯ãƒ¼ã‚«ãƒ¼åˆ¥: `reports/stream/llm_fail_<worker>.ndjson`
  - é›†ç´„: ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã« `reports/llm_fail.ndjson` ã¸çµ±åˆã—ã€æœ«å°¾ã« `session_summary` ã‚’1è¡Œè¿½è¨˜ã—ã¾ã™ã€‚
  - ãƒ¬ã‚³ãƒ¼ãƒ‰: `{ts,event,test_id,phase,outcome,duration_s,worker_id}`ï¼ˆsummaryã«ã¯ failed/error/crashed ä»¶æ•°ã‚’å«ã¿ã¾ã™ï¼‰
- ãƒ­ãƒ¼ã‚«ãƒ«ã§ç„¡åŠ¹åŒ–ã—ãŸã„å ´åˆã¯ `LLM_REPORT_STREAM_FAIL=0` ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚
