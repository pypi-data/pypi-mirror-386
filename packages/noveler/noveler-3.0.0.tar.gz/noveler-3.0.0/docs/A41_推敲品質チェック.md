# A41_推敲品質チェック - A40推敲品質ガイド完了後のチェックリスト（Markdown版）

Version: 1.1.0
Last Updated: 2025-09-25
Type: チェックリスト（A40対向）

対象: A40_推敲品質ガイド.md の実施結果
前提: 原稿の推敲パス（文体/論理/可読性/一貫性）が完了

備考: 旧 `archive/yaml_legacy/A41_推敲品質チェックリスト.yaml` をMarkdown化。詳細項目はA40各章と対応。

注記（スコア表記と優先順位）:
- スコアは内部で 0–1 実数、表示/記述は 0–100 の％で表します（例: 80% ≒ 0.80）。
- 最終合否は `run_quality_checks` の結果を優先し、STEP16（LLM評価）結果は補助指標とします。乖離が5ポイント(=0.05)超の場合、再推敲と再計測を推奨。

品質チェック（抜粋）:
- [ ] 文体一貫（主語・視点・時制）とリズム最適化
- [ ] 論理整合（因果/動機/目的線）と矛盾修正
- [ ] キャラ一貫（口調/行動/関係）と変化の必然性
- [ ] 情報開示計画に沿った伏線・回収の整備
- [ ] 表記・用字・禁則処理の統一（記号/約物/禁止表現）
- [ ] Stage1（技術推敲）自動修正が適用済み（A40 Stage1）
- [ ] Stage2（内容推敲）プロンプト適用済み（A40 Stage2）
- [ ] Stage3（読者体験）プロンプト適用済み（A40 Stage3）
- [ ] `run_quality_checks` 合格スコア（>=80% ≒ >=0.80）確認済み
- [ ] 誤字率（typo_error_rate）<= 0.1%（≒ 0.001）を満たす
- [ ] 必要に応じてアーティファクトから復元（`restore_manuscript_from_artifact`）でロールバック検証

合否判定:
- A33/A39の品質ゲート通過 + 誤字脱字0.1%未満で合格。

---

## 実行手順（推奨）

1) Stage1 技術的推敲（安全自動修正）
- 反復自動改善（既定化）: `noveler check <episode> --auto-fix`
  - 内部的に `improve_quality_until` を優先実行（目標80点/最大3反復）
  - 失敗時はフォールバックで単回の `fix_quality_issues` を適用→再計測
- 単発＋差分: `noveler mcp call fix_quality_issues '{"episode_number": 1, "file_path": "...", "dry_run": true, "include_diff": true}'`

2) Stage2/Stage3 プロンプト適用（内容推敲/読者体験）
> NOTE: Stage2/Stage3 prompts are sourced from `templates/quality/checks/polish_stage2_content.yaml` / `polish_stage3_reader.yaml` via the shared Schema v2 loader. 手動適用時は該当テンプレートを確認してからLLMへ送信してください。

- プロンプト生成: `noveler mcp call polish_manuscript '{"episode_number": 1, "file_path": "...", "stages":["stage2","stage3"], "dry_run": true}'`
- 出力 `metadata.prompts` をLLMに渡して改稿→原稿へ反映

（一気通貫版）
- `noveler mcp call polish_manuscript_apply '{"episode_number": 1, "file_path": "...", "stages":["stage2","stage3"], "dry_run": false}'`
- 改稿本文/差分/レポートは `.noveler/artifacts` に保存。参照IDはレスポンス`metadata.*_artifact`で確認。
- ロールバックが必要な場合は `restore_manuscript_from_artifact` を使用。

（エイリアス）
- `noveler mcp call polish '{"episode_number": 1, "file_path": "...", "mode": "apply", "stages": ["stage2","stage3"], "dry_run": true}'`

3) 再チェックと合否
- `noveler mcp call run_quality_checks '{"episode_number": 1, "format": "summary", "severity_threshold": "medium"}'`
- 本シートのチェック全項目が満たされていることを確認（A33/A39ゲート含む）
- 乖離判定: `run_quality_checks.total_score` と STEP16 `total_score` の差が >0.05 の場合、差分原因を特定し再推敲/再計測。


### 付録: リズムと長さの検査方針（本プロジェクト）
- 文のリズムは「地の文（Narration）のみ」を対象とし、会話（Dialogue）は分布/連続判定から除外します。
- 検査は分布（P25/P50/P75）と連続（短<15字/長>70字の連発）と窓平均（5文）で行います。
- 長さ検査は `project_root/プロジェクト設定.yaml` の `writing.episode.target_length.{min,max}` を参照し、欠落/不正時はエラー（QC-009/QC-010）。length_in_range チェックは実施不可。
