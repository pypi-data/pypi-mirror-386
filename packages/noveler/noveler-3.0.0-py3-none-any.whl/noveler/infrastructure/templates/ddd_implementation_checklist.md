# DDD + TDDå®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

**æ–°æ©Ÿèƒ½é–‹ç™ºæ™‚ã¯å¿…ãšã“ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨**

## ğŸ“‹ å®Ÿè£…å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ğŸ§  Phase 1: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ï¼ˆå¿…é ˆå…ˆè¡Œï¼‰

- [ ] **ãƒ“ã‚¸ãƒã‚¹è¦æ±‚åˆ†æå®Œäº†**
  - ä½•ã®ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã‚’æä¾›ã™ã‚‹ã‹æ˜ç¢ºåŒ–
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼/è¦æ±‚ä»•æ§˜ã‚’ç‰¹å®š

- [ ] **ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç‰¹å®š**
  - ä¸€æ„æ€§ã‚’æŒã¤ãƒ“ã‚¸ãƒã‚¹æ¦‚å¿µã‚’ç‰¹å®š
  - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®çŠ¶æ…‹é·ç§»ã‚’è¨­è¨ˆ
  - ä¸å¤‰æ¡ä»¶ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼‰ã‚’å®šç¾©

- [ ] **å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç‰¹å®š**
  - åŒä¸€æ€§ã‚’æŒãŸãªã„æ¦‚å¿µã‚’ç‰¹å®š
  - ä¸å¤‰æ€§ã‚’ä¿è¨¼ã™ã‚‹è¨­è¨ˆ

- [ ] **ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ç‰¹å®š**
  - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚„å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å±ã•ãªã„ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç‰¹å®š

- [ ] **ãƒªãƒã‚¸ãƒˆãƒªè¨­è¨ˆ**
  - æ°¸ç¶šåŒ–ãŒå¿…è¦ãªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç‰¹å®š
  - ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã§è¨­è¨ˆ
  - æ¤œç´¢ãƒ»ä¿å­˜ãƒ»å‰Šé™¤ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©

### ğŸ”´ Phase 2: TDD REDæ®µéš

- [ ] **ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ†ã‚¹ãƒˆä½œæˆ**
  - `tests/test_domain_[æ©Ÿèƒ½å].py` ä½œæˆ
  - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’ãƒ†ã‚¹ãƒˆã§è¡¨ç¾
  - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®çŠ¶æ…‹é·ç§»ãƒ†ã‚¹ãƒˆ
  - ä¸å¤‰æ¡ä»¶é•åæ™‚ã®ä¾‹å¤–ãƒ†ã‚¹ãƒˆ

- [ ] **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆä½œæˆ**
  - `tests/test_application_[æ©Ÿèƒ½å].py` ä½œæˆ
  - ãƒ¢ãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½¿ç”¨
  - æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ã®ä¸¡æ–¹ã‚’ãƒ†ã‚¹ãƒˆ

- [ ] **ãƒ†ã‚¹ãƒˆå¤±æ•—ç¢ºèª**
  - `pytest tests/test_domain_[æ©Ÿèƒ½å].py` ã§å¤±æ•—ç¢ºèª
  - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæœŸå¾…é€šã‚Šã‹ç¢ºèª

### ğŸŸ¢ Phase 3: TDD GREENæ®µéš

- [ ] **ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤å®Ÿè£…**
  - `domain/[ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ]/entities.py` ã§ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…
  - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å«ã‚€ãƒªãƒƒãƒãªãƒ¢ãƒ‡ãƒ«
  - `domain/[ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ]/repositories.py` ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©

- [ ] **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤å®Ÿè£…**
  - `application/use_cases/[æ©Ÿèƒ½å].py` ã§ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®Ÿè£…
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®èª¿æ•´ã®ã¿å®Ÿè¡Œ
  - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯å«ã¾ãªã„

- [ ] **ã‚¤ãƒ³ãƒ•ãƒ©å±¤å®Ÿè£…**
  - `infrastructure/persistence/[å®Ÿè£…å]_repository.py` ã§å®Ÿè£…
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…
  - ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ /DBç­‰ã¸ã®æ°¸ç¶šåŒ–

- [ ] **ãƒ†ã‚¹ãƒˆæˆåŠŸç¢ºèª**
  - å…¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
  - å…¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ

### ğŸ”µ Phase 4: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ•´å‚™

- [ ] **ä¾å­˜é–¢ä¿‚ç¢ºèª**
  - Domain â† Application â† Infrastructure ã®æ–¹å‘æ€§ç¢ºèª
  - ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ãŒä»–å±¤ã«ä¾å­˜ã—ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª

- [ ] **çµ±åˆãƒ†ã‚¹ãƒˆä½œæˆãƒ»å®Ÿè¡Œ**
  - `tests/test_integration_[æ©Ÿèƒ½å].py` ä½œæˆ
  - å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã—ãŸãƒ†ã‚¹ãƒˆ
  - ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ

- [ ] **DDDå“è³ªã‚²ãƒ¼ãƒˆç¢ºèª**
  - ä»¥ä¸‹ã®å…¨é …ç›®ã‚’ã‚¯ãƒªã‚¢

## ğŸ” DDDå“è³ªã‚²ãƒ¼ãƒˆï¼ˆå¿…é ˆï¼‰

### ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ãƒã‚§ãƒƒã‚¯
- [ ] **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒã¤**
  - ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã§ã¯ãªãæŒ¯ã‚‹èˆã„ã‚’æŒã¤
  - çŠ¶æ…‹é·ç§»ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨
  - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’æ¤œè¨¼ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨

- [ ] **å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä¸å¤‰**
  - `@dataclass(frozen=True)` ã¾ãŸã¯åŒç­‰ã®å®Ÿè£…
  - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã‚’å«ã‚€

- [ ] **ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«å®šç¾©**
  - `domain/[ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ]/repositories.py` ã«å­˜åœ¨
  - ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã«ä¾å­˜ã—ãªã„æŠ½è±¡åŒ–

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ãƒã‚§ãƒƒã‚¯
- [ ] **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã‚’èª¿æ•´ã®ã¿**
  - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’å«ã¾ãªã„
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ã®ã¿
  - å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®å”èª¿

### ã‚¤ãƒ³ãƒ•ãƒ©å±¤ãƒã‚§ãƒƒã‚¯
- [ ] **æŠ€è¡“çš„é–¢å¿ƒäº‹ã®ã¿ã‚’æ‰±ã†**
  - ãƒ•ã‚¡ã‚¤ãƒ«I/Oã€DBæ¥ç¶šç­‰
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å®Ÿè£…
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã®å¤‰æ›

### ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ãƒã‚§ãƒƒã‚¯
- [ ] **ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸90%ä»¥ä¸Š**
- [ ] **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®é‡è¦ãƒ‘ã‚¹ã‚’ã‚«ãƒãƒ¼**
- [ ] **çµ±åˆãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã‚’ç¢ºèª**

## ğŸš« ã‚ˆãã‚ã‚‹é•åãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆé¿ã‘ã‚‹ã“ã¨ï¼‰

### âŒ è²§è¡€ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
```python
# NG: ãƒ‡ãƒ¼ã‚¿ã®ã¿ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
@dataclass
class Episode:
    title: str
    content: str
    status: str  # æ–‡å­—åˆ—ã§ç®¡ç†
```

### âœ… ãƒªãƒƒãƒãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
```python
# OK: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒã¤ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
@dataclass
class Episode:
    title: EpisodeTitle
    content: str
    status: EpisodeStatus

    def can_publish(self) -> bool:
        """å…¬é–‹å¯èƒ½æ€§ã‚’ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã§åˆ¤å®š"""
        return (self.status == EpisodeStatus.REVISED and
                len(self.content) >= 2000)
```

### âŒ ãƒ¬ã‚¤ãƒ¤ãƒ¼é•å
```python
# NG: ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã§ãƒ•ã‚¡ã‚¤ãƒ«I/O
class Episode:
    def save_to_file(self):
        with open(f"{self.title}.md", "w") as f:
            f.write(self.content)
```

### âœ… é©åˆ‡ãªè²¬å‹™åˆ†é›¢
```python
# OK: ãƒªãƒã‚¸ãƒˆãƒªçµŒç”±ã§ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã«å§”è­²
class EpisodeService:
    def save_episode(self, episode: Episode):
        self.repository.save(episode)  # ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã§å®Ÿè£…
```

## ğŸ“š å‚è€ƒå®Ÿè£…

æ—¢å­˜ã®é©åˆ‡ãªDDDå®Ÿè£…ä¾‹ï¼š
- `domain/writing/entities.py` - ãƒªãƒƒãƒãªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
- `application/use_cases/create_episode_from_plot.py` - ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
- `infrastructure/persistence/ddd_episode_repository.py` - ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…
- `tests/test_ddd_writing_system.py` - DDDæº–æ‹ ãƒ†ã‚¹ãƒˆ

**ã“ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’å°åˆ·ã—ã¦æ‰‹å…ƒã«ç½®ãã€å®Ÿè£…æ™‚ã«å¿…ãšç¢ºèªã™ã‚‹ã“ã¨ï¼**
