import{b as M}from"./chunk-74KQCU7Q.js";import{a as p,b as u}from"./chunk-362Q4FKW.js";var x='.dj-calendar{background-color:var(--django-formset-background-color);border:var(--border-width) var(--border-style) var(--border-color);border-radius:var(--border-radius);color:var(--django-formset-foreground-color)}.dj-calendar[role=dialog]{box-shadow:var(--border-color) 0 0 1rem}.dj-calendar [hidden]{display:none !important}.dj-calendar.loading *{opacity:.75;pointer-events:none}.dj-calendar .controls{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border-color)}.dj-calendar .controls button{display:inline-flex;color:inherit;background-color:rgba(0,0,0,0);border:none;padding:0;min-width:28px}.dj-calendar .controls button.extend{flex-grow:1}.dj-calendar .controls button:hover{background-color:color-mix(in srgb, color-mix(in oklab, light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%)), var(--django-formset-fg-color) 20%), var(--django-formset-background-color) 80%)}.dj-calendar .controls button>svg{margin:0 auto}.dj-calendar .controls time{width:10rem;text-align:center}.dj-calendar .controls.years-view time{opacity:.75}.dj-calendar .sheet-body{display:flex;flex-direction:row;padding:0}.dj-calendar .sheet-body .central{flex-grow:1}.dj-calendar .sheet-body :is(.aside-left,.aside-right){flex-grow:0;font-weight:bold;font-size:small;width:24px}.dj-calendar .sheet-body :is(.aside-left,.aside-right) time{white-space:nowrap;display:inline-block;line-height:24px}.dj-calendar .sheet-body .aside-left:has(>time:not(:empty)){background-color:light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%))}.dj-calendar .sheet-body .aside-left>time:not(:empty){transform:rotate(-90deg) translate(-140px, 24px);transform-origin:bottom left}.dj-calendar .sheet-body .aside-right:has(>time:not(:empty)){background-color:light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%))}.dj-calendar .sheet-body .aside-right>time:not(:empty){transform:rotate(90deg) translate(30px, -24px);transform-origin:top left}.dj-calendar .sheet-body ul{margin:0;padding:0;text-align:center;display:grid;gap:2px;line-height:38px}.dj-calendar .sheet-body ul:not(*){background-color:color-mix(in srgb, light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%)), var(--django-formset-background-color) 50%)}.dj-calendar .sheet-body ul>li{list-style:none;border-radius:1px}.dj-calendar .sheet-body ul>li::selection{background-color:rgba(0,0,0,0)}.dj-calendar .sheet-body ul>li.preselected{outline:2px solid light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%))}.dj-calendar .sheet-body ul.hours{grid-template-columns:repeat(6, 1fr);margin-bottom:2px}.dj-calendar .sheet-body ul.hours>li.constricted{border:2px solid light-dark(hsl(213, 96%, 42%), hsl(213, 96%, 58%));border-bottom-color:var(--django-formset-background-color);border-bottom-width:2px;border-top-left-radius:5px;border-top-right-radius:5px}.dj-calendar .sheet-body ul.hours>li:has(~li.constricted){border-bottom:2px solid light-dark(hsl(213, 96%, 42%), hsl(213, 96%, 58%))}.dj-calendar .sheet-body ul.hours>li.constricted~li{border-bottom:2px solid light-dark(hsl(213, 96%, 42%), hsl(213, 96%, 58%))}.dj-calendar .sheet-body ul.minutes{font-size:smaller;border:2px solid light-dark(hsl(213, 96%, 42%), hsl(213, 96%, 58%));margin:-4px 0 4px;padding:0;line-height:inherit}.dj-calendar .sheet-body ul.minutes>li{width:inherit}.dj-calendar .sheet-body ul.minutes>li.preselected{background-color:color-mix(in srgb, color-mix(in oklab, light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%)), var(--django-formset-fg-color) 20%), var(--django-formset-background-color) 80%)}.dj-calendar .sheet-body ul.monthdays{grid-template-columns:repeat(7, 1fr)}.dj-calendar .sheet-body ul.monthdays>li.adjacent{color:color-mix(in srgb, currentcolor, var(--django-formset-background-color) 30%)}.dj-calendar .sheet-body ul.months{grid-template-columns:repeat(3, 1fr)}.dj-calendar .sheet-body ul.years{grid-template-columns:repeat(4, 1fr)}.dj-calendar .sheet-body ul.weekdays{grid-template-columns:repeat(7, 1fr);font-weight:bold}.dj-calendar .sheet-body ul:not(.weekdays){--dummy-style: none}.dj-calendar .sheet-body ul:not(.weekdays)>li{cursor:pointer}.dj-calendar .sheet-body ul:not(.weekdays)>li.selected{background-color:light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%))}.dj-calendar .sheet-body ul:not(.weekdays)>li.selected.today::after{border-color:rgba(0,0,0,0) rgba(0,0,0,0) var(--django-formset-background-color) rgba(0,0,0,0)}.dj-calendar .sheet-body ul:not(.weekdays)>li[disabled]{opacity:.5}.dj-calendar .sheet-body ul:not(.weekdays)>li:not([disabled]):hover{opacity:1;background-color:color-mix(in srgb, color-mix(in oklab, light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%)), var(--django-formset-fg-color) 20%), var(--django-formset-background-color) 80%) !important}.dj-calendar .sheet-body ul>li.today{position:relative}.dj-calendar .sheet-body ul>li.today::after{position:absolute;content:"";bottom:0;right:0;border-style:solid;border-width:0 0 10px 10px;border-color:rgba(0,0,0,0) rgba(0,0,0,0) light-dark(hsl(213, 96%, 64%), hsl(213, 96%, 36%)) rgba(0,0,0,0)}.dj-calendar .sheet-body abbr[title]{text-decoration:none}[is=django-datecalendar]+.dj-calendar .sheet-body ul.monthdays,[is=django-datetimecalendar]+.dj-calendar .sheet-body ul.monthdays,[is=django-daterangecalendar]+.dj-calendar .sheet-body ul.monthdays,[is=django-datetimerangecalendar]+.dj-calendar .sheet-body ul.monthdays{grid-template-rows:repeat(6, 1fr)}[aria-haspopup=dialog]+.dj-calendar{width:max-content;position:absolute;top:0;left:0}[aria-expanded=false]+.dj-calendar{display:none}[aria-expanded=true]+.dj-calendar{display:block}';var f=class extends M{constructor(t,e){super(e.inputElement);this.upperRange=!1;this.preselectedDate=null;this.dateRange=[null,null];this.baseSelector=".dj-calendar";this.turnPrev=()=>{this.fetchCalendar(this.prevSheetDate,this.viewMode)};this.turnNext=()=>{this.fetchCalendar(this.nextSheetDate,this.viewMode)};this.turnNarrow=()=>{this.narrowSheetDate&&(this.viewMode==="m"?this.fetchCalendar(this.narrowSheetDate,"w"):this.viewMode==="y"?this.fetchCalendar(this.narrowSheetDate,"m"):this.fetchCalendar(this.narrowSheetDate,this.viewMode))};this.turnExtend=()=>{this.extendSheetDate&&(this.viewMode==="h"?this.fetchCalendar(this.extendSheetDate,"w"):this.viewMode==="w"?this.fetchCalendar(this.extendSheetDate,"m"):this.fetchCalendar(this.extendSheetDate,"y"))};this.turnToday=()=>{this.settings.dateOnly?this.selectToday():this.fetchCalendar(new Date,"h")};this.hoverPrevButton=t=>{this.extendRangeToListItem(this.calendarItems.item(0))};this.hoverNextButton=t=>{this.extendRangeToListItem(this.calendarItems.item(this.calendarItems.length-1))};this.hoverDateItem=t=>{t.target instanceof HTMLLIElement&&this.extendRangeToListItem(t.target)};this.selectDay=t=>{t.target instanceof HTMLLIElement&&(this.settings.dateOnly?(this.setDate(t.target),this.markSelectedDates(),(!this.settings.withRange||this.dateRange[0]&&this.dateRange[1])&&this.settings.close()):this.fetchCalendar(this.getDate(t.target),"h"))};this.selectMonth=t=>{t.target instanceof HTMLLIElement&&this.fetchCalendar(this.getDate(t.target),"w")};this.selectYear=t=>{t.target instanceof HTMLLIElement&&this.fetchCalendar(this.getDate(t.target),"m")};this.settings=e,t instanceof HTMLElement?this.element=t:(this.element=document.createElement("div"),this.fetchCalendar(new Date,"w")),new MutationObserver(()=>this.registerCalendar()).observe(this.element,{childList:!0}),this.setInterval(),this.setMinMaxBounds(),this.styleSheet=p.stylesAreInstalled(this.baseSelector)??this.transferStyles(),this.rangeSelectCssRule=this.getRangeSelectCssRule(),this.rangeSelectorText=this.rangeSelectCssRule.selectorText,this.registerCalendar(),this.sheetBounds=this.getSheetBounds()}get todayDateString(){let t=u(new Date).toISOString();return this.settings.dateOnly?`${t.slice(0,10)}T00:00`:t.slice(0,16)}getViewMode(){var e;switch((e=this.element.querySelector(":scope > [aria-label]"))==null?void 0:e.getAttribute("aria-label")){case"hours-view":return"h";case"weeks-view":return"w";case"months-view":return"m";case"years-view":return"y";default:throw new Error(`Unknown aria-label on ${this.element}`)}}setInterval(){let t=this.settings.inputElement.getAttribute("step");if(t){let e=new Date("1970-01-01 0:00:00"),a=new Date(`1970-01-01 ${t}`);this.interval=(a.getTime()-e.getTime())/6e4}}setMinMaxBounds(){let t=this.settings.inputElement.getAttribute("min");if(t){let a=new Date(t);this.minDate=new Date(a.getTime()-a.getTimezoneOffset()*6e4),this.minWeekDate=new Date(this.minDate),this.minWeekDate.setHours(0,0,0),this.minMonthDate=new Date(this.minWeekDate),this.minMonthDate.setDate(1),this.minYearDate=new Date(this.minMonthDate),this.minYearDate.setMonth(0)}let e=this.settings.inputElement.getAttribute("max");if(e){let a=new Date(e);this.maxDate=new Date(a.getTime()-a.getTimezoneOffset()*6e4),this.maxWeekDate=new Date(this.maxDate),this.maxWeekDate.setHours(23,59,59),this.maxMonthDate=new Date(this.maxWeekDate),this.maxMonthDate.setDate(28),this.maxYearDate=new Date(this.maxMonthDate),this.maxYearDate.setMonth(11)}}getDate(t){let e=t instanceof Element?t:this.element.querySelector(t);if(!(e instanceof Element))throw new Error(`Element ${t} is missing`);let a=e.getAttribute("data-date")??e.getAttribute("datetime");return new Date(a??"")}registerCalendar(){var i;this.viewMode=this.getViewMode(),this.prevSheetDate=this.getDate("button.prev");let t=this.element.querySelector("button.prev"),e=this.element.querySelector("button.narrow");this.narrowSheetDate=e?this.getDate(e):void 0,this.nextSheetDate=this.getDate("button.next");let a=this.element.querySelector("button.next"),s=this.element.querySelector("button.extend");switch(this.extendSheetDate=s?this.getDate(s):void 0,t==null||t.addEventListener("mouseenter",this.hoverPrevButton),t==null||t.addEventListener("click",this.turnPrev,{once:!0}),e==null||e.addEventListener("click",this.turnNarrow,{once:!0}),s==null||s.addEventListener("click",this.turnExtend,{once:!0}),(i=this.element.querySelector("button.today"))==null||i.addEventListener("click",this.turnToday,{once:!0}),a==null||a.addEventListener("mouseenter",this.hoverNextButton),a==null||a.addEventListener("click",this.turnNext,{once:!0}),this.calendarItems=this.element.querySelectorAll("li[data-date]"),this.viewMode){case"h":this.registerHoursView();break;case"w":this.registerWeeksView();break;case"m":this.registerMonthsView();break;case"y":this.registerYearsView();break}let n=this.element.querySelector("button.today > svg > text");n instanceof SVGTextElement&&(n.textContent=String(new Date().getDate())),this.sheetBounds=this.getSheetBounds(),this.markSelectedDates()}registerHoursView(){var n;if(this.interval){let r=`repeat(${Math.min(60/this.interval,6)}, 1fr)`;this.element.querySelectorAll(".sheet-body ul.minutes").forEach(l=>{l.style.gridTemplateColumns=r})}this.calendarItems.forEach(i=>{let r=this.getDate(i);(this.minDate&&r<this.minDate||this.maxDate&&r>this.maxDate)&&i.toggleAttribute("disabled",!0),i.hasAttribute("disabled")||(i.addEventListener("click",l=>{l.target instanceof HTMLLIElement&&(this.setDate(l.target),this.markSelectedDates(),(!this.settings.withRange||this.dateRange[0]&&this.dateRange[1])&&this.settings.close())},{once:!0}),this.settings.withRange&&i.addEventListener("mouseenter",this.hoverDateItem))});let t=this.dateRange[0]?u(this.dateRange[0]).toISOString().slice(0,13):"",e=this.settings.withRange&&this.dateRange[1]?u(this.dateRange[1]).toISOString().slice(0,16):"",a=e.slice(0,13),s=this.todayDateString.slice(0,13).concat(":00");this.element.querySelectorAll("li[aria-label]").forEach(i=>{var b;let r=i.getAttribute("aria-label");i.classList.toggle("today",r===s);let l=`ul[aria-labelledby="${r}"]`;(t===r.slice(0,13)||a===r.slice(0,13)&&e.slice(11,16)!=="00:00")&&(i.classList.add("constricted"),(b=this.element.querySelector(l))==null||b.removeAttribute("hidden")),this.element.querySelectorAll(`${l} > li[data-date]:not([disabled])`).length===0&&i.toggleAttribute("disabled",!0),i.hasAttribute("disabled")||(i.addEventListener("click",o=>{o.target instanceof HTMLLIElement&&this.selectHour(o.target)}),this.settings.withRange&&i.addEventListener("mouseenter",this.hoverDateItem))}),(n=this.element.querySelector(".sheet-body ul.hours:last-child"))==null||n.setAttribute("hidden","")}registerWeeksView(){let t=`${this.todayDateString.slice(0,10)}T00:00`;this.calendarItems.forEach(e=>{let a=this.getDate(e);e.classList.toggle("today",e.getAttribute("data-date")===t),(this.minWeekDate&&a<this.minWeekDate||this.maxWeekDate&&a>this.maxWeekDate)&&e.toggleAttribute("disabled",!0),e.hasAttribute("disabled")||(e.addEventListener("click",this.selectDay),this.settings.withRange&&e.addEventListener("mouseenter",this.hoverDateItem))})}registerMonthsView(){let t=`${this.todayDateString.slice(0,7)}-01T00:00`;this.calendarItems.forEach(e=>{let a=this.getDate(e);e.classList.toggle("today",e.getAttribute("data-date")===t),(this.minMonthDate&&a<this.minMonthDate||this.maxMonthDate&&a>this.maxMonthDate)&&e.toggleAttribute("disabled",!0),e.hasAttribute("disabled")||(e.addEventListener("click",this.selectMonth),this.settings.withRange&&e.addEventListener("mouseenter",this.hoverDateItem))})}registerYearsView(){let t=`${this.todayDateString.slice(0,4)}-01-01T00:00`;this.calendarItems.forEach(e=>{let a=this.getDate(e);e.classList.toggle("today",e.getAttribute("data-date")===t),(this.minYearDate&&a<this.minYearDate||this.maxYearDate&&a>this.maxYearDate)&&e.toggleAttribute("disabled",!0),e.hasAttribute("disabled")||(e.addEventListener("click",this.selectYear),this.settings.withRange&&e.addEventListener("mouseenter",this.hoverDateItem))})}async navigate(t){let e=null,a=new Map([["y","m"],["m","w"],["w","h"]]);switch(t){case"ArrowUp":await this.goto(0);break;case"ArrowRight":await this.goto(1);break;case"ArrowDown":await this.goto(2);break;case"ArrowLeft":await this.goto(3);break;case"Escape":case"Tab":this.settings.close();break;case"PageUp":e=this.element.querySelector("button.prev"),e&&await this.fetchCalendar(this.getDate(e),this.viewMode);break;case"PageDown":e=this.element.querySelector("button.next"),e&&await this.fetchCalendar(this.getDate(e),this.viewMode);break;case"Enter":if(this.preselectedDate){let s=u(this.preselectedDate).toISOString().slice(0,16);e=this.element.querySelector(`.sheet-body li[data-date="${s}"]`)}else{let s=this.upperRange?this.dateRange[1]:this.dateRange[0],n=s?u(s).toISOString().slice(0,16):"";e=this.element.querySelector(`.sheet-body li[data-date="${n}"]`)}e&&(this.viewMode==="h"||this.viewMode==="w"&&this.settings.dateOnly?(this.preselectedDate=null,this.setDate(e),this.markSelectedDates(),this.upperRange||this.settings.close()):await this.fetchCalendar(this.getDate(e),a.get(this.viewMode)));break;default:break}return!0}getDelta(t,e){let a=this.interval,s=(a??60)<60?new Map([[0,-60],[1,+a],[2,60],[3,-a]]):new Map([[0,-360],[1,60],[2,360],[3,-60]]),n=new Map([[0,-10080],[1,1440],[2,10080],[3,-1440]]),i;switch(this.viewMode){case"h":i=new Date(e.getTime()+6e4*s.get(t));break;case"w":i=new Date(e.getTime()+6e4*n.get(t)),i.setHours(0,0,0);break;case"m":switch(i=new Date(e),t){case 0:i.setMonth(i.getMonth()-3);break;case 1:i.setMonth(i.getMonth()+1);break;case 2:i.setMonth(i.getMonth()+3);break;case 3:i.setMonth(i.getMonth()-1);break}i.setDate(1),i.setHours(0,0,0);break;case"y":switch(i=new Date(e),t){case 0:i.setFullYear(e.getFullYear()-4);break;case 1:i.setFullYear(e.getFullYear()+1);break;case 2:i.setFullYear(e.getFullYear()+4);break;case 3:i.setFullYear(e.getFullYear()-1);break}i.setMonth(0),i.setDate(1),i.setHours(0,0,0);break}return i}getDateSelector(t){let e=u(t).toISOString(),a;switch(this.viewMode){case"h":a=e.slice(0,16);break;case"w":a=`${e.slice(0,10)}T00:00`;break;case"m":a=`${e.slice(0,7)}-01T00:00`;break;case"y":a=`${e.slice(0,4)}-01-01T00:00`;break}return`li[data-date="${a}"]`}indexOfCalendarItem(t){let e=this.getDateSelector(t),a=this.element.querySelector(e);return Array.from(this.calendarItems).indexOf(a)}extendRangeToListItem(t){if(this.dateRange[0]&&!this.dateRange[1]){let e=t.getAttribute("data-date")??t.getAttribute("aria-label")??"",a=new Date(e);this.markDateRange(this.dateRange[0],a,!0)}}markDateRange(t,e,a=!1){var v,S;let s=t<e?t:e,n=t<e?e:t,i=this.indexOfCalendarItem(s),r=this.indexOfCalendarItem(n),l=a&&!((v=this.calendarItems.item(i))!=null&&v.classList.contains("selected"))?1:2,b=a&&!((S=this.calendarItems.item(r))!=null&&S.classList.contains("selected"))?1:0,o=this.interval?Math.min(60/this.interval,6):1,D=Math.floor(i/o)%6+1,y=Math.floor(r/o)%6+1,c;if(i===-1&&r===-1)s<this.sheetBounds[0]&&n>this.sheetBounds[1]?c=[":not(.weekdays) > li"]:c=[":not(*)"];else if(i===-1)if(this.viewMode==="h"){let d=Math.floor(r/6/o)+1;c=[`:nth-child(-n + ${d-1} of .hours) > li`,`:nth-child(${d} of .hours) > li:nth-child(-n + ${y-1})`]}else c=[`:not(.weekdays) > li:nth-child(-n + ${r+b})`];else if(r===-1)if(this.viewMode==="h"){let d=Math.floor(i/6/o)+1;c=[`:nth-child(${d} of .hours) > li:nth-child(n + ${D+1})`,`:nth-child(n + ${d+1} of .hours) > li`]}else c=[`:not(.weekdays) > li:nth-child(n + ${i+l})`];else if(this.viewMode==="h"){let d=Math.floor(i/6/o)+1,m=Math.floor(r/6/o)+1;d===m?c=[`:nth-child(${d} of .hours) > li:nth-child(n + ${D+1}):nth-child(-n + ${y-1})`]:c=[`:nth-child(${d} of .hours) > li:nth-child(n + ${D+1})`,`:nth-child(n + ${d+1} of .hours):nth-child(-n + ${m-1} of .hours) > li`,`:nth-child(${m} of .hours) > li:nth-child(-n + ${y-1})`]}else c=[`:not(.weekdays) > li:nth-child(n + ${i+l}):nth-child(-n + ${r+b})`];if(this.viewMode==="h"&&this.interval&&(i!==-1||r!==-1)){let d=Math.floor(i/o)+1,m=Math.floor(r/o)+1;r===-1?c.push(`:nth-child(${d} of .minutes) > li:nth-child(n + ${i%o+2})`):i===-1?c.push(`:nth-child(${m} of .minutes) > li:nth-child(-n + ${r%o})`):d===m?c.push(`:nth-child(${d} of .minutes) > li:nth-child(n + ${i%o+2}):nth-child(-n + ${r%o})`):(c.push(`:nth-child(${d} of .minutes) > li:nth-child(n + ${i%o+2})`),c.push(`:nth-child(${m} of .minutes) > li:nth-child(-n + ${r%o})`))}this.rangeSelectCssRule.selectorText=c.map(d=>this.rangeSelectorText.replace(":not(*)",d)).join(",")}markSelectedDates(){var t,e,a,s,n,i,r;if(this.calendarItems.forEach(l=>l.classList.remove("selected","preselected")),this.settings.withRange){if(this.dateRange[0]&&this.dateRange[1]){this.markDateRange(this.dateRange[0],this.dateRange[1]),(t=this.calendarItems.item(this.indexOfCalendarItem(this.dateRange[0])))==null||t.classList.add("selected");let l=this.indexOfCalendarItem(this.dateRange[1]);(l!==0||this.viewMode!=="h"||this.dateRange[1].getHours()!==0||this.dateRange[1].getMinutes()!==0)&&((e=this.calendarItems.item(l))==null||e.classList.add("selected"))}else if(this.dateRange[0]){let l=this.getDateSelector(this.dateRange[0]);(a=this.element.querySelector(l))==null||a.classList.add("selected")}if(this.preselectedDate){let l=this.getDateSelector(this.preselectedDate);(s=this.element.querySelector(l))==null||s.classList.add("preselected")}if(this.viewMode==="h"){let l=(n=this.element.querySelector(".sheet-body ul.hours:last-child > li"))==null?void 0:n.getAttribute("data-date");(i=this.element.querySelector(".sheet-body ul.hours:last-child"))==null||i.toggleAttribute("hidden",this.dateRange[1]?u(this.dateRange[1]).toISOString().slice(0,16)!==l:!this.upperRange)}}else if(this.dateRange[0]){let l=this.getDateSelector(this.dateRange[0]);(r=this.element.querySelector(l))==null||r.classList.add("selected")}}setDate(t){let e=new Date(t.getAttribute("data-date"));this.settings.withRange?this.upperRange&&this.dateRange[0]?(this.dateRange=e<this.dateRange[0]?[e,this.dateRange[0]]:[this.dateRange[0],e],this.settings.updateDate(this.dateRange[0],this.dateRange[1]),this.upperRange=!1,this.rangeSelectCssRule.style.cursor=""):(this.dateRange=[e,null],this.settings.updateDate(e,null),this.upperRange=!0):(this.dateRange[0]=e,this.settings.updateDate(this.dateRange[0],!0)),this.minDate&&(this.dateRange[0]&&this.dateRange[0]<this.minDate&&(this.dateRange[0]=this.minDate),this.dateRange[1]&&this.dateRange[1]<this.minDate&&(this.dateRange[1]=this.minDate)),this.maxDate&&(this.dateRange[0]&&this.dateRange[0]>this.maxDate&&(this.dateRange[0]=this.maxDate),this.dateRange[1]&&this.dateRange[1]>this.maxDate&&(this.dateRange[1]=this.maxDate)),this.settings.withRange&&this.showDateRange()}showDateRange(){let t=(s,n)=>{s.dateTime=n.toISOString(),s.textContent=this.settings.dateOnly?n.toDateString():n.toLocaleString()},e=this.element.querySelector(".sheet-body > .aside-left > time");if(e){let s=this.element.querySelector("li[data-date]:first-child"),n=this.getDate(s);this.dateRange[1]&&this.dateRange[1]<n?t(e,this.dateRange[1]):this.dateRange[0]&&this.dateRange[0]<n?t(e,this.dateRange[0]):(e.dateTime="",e.textContent="")}let a=this.element.querySelector(".sheet-body > .aside-right > time");if(a){let s=this.element.querySelector("li[data-date]:last-child"),n=this.getDate(s);this.dateRange[0]&&this.dateRange[0]>n?t(a,this.dateRange[0]):this.dateRange[1]&&this.dateRange[1]>n?t(a,this.dateRange[1]):(a.dateTime="",a.textContent="")}}async selectToday(){let t=this.todayDateString,e=this.element.querySelector(`li[data-date="${t}"]`);e||(await this.fetchCalendar(new Date,"w"),e=this.element.querySelector(`li[data-date="${t}"]`)),e&&!e.hasAttribute("disabled")&&(this.setDate(e),this.markSelectedDates()),(!this.settings.withRange||this.dateRange[0]&&this.dateRange[1])&&this.settings.close()}selectHour(t){var a;this.element.querySelectorAll("li[aria-label]").forEach(s=>{s.classList.remove("selected","preselected","constricted")}),this.element.querySelectorAll("ul[aria-labelledby]").forEach(s=>{s.toggleAttribute("hidden",!0)}),this.rangeSelectCssRule.selectorText=`${this.baseSelector} .sheet-body ul:not(*)`;let e=t.getAttribute("aria-label");if(e){let s=this.element.querySelector(`ul[aria-labelledby="${e}"]`);s instanceof HTMLUListElement&&(t.classList.add("constricted"),s.removeAttribute("hidden"))}else if(t.parentElement instanceof HTMLUListElement&&t.parentElement.hasAttribute("aria-labelledby")){let s=t.parentElement.getAttribute("aria-labelledby");(a=this.element.querySelector(`li[aria-label="${s}"]`))==null||a.classList.add("constricted"),t.parentElement.removeAttribute("hidden")}}async goto(t){let e=null;if(this.settings.withRange?this.preselectedDate?e=this.preselectedDate:!this.upperRange&&this.dateRange[0]?e=this.dateRange[0]:this.upperRange&&this.dateRange[1]&&(e=this.dateRange[1]):this.dateRange[0]&&(e=this.dateRange[0]),!e)if(this.dateRange[0])e=this.dateRange[0];else{let i=this.calendarItems.item(this.calendarItems.length/2);e=this.getDate(i)}let a=this.getDelta(t,e);this.preselectedDate=this.settings.withRange?a:null;let s=u(a).toISOString().slice(0,16),n=null;(this.viewMode!=="w"||e.getMonth()===a.getMonth())&&(n=this.element.querySelector(`.sheet-body li[data-date="${s}"]`)),n||(await this.fetchCalendar(a,this.viewMode),n=this.element.querySelector(`.sheet-body li[data-date="${s}"]`)),n instanceof HTMLLIElement&&(this.viewMode==="h"&&this.selectHour(n),this.preselectedDate||this.setDate(n),this.markSelectedDates(),this.upperRange&&this.dateRange[0]&&this.preselectedDate&&this.markDateRange(this.dateRange[0],this.preselectedDate,!0))}async fetchCalendar(t,e){let a=new URLSearchParams("calendar");a.set("date",u(t).toISOString().slice(0,10)),a.set("mode",e),this.settings.hour12&&a.set("hour12",""),this.settings.pure&&a.set("pure",""),this.interval&&a.set("interval",String(this.interval)),this.element.classList.add("loading");let s=await fetch(`${this.endpoint}?${a.toString()}`,{method:"GET"});this.element.classList.remove("loading"),s.status===200?(this.element.innerHTML=await s.text(),this.settings.withRange&&this.showDateRange()):console.error(`Failed to fetch from ${this.endpoint} (status=${s.status})`)}getSheetBounds(){let t=this.calendarItems.item(0),e=this.calendarItems.item(this.calendarItems.length-1),a=new Date(t.getAttribute("data-date")),s=new Date(e.getAttribute("data-date"));return[a,s]}transferStyles(){let t=document.createElement("style");if(t.innerText=x,document.head.appendChild(t),!t.sheet)throw new Error("Could not create <style> element");let e=t.sheet,a=!1,s=this.settings.inputElement;s.style.transition="none";for(let n=0;n<e.cssRules.length;n++){let r=e.cssRules.item(n).selectorText.trim(),l="";switch(r){case this.baseSelector:l=p.extractStyles(s,["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","white-space","line-height"]).concat(p.extractStyles(s,{"--border-style":"border-style","--border-width":"border-width","--border-radius":"border-radius"})),a=!0;break;case`${this.baseSelector} .controls`:l=p.extractStyles(s,["padding"]);break;case`${this.baseSelector} .sheet-body .central`:l=p.extractStyles(s,["padding"]);break;default:break}l&&e.insertRule(`${r}{${l}}`,++n)}if(s.style.transition="",p.pushMediaQueryStyles(e,this.baseSelector,{"--border-color":"border-color","--outline":"outline"},s),!a)throw new Error(`Could not load styles for ${this.baseSelector}`);return e}getRangeSelectCssRule(){for(let t=document.styleSheets.length-1;t>=0;--t){let e=document.styleSheets[t];for(let a=0;a<e.cssRules.length;++a){let s=e.cssRules[a];if(s instanceof CSSStyleRule&&s.selectorText===`${this.baseSelector} .sheet-body ul:not(*)`){let n=`#${CSS.escape(this.settings.inputElement.id)} ~ ${this.baseSelector} .sheet-body ul:not(*)`,i=e.insertRule(`${n}{${s.style.cssText}}`,e.cssRules.length);return e.cssRules[i]}}}throw new Error(`Could not find CSS rule for '${this.baseSelector} .sheet-body ul:not(*)'`)}formResetted(t){this.settings.inputElement.value=this.settings.inputElement.defaultValue,this.settings.inputElement.value?this.updateDate(new Date(this.settings.inputElement.value),null):this.updateDate(null,null)}formSubmitted(t){}updateDate(t,e){this.dateRange=t?[t,e]:[null,null],this.upperRange=!1,t&&this.fetchCalendar(t,this.viewMode)}valueAsDate(){return this.dateRange[0]}},h=Symbol("Calendar"),I,R=class extends(I=HTMLInputElement,h,I){connectedCallback(){let g=this.closest('[role="group"]');if(!g)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let t=g.querySelector('[aria-label="calendar"]'),e=Intl.DateTimeFormat(navigator.language,{hour:"2-digit"}),a={dateOnly:!0,withRange:!1,inputElement:this,hour12:e.resolvedOptions().hour12??!1,pure:!0,updateDate:s=>{this.value=s.toISOString().slice(0,10),this.dispatchEvent(new Event("input")),this.dispatchEvent(new Event("blur"))},close:()=>{}};this[h]=new f(t,a),this.value&&this[h].updateDate(new Date(`${this.value}T00:00`),null),this.hidden=!0}get valueAsDate(){return this[h].valueAsDate()}},T,k=class extends(T=HTMLInputElement,h,T){connectedCallback(){let g=this.closest('[role="group"]');if(!g)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let t=g.querySelector('[aria-label="calendar"]'),e=Intl.DateTimeFormat(navigator.language,{hour:"2-digit"}),a={dateOnly:!1,withRange:!1,inputElement:this,hour12:e.resolvedOptions().hour12??!1,pure:!0,updateDate:s=>{this.value=s.toISOString().slice(0,16),this.dispatchEvent(new Event("input")),this.dispatchEvent(new Event("blur"))},close:()=>{}};this[h]=new f(t,a),this.value&&this[h].updateDate(new Date(this.value),null),this.hidden=!0}get valueAsDate(){return this[h].valueAsDate()}},j,E=class extends(j=HTMLInputElement,h,j){connectedCallback(){let g=this.closest('[role="group"]');if(!g)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let t=g.querySelector('[aria-label="calendar"]'),e=Intl.DateTimeFormat(navigator.language,{hour:"2-digit"}),a={dateOnly:!0,withRange:!0,inputElement:this,hour12:e.resolvedOptions().hour12??!1,pure:!0,updateDate:(s,n)=>{let i=[`${u(s).toISOString().slice(0,10)}T00:00`,n?`${u(n).toISOString().slice(0,10)}T00:00`:""];this.value=i.join(";"),this.dispatchEvent(new Event("input")),this.dispatchEvent(new Event("blur"))},close:()=>{}};if(this[h]=new f(t,a),this.value){let[s,n]=this.value.split(";");this[h].updateDate(new Date(s),new Date(n))}this.hidden=!0}get valueAsDate(){return this[h].valueAsDate()}},$,L=class extends($=HTMLInputElement,h,$){connectedCallback(){let g=this.closest('[role="group"]');if(!g)throw new Error(`Attempt to initialize ${this} outside <django-formset>`);let t=g.querySelector('[aria-label="calendar"]'),e=Intl.DateTimeFormat(navigator.language,{hour:"2-digit"}),a={dateOnly:!1,withRange:!0,inputElement:this,hour12:e.resolvedOptions().hour12??!1,pure:!0,updateDate:(s,n)=>{let i=[u(s).toISOString().slice(0,16),n?u(n).toISOString().slice(0,16):""];this.value=i.join(";"),this.dispatchEvent(new Event("input")),this.dispatchEvent(new Event("blur"))},close:()=>{}};if(this[h]=new f(t,a),this.value){let[s,n]=this.value.split(";");this[h].updateDate(new Date(s),new Date(n))}this.hidden=!0}get valueAsDate(){return this[h].valueAsDate()}};export{f as a,R as b,k as c,E as d,L as e};
