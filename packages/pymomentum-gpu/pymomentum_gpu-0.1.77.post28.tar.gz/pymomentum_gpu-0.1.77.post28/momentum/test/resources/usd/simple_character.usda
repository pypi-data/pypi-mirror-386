#usda 1.0
# Copyright (c) Meta Platforms, Inc. and affiliates.
#
# This source code is licensed under the MIT license found in the
# LICENSE file in the root directory of this source tree.
(
    defaultPrim = "SkelRoot"
    metersPerUnit = 1
    upAxis = "Y"
)

def SkelRoot "SkelRoot"
{
    def Skeleton "Skeleton"
    {
        uniform token[] joints = ["root", "spine", "head", "left_shoulder", "left_arm", "right_shoulder", "right_arm"]
        uniform matrix4d[] bindTransforms = [
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 1, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 2, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (-0.5, 1.5, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (-1, 1.5, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0.5, 1.5, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (1, 1.5, 0, 1) )
        ]
        uniform matrix4d[] restTransforms = [
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 1, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 2, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (-0.5, 1.5, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (-1, 1.5, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0.5, 1.5, 0, 1) ),
            ( (1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (1, 1.5, 0, 1) )
        ]
    }

    def Mesh "Mesh" (
        prepend apiSchemas = ["SkelBindingAPI"]
    )
    {
        int[] faceVertexCounts = [3, 3, 3, 3, 3, 3, 3, 3]
        int[] faceVertexIndices = [0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 0, 4, 1, 1, 4, 5, 2, 6, 3, 3, 6, 7]
        point3f[] points = [
            (-0.5, 0, -0.5), (-0.5, 0, 0.5), (0.5, 0, 0.5), (0.5, 0, -0.5),
            (-0.5, 2, -0.5), (-0.5, 2, 0.5), (0.5, 2, 0.5), (0.5, 2, -0.5)
        ]
        texCoord2f[] primvars:st = [
            (0, 0), (0, 1), (1, 1), (1, 0),
            (0, 0), (0, 1), (1, 1), (1, 0)
        ] (
            interpolation = "vertex"
        )

        # Skinning data
        int[] primvars:skel:jointIndices = [
            0, 1, 0, 0,  # vertex 0
            0, 1, 0, 0,  # vertex 1
            0, 1, 0, 0,  # vertex 2
            0, 1, 0, 0,  # vertex 3
            1, 2, 0, 0,  # vertex 4
            1, 2, 0, 0,  # vertex 5
            1, 2, 0, 0,  # vertex 6
            1, 2, 0, 0   # vertex 7
        ] (
            elementSize = 4
            interpolation = "vertex"
        )
        float[] primvars:skel:jointWeights = [
            0.8, 0.2, 0, 0,  # vertex 0
            0.8, 0.2, 0, 0,  # vertex 1
            0.8, 0.2, 0, 0,  # vertex 2
            0.8, 0.2, 0, 0,  # vertex 3
            0.3, 0.7, 0, 0,  # vertex 4
            0.3, 0.7, 0, 0,  # vertex 5
            0.3, 0.7, 0, 0,  # vertex 6
            0.3, 0.7, 0, 0   # vertex 7
        ] (
            elementSize = 4
            interpolation = "vertex"
        )

        rel skel:skeleton = </SkelRoot/Skeleton>
    }
}
