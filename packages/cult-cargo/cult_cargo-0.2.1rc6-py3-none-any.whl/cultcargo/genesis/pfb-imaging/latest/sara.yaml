inputs:
  _include:
  - (.)gridding.yml
  - (.)pdopts.yml
  - (.)pmopts.yml
  - (.)cgopts.yml
  - (.)out.yml
  alpha:
    default: 2
    dtype: float
    info: Controls how aggressively the l1reweighting is applied. Larger values correspond
      to more agressive reweighting.
  bases:
    abbreviation: bases
    default: self,db1,db2,db3
    dtype: str
    info: 'Wavelet bases to use. Give as comma separated str eg. '
  diverge-count:
    default: 5
    dtype: int
    info: Will terminate the algorithm if the rms increases this many times. Set to
      larger than niter to disable this check.
  eta:
    default: 1.0
    dtype: float
    info: Will use eta*wsum to regularise the inversion of the Hessian approximation.
  gamma:
    default: 1.0
    dtype: float
    info: Step size of update
  hess-approx:
    abbreviation: hess-approx
    choices:
    - wgt
    - psf
    - direct
    default: psf
    dtype: str
    info: Which Hessian approximation to use. Set to wgt for vis space approximation,
      psf for zero-padded image space approximation and direct for direct inversion.
  hess-norm:
    abbreviation: hess-norm
    dtype: float
    info: Spectral norm of hessian approximation
  init-factor:
    default: 0.5
    dtype: float
    info: Reduce the regularisation strength by this fraction at the outset.
  l1-reweight-from:
    default: 5
    dtype: int
    info: L1 reweighting will kick in either at convergence or after this many iterations.
      Set to a negative value to disbale L1 reweighting.
  nbasisf:
    dtype: int
    info: Number of basis functions to use while fitting the frequency axis. Default
      is to use the number of non-null imaging bands i.e. interpolation.
  niter:
    abbreviation: niter
    default: 10
    dtype: int
    info: Number of iterations.
  nlevels:
    abbreviation: nlevels
    default: 2
    dtype: int
    info: Wavelet decomposition level
  nthreads:
    abbreviation: nt
    dtype: int
    info: Total number of threads to use. Defaults to half the total number available.
  positivity:
    default: 1
    dtype: int
    info: How to apply positivity constraint 0 -> no positivity, 1 -> normal positivity
      constraint 2 -> strong positivity i.e. all pixels in a band > 0
  rms-outside-model:
    default: false
    dtype: bool
    info: Mask residual where model is non-zero when computing rms. This is not recommended
      for largely non-empty fields.
  rmsfactor:
    default: 1.0
    dtype: float
    info: By default will threshold by rmsfactor*rms at every iteration
  skip-model:
    default: false
    dtype: bool
    info: Skip model creation i.e. use with do-res to do-res only
  suffix:
    default: main
    dtype: str
    info: Can be used to specify a custom name for the image space data products
  tol:
    default: 5e-4
    dtype: float
    info: Tolerance at which to terminate algorithm. Will stop when norm(x-xp)/norm(x)
      < tol
  verbosity:
    default: 1
    dtype: int
    info: Set to larger than 1 to report timings during residual computation
outputs:
  dds-out:
    dtype: Directory
    implicit: '{current.output-filename}_{current.product}_{current.suffix}.dds'
    must_exist: false
  mds-out:
    dtype: Directory
    implicit: '{current.output-filename}_{current.product}_{current.suffix}_model.mds'
    must_exist: false
policies:
  pass_missing_as_none: true
