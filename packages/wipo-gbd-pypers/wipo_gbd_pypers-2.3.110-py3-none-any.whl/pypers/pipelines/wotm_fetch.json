{
  "name": "wotm_fetch",
  "label": "Fetch WOTM collection",
  "dag": {
     "nodes": {
            "fetch"   : "fetch.download.FTP",
            "group"    : "fetch.common.GroupByMask",
            "extract"  : "fetch.extract.wo.Trademarks",
            "img"      : "fetch.common.DownloadIMG",
            "organize" : "fetch.common.Organize",
            "clean"    : "fetch.common.Cleanup"
        },
    "edges": [
           {
                "from"     : "fetch",
                "to"       : "group",
                "bindings" : { "group.input_files" : "fetch.output_files" }
            },
            {
                "from"     : "group",
                "to"       : "extract",
                "bindings" : { "extract.archives" : "group.output_files" }
            },
             {
                "from"     : "extract",
                "to"       : "img",
                "bindings" : { "img.manifest" : "extract.manifest"}
            },
            {
                "from"     : "img",
                "to"       : "organize",
                "bindings" : { "organize.manifest"  : "img.manifest" }
            },
            {
                "from"     : "fetch",
                "to"       : "clean",
                "bindings" : { "clean.processed_list" : "fetch.output_files" }
            },
            {
                "from": "organize",
                "to": "clean",
                "bindings": {
                    "clean.manifest_list": "organize.manifest"
                }
            }
        ]
  },
  "config": {
    "steps": {
      "fetch": {
        "file_regex": ".*.zip"
      },
      "group": {
        "mask_input": "(\\d{4})(\\d{2})(\\d{2})$",
        "mask_output": "\\1-\\2-\\3"
      }
    }
  }
}