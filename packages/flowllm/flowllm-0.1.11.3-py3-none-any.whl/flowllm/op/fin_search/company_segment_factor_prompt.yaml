factor_step1_prompt: |
  # 角色与任务
  你是金融研究员，基于当前因子图和 Meta 信息列表，判断信息缺口并生成搜索查询（最多 {max_search_cnt} 条）。

  # 输入
  ## 目标：{name} 的 {segment} 业务
  
  ## 现有 Meta 信息
  {meta_list}

  ## 当前因子传导图
  {mermaid_graph}

  # 规则
  1. **查询格式**：关键词空格分隔，禁用句子/标点/疑问词
  2. **去重**：不重复检索 Meta 列表中已有信息
  3. **补全维度**（优先级排序）：
     - 上游：原材料、设备、成本
     - 自身：产能、技术、效率
     - 下游：需求、订单、景气度
     - 政策：监管、补贴、关税
     - 公司：财报、公告、规划
  4. **视角**：未盈利看营收/份额，已盈利看利润/成本，估值看利率
  5. **终止条件**：逻辑链完整或无新信息可查，返回 `[]`

  # 输出格式
  ### 思考
  当前缺口或需展开处

  ### 搜索 query list
  ```json
  ["关键词1 关键词2", "关键词3"]
  ```

factor_step2_prompt: |
  # 角色与任务
  你是金融研究员，从搜索内容中提炼事实，维护 Meta 信息列表。

  # 输入
  ## 目标：{name} 的 {segment} 业务（当前时间：{current_time}）

  ## 搜索结果
  {search_content}

  ## 现有 Meta 信息
  {meta_list}

  # Meta 信息定义
  - 简洁陈述 重要事件/政策/新闻/数据
  - 客观、可验证、具体事实

  # 规则
  1. **提取**：从搜索结果提取关键事实，转为 Meta 信息
  2. **去重**：合并重复/同义信息，删除过时信息
  3. **保留**：所有与目标业务相关的有效信息
  4. **涵盖**：政策、行业、公司数据、上下游变化
  5. **不变性**：若无有效新信息，原样输出原列表

  # 输出格式
  ### 思考
  本次新增/修改/删除及理由

  ### 更新的 Meta 信息列表
  ```json
  ["Meta信息1", "Meta信息2"]
  ```

factor_step3_prompt: |
  # 角色与任务
  你是金融研究员，基于 Meta 信息列表构建/更新因子传导逻辑图。

  # 输入
  ## 目标：{name} 的 {segment} 业务（当前时间：{current_time}）

  ## Meta 信息依据
  {meta_list}

  ## 现有因子传导图
  {mermaid_graph}

  # 严格要求
  1. **因子命名**：实体+方向，可验证（如"铜价涨""降息"）
  
  2. **依据约束**：
     - 每个起始因子必须有 Meta 支撑，禁止凭空创造
  
  3. **去冗余**：
     - 合并重复因子，删除过时/无依据因子
  
  4. **起始因子约束**：
     - 最多6个起始点
     - 起始点必须是完整的 Meta 信息，直接从 Meta 列表中选取，尽可能包含核心数字
     - 起始点必须是客观事件/政策/新闻/数据等不可扩展的客观点
     - 不可使用主观判断或趋势性描述作为起始点
     - 例如："降息""铜价涨""新政出台""与XX合并完成"
  
  5. **路径构建**：
     - 最终收敛至 `A[{name} {segment} 估值变化]`
     - 越是起始因子，越是具体；越往后越抽象，逐层传导
     - 中间因子可以相对泛化，聚合多个具体事件的影响
     - 每条路径最多5个因子（包括起始点和终点 `A[{name} {segment} 估值变化]`）
     - 优先保留影响范围大的因子
  
  6. **逻辑清晰**：
     - 因果关系明确
     - 禁止循环依赖
     - 除了起始因子外，其他因子命名简洁（≤10字）
     - 中间因子保持客观描述，不预设正负方向
  
  7. **不变性**：
     - 若 Meta 无新依据，原样输出原图

  # Mermaid 规范
  - 格式：`graph LR;`（Left-Right，从左到右展示因果关系）
  - 固定收敛点：`A[{name} {segment} 估值变化]`（位于右侧）
  - 起始因子：位于左侧
  - 注意：估值变化为中性表述，正向或负向影响由读者根据因子传导路径自行判断
  - **所有因子必须使用格式**：`X[内容]`，其中：
    - X 是单个字符（如 B、C、D 等）或 An 形式（如 A1、B1、C1 等）
    - 内容必须是中文描述
    - 例如：`B[降息]`、`C[利率降]`、`D1[借贷业务收入变化]`
  - 清晰因果箭头，禁止循环/自指
  - 示例：
    ```mermaid
    graph LR;
    B[央行降息政策出台] --> C[市场利率下降]
    C[市场利率下降] --> D[贷款需求增加]
    D[贷款需求增加] --> A[xx银行 借贷业务 估值变化]
    ```

  # 输出格式
  ### 思考
  纳入/调整/删除的因子、理由及对应的 Meta 依据

  ### 更新的金融因子逻辑图
  ```mermaid
  graph LR;
  ...
  ```

init_mermaid_graph: |
  ```mermaid
  graph LR;
  A[{name} {segment} 估值变化]
  ```

init_meta_list: |
  ```json
  []
  ```
