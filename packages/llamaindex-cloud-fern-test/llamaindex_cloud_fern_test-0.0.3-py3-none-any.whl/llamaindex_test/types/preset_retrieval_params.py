# This file was auto-generated by Fern from our API Definition.

from __future__ import annotations

import typing

import pydantic
from ..core.pydantic_utilities import IS_PYDANTIC_V2, update_forward_refs
from ..core.unchecked_base_model import UncheckedBaseModel
from .preset_retrieval_params_search_filters_inference_schema_value import (
    PresetRetrievalParamsSearchFiltersInferenceSchemaValue,
)
from .retrieval_mode import RetrievalMode


class PresetRetrievalParams(UncheckedBaseModel):
    """
    Schema for the search params for an retrieval execution that can be preset for a pipeline.
    """

    dense_similarity_top_k: typing.Optional[int] = pydantic.Field(default=None)
    """
    Number of nodes for dense retrieval.
    """

    dense_similarity_cutoff: typing.Optional[float] = pydantic.Field(default=None)
    """
    Minimum similarity score wrt query for retrieval
    """

    sparse_similarity_top_k: typing.Optional[int] = pydantic.Field(default=None)
    """
    Number of nodes for sparse retrieval.
    """

    enable_reranking: typing.Optional[bool] = pydantic.Field(default=None)
    """
    Enable reranking for retrieval
    """

    rerank_top_n: typing.Optional[int] = pydantic.Field(default=None)
    """
    Number of reranked nodes for returning.
    """

    alpha: typing.Optional[float] = pydantic.Field(default=None)
    """
    Alpha value for hybrid retrieval to determine the weights between dense and sparse retrieval. 0 is sparse retrieval and 1 is dense retrieval.
    """

    search_filters: typing.Optional["MetadataFilters"] = pydantic.Field(default=None)
    """
    Search filters for retrieval.
    """

    search_filters_inference_schema: typing.Optional[
        typing.Dict[str, typing.Optional[PresetRetrievalParamsSearchFiltersInferenceSchemaValue]]
    ] = pydantic.Field(default=None)
    """
    JSON Schema that will be used to infer search_filters. Omit or leave as null to skip inference.
    """

    files_top_k: typing.Optional[int] = pydantic.Field(default=None)
    """
    Number of files to retrieve (only for retrieval mode files_via_metadata and files_via_content).
    """

    retrieval_mode: typing.Optional[RetrievalMode] = pydantic.Field(default=None)
    """
    The retrieval mode for the query.
    """

    retrieve_image_nodes: typing.Optional[bool] = pydantic.Field(default=None)
    """
    Whether to retrieve image nodes.
    """

    retrieve_page_screenshot_nodes: typing.Optional[bool] = pydantic.Field(default=None)
    """
    Whether to retrieve page screenshot nodes.
    """

    retrieve_page_figure_nodes: typing.Optional[bool] = pydantic.Field(default=None)
    """
    Whether to retrieve page figure nodes.
    """

    class_name: typing.Optional[str] = None

    if IS_PYDANTIC_V2:
        model_config: typing.ClassVar[pydantic.ConfigDict] = pydantic.ConfigDict(extra="allow", frozen=True)  # type: ignore # Pydantic v2
    else:

        class Config:
            frozen = True
            smart_union = True
            extra = pydantic.Extra.allow


from .metadata_filters import MetadataFilters  # noqa: E402, F401, I001

update_forward_refs(PresetRetrievalParams)
