"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5388],{15388:(e,n,s)=>{s.r(n),s.d(n,{AssignmentEdit:()=>E,default:()=>R});var t=s(9387),i=s(20568),a=s(17781),r=s(6856),o=s(98754),l=s(38227),c=s(94706),d=s(35650),u=s(81461),h=s(48824),m=s(11029),g=s(87324),p=s(54617),x=s(99180),v=s(38621),f=s(85383),y=s(12338),j=s(2159),b=s(84271),A=s(16476),k=s(60105),S=s(17788),C=s(41273),w=s(99179),N=s(23267),B=s(72085),I=s(75345),O=s(18683);const E=()=>{const{assignmentId:e}=(0,i.g)();if(!e)return(0,O.jsx)(O.Fragment,{});const n=(0,w.J)(),s=(0,a.S)(),E=(0,S.Z)(),R=(0,N.mt)(),V=(0,A.Gx)(),z=(0,B.OK)(),_=R.layout().space,D=z.saveRequest,F=V.selectNotebookModel(e),{cloneAssignment:Q,getAssignment:T,getAssignmentStudentVersion:J,refreshAssignment:M,updateNotebookModel:L,updateNotebook:U}=(0,k.E)(),{enqueueToast:P}=(0,C.d)(),[$,q]=(0,t.useState)("editor"),[G,H]=(0,t.useState)(!1),[K,Z]=(0,t.useState)(void 0),[W,X]=(0,t.useState)([]),[Y,ee]=(0,t.useState)(),[ne,se]=(0,t.useState)({name:"",description:""}),[te,ie]=(0,t.useState)({name:void 0,description:void 0}),ae=(0,t.useMemo)(()=>[new j._],[]),re=(0,t.useMemo)(()=>[new j._({factory:b.a})],[]),oe=(e,n)=>{n.preventDefault(),R.layout().resetRightPortal(),X([]),q(e)};(0,t.useEffect)(()=>{if(e&&"editor"===$)return R.layout().showBackdrop("Loading the assignment..."),M(e).then(n=>{if(n.success){const n=T(e);n?(ee(n),R.layout().setItem(n),se({name:n.name,description:n.description})):E("/")}}).finally(()=>{R.layout().hideBackdrop()}),()=>{V.reset(),R.layout().setItem(void 0)}},[e,$]);const le=()=>{F?.model?.cells&&(R.layout().showBackdrop("Saving the assignment..."),L(e,F.model.toJSON()).then(e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),R.layout().triggerItemsRefresh(),ee({...Y,nbformat:F.model.toJSON()}))}).finally(()=>{R.layout().hideBackdrop()}))},ce=n=>{F?.model?.cells&&(n.preventDefault(),R.layout().showBackdrop("Generating the student version of the assignment..."),L(e,F.model.toJSON()),J(e).then(e=>{H(!0),oe("student",n),e.success?Z(JSON.parse(e.notebook)):e.errors&&X(e.errors)}).finally(()=>{R.layout().hideBackdrop()}))};(0,t.useEffect)(()=>{D&&Y&&le()},[D]),(0,t.useEffect)(()=>{ie({...te,name:void 0===ne.name?void 0:ne.name.length>2,description:void 0===ne.description?void 0:ne.description.length>2})},[ne]);const de=(0,t.useCallback)(async t=>{s({title:"Are you sure?",content:"Please confirm you want to clone this assignment in your private library."}).then(s=>{s&&(R.layout().showBackdrop(),Q(e).then(e=>{e.success&&(P(e.message,{variant:"success"}),R.layout().triggerItemsRefresh(),E(`/${n?.handle}/library/assignments`))}).finally(()=>{R.layout().hideBackdrop()}))})},[s,Y]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(p.z,{children:(0,O.jsxs)(o.A,{display:"flex",children:[(0,O.jsx)(o.A,{flex:1,children:(0,O.jsx)(u.A,{sx:{fontSize:3},children:"Assignment editor"})}),"student"!==$&&(0,O.jsxs)(o.A,{display:"flex",children:[(0,O.jsx)(I.E,{commandRegistry:V.selectNotebookAdapter(e)?.commands,save:le}),(0,O.jsx)(l.A,{children:(0,O.jsx)(x.Q,{variant:"invisible",size:"small",leadingVisual:f.A,onClick:e=>ce(e),children:"Student version"})}),Y&&_&&(0,O.jsx)(x.Q,{variant:"invisible",size:"small",leadingVisual:v.Nc$,onClick:de,children:"Clone"})]})]})}),Y&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(r.O,{sx:{mt:3,mb:3},children:[(0,O.jsx)(r.O.Item,{href:"","aria-label":"","aria-current":"editor"===$?"page":void 0,onClick:e=>oe("editor",e),children:"Editor"}),(0,O.jsx)(r.O.Item,{href:"","aria-label":"","aria-current":"properties"===$?"page":void 0,onClick:e=>oe("properties",e),children:"Properties"}),(0,O.jsx)(r.O.Item,{href:"","aria-label":"","aria-current":"student"===$?"page":void 0,onClick:e=>ce(e),children:"Student version"})]}),"editor"===$&&(0,O.jsx)(o.A,{children:Y.nbformat&&(0,O.jsx)(y.g,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:Y.nbformat,extensions:ae,cellSidebarMargin:200})}),"properties"===$&&(0,O.jsx)(o.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,O.jsx)(o.A,{children:(0,O.jsxs)(o.A,{sx:{label:{marginTop:2}},children:[(0,O.jsxs)(m.A,{children:[(0,O.jsx)(m.A.Label,{children:"Name"}),(0,O.jsx)(g.A,{block:!0,value:ne.name,onChange:e=>{se(n=>({...n,name:e.target.value}))}}),!1===te.name&&(0,O.jsx)(m.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,O.jsxs)(m.A,{children:[(0,O.jsx)(m.A.Label,{children:"Description"}),(0,O.jsx)(h.Ay,{block:!0,value:ne.description,onChange:e=>{se(n=>({...n,description:e.target.value}))}}),!1===te.description&&(0,O.jsx)(m.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,O.jsx)(m.A,{children:(0,O.jsx)(x.Q,{variant:"primary",disabled:!te.name||!te.description,sx:{marginTop:2},onClick:async()=>{R.layout().showBackdrop("Updating assignment..."),U(e,ne.name,ne.description).then(e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),R.layout().triggerItemsRefresh(),ee({...Y,name:ne.name,description:ne.description}))}).finally(()=>{R.layout().hideBackdrop()})},children:"Update assignment"})})]})})}),"student"===$&&(0,O.jsxs)(o.A,{ml:3,mr:3,children:[(0,O.jsx)(d.A,{variant:"warning",children:"Student version of the assignment."}),W.map(e=>(0,O.jsxs)(d.A,{variant:"danger",children:[(0,O.jsx)(c.A,{icon:v._0O}),e]})),K&&0===W.length&&(0,O.jsx)(y.g,{id:`${e}-student`,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:K,readonly:!0,extensions:re})]})]})]})},R=E},75345:(e,n,s)=>{s.d(n,{E:()=>l});var t=s(18683),i=s(71791),a=s(99180),r=s(38621),o=s(9387);function l(e){const{commandRegistry:n,runtimeDesc:s,sessionConnection:l}=e,[c,d]=(0,o.useState)();return(0,o.useEffect)(()=>{const e=()=>{d(l?.kernel?.status)};return e(),l?.statusChanged.connect(e),l?.connectionStatusChanged.connect(e),()=>{l?.statusChanged.disconnect(e),l?.connectionStatusChanged.disconnect(e)}},[l]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Q,{variant:"invisible",size:"small",leadingVisual:r.udU,disabled:!s?.location||"busy"===c,onClick:e=>n?.execute(i.nx.runAll),children:"Run all"}),(0,t.jsx)(a.Q,{variant:"invisible",size:"small",leadingVisual:r.wFz,disabled:!s?.location||"busy"!==c,onClick:e=>n?.execute(i.nx.interrupt),children:"Interrupt"})]})}},84271:(e,n,s)=>{s.d(n,{a:()=>c});var t=s(18683),i=s(38621),a=s(98754),r=s(99180),o=s(71791),l=s(84604);function c(e){const{commands:n}=e;return(0,t.jsx)(a.A,{className:l.VL,sx:{"& p":{marginBottom:"0 !important"}},children:(0,t.jsx)(r.Q,{trailingVisual:i.udU,size:"small",variant:"invisible",onClick:e=>{e.preventDefault(),n.execute(o.nx.run).catch(e=>{console.error("Failed to run cell.",e)})},children:"Run"})})}}}]);