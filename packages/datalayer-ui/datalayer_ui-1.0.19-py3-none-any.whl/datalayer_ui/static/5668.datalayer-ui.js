"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5668],{75345:(e,s,t)=>{t.d(s,{E:()=>l});var n=t(18683),a=t(71791),i=t(99180),r=t(38621),o=t(9387);function l(e){const{commandRegistry:s,runtimeDesc:t,sessionConnection:l}=e,[c,d]=(0,o.useState)();return(0,o.useEffect)(()=>{const e=()=>{d(l?.kernel?.status)};return e(),l?.statusChanged.connect(e),l?.connectionStatusChanged.connect(e),()=>{l?.statusChanged.disconnect(e),l?.connectionStatusChanged.disconnect(e)}},[l]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:r.udU,disabled:!t?.location||"busy"===c,onClick:e=>s?.execute(a.nx.runAll),children:"Run all"}),(0,n.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:r.wFz,disabled:!t?.location||"busy"!==c,onClick:e=>s?.execute(a.nx.interrupt),children:"Interrupt"})]})}},95668:(e,s,t)=>{t.r(s),t.d(s,{LessonEdit:()=>B,default:()=>w});var n=t(9387),a=t(20568),i=t(17781),r=t(6856),o=t(98754),l=t(81461),c=t(48824),d=t(11029),u=t(87324),h=t(54617),m=t(99180),p=t(38621),x=t(12338),y=t(2159),g=t(16476),f=t(75345),v=t(60105),j=t(17788),b=t(41273),k=t(99179),A=t(23267),C=t(72085),S=t(18683);const B=()=>{const e=(0,n.useMemo)(()=>[new y._],[]),{lessonId:s}=(0,a.g)();if(!s)return(0,S.jsx)(S.Fragment,{});const t=(0,k.J)(),B=(0,i.S)(),w=(0,j.Z)(),E=(0,A.mt)(),I=(0,g.Gx)(),N=E.layout().space,R=(0,C.OK)().saveRequest,L=I.selectNotebookModel(s),{cloneLesson:z,getLesson:O,refreshLesson:T,updateNotebook:F,updateNotebookModel:V}=(0,v.E)(),[_,D]=(0,n.useState)("editor"),{enqueueToast:M}=(0,b.d)(),[P,Q]=(0,n.useState)(),[J,q]=(0,n.useState)({name:"",description:""}),[U,$]=(0,n.useState)({name:void 0,description:void 0}),G=(e,s)=>{s.preventDefault(),E.layout().resetRightPortal(),D(e)};(0,n.useEffect)(()=>(E.layout().showBackdrop(),T(s).then(e=>{if(E.layout().hideBackdrop(),e.success){const e=O(s);e?(Q(e),E.layout().setItem(e),q({name:e.name,description:e.description})):w("/")}}).finally(()=>{E.layout().hideBackdrop()}),()=>{Q(void 0),I.reset(),E.layout().setItem(void 0)}),[s]);const H=()=>{L?.model?.cells&&(E.layout().showBackdrop("Saving the lesson..."),V(s,L.model.toJSON()).then(e=>{e.success&&(M("The lesson is successfully updated.",{variant:"success"}),E.layout().triggerItemsRefresh(),Q({...P,nbformat:L.model.toJSON()}))}).finally(()=>{E.layout().hideBackdrop()}))};(0,n.useEffect)(()=>{R&&P&&H()},[R]),(0,n.useEffect)(()=>{$({...U,name:void 0===J.name?void 0:J.name.length>2,description:void 0===J.description?void 0:J.description.length>2})},[J]);const K=(0,n.useCallback)(async e=>{B({title:"Are you sure?",content:"Please confirm you want to clone this lesson in your private library."}).then(e=>{e&&(E.layout().showBackdrop(),z(s).then(e=>{E.layout().hideBackdrop(),e.success&&(M(e.message,{variant:"success"}),E.layout().triggerItemsRefresh(),w(`/${t?.handle}/library/lessons`))}).finally(()=>{E.layout().hideBackdrop()}))})},[B,P]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h.z,{children:(0,S.jsxs)(o.A,{display:"flex",children:[(0,S.jsx)(o.A,{flex:1,children:(0,S.jsx)(l.A,{sx:{fontSize:3},children:"Lesson editor"})}),"editor"===_&&(0,S.jsx)(o.A,{children:(0,S.jsx)(f.E,{commandRegistry:I.selectNotebookAdapter(s)?.commands,save:H})}),P&&N&&(0,S.jsx)(o.A,{children:(0,S.jsx)(m.Q,{variant:"invisible",size:"small",leadingVisual:p.Nc$,onClick:K,children:"Clone"})})]})}),P&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(r.O,{sx:{mt:3,mb:3},children:[(0,S.jsx)(r.O.Item,{href:"","aria-label":"","aria-current":"editor"===_?"page":void 0,onClick:e=>G("editor",e),children:"Editor"}),(0,S.jsx)(r.O.Item,{href:"","aria-label":"","aria-current":"properties"===_?"page":void 0,onClick:e=>G("properties",e),children:"Properties"})]}),"editor"===_&&(0,S.jsx)(o.A,{children:P.nbformat&&(0,S.jsx)(x.g,{id:s,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",cellMetadataPanel:!0,nbformat:P.nbformat,extensions:e})}),"properties"===_&&(0,S.jsx)(o.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,S.jsx)(o.A,{children:(0,S.jsxs)(o.A,{sx:{label:{marginTop:2}},children:[(0,S.jsxs)(d.A,{children:[(0,S.jsx)(d.A.Label,{children:"Name"}),(0,S.jsx)(u.A,{block:!0,value:J.name,onChange:e=>{q(s=>({...s,name:e.target.value}))}}),!1===U.name&&(0,S.jsx)(d.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,S.jsxs)(d.A,{children:[(0,S.jsx)(d.A.Label,{children:"Description"}),(0,S.jsx)(c.Ay,{block:!0,value:J.description,onChange:e=>{q(s=>({...s,description:e.target.value}))}}),!1===U.description&&(0,S.jsx)(d.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,S.jsx)(d.A,{children:(0,S.jsx)(m.Q,{variant:"primary",disabled:!U.name||!U.description,sx:{marginTop:2},onClick:async()=>{E.layout().showBackdrop(),F(s,J.name,J.description).then(e=>{E.layout().hideBackdrop(),e.success&&(M("The lesson is successfully updated.",{variant:"success"}),E.layout().triggerItemsRefresh(),Q({...P,name:J.name,description:J.description}))}).finally(()=>{E.layout().hideBackdrop()})},children:"Update lesson"})})]})})})]})]})},w=B}}]);