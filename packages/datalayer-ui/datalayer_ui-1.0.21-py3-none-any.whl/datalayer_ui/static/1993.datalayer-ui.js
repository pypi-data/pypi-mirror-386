"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[1993],{11796:(e,t,s)=>{s.d(t,{x:()=>c});var i=s(2335),n=s(48542),o=s(75987),r=s(85181),a=s(98238),l=s(72490),h=s(63527);class d{constructor(e){this.model=e,this._cellMap=new WeakMap,this._changed=new l.Signal(this),this._isDisposed=!1,this._insertCells(0,this.model.cells),this.model.changed.connect(this._onSharedModelChanged,this)}get changed(){return this._changed}get isDisposed(){return this._isDisposed}get length(){return this.model.cells.length}*[Symbol.iterator](){for(const e of this.model.cells)yield this._cellMap.get(e)}dispose(){var e;if(!this._isDisposed){this._isDisposed=!0;for(const t of this.model.cells)null===(e=this._cellMap.get(t))||void 0===e||e.dispose();l.Signal.clearData(this)}}get(e){return this._cellMap.get(this.model.cells[e])}_insertCells(e,t){return t.forEach(e=>{let t;switch(e.cell_type){case"code":t=new h.DJ({sharedModel:e});break;case"markdown":t=new h.Xr({sharedModel:e});break;default:t=new h.mT({sharedModel:e})}this._cellMap.set(e,t),e.disposed.connect(()=>{t.dispose(),this._cellMap.delete(e)})}),this.length}_onSharedModelChanged(e,t){var s;let i=0;const n=new Array;null===(s=t.cellsChange)||void 0===s||s.forEach(e=>{null!=e.insert?(this._insertCells(i,e.insert),n.push({type:"add",newIndex:i,newValues:e.insert.map(e=>this._cellMap.get(e)),oldIndex:-2,oldValues:[]}),i+=e.insert.length):null!=e.delete?n.push({type:"remove",newIndex:-1,newValues:[],oldIndex:i,oldValues:new Array(e.delete).fill(void 0)}):null!=e.retain&&(i+=e.retain)}),n.forEach(e=>this._changed.emit(e))}}class c{constructor(e={}){var t,s;this.standaloneModel=!1,this._dirty=!1,this._readOnly=!1,this._contentChanged=new l.Signal(this),this._stateChanged=new l.Signal(this),this._isDisposed=!1,this._metadataChanged=new l.Signal(this),this.standaloneModel=void 0===e.sharedModel,e.sharedModel?this.sharedModel=e.sharedModel:this.sharedModel=o.Xn.create({disableDocumentWideUndoRedo:null===(t=e.disableDocumentWideUndoRedo)||void 0===t||t,data:{nbformat:n.BW,nbformat_minor:n.T$,metadata:{kernelspec:{name:"",display_name:""},language_info:{name:null!==(s=e.languagePreference)&&void 0!==s?s:""}}}}),this._cells=new d(this.sharedModel),this._trans=(e.translator||r.wK).load("jupyterlab"),this._deletedCells=[],this._collaborationEnabled=!!(null==e?void 0:e.collaborationEnabled),this._cells.changed.connect(this._onCellsChanged,this),this.sharedModel.changed.connect(this._onStateChanged,this),this.sharedModel.metadataChanged.connect(this._onMetadataChanged,this)}get contentChanged(){return this._contentChanged}get metadataChanged(){return this._metadataChanged}get stateChanged(){return this._stateChanged}get cells(){return this._cells}get dirty(){return this._dirty}set dirty(e){const t=this._dirty;e!==t&&(this._dirty=e,this.triggerStateChange({name:"dirty",oldValue:t,newValue:e}))}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly)return;const t=this._readOnly;this._readOnly=e,this.triggerStateChange({name:"readOnly",oldValue:t,newValue:e})}get metadata(){return this.sharedModel.metadata}get nbformat(){return this.sharedModel.nbformat}get nbformatMinor(){return this.sharedModel.nbformat_minor}get defaultKernelName(){var e;const t=this.getMetadata("kernelspec");return null!==(e=null==t?void 0:t.name)&&void 0!==e?e:""}get deletedCells(){return this._deletedCells}get defaultKernelLanguage(){var e;const t=this.getMetadata("language_info");return null!==(e=null==t?void 0:t.name)&&void 0!==e?e:""}get collaborative(){return this._collaborationEnabled}dispose(){if(this.isDisposed)return;this._isDisposed=!0;const e=this.cells;this._cells=null,e.dispose(),this.standaloneModel&&this.sharedModel.dispose(),l.Signal.clearData(this)}deleteMetadata(e){return this.sharedModel.deleteMetadata(e)}getMetadata(e){return this.sharedModel.getMetadata(e)}setMetadata(e,t){void 0===t?this.sharedModel.deleteMetadata(e):this.sharedModel.setMetadata(e,t)}toString(){return JSON.stringify(this.toJSON())}fromString(e){this.fromJSON(JSON.parse(e))}toJSON(){return this._ensureMetadata(),this.sharedModel.toJSON()}fromJSON(e){var t,s;const o=a.JSONExt.deepCopy(e),r=e.metadata.orig_nbformat;if(o.nbformat=Math.max(e.nbformat,n.BW),(o.nbformat!==e.nbformat||o.nbformat_minor<n.T$)&&(o.nbformat_minor=n.T$),void 0!==r&&o.nbformat!==r){let e;e=o.nbformat>r?this._trans.__("This notebook has been converted from an older notebook format (v%1)\nto the current notebook format (v%2).\nThe next time you save this notebook, the current notebook format (v%2) will be used.\n'Older versions of Jupyter may not be able to read the new format.' To preserve the original format version,\nclose the notebook without saving it.",r,o.nbformat):this._trans.__("This notebook has been converted from an newer notebook format (v%1)\nto the current notebook format (v%2).\nThe next time you save this notebook, the current notebook format (v%2) will be used.\nSome features of the original notebook may not be available.' To preserve the original format version,\nclose the notebook without saving it.",r,o.nbformat),(0,i.ui)({title:this._trans.__("Notebook converted"),body:e,buttons:[i.lG.okButton({label:this._trans.__("Ok")})]})}0===(null!==(s=null===(t=o.cells)||void 0===t?void 0:t.length)&&void 0!==s?s:0)&&(o.cells=[{cell_type:"code",source:"",metadata:{trusted:!0}}]),this.sharedModel.fromJSON(o),this._ensureMetadata(),this.dirty=!0}_onCellsChanged(e,t){switch(t.type){case"add":case"set":t.newValues.forEach(e=>{e.contentChanged.connect(this.triggerContentChange,this)})}this.triggerContentChange()}_onMetadataChanged(e,t){this._metadataChanged.emit(t),this.triggerContentChange()}_onStateChanged(e,t){t.stateChange&&t.stateChange.forEach(e=>{"dirty"===e.name?this.dirty=e.newValue:e.oldValue!==e.newValue&&this.triggerStateChange({newValue:void 0,oldValue:void 0,...e})})}_ensureMetadata(e=""){this.getMetadata("language_info")||this.sharedModel.setMetadata("language_info",{name:e}),this.getMetadata("kernelspec")||this.sharedModel.setMetadata("kernelspec",{name:"",display_name:""})}triggerStateChange(e){this._stateChanged.emit(e)}triggerContentChange(){this._contentChanged.emit(void 0),this.dirty=!0}get isDisposed(){return this._isDisposed}}},29028:(e,t,s)=>{s.d(t,{k:()=>h});var i=s(49723),n=s(14738),o=s(47798),r=s(85181),a=s(72490);class l{constructor(e){this._requestBatchSize=10,this._cursor=0,this._hasSession=!1,this._history=[],this._placeholder="",this._kernelSession="",this._setByHistory=!1,this._isDisposed=!1,this._editor=null,this._filtered=[],this._kernel=null,this._sessionContext=e.sessionContext,this._trans=(e.translator||r.wK).load("jupyterlab"),this._handleKernel().then(()=>{this._sessionContext.kernelChanged.connect(this._handleKernel,this)}),this._toRequest=this._requestBatchSize}get editor(){return this._editor}set editor(e){if(this._editor===e)return;const t=this._editor;t&&t.model.sharedModel.changed.disconnect(this.onTextChange,this),this._editor=e,e&&e.model.sharedModel.changed.connect(this.onTextChange,this)}get placeholder(){return this._placeholder}get kernelSession(){return this._kernelSession}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._history.length=0,a.Signal.clearData(this)}async checkSession(e){var t;this._hasSession||(await this._retrieveHistory(),this._hasSession=!0,this.editor=e.editor,this._placeholder=(null===(t=this._editor)||void 0===t?void 0:t.model.sharedModel.getSource())||"",this.setFilter(this._placeholder),this._cursor=this._filtered.length-1)}async back(e){return await this.checkSession(e),--this._cursor,this._cursor<0&&await this.fetchBatch(),this._cursor=Math.max(0,this._cursor),this._filtered[this._cursor]}async forward(e){return await this.checkSession(e),++this._cursor,this._cursor=Math.min(this._filtered.length-1,this._cursor),this._filtered[this._cursor]}updateEditor(e,t){var s,i;if(e){const n=null===(s=e.editor)||void 0===s?void 0:s.model,o=null==n?void 0:n.sharedModel.getSource();if(this.isDisposed||!t)return;if(o===t)return;this._setByHistory=!0,null==n||n.sharedModel.setSource(t);let r=0;r=t.indexOf("\n"),r<0&&(r=t.length),null===(i=e.editor)||void 0===i||i.setCursorPosition({line:0,column:r})}}reset(){this._hasSession=!1,this._placeholder="",this._toRequest=this._requestBatchSize}async fetchBatch(){this._toRequest+=this._requestBatchSize;let e=this._filtered.slice().reverse(),t=this._history.slice();await this._retrieveHistory().then(()=>{this.setFilter(this._placeholder);let t=0,s=this._filtered.slice().reverse();for(let i=0;i<e.length;i++){let n=e[i];for(let e=i+t;e<s.length&&n!==s[e];e++)t+=1}this._cursor=this._filtered.length-(e.length+1)-t}),this._cursor<0&&this._history.length>t.length&&await this.fetchBatch()}onHistory(e,t){this._history.length=0;let s=["","",""],i=["","",""],n="";if("ok"===e.content.status){for(let t=0;t<e.content.history.length;t++)i=e.content.history[t],i!==s&&(n=e.content.history[t][0],this._history.push(s=i));this.kernelSession||i[2]==(null==t?void 0:t.model.sharedModel.getSource())&&(this._kernelSession=n)}}onTextChange(){this._setByHistory?this._setByHistory=!1:this.reset()}async _handleKernel(){var e;this._kernel=null===(e=this._sessionContext.session)||void 0===e?void 0:e.kernel,this._kernel?await this._retrieveHistory().catch():this._history.length=0}async _retrieveHistory(e){var t,s;return await(null===(t=this._kernel)||void 0===t?void 0:t.requestHistory((s=this._toRequest,{output:!1,raw:!0,hist_access_type:"tail",n:s})).then(t=>{this.onHistory(t,e)}).catch(()=>{console.warn(this._trans.__("History was unable to be retrieved"))}))}setFilter(e=""){this._filtered.length=0;let t="",s="";for(let i=0;i<this._history.length;i++)s=this._history[i][2],s!==t&&e!==s&&this._filtered.push(t=s);this._filtered.push(e)}}class h extends i.tR{constructor(e){super(e),this.rendermime=e.rendermime,this.contentFactory=e.contentFactory,this.mimeTypeService=e.mimeTypeService,this._editorConfig=e.editorConfig||o.a.defaultEditorConfig,this._notebookConfig=e.notebookConfig||o.a.defaultNotebookConfig}get editorConfig(){return this._editorConfig}set editorConfig(e){this._editorConfig=e}get notebookConfig(){return this._notebookConfig}set notebookConfig(e){this._notebookConfig=e}createNewWidget(e,t){const s=e.translator,i=new l({sessionContext:e.sessionContext,translator:s}),o={rendermime:t?t.content.rendermime:this.rendermime.clone({resolver:e.urlResolver}),contentFactory:this.contentFactory,mimeTypeService:this.mimeTypeService,editorConfig:t?t.content.editorConfig:this._editorConfig,notebookConfig:t?t.content.notebookConfig:this._notebookConfig,translator:s,kernelHistory:i},r=this.contentFactory.createNotebook(o);return new n.S({context:e,content:r})}}},39756:(e,t,s)=>{s.d(t,{G:()=>o});var i=s(41665),n=s(72490);class o extends i.H{constructor(){super(...arguments),this._activeCell=null,this._activeCellChanged=new n.Signal(this),this._selectionChanged=new n.Signal(this)}get activeCell(){const e=this.currentWidget;return e&&e.content.activeCell||null}get activeCellChanged(){return this._activeCellChanged}get selectionChanged(){return this._selectionChanged}add(e){const t=super.add(e);return e.content.activeCellChanged.connect(this._onActiveCellChanged,this),e.content.selectionChanged.connect(this._onSelectionChanged,this),t}dispose(){this._activeCell=null,super.dispose()}onCurrentChanged(e){const t=this.activeCell;t&&t===this._activeCell||(this._activeCell=t,e&&this._activeCellChanged.emit(e.content.activeCell||null))}_onActiveCellChanged(e,t){this.currentWidget&&this.currentWidget.content===e&&(this._activeCell=t||null,this._activeCellChanged.emit(this._activeCell))}_onSelectionChanged(e){this.currentWidget&&this.currentWidget.content===e&&this._selectionChanged.emit(void 0)}}},70639:(e,t,s)=>{s.d(t,{p:()=>n});var i=s(11796);class n{constructor(e={}){var t,s;this._disposed=!1,this._disableDocumentWideUndoRedo=null===(t=e.disableDocumentWideUndoRedo)||void 0===t||t,this._collaborative=null===(s=e.collaborative)||void 0===s||s}get disableDocumentWideUndoRedo(){return this._disableDocumentWideUndoRedo}set disableDocumentWideUndoRedo(e){this._disableDocumentWideUndoRedo=e}get name(){return"notebook"}get contentType(){return"notebook"}get fileFormat(){return"json"}get collaborative(){return this._collaborative}get isDisposed(){return this._disposed}dispose(){this._disposed=!0}createNew(e={}){return new i.x({languagePreference:e.languagePreference,sharedModel:e.sharedModel,collaborationEnabled:e.collaborationEnabled&&this.collaborative,disableDocumentWideUndoRedo:this._disableDocumentWideUndoRedo})}preferredLanguage(e){return""}}}}]);