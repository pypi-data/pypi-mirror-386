"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[1954,5003],{3188:(e,t,n)=>{n.d(t,{k:()=>M});var r=n(18008),a=n(45474),o=n(80914),s=n(58007);const i=new Map,c="undefined"==typeof BroadcastChannel?class{constructor(e){this.room=e,this.onmessage=null,this._onChange=t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:o.Ey(t.newValue||"")}),s.k9(this._onChange)}postMessage(e){s.JT.setItem(this.room,o.nk(o.zS(e)))}close(){s.o6(this._onChange)}}:BroadcastChannel,l=e=>r._4(i,e,()=>{const t=a.vt(),n=new c(e);return n.onmessage=e=>t.forEach(t=>t(e.data,"broadcastchannel")),{bc:n,subs:t}}),d=(e,t,n=null)=>{const r=l(e);r.bc.postMessage(t),r.subs.forEach(e=>e(t,n))};var u=n(38229),m=n(39189),h=n(50809),p=n(9366);const v=(e,t)=>{m.zd(e,0);const n=p.FX(t);m.Gu(e,n)},f=(e,t,n)=>{m.zd(e,1),m.Gu(e,p.PR(t,n))},g=(e,t,n)=>{try{p.QE(t,h.bo(e),n)}catch(e){console.error("Caught error while handling a Yjs update",e)}},w=g;var y=n(54195),x=n(48201),b=n(51318),S=n(287),k=n(8417),C=n(42165);const T=[];T[0]=(e,t,n,r,a)=>{m.zd(e,0);const o=((e,t,n,r)=>{const a=h.cw(e);switch(a){case 0:((e,t,n)=>{f(t,n,h.bo(e))})(e,t,n);break;case 1:g(e,n,r);break;case 2:w(e,n,r);break;default:throw new Error("Unknown message type")}return a})(t,e,n.doc,n);r&&1===o&&!n.synced&&(n.synced=!0)},T[3]=(e,t,n,r,a)=>{m.zd(e,1),m.Gu(e,y.X3(n.awareness,Array.from(n.awareness.getStates().keys())))},T[1]=(e,t,n,r,a)=>{y.tQ(n.awareness,h.bo(t),n)},T[2]=(e,t,n,r,a)=>{((e,t,n)=>{0===h.cw(e)&&n(0,h.t3(e))})(t,n.doc,(e,t)=>A(n,t))};const A=(e,t)=>console.warn(`Permission denied to access ${e.url}.\n${t}`),V=(e,t,n)=>{const r=h.$C(t),a=m.xv(),o=h.cw(r),s=e.messageHandlers[o];return s?s(a,r,e,n,o):console.error("Unable to compute message"),a},E=(e,t,n)=>{t===e.ws&&(e.emit("connection-close",[n,e]),e.ws=null,t.close(),e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,y._g(e.awareness,Array.from(e.awareness.getStates().keys()).filter(t=>t!==e.doc.clientID),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(I,b.jk(100*b.n7(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e))},I=e=>{if(e.shouldConnect&&null===e.ws){const t=new e._WS(e.url,e.protocols);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=n=>{e.wsLastMessageReceived=u._g();const r=V(e,new Uint8Array(n.data),!0);m.Bw(r)>1&&t.send(m.Fo(r))},t.onerror=t=>{e.emit("connection-error",[t,e])},t.onclose=n=>{E(e,t,n)},t.onopen=()=>{e.wsLastMessageReceived=u._g(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);const n=m.xv();if(m.zd(n,0),v(n,e.doc),t.send(m.Fo(n)),null!==e.awareness.getLocalState()){const n=m.xv();m.zd(n,1),m.Gu(n,y.X3(e.awareness,[e.doc.clientID])),t.send(m.Fo(n))}},e.emit("status",[{status:"connecting"}])}},_=(e,t)=>{const n=e.ws;e.wsconnected&&n&&n.readyState===n.OPEN&&n.send(t),e.bcconnected&&d(e.bcChannel,t,e)};class j extends x.W{constructor(e,t,n,{connect:r=!0,awareness:a=new y.ww(n),params:o={},protocols:s=[],WebSocketPolyfill:i=WebSocket,resyncInterval:c=-1,maxBackoffTime:l=2500,disableBc:h=!1}={}){for(super();"/"===e[e.length-1];)e=e.slice(0,e.length-1);this.serverUrl=e,this.bcChannel=e+"/"+t,this.maxBackoffTime=l,this.params=o,this.protocols=s,this.roomname=t,this.doc=n,this._WS=i,this.awareness=a,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=h,this.wsUnsuccessfulReconnects=0,this.messageHandlers=T.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=r,this._resyncInterval=0,c>0&&(this._resyncInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){const e=m.xv();m.zd(e,0),v(e,n),this.ws.send(m.Fo(e))}},c)),this._bcSubscriber=(e,t)=>{if(t!==this){const t=V(this,new Uint8Array(e),!1);m.Bw(t)>1&&d(this.bcChannel,m.Fo(t),this)}},this._updateHandler=(e,t)=>{if(t!==this){const t=m.xv();m.zd(t,0),((e,t)=>{m.zd(e,2),m.Gu(e,t)})(t,e),_(this,m.Fo(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:e,updated:t,removed:n},r)=>{const o=e.concat(t).concat(n),s=m.xv();m.zd(s,1),m.Gu(s,y.X3(a,o)),_(this,m.Fo(s))},this._exitHandler=()=>{y._g(this.awareness,[n.clientID],"app closed")},k.Ll&&void 0!==C&&C.on("exit",this._exitHandler),a.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.wsconnected&&3e4<u._g()-this.wsLastMessageReceived&&E(this,this.ws,null)},3e3),r&&this.connect()}get url(){const e=(t=this.params,S.Tj(t,(e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`).join("&"));var t;return this.serverUrl+"/"+this.roomname+(0===e.length?"":"?"+e)}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),k.Ll&&void 0!==C&&C.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;var e,t;this.bcconnected||(e=this.bcChannel,t=this._bcSubscriber,l(e).subs.add(t),this.bcconnected=!0);const n=m.xv();m.zd(n,0),v(n,this.doc),d(this.bcChannel,m.Fo(n),this);const r=m.xv();m.zd(r,0),f(r,this.doc),d(this.bcChannel,m.Fo(r),this);const a=m.xv();m.zd(a,3),d(this.bcChannel,m.Fo(a),this);const o=m.xv();m.zd(o,1),m.Gu(o,y.X3(this.awareness,[this.doc.clientID])),d(this.bcChannel,m.Fo(o),this)}disconnectBc(){const e=m.xv();m.zd(e,1),m.Gu(e,y.X3(this.awareness,[this.doc.clientID],new Map)),_(this,m.Fo(e)),this.bcconnected&&(((e,t)=>{const n=l(e);n.subs.delete(t)&&0===n.subs.size&&(n.bc.close(),i.delete(e))})(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&E(this,this.ws,null)}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(I(this),this.connectBc())}}var R,z=n(63711),N=n(72490),D=n(9570);!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Error="error"}(R||(R={}));class M{type="datalayer";_status=R.Disconnected;_provider=null;_sharedModel=null;_statusChanged=new N.Signal(this);_errorOccurred=new N.Signal(this);_syncStateChanged=new N.Signal(this);_isDisposed=!1;_config;_onSync=null;_onConnectionClose=null;constructor(e){this._config=e}get status(){return this._status}get isConnected(){return this._status===R.Connected}get isDisposed(){return this._isDisposed}get events(){return{statusChanged:this._statusChanged,errorOccurred:this._errorOccurred,syncStateChanged:this._syncStateChanged}}setStatus(e){this._status!==e&&(this._status=e,this._statusChanged.emit(e))}async connect(e,t,n){if(this.isConnected)console.warn("Already connected to Datalayer collaboration service");else{this.setStatus(R.Connecting);try{const{configuration:r}=D.$K.getState(),a=this._config.runUrl??r?.runUrl,o=this._config.token??r?.token;if(!a)throw new Error("Datalayer runUrl is not configured");if(!o)throw new Error("Datalayer token is not configured");const{ydoc:s,awareness:i}=e,c=z.URLExt.join(a,"/api/spacer/v1/documents"),l=c.replace(/^http/,"ws"),d=await async function({url:e,token:t}){const n={Accept:"application/json"};t&&(n.Authorization=`Bearer ${t}`);const r=await fetch(e,{method:"GET",headers:n,credentials:t?"include":"omit",mode:"cors",cache:"no-store"});if(r.ok)return(await r.json()).sessionId;throw console.error("Failed to fetch session ID.",r),new Error("Failed to fetch session ID.")}({url:z.URLExt.join(c,t),token:o});this._provider=new j(l,t,s,{disableBc:!0,params:{sessionId:d,token:o},awareness:i,...n}),this._sharedModel=e,this._onSync=e=>{this.handleSync(e)},this._onConnectionClose=e=>{e&&this.handleConnectionClose(e)},this._provider.on("sync",this._onSync),this._provider.on("connection-close",this._onConnectionClose),console.log("Connected to Datalayer collaboration service")}catch(e){throw this.setStatus(R.Error),this._errorOccurred.emit(e),e}}}disconnect(){this._provider&&(this._onSync&&this._provider.off("sync",this._onSync),this._onConnectionClose&&this._provider.off("connection-close",this._onConnectionClose),this._provider.disconnect(),this._provider=null),this._sharedModel=null,this.setStatus(R.Disconnected)}getProvider(){return this._provider}getSharedModel(){return this._sharedModel}handleConnectionClose(e){console.warn("Collaboration connection closed:",e),this.setStatus(R.Disconnected),4002===e.code&&console.warn("Datalayer collaboration session expired")}handleSync(e){this._syncStateChanged.emit(e),e&&this.setStatus(R.Connected)}dispose(){this._isDisposed||(this.disconnect(),this._isDisposed=!0)}}},4662:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(52908),a=n.n(r),o=n(10293),s=n.n(o)()(a());s.push([e.id,'.prc-TreeView-TreeViewRootUlStyles-eZtxW{list-style:none;margin:0;padding:0}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0{outline:none}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0):focus-visible>div,:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0).focus-visible>div{box-shadow:var(--boxShadow-thick,inset 0 0 0 .125rem) var(--fgColor-accent,var(--color-accent-fg))}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0):focus-visible>div,:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0).focus-visible>div{outline:2px solid HighlightText;outline-offset:-2}}[data-has-leading-action]:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0){--has-leading-action:1}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn{--level:1;--toggle-width:1rem;--min-item-height:2rem;border-radius:var(--borderRadius-medium,.375rem);color:var(--fgColor-default,var(--color-fg-default));cursor:pointer;display:grid;font-size:var(--text-body-size-medium,.875rem);grid-template-areas:"spacer leadingAction toggle content";grid-template-columns:var(--spacer-width) var(--leading-action-width) var(--toggle-width) 1fr;position:relative;width:100%;--leading-action-width:calc(var(--has-leading-action, 0)*1.5rem);--spacer-width:calc((var(--level) - 1)*(var(--toggle-width)/2))}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):hover{background-color:var(--control-transparent-bgColor-hover,var(--color-action-list-item-default-hover-bg))}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):hover{outline:2px solid transparent;outline-offset:-2px}}@media (pointer:coarse){.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn{--toggle-width:1.5rem;--min-item-height:2.75rem}}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):has(.prc-TreeView-TreeViewItemSkeleton-fqk59):hover{background-color:transparent;cursor:default}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContainer--2Rkn):has(.prc-TreeView-TreeViewItemSkeleton-fqk59):hover{outline:none}}.prc-TreeView-TreeViewRootUlStyles-eZtxW:where([data-omit-spacer=true]) .prc-TreeView-TreeViewItemContainer--2Rkn{grid-template-columns:0 0 0 1fr}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0[aria-current=true]>.prc-TreeView-TreeViewItemContainer--2Rkn{background-color:var(--control-transparent-bgColor-selected,var(--color-action-list-item-default-selected-bg))}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0[aria-current=true]>.prc-TreeView-TreeViewItemContainer--2Rkn):after{background-color:var(--fgColor-accent,var(--color-accent-fg));border-radius:var(--borderRadius-medium,.375rem);content:"";height:1.5rem;left:calc(var(--base-size-8,.5rem)*-1);position:absolute;top:calc(50% - var(--base-size-12,.75rem));width:.25rem}@media (forced-colors:active){:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItem-ShJr0[aria-current=true]>.prc-TreeView-TreeViewItemContainer--2Rkn):after{background-color:HighlightText}}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemToggle-gWUdE{align-items:flex-start;color:var(--fgColor-muted,var(--color-fg-muted));display:flex;grid-area:toggle;height:100%;justify-content:center;padding-top:calc(var(--min-item-height)/2 - var(--base-size-12,.75rem)/2)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemToggleHover-nEgP-:hover{background-color:var(--control-transparent-bgColor-hover,var(--color-action-list-item-default-hover-bg))}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemToggleEnd-t-AEB{border-bottom-left-radius:var(--borderRadius-medium,.375rem);border-top-left-radius:var(--borderRadius-medium,.375rem)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContent-f0r0b{display:flex;gap:var(--stack-gap-condensed,.5rem);grid-area:content;height:100%;line-height:var(--custom-line-height,var(--text-body-lineHeight-medium,1.4285));padding:0 var(--base-size-8,.5rem);padding-bottom:calc((var(--min-item-height) - var(--custom-line-height, 1.3rem))/2);padding-top:calc((var(--min-item-height) - var(--custom-line-height, 1.3rem))/2)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemContentText-smZM-{flex:1 1 auto;width:0}.prc-TreeView-TreeViewRootUlStyles-eZtxW:where([data-truncate-text=true]) .prc-TreeView-TreeViewItemContentText-smZM-{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.prc-TreeView-TreeViewRootUlStyles-eZtxW:where([data-truncate-text=false]) .prc-TreeView-TreeViewItemContentText-smZM-{word-break:break-word}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemVisual-dRlGq{align-items:center;color:var(--fgColor-muted,var(--color-fg-muted));display:flex;height:var(--custom-line-height,1.3rem)}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLeadingAction-VXx8I{color:var(--fgColor-muted,var(--color-fg-muted));display:flex;grid-area:leadingAction}:is(.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLeadingAction-VXx8I)>button{flex-shrink:1}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLevelLine-KPSSL{border-color:var(--borderColor-muted,var(--color-border-muted));border-right:var(--borderWidth-thin,.0625rem) solid;height:100%;width:100%}@media (hover:hover){.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewItemLevelLine-KPSSL{border-color:transparent}.prc-TreeView-TreeViewRootUlStyles-eZtxW:focus-within .prc-TreeView-TreeViewItemLevelLine-KPSSL,.prc-TreeView-TreeViewRootUlStyles-eZtxW:hover .prc-TreeView-TreeViewItemLevelLine-KPSSL{border-color:var(--borderColor-muted,var(--color-border-muted))}}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewDirectoryIcon-PHbeP{color:var(--treeViewItem-leadingVisual-iconColor-rest,var(--color-tree-view-item-directory-fill));display:grid}.prc-TreeView-TreeViewRootUlStyles-eZtxW .prc-TreeView-TreeViewVisuallyHidden-4-mPv{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border-width:0;white-space:nowrap}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0{align-items:center;column-gap:.5rem;display:flex;height:2rem}@media (pointer:coarse){.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0{height:2.75rem}}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+1){--tree-item-loading-width:67%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+2){--tree-item-loading-width:47%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+3){--tree-item-loading-width:73%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+4){--tree-item-loading-width:64%}.prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0:nth-of-type(5n+5){--tree-item-loading-width:50%}.prc-TreeView-TreeItemSkeletonTextStyles-wnBY9{width:var(--tree-item-loading-width,67%)}',""]);const i=s},5700:(e,t,n)=>{n.d(t,{N:()=>l});var r=n(18683),a=n(38621),o=n(98754),s=n(58875),i=n(71791),c=n(84604);function l(e){const{commands:t,model:n}=e;return(0,r.jsxs)(o.A,{className:c.VL,sx:{width:16,position:"relative",marginTop:4,marginLeft:"16px !important","& p":{marginBottom:"0 !important"}},children:[(0,r.jsx)(s.K,{size:"small",color:"secondary","aria-label":"Run cell",title:"Run cell",onClick:e=>{e.preventDefault(),t.execute(i.nx.run).catch(e=>{console.error("Failed to run cell.",e)})},icon:a.udU,variant:"invisible"}),(0,r.jsx)(s.K,{size:"small",color:"secondary","aria-label":"Add code cell above",title:"Add code cell above",onClick:e=>{e.preventDefault(),t.execute(i.nx.insertAbove).catch(e=>{console.error("Failed to insert code cell above.",e)})},icon:a.Mtm,variant:"invisible"}),(0,r.jsx)(s.K,{size:"small",color:"secondary","aria-label":"Add markdown cell above",title:"Add markdown cell above",onClick:e=>{e.preventDefault(),t.execute(i.nx.insertAbove,{cellType:"markdown"}).catch(e=>{console.error("Failed to insert markdown cell above.",e)})},icon:a.Mtm,variant:"invisible"}),"code"===n.type?(0,r.jsx)(s.K,{"aria-label":"Convert to markdow cell",title:"Convert to markdow cell",icon:a.dHM,size:"small",variant:"invisible",onClick:e=>{e.preventDefault(),t.execute(i.nx.changeCellTypeToMarkdown).catch(e=>{console.error("Failed to change cell type to markdown.",e)})}}):(0,r.jsx)(s.K,{"aria-label":"Convert to code cell",title:"Convert to code cell",icon:a.dHM,variant:"invisible",size:"small",onClick:e=>{e.preventDefault(),t.execute(i.nx.changeCellTypeToCode).catch(e=>{console.error("Failed to change cell type to code.",e)})}}),(0,r.jsx)(s.K,{size:"small",color:"secondary","aria-label":"Add markdown cell below",title:"Add markdown cell below",onClick:e=>{e.preventDefault(),t.execute(i.nx.insertBelow,{cellType:"markdown"}).catch(e=>{console.error("Failed to insert markdown cell below.",e)})},icon:a.D3D,variant:"invisible"}),(0,r.jsx)(s.K,{size:"small",color:"secondary","aria-label":"Add code cell above",title:"Add code cell above",onClick:e=>{e.preventDefault(),t.execute(i.nx.insertBelow).catch(e=>{console.error("Failed to insert code cell below.",e)})},icon:a.D3D,variant:"invisible"}),(0,r.jsx)(s.K,{size:"small",color:"error","aria-label":"Delete cell",title:"Delete cell",onClick:e=>{e.preventDefault(),t.execute(i.nx.deleteCells).catch(e=>{console.error("Failed to delete cells.",e)})},icon:a.uv5,variant:"invisible"})]})}},6543:(e,t,n)=>{n.d(t,{C:()=>y});var r=n(18683),a=n(9387),o=n(46343),s=n(34447),i=n(98754),c=n(35650),l=n(34429),d=n(70985),u=n(11029),m=n(81089),h=n(87123),p=n(41273),v=n(6417),f=n(26480),g=n(92131),w=n(33872);function y(e){const{children:t,connection:n,podName:y,multiServiceManager:x,disabled:b}=e,{addRuntimeSnapshot:S,runtimesRunUrl:k,runtimeSnapshots:C,setRuntimeSnapshots:T}=(0,g.c6)(),{trackAsyncTask:A}=(0,p.d)(),[V,E]=(0,a.useState)(!1),[I,_]=(0,a.useState)(!1),[j,R]=(0,a.useState)(!1),[z,N]=(0,a.useState)(C[0]?.id??""),[D,M]=(0,a.useState)();(0,a.useEffect)(()=>{(0,v.Ay)().then(e=>{T(e),!z&&e.length>0&&N(e[0].id)}).catch(e=>{console.error(`Failed to fetch remote kernel snapshots; ${e}`)})},[k]);const L=(0,a.useCallback)(()=>{M(void 0),E(!0)},[]),U=(0,a.useCallback)(e=>{N(e.target.value)},[]),P=(0,a.useCallback)(async({id:e,connection:t,podName:n})=>{n?await(0,v.Pk)({id:n,from:e}):t&&await(0,f.j)({connection:t,id:e})},[]),$=(0,a.useCallback)(async()=>{try{let e,t;R(!0);let r="",a="";if(y&&x?.remote)a=(0,w.u)("cloud"),t=x.remote.runtimesManager.snapshot({podName:y,name:a,description:a,stop:!1}),r=y.split("-",2).reverse()[0],t.then(t=>{e=t});else if(n&&x?.browser){const o=n.model;r=o.id,a=(0,w.u)("browser");let s=!0;t=(0,f.T)({connection:x.browser.kernels.connectTo({model:o}),metadata:{filename:`${a}.data`},onUploadProgress:()=>{s&&(s=!1,(0,v.Ay)().then(t=>{e=t.find(e=>e.name===a)}))}})}t&&(A(t,{error:{message:(e,t)=>"Empty snapshot"===e?`Runtime ${r} will not be snapshotted as it does not contain any serializable state.`:`Failed to pause runtime ${r} - ${e}`},pending:{message:`Taking a snapshot of runtime ${r}…`},success:{message:()=>`Runtime ${r} successfully snapshotted as ${a}.`}}),await t,e&&S(e))}finally{R(!1)}},[n,y,x]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(d.W,{children:[(0,r.jsx)(d.W.Button,{leadingVisual:o.A,variant:"invisible",size:"small",disabled:I||j||b,children:t}),(0,r.jsx)(d.W.Overlay,{children:(0,r.jsxs)(s.l,{children:[(0,r.jsx)(s.l.Item,{onSelect:L,disabled:I||0===C.length,children:"Load a runtime snapshot…"}),(0,r.jsx)(s.l.Item,{onSelect:$,disabled:j,children:"Take a runtime snapshot"})]})})]}),V&&(0,r.jsx)(h.l,{title:(0,r.jsx)("span",{style:{color:"var(--fgColor-default)"},children:"Choose a runtime snapshot to load"}),onClose:()=>{E(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:e=>{e.defaultPrevented||(e.preventDefault(),E(!1))}},{buttonType:"primary",content:I?(0,r.jsx)(l.A,{size:"small"}):"Load",disabled:I,onClick:async e=>{if(!e.defaultPrevented){e.preventDefault(),_(!0);try{M(void 0);const e=C.find(e=>e.id===z);e&&(n||y)?await P({connection:n,id:e.id,podName:y}):M("No runtime snapshot found.")}finally{_(!1),E(!1)}}},autoFocus:!0}],children:(0,r.jsxs)(i.A,{as:"form",children:[(0,r.jsxs)(u.A,{children:[(0,r.jsx)(u.A.Label,{children:"Snapshot"}),(0,r.jsx)(m.A,{name:"snapshot",value:z,onChange:U,block:!0,children:C.map(e=>(0,r.jsx)(m.A.Option,{value:e.id,children:e.name?`${e.name} (${e.id})`:e.id},e.id))})]}),D&&(0,r.jsx)(c.A,{variant:"danger",children:D})]})})]})}y.defaultProps={disabled:!1}},7384:(e,t,n)=>{n.r(t),n.d(t,{createMarkdownParser:()=>l,default:()=>d});var r=n(98238),a=n(63711),o=n(1290),s=n(5279);new r.Token("@jupyterlab/mermaid:IMermaidManager","a manager for rendering mermaid text-based diagrams");const i=new r.Token("@jupyterlab/mermaid:IMermaidMarkdown","a manager for rendering mermaid text-based diagrams in markdown fenced code blocks"),c="```~~~";function l(e,t){return{render:n=>u.render(n,e,t)}}const d={id:"@jupyterlab/markedparser-extension:plugin",description:"Provides the Markdown parser.",autoStart:!0,provides:s.co,requires:[o.SW],optional:[i],activate:(e,t,n)=>l(t,{blocks:n?[n]:[]})};var u;!function(e){let t=null,o=null,s=[],i=null,l={},d=new a.LruCache;async function u(e){if(o)return o;if(t)return await t.promise;s=(null==e?void 0:e.blocks)||[],s=s.sort((e,t)=>{var n,r;return(null!==(n=e.rank)&&void 0!==n?n:1/0)-(null!==(r=t.rank)&&void 0!==r?r:1/0)}),t=new r.PromiseDelegate;const[{marked:a,Renderer:i},c]=await Promise.all([n.e(5846).then(n.bind(n,55846)),m()]);for(const e of c)a.use(e);return l={async:!0,gfm:!0,walkTokens:p,renderer:h(i)},o=a,t.resolve(o),o}async function m(){return Promise.all([(async()=>(await n.e(529).then(n.bind(n,90529))).gfmHeadingId())(),(async()=>(await n.e(9741).then(n.bind(n,59741))).mangle())()])}function h(e){const t=new e,n=t.code;return t.code=({text:e,lang:r,escaped:a})=>{for(const t of s)if(r&&t.languages.includes(r)){const n=t.render(e);if(null!=n)return n}const o=`${r}${c}${e}${c}`,i=d.get(o);return null!=i?i:n.call(t,{text:e,lang:r,escaped:a})},t}async function p(e){if("code"===e.type){if(e.lang)for(const t of s)if(t.languages.includes(e.lang))return void await t.walk(e.text);await async function(e){const{lang:t,text:n}=e;if(!t||!i)return;const r=`${t}${c}${n}${c}`;if(d.get(r))return;const a=document.createElement("div");try{await i.highlight(n,i.findBest(t),a);const e=`<pre><code class="language-${t}">${a.innerHTML}</code></pre>`;d.set(r,e)}catch(e){console.error(`Failed to highlight ${t} code`,e)}finally{a.remove()}}(e)}}e.render=async function(e,t,n){return i=t,o||(o=await u(n)),o(e,l)},e.initializeMarked=u}(u||(u={}))},10069:(e,t,n)=>{n.d(t,{Ks:()=>s});var r=n(97283),a=n(7282);const o=(0,r.y)(e=>({aiAgents:[],addAIAgent:t=>{e(e=>e.aiAgents.includes(t)?{}:{aiAgents:e.aiAgents.concat([t])})},deleteAIAgent:t=>{e(e=>({aiAgents:e.aiAgents.filter(e=>e.documentId===t)}))},updateAIAgent:(t,n)=>{e(e=>{const r=e.aiAgents.findIndex(e=>e.documentId===t);return r>=0?(e.aiAgents[r].runtimeId=n,{aiAgents:[...e.aiAgents]}):{}})}}));function s(e){return(0,a.Pj)(o,e)}},17310:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(9387);const a={small:16,medium:32,large:64};function o({title:e,titleId:t,size:n,...o},s){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 72 72",fill:"currentColor","aria-hidden":"true",ref:s,width:n?"string"==typeof n?a[n]:n:"16px","aria-labelledby":t},o),e?r.createElement("title",{id:t},e):null,r.createElement("circle",{cx:36.146,cy:36.428,r:22.543,fill:"#ea5a47"}),r.createElement("path",{fill:"#d22f27",d:"M52.524 20.931a22.544 22.544 0 01-36.242 26.145A22.542 22.542 0 1052.524 20.93z"}),r.createElement("path",{fill:"#f1b31c",d:"M52.794 22.755c7.674-.926 13.138-.024 14.191 2.849C68.825 30.622 56.51 39.754 39.478 46S7.146 53.242 5.306 48.224c-1.07-2.919 2.647-7.228 9.296-11.552l.076 1.553c-2.509 2.253-3.714 4.341-3.138 5.913 1.434 3.909 13.352 3.133 26.62-1.733S61.02 30.426 59.588 26.517c-.553-1.507-2.665-2.318-5.812-2.466z"}),r.createElement("g",{fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2},r.createElement("path",{d:"M17.156 46.594a21.539 21.539 0 1138.77-18.688M57.677 37.164a21.555 21.555 0 01-34.892 16.164"}),r.createElement("path",{d:"M52.794 22.755c7.674-.926 13.138-.024 14.191 2.849C68.825 30.622 56.51 39.754 39.478 46S7.146 53.242 5.306 48.224c-1.07-2.919 2.647-7.228 9.296-11.552"}),r.createElement("path",{d:"M53.776 24.05c3.147.15 5.259.96 5.811 2.467 1.434 3.91-8.16 11.023-21.428 15.888s-25.185 5.642-26.619 1.733c-.576-1.572.63-3.66 3.138-5.913"})))}const s=r.forwardRef(o)},27203:(e,t,n)=>{n.d(t,{k:()=>ue});var r=n(18683),a=n(9387),o=n(22462),s=n(52982),i=n(90117),c=n(1290),l=n(37706),d=n(62097),u=n(89492),m=n(71784),h=n(67004),p=n(63711),v=n(14377),f=n(47501),g=n(83303),w=n(7384),y=n(30574),x=n(14738),b=n(29028),S=n(47798),k=n(39756),C=n(11796),T=n(70639),A=n(89915),V=n(53054),E=n(75987),I=n(38921),_=n(16950),j=n(79246),R=n(72490),z=n(14809),N=n(59205),D=n(20137),M=n(45458),L=n(89462),U=n(66698),P=n(17402),$=n(66087),F=n(98238),B=n(9366);const H=$.sj.define({combine:e=>e[e.length-1]}),W=D.Lz.baseTheme({".jp-remote-cursor":{borderLeft:"1px solid black",marginLeft:"-1px"},".jp-remote-cursor.jp-mod-primary":{borderLeftWidth:"2px"},".jp-remote-selection":{opacity:.5},".cm-tooltip":{border:"none"},".cm-tooltip.jp-remote-userInfo":{color:"var(--jp-ui-inverse-font-color0)",padding:"0px 2px"}}),O=$.YH.define();class K{style;marker;constructor(e,t){this.style=e,this.marker=t}draw(){const e=this.marker.draw();for(const[t,n]of Object.entries(this.style))e.style[t]=n;return e}eq(e){return this.marker.eq(e.marker)&&F.JSONExt.deepEqual(this.style,e.style)}update(e,t){for(const[t,n]of Object.entries(this.style))e.style[t]=n;return this.marker.update(e,t.marker)}}const Z=(0,D.qd)({above:!0,markers(e){const{awareness:t,ytext:n}=e.state.facet(H),r=n.doc,a=[];return t.getStates().forEach((o,s)=>{if(s===t.doc.clientID)return;const i=o.cursors;for(const t of i??[]){if(!t?.anchor||!t?.head)return;const s=(0,B.IT)(t.anchor,r),i=(0,B.IT)(t.head,r);if(s?.type!==n||i?.type!==n)return;const c=t.primary??1?"jp-remote-cursor jp-mod-primary":"jp-remote-cursor",l=$.OF.cursor(i.index,i.index>s.index?-1:1);for(const t of D.Ip.forRange(e,c,l))a.push(new K({borderLeftColor:o.user?.color??"black"},t))}}),a},update:(e,t)=>!!e.transactions.find(e=>e.annotation(O)),class:"jp-remote-cursors"});function q(e){const t=new Array,{awareness:n,ytext:r}=e.facet(H),a=r.doc;for(const[e,o]of n.getStates())if(e!==n.doc.clientID)for(const e of o.cursors??[]){if(!e?.head)continue;const n=(0,B.IT)(e.head,a);n?.type===r&&t.push({pos:n.index,above:!0,create:()=>{const e=document.createElement("div");return e.classList.add("jp-remote-userInfo"),e.style.backgroundColor=o.user?.color??"darkgrey",e.textContent=o.user?.display_name??"Anonymous",{dom:e}}})}return t}const G=$.sU.define({create:q,update:(e,t)=>t.annotation(O)?q(t.state):e,provide:e=>D.DK.computeN([e],t=>t.field(e))}),J=(0,D.qd)({above:!1,markers(e){const{awareness:t,ytext:n}=e.state.facet(H),r=n.doc,a=[];return t.getStates().forEach((o,s)=>{if(s===t.doc.clientID)return;const i=o.cursors;for(const t of i??[]){if((t.empty??1)||!t?.anchor||!t?.head)return;const s=(0,B.IT)(t.anchor,r),i=(0,B.IT)(t.head,r);if(s?.type!==n||i?.type!==n)return;const c="jp-remote-selection";for(const t of D.Ip.forRange(e,c,$.OF.range(s.index,i.index)))a.push(new K({backgroundColor:o.user?.color??"black"},t))}}),a},update:(e,t)=>!!e.transactions.find(e=>e.annotation(O)),class:"jp-remote-selections"}),X=D.Z9.fromClass(class{editorAwareness;_listener;constructor(e){this.editorAwareness=e.state.facet(H),this._listener=({added:t,updated:n,removed:r})=>{t.concat(n).concat(r).findIndex(e=>e!==this.editorAwareness.awareness.doc.clientID)>=0&&e.dispatch({annotations:[O.of([])]})},this.editorAwareness.awareness.on("change",this._listener)}destroy(){this.editorAwareness.awareness.off("change",this._listener)}update(e){if(!e.docChanged&&!e.selectionSet)return;const{awareness:t,ytext:n}=this.editorAwareness,r=t.getLocalState();if(r){const a=e.view.hasFocus&&e.view.dom.ownerDocument.hasFocus(),o=e.state.selection,s=new Array;if(a&&o){for(const e of o.ranges){const t=e===o.main,r=(0,B.SF)(n,e.anchor),a=(0,B.SF)(n,e.head);s.push({anchor:r,head:a,primary:t,empty:e.empty})}if(!r.cursors||s.length>0){const e=r.cursors?.map(e=>({...e,anchor:e?.anchor?(0,B.sH)(e.anchor):null,head:e?.head?(0,B.sH)(e.head):null}));F.JSONExt.deepEqual(s,e)||t.setLocalStateField("cursors",s)}}}}},{provide:()=>[W,Z,J,G,(0,D.vX)({position:"absolute",parent:document.body})]});var Y=n(50059),Q=n(71791),ee=n(51671);class te{_commands;_panel;_notebook;_context;_defaultCellType="code";constructor(e,t,n){this._commands=e,this._panel=t,this._notebook=t.content,this._context=n}get commands(){return this._commands}get panel(){return this._panel}get notebook(){return this._notebook}get context(){return this._context}setDefaultCellType(e){this._defaultCellType=e}get defaultCellType(){return this._defaultCellType}insertAbove(e){const t=this._notebook;ee.Ft.insertAbove(t),"code"!==this._defaultCellType&&ee.Ft.changeCellType(t,this._defaultCellType),e&&t.activeCell&&t.activeCell.model.sharedModel.setSource(e),t.mode="edit"}insertBelow(e){const t=this._notebook;ee.Ft.insertBelow(t),"code"!==this._defaultCellType&&ee.Ft.changeCellType(t,this._defaultCellType),e&&t.activeCell&&t.activeCell.model.sharedModel.setSource(e),t.mode="edit"}changeCellType(e){const t=this._notebook;t.activeCell&&t.activeCell.model.type!==e&&ee.Ft.changeCellType(t,e)}deleteCells(){const e=this._notebook;ee.Ft.deleteCells(e)}get model(){return this._context.model}dispose(){}}const ne=(0,n(97283).y)((e,t)=>({notebooks:new Map,setNotebooks2:t=>e(e=>({notebooks:t})),selectNotebook2:e=>t().notebooks.get(e),selectNotebookAdapter2:e=>{const n=t().notebooks.get(e);if(n)return n.adapter},run:e=>{t().notebooks.get(e)?.adapter?.commands.execute(Q.nx.run)},runAll:e=>{t().notebooks.get(e)?.adapter?.commands.execute(Q.nx.runAll)},interrupt:e=>{t().notebooks.get(e)?.adapter?.commands.execute(Q.nx.interrupt)},insertAbove:e=>{t().notebooks.get(e.id)?.adapter?.setDefaultCellType(e.cellType),t().notebooks.get(e.id)?.adapter?.insertAbove(e.source)},insertBelow:e=>{t().notebooks.get(e.id)?.adapter?.setDefaultCellType(e.cellType),t().notebooks.get(e.id)?.adapter?.insertBelow(e.source)},delete:e=>{t().notebooks.get(e)?.adapter?.commands.execute(Q.nx.deleteCells)},changeCellType:e=>{t().notebooks.get(e.id)?.adapter?.changeCellType(e.cellType)},reset:()=>e(e=>({notebooks:new Map}))})),re=1e3,ae=new Array,oe=".datalayer/ping.ipynb";function se(e){const{commands:t,extensions:n=ae,kernelId:o,renderers:c,serviceManager:p,model:f,onSessionConnection:g}=e,[w,y]=(0,a.useState)(!0),[C,T]=(0,a.useState)(new Array),[A,V]=(0,a.useState)(null),[E,_]=(0,a.useState)(null),j=(0,a.useMemo)(()=>e.id||(0,P.YG)(),[e.id]),D=(0,a.useMemo)(()=>e.path||oe,[e.path]),$=(0,a.useMemo)(()=>new ie({commands:t,renderers:c}),[t,c]),F=(0,a.useMemo)(()=>new x.S.ContentFactory({editorFactory:$.editorServices.factoryService.newInlineEditor}),[$.editorServices.factoryService.newInlineEditor]);(0,a.useEffect)(()=>{const e=new l.A({model:new d.X}),t=new z.x0,n=new u.C({context:{widget:t},providers:[new m.G],timeout:re}),r=new h.$({completer:e,reconciliator:n});return e.hide(),z.x0.attach(e,document.body),V(r),()=>{r.dispose(),e.dispose(),t.dispose()}},[]);const[B,H]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=new b.k({name:"Notebook",label:"Notebook",modelName:"notebook",fileTypes:["notebook"],defaultFor:["notebook"],preferKernel:!0,autoStartDefault:!1,canStartKernel:!1,shutdownOnClose:!1,rendermime:$.rendermime,contentFactory:F,mimeTypeService:$.editorServices.mimeTypeService,notebookConfig:{...S.a.defaultNotebookConfig,recordTiming:!0}});return H(e),()=>{e.dispose(),H(t=>t===e?null:t)}},[F,$]);const[W,O]=(0,a.useState)(null);(0,a.useEffect)(()=>{const t=A?new k.G({namespace:j}):null,n=A?(0,Q.VV)($.commands,A,t,e.path):null;return O(t),()=>{n?.dispose(),t?.dispose(),O(e=>e===t?null:e)}},[A,j,$.commands,e.path]);const[K,Z]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=new ce(f),t=new v.o({factory:e,manager:p??new le,path:D,kernelPreference:{shouldStart:!1,canStart:!1,autoStartDefault:!1,shutdownOnDispose:!1}});return function(e,t,n,r,a=!1){const o=!n;e.sessionContext._initialize=async()=>{const t=e.sessionContext.sessionManager;await t.ready,await t.refreshRunning();const r=(0,I.find)(t.running(),t=>t.kernel?.id===(e.sessionContext.kernelPreference.id??""));if(r)try{const a=t.connectTo({model:{...r,path:n??r.path,name:n??r.name},kernelConnectionOptions:{handleComms:!0}});e.sessionContext._handleNewSession(a),this._kernel?.connection?.dispose()}catch(t){return e.sessionContext._handleSessionError(t),Promise.reject(t)}return await e.sessionContext._startIfNecessary()},e.dispose=()=>{e.isDisposed||(e._isDisposed=!0,e.sessionContext.dispose(),e._disposed.emit(void 0),R.Signal.clearData(this))},o&&(e._populate=async()=>{if(e._isPopulated=!0,e._isReady=!0,e._populatedPromise.resolve(void 0),e.isDisposed)return;const t=e._model.defaultKernelName||e.sessionContext.kernelPreference.name;e.sessionContext.kernelPreference={...e.sessionContext.kernelPreference,name:t,language:e._model.defaultKernelLanguage},a||e.sessionContext.initialize().then(t=>{t&&e._dialogs.selectKernel(e.sessionContext.sessionContext)})},e.initialize=async n=>{e.model.dirty=!1;const r=(new Date).toISOString(),a={path:t,name:t,type:"notebook",content:void 0,writable:!0,created:r,last_modified:r,mimetype:"application/x-ipynb+json",format:"json"};e._updateContentsModel(a),await e._populate(),e.model.sharedModel.clearUndoHistory()}),e.sessionContext.sessionChanged.connect((e,t)=>{const n=t.newValue;console.log("Current Jupyter Session Connection.",n),r?.(n??void 0)}),e.sessionContext.kernelChanged.connect((e,t)=>{const n=t.newValue;console.log("Current Jupyter Kernel Connection.",n),n&&!n.handleComms&&(console.log("Updating the current Kernel Connection to enforce Comms support.",n.handleComms),n.handleComms=!0)}),e.sessionContext.ready.then(()=>{r?.(e?.sessionContext.session??void 0)}),e.initialize(!n)}(t,j,D!==oe?D:void 0,g,!p),Z(t),()=>{t.dispose(),e.dispose(),Z(e=>e===t?null:e)}},[j,p,f,g,D]),(0,a.useEffect)(()=>{K&&o&&!K.sessionContext.isDisposed&&K.sessionContext.changeKernel({id:o}).catch(e=>{console.error("Failed to change kernel model.",e)})},[K,o]);const[q,G]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=null,t=null,a=null;if(K&&(e=B?.createNew(K)??null,e)){t=new te($.commands,e,K),_(t),T(n.map(t=>(t.init({notebookId:j,commands:$.commands,panel:e}),t.createNew(e,K),t.component??(0,r.jsx)(r.Fragment,{}))));const o=e.content.rendermime;a=new M.SS(K,o,{saveState:!1}),o.addFactory({safe:!0,mimeTypes:[L.a],defaultRank:1,createRenderer:e=>new U.X(e,a)},1);for(const t of e.content.widgets)if("code"===t.model.type)for(const e of t.outputArea.widgets)for(const t of Array.from(e.children()))t instanceof U.X&&(t.manager=a);y(!1)}return G(e),e||(T([]),_(null)),()=>{if(a?.dispose(),t&&t.dispose(),e){e.content&&R.Signal.clearData(e.content);try{e.dispose()}catch(e){}}G(t=>t===e?null:t),_(e=>e===t?null:e)}},[K,n,$.commands,B]),(0,a.useEffect)(()=>{if(E){const e=ne.getState().notebooks,t=new Map(e);t.set(j,{adapter:E}),ne.getState().setNotebooks2(t)}else{const e=ne.getState().notebooks;if(e.has(j)){const t=new Map(e);t.delete(j),ne.getState().setNotebooks2(t)}}},[E,j]),(0,a.useEffect)(()=>{let e=!0,t=null,n=null;return q&&(W&&(W.has(q)||W.add(q).catch(e=>{console.error(`Failed to track the notebook panel '${j}'.`)})),A&&(t=(e,t)=>{t&&t.ready.then(()=>{A.editor=t?.editor})},n=(t,n)=>{if(!e)return;const r=q.content.activeCell?.editor,a=new m.G,o=new u.C({context:{widget:q,editor:r,session:n.newValue},providers:[a],timeout:re});A.editor=r,A.reconciliator=o},q.context.sessionContext.sessionChanged.connect(n),q.context.sessionContext.ready.then(()=>{n?.(q.context.sessionContext,{name:"session",oldValue:null,newValue:q.context.sessionContext.session})}),q.content.activeCellChanged.connect(t))),()=>{e=!1,A&&(t&&q?.content.activeCellChanged.disconnect(t),n&&q?.context.sessionContext.sessionChanged.connect(n),A.editor=null,A.reconciliator=new u.C({context:{widget:new z.x0},providers:[new m.G],timeout:re}))}},[A,q,W]),(0,a.useEffect)(()=>{const e=e=>{$.commands.processKeydownEvent(e)};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[$.commands]),(0,a.useEffect)(()=>()=>{const e=ne.getState().notebooks;if(e.has(j)){const t=new Map(e);t.delete(j),ne.getState().setNotebooks2(t)}},[j]),(0,r.jsxs)(r.Fragment,{children:[C.map((e,t)=>(0,r.jsx)(s.az,{children:e},`${e}-${t}`)),w?(0,r.jsx)(i.a,{},"notebook-loader"):q?(0,r.jsx)(s.az,{sx:{height:"100%"},children:(0,r.jsx)(Y.j,{id:j,children:q},"notebook-container")}):(0,r.jsx)(N.l,{variant:"critical",description:"Unable to create the notebook view.",hideTitle:!0,title:"Error"},"notebook-error")]})}class ie{_commands;_editorServices;_rendermime;constructor(e={}){this._commands=e.commands??new _.J;const t=new c.T9;for(const e of c.T9.getDefaultLanguages())t.addLanguage(e);t.addLanguage({name:"ipythongfm",mime:"text/x-ipythongfm",load:async()=>(await Promise.all([n.e(6636),n.e(9946),n.e(2899),n.e(5949)]).then(n.bind(n,15949))).markdown({codeLanguages:e=>t.findBest(e)})});const r=A.dn.filter(e=>"text/javascript"!==e.mimeTypes[0]).concat([g.rendererFactory,f.rendererFactory]).concat(e.renderers??[]);this._rendermime=new V.K({initialFactories:r,latexTypesetter:new y.p,markdownParser:(0,w.createMarkdownParser)(t)});const a=new c.mN(t),o=new c.k8;for(const e of c.k8.getDefaultThemes())o.addTheme(e);const s=new c.AG;for(const e of c.AG.getDefaultExtensions({themes:o}))s.addExtension(e);s.addExtension({name:"shared-model-binding",factory:e=>{const t=e.model.sharedModel;return c.AG.createImmutableExtension((0,c.rX)({ytext:t.ysource,undoManager:t.undoManager??void 0}))}}),s.addExtension({name:"remote-user-cursors",factory(e){const{awareness:t,ysource:n}=e.model.sharedModel;return c.AG.createImmutableExtension((r={awareness:t,ytext:n},[H.of(r),X]));var r}});const i=function(){const e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null}();i&&s.addExtension({name:"csp-nonce",factory:()=>c.AG.createImmutableExtension(D.Lz.cspNonce.of(i))});const l=new c.Ez({extensions:s,languages:t});this._editorServices={factoryService:l,mimeTypeService:a}}get commands(){return this._commands}get editorServices(){return this._editorServices}get rendermime(){return this._rendermime}}class ce extends T.p{model;constructor(e){super(),this.model=e}createNew(e){return this.model}}class le{contents=Object.freeze({fileChanged:{connect:()=>{}},getSharedModelFactory:e=>null,localPath(e){const t=e.split("/"),n=t[0].split(":");return 1!==n.length&&this._additionalDrives.has(n[0])?p.PathExt.join(n.slice(1).join(":"),...t.slice(1)):p.PathExt.removeSlash(e)},normalize(e){const t=e.split(":");return 1===t.length?p.PathExt.normalize(e):`${t[0]}:${p.PathExt.normalize(t.slice(1).join(":"))}`}});kernelspecs=Object.freeze({ready:new Promise(()=>{})});sessions=Object.freeze({ready:new Promise(()=>{})});ready=Promise.resolve()}const de=o.DU`
  .dla-Box-Notebook .jp-Cell .dla-CellSidebar-Container {
    display: none;
  }
  .dla-Box-Notebook .jp-Cell.jp-mod-active .dla-CellSidebar-Container {
    display: block;
  }
`;function ue(e){const{Toolbar:t,children:n,cellSidebarMargin:o=120,collaborationProvider:c,commands:l,extensions:d,height:u="100vh",maxHeight:m="100vh",id:h,nbformat:p,onNotebookModelChanged:v,onSessionConnection:f,path:g,readonly:w=!1,renderers:y,serviceManager:x,startDefaultKernel:b=!1,url:S}=e,[k,T]=(0,a.useState)(!0),A=function(e={}){const{kernels:t,requestedKernelId:n,startDefaultKernel:r=!1}=e,[o,s]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{let e,a=!0;return t&&(async()=>{let o;if(await t.ready,n)for(const e of t.running())if(e.id===n){o=n;break}!o&&r&&a&&(console.log("Starting new kernel."),e=await t.startNew(),a?o=e.id:e.dispose()),a&&s(o)})(),()=>{a=!1,e&&(console.log(`Shutting down kernel '${e.id}'.`),e.shutdown().catch(t=>{console.warn(`Failed to shutdown kernel '${e?.id}'.`,t)}).finally(()=>{e?.dispose()}))}},[t,n,r]),o}({requestedKernelId:e.kernelId,kernels:x.kernels,startDefaultKernel:b}),V=function(e){const{collaborationProvider:t,nbformat:n,readonly:r=!1,url:o,path:s,serviceManager:i,id:c}=e,[l,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=!0;const a=new j.DisposableSet;if(t&&i&&c){const n=async()=>{try{const n=new E.Xn;if(await t.connect(n,c,{serviceManager:i,path:s}),e){const e=new C.x({collaborationEnabled:!0,disableDocumentWideUndoRedo:!0,sharedModel:n});e.readOnly=r,d(e),a.add({dispose:()=>{t.disconnect()},get isDisposed(){return!1}})}}catch(e){console.error("Failed to setup collaboration:",e)}};n()}else{const t=e=>{const t=new C.x;e&&(e.cells.forEach(e=>{e.metadata.editable=!r}),t.fromJSON(e)),t.readOnly=r,d(t)};!n&&o?async function(e){return fetch(e).then(e=>e.text()).then(e=>JSON.parse(e))}(o).then(n=>{e&&t(n)}):t(n)}return()=>{e=!1,a.dispose()}},[t,n,r,o,s,i,c]),l}({collaborationProvider:c,nbformat:p,readonly:w,url:S,path:g,serviceManager:x,id:h});return(0,a.useEffect)(()=>{V&&T(!1),v?.(V)},[V,v]),(0,a.useEffect)(()=>{const e=()=>{c&&V&&V.sharedModel.awareness.setLocalStateField("user",x.user.identity)};return e(),x.user.userChanged.connect(e),()=>{x.user.userChanged.disconnect(e)}},[c,V,x]),k?(0,r.jsx)(i.a,{},"notebook-loader"):(0,r.jsxs)(s.az,{style:{height:u,width:"100%",position:"relative"},id:"dla-Jupyter-Notebook",children:[t&&(0,r.jsx)(t,{notebookId:h}),(0,r.jsxs)(s.az,{className:"dla-Box-Notebook",sx:{height:u,maxHeight:m,width:"100%",overflowY:"hidden","& .datalayer-NotebookPanel-header":{minHeight:"50px"},"& .jp-Notebook":{flex:"1 1 auto !important",height:"100%",overflowY:"scroll"},"& .jp-NotebookPanel":{},"& .jp-Toolbar":{display:"none",zIndex:0},"& .jp-Toolbar .jp-HTMLSelect.jp-DefaultStyle select":{fontSize:"14px"},"& .jp-Toolbar > .jp-Toolbar-responsive-opener":{display:"none"},"& .jp-Toolbar-kernelName":{display:"none"},"& .jp-Cell":{width:`calc(100% - ${o}px)`},"& .jp-Notebook-footer":{width:`calc(100% - ${o+82}px)`},"& .jp-CodeMirrorEditor":{cursor:"text !important"},".dla-Box-Notebook":{position:"relative"}},children:[n,(0,r.jsx)(de,{}),V&&x&&(0,r.jsx)(se,{commands:l,id:h,extensions:d,kernelId:A,model:V,path:g,renderers:y,serviceManager:x,onSessionConnection:f})]})]})}},27446:(e,t,n)=>{n.d(t,{R:()=>i});var r=n(18683),a=n(99180),o=n(38621),s=n(18316);const i=e=>{const{data:t,fileName:n,variant:i,extension:c}=e;return(0,r.jsx)(a.Q,{variant:i,leadingVisual:o.s3U,onClick:e=>(0,s.xD)(t,n,c),children:"Download"})};i.defaultProps={variant:"default",name:"data",extension:"json"}},32916:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(9387);const a={small:16,medium:32,large:64};function o({title:e,titleId:t,size:n,colored:o,...s},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:o?"currentColor":["#fff","#fffff","white","#FFF","#FFFFFF"].includes("currentColor")?"white":"currentColor",fillRule:"evenodd",style:{width:n?"string"==typeof n?a[n]:n:"16px",flex:"none",lineHeight:1},viewBox:"0 0 24 24","aria-hidden":"true",ref:i,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{d:"M15.688 2.343a2.588 2.588 0 00-3.61 0l-9.626 9.44a.863.863 0 01-1.203 0 .823.823 0 010-1.18l9.626-9.44a4.313 4.313 0 016.016 0 4.116 4.116 0 011.204 3.54 4.3 4.3 0 013.609 1.18l.05.05a4.115 4.115 0 010 5.9l-8.706 8.537a.274.274 0 000 .393l1.788 1.754a.823.823 0 010 1.18.863.863 0 01-1.203 0l-1.788-1.753a1.92 1.92 0 010-2.754l8.706-8.538a2.47 2.47 0 000-3.54l-.05-.049a2.588 2.588 0 00-3.607-.003l-7.172 7.034-.002.002-.098.097a.863.863 0 01-1.204 0 .823.823 0 010-1.18l7.273-7.133a2.47 2.47 0 00-.003-3.537z"}),r.createElement("path",{d:"M14.485 4.703a.823.823 0 000-1.18.863.863 0 00-1.204 0l-7.119 6.982a4.115 4.115 0 000 5.9 4.314 4.314 0 006.016 0l7.12-6.982a.823.823 0 000-1.18.863.863 0 00-1.204 0l-7.119 6.982a2.588 2.588 0 01-3.61 0 2.47 2.47 0 010-3.54l7.12-6.982z"}))}const s=r.forwardRef(o)},35903:(e,t,n)=>{n.d(t,{Gr:()=>s});var r=n(97283),a=n(7282);const o=(0,r.y)((e,t)=>({datasources:[],updateDatasources:t=>e(e=>({datasources:t}))}));function s(e){return(0,a.Pj)(o,e)}},45077:(e,t,n)=>{n.d(t,{O:()=>a});var r=n(18683);const a=e=>{const{code:t}=e;return(0,r.jsx)("pre",{style:{fontSize:"12px",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:t})}},56944:(e,t,n)=>{n.d(t,{w:()=>s});var r=n(63711),a=n(9570),o=n(76199);const s=(e="api/ai-agents/v1")=>{const{configuration:t}=(0,a._O)(),{requestDatalayer:n}=(0,o.F)({notifyOnError:!1});return{createAIAgent:(a,o,s,i,c,{signal:l,baseUrl:d=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,d,"agents"),method:"POST",body:{document_id:a,document_type:o,runtime:{ingress:s,token:i,kernel_id:c}},signal:l}),getAIAgents:({signal:a,baseUrl:o=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,o,"agents"),method:"GET",signal:a}),deleteAIAgent:(a,{signal:o,baseUrl:s=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,s,"agents",a),method:"DELETE",signal:o}),getAIAgent:(a,{signal:o,baseUrl:s=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,s,"agents",a),method:"GET",signal:o}),patchAIAgent:(a,o,s,i,{signal:c,baseUrl:l=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,l,"agents",a),method:"PATCH",body:{runtime:o&&s&&i?{ingress:o,token:s,kernel_id:i}:null},signal:c})}}},66210:(e,t,n)=>{n.d(t,{G:()=>s});var r=n(9387),a=n(10069),o=n(56944);function s(e){const{getAIAgent:t}=(0,o.w)(),{aiAgents:n,addAIAgent:s,deleteAIAgent:i,updateAIAgent:c}=(0,a.Ks)();return(0,r.useEffect)(()=>{let r;const a=setInterval(async()=>{r=new AbortController;try{const a=await t(e,{signal:r.signal});if(!a.success)return void i(e);const o=n.find(t=>t.documentId===e),l=a.agent.runtime?.id;o?o.runtimeId!==l&&c(e,l):s({documentId:e,runtimeId:l})}catch(t){i(e)}},6e4);return()=>{r?.abort("Component unmounted"),clearInterval(a)}},[n,e]),n.find(t=>t.documentId===e)}},68652:(e,t,n)=>{n.d(t,{XV:()=>fe});var r=n(18683),a=n(9387),o=n(63711),s=n(98238),i=n(81461),c=n(58875),l=n(34429),d=n(87319),u=n(38621),m=n(34164),h=n(46186),p=n.n(h),v=n(4662);p()(v.A,{insert:"head",singleton:!1}),v.A.locals;var f="prc-TreeView-TreeViewItemVisual-dRlGq",g="prc-TreeView-TreeViewVisuallyHidden-4-mPv",w=n(17781),y=n(58449),x=n(41896),b=n(92209),S=n(27432);function k(e){var t,n,r;const a=e.getAttribute("aria-label"),o=e.getAttribute("aria-labelledby");return a||(o?null!==(t=null===(n=document.getElementById(o))||void 0===n?void 0:n.textContent)&&void 0!==t?t:"":null!==(r=e.textContent)&&void 0!==r?r:"")}var C=n(27907);function T(e){return e&&e!==document.body?function(e){return e.scrollHeight>e.clientHeight&&!(-1!==window.getComputedStyle(e).overflowY.indexOf("hidden"))}(e)?e:T(e.parentElement):null}var A=n(94761);function V(e,t,n){var r;if(t instanceof HTMLElement){try{if(t.closest("dialog:modal"))return}catch{}return null!==(r=function(e,t){switch(`${function(e){if("treeitem"!==e.getAttribute("role"))throw new Error("Element is not a treeitem");switch(e.getAttribute("aria-expanded")){case"true":return"open";case"false":return"closed";default:return"end"}}(e)} ${t.key}`){case"open ArrowRight":return I(e);case"open ArrowLeft":case"closed ArrowRight":case"end ArrowRight":return;case"closed ArrowLeft":case"end ArrowLeft":return _(e)}switch(t.key){case"ArrowUp":return E(e,"previous");case"ArrowDown":return E(e,"next");case"Backspace":return _(e);case"Home":return function(e){const t=e.closest("[role=tree]"),n=null==t?void 0:t.querySelector("[role=treeitem]");return n instanceof HTMLElement?n:void 0}(e);case"End":return function(e){const t=e.closest("[role=tree]"),n=Array.from((null==t?void 0:t.querySelectorAll("[role=treeitem]"))||[]);if(0===n.length)return;let r=n.length-1,a=n[r];for(;r>0&&a instanceof HTMLElement&&null!==(o=a.parentElement)&&void 0!==o&&o.closest("[role=treeitem][aria-expanded=false]");){var o;r-=1,a=n[r]}return a instanceof HTMLElement?a:void 0}(e);case"PageUp":return function(e){const t=e.closest('[role="tree"]');if(!t)return;const n=Array.from(t.querySelectorAll('[role="treeitem"]'));if(0===n.length)return;const r=R(t,n[0].firstElementChild),a=Math.floor(n.indexOf(e)/r),o=n.indexOf(e)-r*a;return n[Math.max(0,(a-1)*r+o)]}(e);case"PageDown":return function(e){const t=e.closest('[role="tree"]');if(!t)return;const n=Array.from(t.querySelectorAll('[role="treeitem"]'));if(0===n.length)return;const r=R(t,n[0].firstElementChild),a=Math.floor(n.indexOf(e)/r),o=n.indexOf(e)-r*a;return n[Math.min(n.length-1,(a+1)*r+o)]}(e)}}(t,n))&&void 0!==r?r:t}}function E(e,t){const n=e.closest("[role=tree]");if(!n)return;const r=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,e=>e instanceof HTMLElement&&"treeitem"===e.getAttribute("role")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP);let a=r.firstChild();for(;a!==e;)a=r.nextNode();let o="next"===t?r.nextNode():r.previousNode();for(;o instanceof HTMLElement&&null!==(s=o.parentElement)&&void 0!==s&&s.closest("[role=treeitem][aria-expanded=false]");){var s;o="next"===t?r.nextNode():r.previousNode()}return o instanceof HTMLElement?o:void 0}function I(e){const t=e.querySelector("[role=treeitem]");return t instanceof HTMLElement?t:void 0}function _(e){const t=e.closest("[role=group]"),n=null==t?void 0:t.closest("[role=treeitem]");return n instanceof HTMLElement?n:void 0}const j={height:32};function R(e,t){var n,r;const a=T(e),{height:o}=null!==(n=null==t?void 0:t.getBoundingClientRect())&&void 0!==n?n:j,s=null!==(r=null==a?void 0:a.clientHeight)&&void 0!==r?r:window.innerHeight;return Math.floor(s/o)}function z(e){return e===document.activeElement}var N=n(72533),D=n(74306),M=n(49740);const L=a.createContext({announceUpdate:()=>{},expandedStateCache:{current:new Map}}),U=a.createContext({itemId:"",level:1,isSubTreeEmpty:!1,setIsSubTreeEmpty:()=>{},isExpanded:!1,setIsExpanded:()=>{},leadingVisualId:"",trailingVisualId:""}),P=e=>{const t=(0,d.c)(23),{"aria-label":n,"aria-labelledby":o,children:s,flat:i,truncate:c,className:l,style:u}=e,h=void 0===c||c,p=a.useRef(null),v=a.useRef(!1),[f,g]=a.useState("");let w;t[0]===Symbol.for("react.memo_cache_sentinel")?(w=e=>{g(e)},t[0]=w):w=t[0];const x=w;let S;t[1]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{v.current=!0},t[1]=S):S=t[1];const T=S;let E,I,_,j;t[2]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{const e=function(){v.current=!1};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}},I=[],t[2]=E,t[3]=I):(E=t[2],I=t[3]),(0,a.useEffect)(E,I),t[4]===Symbol.for("react.memo_cache_sentinel")?(_={containerRef:p,mouseDownRef:v},t[4]=_):_=t[4],function(e){const t=(0,d.c)(6),{containerRef:n,mouseDownRef:r}=e;let a,o;t[0]!==n||t[1]!==r?(a=()=>{var e,t,a;if(r.current)return;const o=null===(e=n.current)||void 0===e?void 0:e.querySelector("[aria-current]"),s=null===(t=n.current)||void 0===t?void 0:t.querySelector('[role="treeitem"]');return o instanceof HTMLElement?o:document.activeElement instanceof HTMLElement&&null!==(a=n.current)&&void 0!==a&&a.contains(document.activeElement)&&"treeitem"===document.activeElement.getAttribute("role")?document.activeElement:s instanceof HTMLElement?s:void 0},t[0]=n,t[1]=r,t[2]=a):a=t[2],t[3]!==n||t[4]!==a?(o={containerRef:n,bindKeys:A.z0.ArrowVertical|A.z0.ArrowHorizontal|A.z0.HomeAndEnd|A.z0.Backspace|A.z0.PageUpDown,preventScroll:!0,getNextFocusable:V,focusInStrategy:a},t[3]=n,t[4]=a,t[5]=o):o=t[5],(0,C.G)(o)}(_),t[5]===Symbol.for("react.memo_cache_sentinel")?(j={containerRef:p,onFocusChange:Q},t[5]=j):j=t[5],function(e){const t=(0,d.c)(11),{containerRef:n,onFocusChange:r}=e,o=a.useRef(""),s=a.useRef(0),i=a.useRef(r),{safeSetTimeout:c,safeClearTimeout:l}=(0,b.A)();let u,m,h;t[0]!==r?(u=()=>{i.current=r},m=[r],t[0]=r,t[1]=u,t[2]=m):(u=t[1],m=t[2]),a.useEffect(u,m),t[3]!==n?(h=e=>{if(!e)return;if(!n.current)return;const t=n.current,r=Array.from(t.querySelectorAll('[role="treeitem"]')),a=r.findIndex(z);let o=(c=a,(s=r).map((e,t)=>s[(c+t)%s.length]));var s,c;1===e.length&&(o=o.slice(1));const l=o.find(t=>k(t).toLowerCase().startsWith(e.toLowerCase()));l&&i.current(l)},t[3]=n,t[4]=h):h=t[4];const p=h;let v,f;t[5]!==n||t[6]!==p||t[7]!==l||t[8]!==c?(v=()=>{if(!n.current)return;const e=n.current,t=function(e){!e.key||e.key.length>1||" "===e.key||e.ctrlKey||e.altKey||e.metaKey||(o.current=o.current+e.key,p(o.current),l(s.current),s.current=c(()=>o.current="",300),e.preventDefault(),e.stopPropagation())};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)},f=[n,p,l,c],t[5]=n,t[6]=p,t[7]=l,t[8]=c,t[9]=v,t[10]=f):(v=t[9],f=t[10]),a.useEffect(v,f)}(j);const R=a.useRef(null);if(null===R.current){let e;t[6]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,t[6]=e):e=t[6],R.current=e}let N,D;t[7]===Symbol.for("react.memo_cache_sentinel")?(N={announceUpdate:x,expandedStateCache:R},t[7]=N):N=t[7],t[8]!==f?(D=(0,r.jsx)(y.A,{role:"status","aria-live":"polite","aria-atomic":"true",children:f}),t[8]=f,t[9]=D):D=t[9];const M=h||!1;let U,P,$;return t[10]!==l?(U=(0,m.$)(l,"prc-TreeView-TreeViewRootUlStyles-eZtxW"),t[10]=l,t[11]=U):U=t[11],t[12]!==n||t[13]!==o||t[14]!==s||t[15]!==i||t[16]!==u||t[17]!==M||t[18]!==U?(P=(0,r.jsx)("ul",{ref:p,role:"tree","aria-label":n,"aria-labelledby":o,"data-omit-spacer":i,"data-truncate-text":M,onMouseDown:T,className:U,style:u,children:s}),t[12]=n,t[13]=o,t[14]=s,t[15]=i,t[16]=u,t[17]=M,t[18]=U,t[19]=P):P=t[19],t[20]!==P||t[21]!==D?($=(0,r.jsx)(L.Provider,{value:N,children:(0,r.jsxs)(r.Fragment,{children:[D,P]})}),t[20]=P,t[21]=D,t[22]=$):$=t[22],$};P.displayName="TreeView";const $=a.forwardRef(({id:e,containIntrinsicSize:t,current:n=!1,defaultExpanded:o,expanded:s,onExpandedChange:i,onSelect:c,children:l,className:h,"aria-label":p,"aria-labelledby":v},f)=>{const[g,w]=(0,S.H)(l,{leadingAction:J,leadingVisual:q,trailingVisual:G}),{expandedStateCache:y}=a.useContext(L),b=(0,x.B)(),k=(0,x.B)(),C=(0,x.B)(),[T,A]=function({name:e="custom",defaultValue:t,value:n,onChange:r}){const[o,s]=a.useState(null!=n?n:t),i=a.useRef(null),c=a.useRef(r);a.useEffect(()=>{c.current=r}),null===i.current&&(i.current=void 0!==n);const l=a.useCallback(e=>{var t;const n="function"==typeof e?e(o):e;!1===i.current&&s(n),null===(t=c.current)||void 0===t||t.call(c,n)},[o]);return a.useEffect(()=>{i.current,i.current},[e,n]),!0===i.current?[n,l]:[o,l]}({name:e,defaultValue:()=>{var t,r,a;return null!==(t=null!==(r=null===(a=y.current)||void 0===a?void 0:a.get(e))&&void 0!==r?r:o)&&void 0!==t?t:n},value:null!==s&&s,onChange:i}),{level:V}=a.useContext(U),{hasSubTree:E,subTree:I,childrenWithoutSubTree:_}=function(e){const t=(0,d.c)(8);let n,r;t[0]!==e?(r=a.Children.toArray(e).find(Z),t[0]=e,t[1]=r):r=t[1];const o=r;let s;t[2]!==e?(s=a.Children.toArray(e).filter(K),t[2]=e,t[3]=s):s=t[3];const i=s,c=Boolean(o);let l;return t[4]!==i||t[5]!==o||t[6]!==c?(l={subTree:o,childrenWithoutSubTree:i,hasSubTree:c},t[4]=i,t[5]=o,t[6]=c,t[7]=l):l=t[7],n=l,n}(w),[j,R]=a.useState(!E),[z,N]=a.useState(!1),D=a.useCallback(t=>{var n;A(t),null===(n=y.current)||void 0===n||n.set(e,t)},[e,A,y]),M=a.useCallback(e=>{D(!T),null==e||e.stopPropagation()},[T,D]),P=a.useCallback(e=>{switch(e.key){case"Enter":case" ":c?c(e):M(e),e.stopPropagation();break;case"ArrowRight":if(e.altKey||e.metaKey)return;e.preventDefault(),e.stopPropagation(),D(!0);break;case"ArrowLeft":if(e.altKey||e.metaKey)return;e.preventDefault(),e.stopPropagation(),D(!1)}},[c,D,M]),$=[g.leadingVisual?k:null,g.trailingVisual?C:null].filter(Boolean);return(0,r.jsx)(U.Provider,{value:{itemId:e,level:V+1,isSubTreeEmpty:j,setIsSubTreeEmpty:R,isExpanded:T,setIsExpanded:D,leadingVisualId:k,trailingVisualId:C},children:(0,r.jsxs)("li",{className:(0,m.$)("PRIVATE_TreeView-item",h,"prc-TreeView-TreeViewItem-ShJr0"),ref:f,tabIndex:0,id:e,role:"treeitem","aria-label":p,"aria-labelledby":p?void 0:v||b,"aria-describedby":$.length?$.join(" "):void 0,"aria-level":V,"aria-expanded":(!j||T&&E)&&null!==s?T:void 0,"aria-current":n?"true":void 0,"aria-selected":z?"true":"false","data-has-leading-action":!!g.leadingAction||void 0,onKeyDown:P,onFocus:e=>{var t;null===(t=e.currentTarget.firstElementChild)||void 0===t||t.scrollIntoView({block:"nearest",inline:"nearest"}),N(!0),e.stopPropagation()},onBlur:()=>N(!1),onClick:e=>{c?c(e):M(e),e.stopPropagation()},onAuxClick:e=>{c&&1===e.button&&c(e),e.stopPropagation()},children:[(0,r.jsxs)("div",{className:(0,m.$)("PRIVATE_TreeView-item-container","prc-TreeView-TreeViewItemContainer--2Rkn"),style:{"--level":V,contentVisibility:t?"auto":void 0,containIntrinsicSize:t},children:[(0,r.jsx)("div",{style:{gridArea:"spacer",display:"flex"},children:(0,r.jsx)(F,{level:V})}),g.leadingAction,E?(0,r.jsx)("div",{className:(0,m.$)("PRIVATE_TreeView-item-toggle",c&&"PRIVATE_TreeView-item-toggle--hover",1===V&&"PRIVATE_TreeView-item-toggle--end","prc-TreeView-TreeViewItemToggle-gWUdE","prc-TreeView-TreeViewItemToggleHover-nEgP-","prc-TreeView-TreeViewItemToggleEnd-t-AEB"),onClick:e=>{c&&M(e)},children:T?(0,r.jsx)(u.D3D,{size:12}):(0,r.jsx)(u.vKP,{size:12})}):null,(0,r.jsxs)("div",{id:b,className:(0,m.$)("PRIVATE_TreeView-item-content","prc-TreeView-TreeViewItemContent-f0r0b"),children:[g.leadingVisual,(0,r.jsx)("span",{className:(0,m.$)("PRIVATE_TreeView-item-content-text","prc-TreeView-TreeViewItemContentText-smZM-"),children:_}),g.trailingVisual]})]}),I]})})}),F=e=>{const t=(0,d.c)(3),{level:n}=e;let a,o;return t[0]===Symbol.for("react.memo_cache_sentinel")?(a={width:"100%",display:"flex"},t[0]=a):a=t[0],t[1]!==n?(o=(0,r.jsx)("div",{style:a,children:Array.from({length:n-1}).map(ee)}),t[1]=n,t[2]=o):o=t[2],o};$.displayName="TreeView.Item";const B=e=>{const t=(0,d.c)(29),{count:n,state:o,children:s,"aria-label":i}=e,{announceUpdate:c}=a.useContext(L),{itemId:l,isExpanded:u,isSubTreeEmpty:m,setIsSubTreeEmpty:h}=a.useContext(U),p=a.useRef(null),v=a.useRef(null),[f,g]=a.useState(!1),[w,y]=a.useState(""),x=function(e){const t=a.useRef(e);return a.useEffect(()=>{t.current=e},[e]),t.current}(o),{safeSetTimeout:S}=(0,b.A)();let C,T,A,V,E,_,j;if(t[0]!==s||t[1]!==m||t[2]!==h||t[3]!==o?(C=()=>{void 0!==o&&"done"!==o||(m||s?m&&s&&h(!1):h(!0))},T=[o,m,h,s],t[0]=s,t[1]=m,t[2]=h,t[3]=o,t[4]=C,t[5]=T):(C=t[4],T=t[5]),a.useEffect(C,T),t[6]!==c||t[7]!==l||t[8]!==f||t[9]!==x||t[10]!==S||t[11]!==o?(A=()=>{const e=document.getElementById(l);if(e)if(y(k(e)),"loading"===x&&"done"===o){var t;const n=k(e);if(null!==(t=v.current)&&void 0!==t&&t.childElementCount?c(`${n} content loaded`):c(`${n} is empty`),f){const t=I(e);S(t?()=>{t.focus()}:()=>{e.focus()}),g(!1)}}else if("loading"===o){const t=k(e);c(`${t} content loading`)}},V=[f,x,o,l,c,v,S],t[6]=c,t[7]=l,t[8]=f,t[9]=x,t[10]=S,t[11]=o,t[12]=A,t[13]=V):(A=t[12],V=t[13]),a.useEffect(A,V),t[14]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{const e=function(){g(!0)},t=function(e){e.relatedTarget&&g(!1)},n=p.current;if(n)return n.addEventListener("focus",e),n.addEventListener("blur",t),()=>{n.removeEventListener("focus",e),n.removeEventListener("blur",t)}},t[14]=E):E=t[14],t[15]!==o?(_=[p,o],t[15]=o,t[16]=_):_=t[16],a.useEffect(E,_),!u)return null;t[17]===Symbol.for("react.memo_cache_sentinel")?(j={listStyle:"none",padding:0,margin:0},t[17]=j):j=t[17];const R=i||w;let z,N,D;return t[18]!==s||t[19]!==n||t[20]!==o?(z="loading"===o?(0,r.jsx)(W,{ref:p,count:n}):s,t[18]=s,t[19]=n,t[20]=o,t[21]=z):z=t[21],t[22]!==m||t[23]!==o?(N=m&&"loading"!==o?(0,r.jsx)(O,{}):null,t[22]=m,t[23]=o,t[24]=N):N=t[24],t[25]!==N||t[26]!==R||t[27]!==z?(D=(0,r.jsxs)("ul",{role:"group",style:j,ref:v,"aria-label":R,children:[z,N]}),t[25]=N,t[26]=R,t[27]=z,t[28]=D):D=t[28],D};B.displayName="TreeView.SubTree";const H=()=>{const e=(0,d.c)(1);let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,r.jsxs)("span",{className:(0,m.$)("prc-TreeView-TreeViewSkeletonItemContainerStyle-EB7p0","prc-TreeView-TreeViewItemSkeleton-fqk59","PRIVATE_TreeView-item-skeleton"),children:[(0,r.jsx)(D.N,{size:16,square:!0}),(0,r.jsx)(M.r,{className:"prc-TreeView-TreeItemSkeletonTextStyles-wnBY9"})]}),e[0]=t):t=e[0],t},W=a.forwardRef((e,t)=>{const n=(0,d.c)(15),{count:a}=e,o=(0,x.B)();if(a){let e,s,i,c;return n[0]!==a?(e=Array.from({length:a}).map(te),n[0]=a,n[1]=e):e=n[1],n[2]===Symbol.for("react.memo_cache_sentinel")?(s=(0,m.$)("PRIVATE_VisuallyHidden",g),n[2]=s):s=n[2],n[3]!==a?(i=(0,r.jsxs)("div",{className:s,children:["Loading ",a," items"]}),n[3]=a,n[4]=i):i=n[4],n[5]!==o||n[6]!==t||n[7]!==e||n[8]!==i?(c=(0,r.jsxs)($,{id:o,ref:t,children:[e,i]}),n[5]=o,n[6]=t,n[7]=e,n[8]=i,n[9]=c):c=n[9],c}let s,i,c;return n[10]===Symbol.for("react.memo_cache_sentinel")?(s=(0,r.jsx)(q,{children:(0,r.jsx)(l.A,{size:"small"})}),i=(0,r.jsx)(N.A,{className:"fgColor-muted",children:"Loading..."}),n[10]=s,n[11]=i):(s=n[10],i=n[11]),n[12]!==o||n[13]!==t?(c=(0,r.jsxs)($,{id:o,ref:t,children:[s,i]}),n[12]=o,n[13]=t,n[14]=c):c=n[14],c}),O=a.forwardRef((e,t)=>{const n=(0,d.c)(4),a=(0,x.B)();let o,s;return n[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,r.jsx)(N.A,{className:"fgColor-muted",children:"No items found"}),n[0]=o):o=n[0],n[1]!==t||n[2]!==a?(s=(0,r.jsx)($,{expanded:null,id:a,ref:t,children:o}),n[1]=t,n[2]=a,n[3]=s):s=n[3],s});function K(e){return!(a.isValidElement(e)&&e.type===B)}function Z(e){return a.isValidElement(e)&&e.type===B}const q=e=>{const t=(0,d.c)(13),{isExpanded:n,leadingVisualId:o}=a.useContext(U);let s;t[0]!==n||t[1]!==e.children?(s="function"==typeof e.children?e.children({isExpanded:n}):e.children,t[0]=n,t[1]=e.children,t[2]=s):s=t[2];const i=s;let c,l,u,h,p;return t[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,m.$)("PRIVATE_VisuallyHidden",g),t[3]=c):c=t[3],t[4]!==o||t[5]!==e.label?(l=(0,r.jsx)("div",{className:c,"aria-hidden":!0,id:o,children:e.label}),t[4]=o,t[5]=e.label,t[6]=l):l=t[6],t[7]===Symbol.for("react.memo_cache_sentinel")?(u=(0,m.$)("PRIVATE_TreeView-item-visual",f),t[7]=u):u=t[7],t[8]!==i?(h=(0,r.jsx)("div",{className:u,"aria-hidden":!0,children:i}),t[8]=i,t[9]=h):h=t[9],t[10]!==l||t[11]!==h?(p=(0,r.jsxs)(r.Fragment,{children:[l,h]}),t[10]=l,t[11]=h,t[12]=p):p=t[12],p};q.displayName="TreeView.LeadingVisual";const G=e=>{const t=(0,d.c)(13),{isExpanded:n,trailingVisualId:o}=a.useContext(U);let s;t[0]!==n||t[1]!==e.children?(s="function"==typeof e.children?e.children({isExpanded:n}):e.children,t[0]=n,t[1]=e.children,t[2]=s):s=t[2];const i=s;let c,l,u,h,p;return t[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,m.$)("PRIVATE_VisuallyHidden",g),t[3]=c):c=t[3],t[4]!==e.label||t[5]!==o?(l=(0,r.jsx)("div",{className:c,"aria-hidden":!0,id:o,children:e.label}),t[4]=e.label,t[5]=o,t[6]=l):l=t[6],t[7]===Symbol.for("react.memo_cache_sentinel")?(u=(0,m.$)("PRIVATE_TreeView-item-visual",f),t[7]=u):u=t[7],t[8]!==i?(h=(0,r.jsx)("div",{className:u,"aria-hidden":!0,children:i}),t[8]=i,t[9]=h):h=t[9],t[10]!==l||t[11]!==h?(p=(0,r.jsxs)(r.Fragment,{children:[l,h]}),t[10]=l,t[11]=h,t[12]=p):p=t[12],p};G.displayName="TreeView.TrailingVisual";const J=e=>{const t=(0,d.c)(12),{isExpanded:n}=a.useContext(U);let o;t[0]!==n||t[1]!==e.children?(o="function"==typeof e.children?e.children({isExpanded:n}):e.children,t[0]=n,t[1]=e.children,t[2]=o):o=t[2];const s=o;let i,c,l,u,h;return t[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,m.$)("PRIVATE_VisuallyHidden",g),t[3]=i):i=t[3],t[4]!==e.label?(c=(0,r.jsx)("div",{className:i,"aria-hidden":!0,children:e.label}),t[4]=e.label,t[5]=c):c=t[5],t[6]===Symbol.for("react.memo_cache_sentinel")?(l=(0,m.$)("PRIVATE_TreeView-item-leading-action","prc-TreeView-TreeViewItemLeadingAction-VXx8I"),t[6]=l):l=t[6],t[7]!==s?(u=(0,r.jsx)("div",{className:l,"aria-hidden":!0,children:s}),t[7]=s,t[8]=u):u=t[8],t[9]!==c||t[10]!==u?(h=(0,r.jsxs)(r.Fragment,{children:[c,u]}),t[9]=c,t[10]=u,t[11]=h):h=t[11],h};J.displayName="TreeView.LeadingAction";const X=e=>{const t=(0,d.c)(9),{title:n,children:o,onRetry:s,onDismiss:i}=e,c=void 0===n?"Error":n,{itemId:l,setIsExpanded:u}=a.useContext(U);let m,h;return t[0]!==l||t[1]!==i||t[2]!==s||t[3]!==u?(m=e=>{setTimeout(()=>{const e=document.getElementById(l);null==e||e.focus()}),"confirm"===e?null==s||s():(u(!1),null==i||i())},t[0]=l,t[1]=i,t[2]=s,t[3]=u,t[4]=m):m=t[4],t[5]!==o||t[6]!==m||t[7]!==c?(h=(0,r.jsx)("div",{onKeyDown:ne,children:(0,r.jsx)(w.K,{title:c,onClose:m,confirmButtonContent:"Retry",cancelButtonContent:"Dismiss",children:o})}),t[5]=o,t[6]=m,t[7]=c,t[8]=h):h=t[8],h};X.displayName="TreeView.ErrorDialog";const Y=Object.assign(P,{Item:$,SubTree:B,LeadingAction:J,LeadingVisual:q,TrailingVisual:G,DirectoryIcon:()=>{const e=(0,d.c)(3),{isExpanded:t}=a.useContext(U),n=t?u.OpE:u.mL$;let o,s;return e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,m.$)("PRIVATE_TreeView-directory-icon","prc-TreeView-TreeViewDirectoryIcon-PHbeP"),e[0]=o):o=e[0],e[1]!==n?(s=(0,r.jsx)("div",{className:o,children:(0,r.jsx)(n,{})}),e[1]=n,e[2]=s):s=e[2],s},ErrorDialog:X});function Q(e){e instanceof HTMLElement&&e.focus()}function ee(e,t){return(0,r.jsx)("div",{className:(0,m.$)("PRIVATE_TreeView-item-level-line","prc-TreeView-TreeViewItemLevelLine-KPSSL")},t)}function te(e,t){return(0,r.jsx)(H,{"aria-hidden":!0},t)}function ne(e){["Backspace","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Enter"].includes(e.key)&&e.stopPropagation()}ee.displayName="_temp2",te.displayName="_temp3";var re=n(70985),ae=n(34447),oe=n(52982),se=n(87123),ie=n(2067),ce=n(48461),le=n(55285),de=n(41273),ue=n(80258);function me(e,t){let n=e.map(e=>({...e,fileType:t?.getFileTypeForModel(e)}));return n=n.filter(e=>!e.name.startsWith(".")),n.sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name)),n}function he(e){const{item:t,contents:n,current:o,documentRegistry:s,onContextMenu:i,onSelect:c}=e,l=(0,a.useRef)(null),[d,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(!1),p=(0,a.useCallback)(()=>{h(!0),n.get(t.path).then(e=>{h(!1),u(me(e.content,s))}).catch(()=>{h(!1)})},[n,t,s]),v=(0,a.useCallback)(async e=>{null===d&&e&&p()},[d,t,n]);return(0,r.jsxs)(Y.Item,{ref:l,id:`${t.type}-${t.name}`,onExpandedChange:v,onSelect:()=>{c(t,p)},current:t.path===o?.path,children:[(0,r.jsx)(Y.LeadingVisual,{children:(0,r.jsx)(Y.DirectoryIcon,{})}),(0,r.jsx)("span",{onContextMenu:e=>{e.preventDefault(),o?.path!==t.path&&c(t,p),i(l)},children:t.name}),(0,r.jsx)(Y.SubTree,{state:m?"loading":(d?.length??-1)>=0?"done":"initial",children:d?.map(e=>"directory"===e.type?(0,r.jsx)(he,{item:e,contents:n,current:o,documentRegistry:s,onContextMenu:i,onSelect:c},e.name):(0,r.jsx)(pe,{item:e,current:e.path===o?.path,onSelect:e=>c(e,p),onContextMenu:i},e.name))})]})}function pe(e){const{item:t,current:n,onSelect:o,onContextMenu:s}=e,i=(0,a.useRef)(null),c=t.fileType?.icon;return(0,r.jsxs)(Y.Item,{ref:i,id:`${t.type}-${t.name}`,current:n,onSelect:()=>{o(t)},children:[(0,r.jsx)(Y.LeadingVisual,{children:c?(0,r.jsx)(c.react,{tag:"span"}):(0,r.jsx)(u.oSV,{})}),(0,r.jsx)("span",{onContextMenu:e=>{e.preventDefault(),n||o(t),s(i)},children:t.name})]},t.name)}const ve=1048576;function fe(e){const{contents:t,localContents:n,documentRegistry:d}=e,u=(0,le.aq)(),{trackAsyncTask:m}=(0,de.d)(),[h,p]=(0,a.useState)(null),[v,f]=(0,a.useState)(!0),[g,w]=(0,a.useState)(null),[y,x]=(0,a.useState)(null),[b,S]=(0,a.useState)(!1),[k,C]=(0,a.useState)(!1),T=(0,a.useCallback)(()=>{t.get("").then(e=>{f(!1),p(me(e.content,d))}).catch(e=>{f(!1),console.error(`Failed to fetch folder '' content for manager ${t.serverSettings.appUrl}.`,e)})},[t]);(0,a.useEffect)(()=>{T()},[T]);const A=(0,a.useCallback)(async e=>{const n=()=>{if(!u())return Promise.reject(`Failed to upload ${e.name}; StorageBrowser component is unmounted.`)};n();const r=e.size>ve,a=g?"directory"===g.type?g.path:o.PathExt.dirname(g.path):"",i=a?o.PathExt.join(a,e.name):e.name,c=e.name,l=async(r,a)=>{n();const o=new FileReader;o.readAsDataURL(r),await new Promise((t,n)=>{o.onload=t,o.onerror=t=>n(`Failed to upload "${e.name}":`+t)}),n();const s=o.result.split(",")[1],l={type:"file",format:"base64",name:c,chunk:a,content:s};return await t.save(i,l)},d={error:{message:t=>{const n=`Failed to upload ${e.name}.`;return console.error(n,t),n}},pending:{message:`Uploading ${e.name}…`},success:{message:()=>`${e.name} uploaded.`}};if(!r){const t=l(e);return m(t,d),t.then(()=>{g?g.refresh():T()}),t}{const t=new s.PromiseDelegate;m(t.promise,d);try{let n;for(let r=0;!n;r+=ve){const a=r+ve,o=a>=e.size,s=o?-1:a/ve,i=await l(e.slice(r,a),s);o&&(n=i,t.resolve(n))}return g?g.refresh():T(),n}catch(e){throw t.reject(e),e}}},[t,g,T]),V=(0,a.useCallback)(e=>{x(y===e?null:e)},[y]),E=(0,a.useCallback)(()=>{S(!0)},[]),I=(0,a.useCallback)(()=>{if(g){const e=t.delete(g.path);m(e,{success:{message:()=>`${g.path} deleted.`},pending:{message:`Deleting ${g.path}…`},error:{message:e=>{const t=`Failed to delete ${g.path}.`;return console.error(t,e),t}}}),e.finally(()=>{g.refresh()})}S(!1)},[t,g]),_=(0,a.useCallback)(()=>{C(!0)},[]),j=(0,a.useCallback)(()=>{g&&n&&t.get(g.path).then(e=>{const t=n?.save(e.path,e);m(t,{success:{message:()=>`${g.path} copied to local.`},pending:{message:`Copying to local ${g.path}…`},error:{message:e=>{const t=`Failed to copy to local ${g.path}.`;return console.error(t,e),t}}}),t.finally(()=>{g.refresh()}),C(!1)})},[n,g]),R=(0,a.useCallback)((e,t)=>{w(e.path===g?.path?null:{...e,refresh:t})},[g]);return(0,r.jsxs)(oe.az,{sx:{display:"grid",gridTemplateAreas:'"header" "content"'},children:[(0,r.jsxs)(oe.az,{sx:{gridArea:"header",display:"flex",alignItems:"center"},children:[(0,r.jsx)(i.A,{as:"h4",sx:{fontSize:"var(--text-title-size-small)",lineHeight:"var(--text-title-lineHeight-medium)",fontWeight:"var(--text-title-weight-medium)",flex:"1 1 auto"},children:"Contents Browser"}),(0,r.jsxs)(oe.az,{children:[(0,r.jsx)(c.K,{variant:"invisible","aria-label":"Refresh contents browser.",title:"Refresh contents browser.",icon:ce.A,onClick:T}),(0,r.jsx)(ue.HF,{label:"Upload a file",multiple:!0,upload:A})]})]}),v?(0,r.jsx)(oe.az,{sx:{gridArea:"content",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40px",height:"100vh"},children:(0,r.jsx)(l.A,{})}):(0,r.jsx)(oe.az,{sx:{gridArea:"content"},children:h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y,{children:h?.map(e=>"directory"===e.type?(0,r.jsx)(he,{item:e,contents:t,current:g,documentRegistry:d,onContextMenu:V,onSelect:R},e.name):(0,r.jsx)(pe,{item:e,current:g?.path===e.path,onSelect:e=>{R(e,T)},onContextMenu:V},e.name))}),(0,r.jsx)(re.W,{anchorRef:y??void 0,open:null!==y?.current,onOpenChange:()=>{x(null)},children:(0,r.jsx)(re.W.Overlay,{children:(0,r.jsxs)(ae.l,{children:[(0,r.jsx)(ae.l.Item,{title:"Delete the active item.",onSelect:E,children:"Delete…"}),n&&(0,r.jsx)(ae.l.Item,{title:"Copy the active item to the local drive.",onSelect:_,children:"Copy to local drive…"})]})})}),b&&(0,r.jsx)(se.l,{title:(0,r.jsx)("span",{style:{color:"var(--fgColor-default)"},children:"Confirm deletion"}),onClose:()=>{S(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{S(!1)}},{buttonType:"danger",content:"Delete",onClick:()=>{I()}}],children:`Are you sure you want to delete ${g?.path}?`}),k&&(0,r.jsx)(se.l,{title:(0,r.jsx)("span",{style:{color:"var(--fgColor-default)"},children:"Confirm copy to local"}),onClose:()=>{C(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{C(!1)}},{buttonType:"danger",content:"Copy to local",onClick:()=>{j()}}],children:`Are you sure you want to copy to local ${g?.path}?`})]}):(0,r.jsx)(ie.E,{children:(0,r.jsx)(ie.E.Heading,{children:"No contents"})})})]})}},75345:(e,t,n)=>{n.d(t,{E:()=>c});var r=n(18683),a=n(71791),o=n(99180),s=n(38621),i=n(9387);function c(e){const{commandRegistry:t,runtimeDesc:n,sessionConnection:c}=e,[l,d]=(0,i.useState)();return(0,i.useEffect)(()=>{const e=()=>{d(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}},[c]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Q,{variant:"invisible",size:"small",leadingVisual:s.udU,disabled:!n?.location||"busy"===l,onClick:e=>t?.execute(a.nx.runAll),children:"Run all"}),(0,r.jsx)(o.Q,{variant:"invisible",size:"small",leadingVisual:s.wFz,disabled:!n?.location||"busy"!==l,onClick:e=>t?.execute(a.nx.interrupt),children:"Interrupt"})]})}},83051:(e,t,n)=>{n.d(t,{P:()=>V});var r=n(18683),a=n(9387),o=n(34164),s=n(94313),i=n(2918),c=n(46186),l=n.n(c),d=n(83788);l()(d.A,{insert:"head",singleton:!1}),d.A.locals;const u={disabled:"[disabled]",hidden:"[hidden]",inert:"[inert]",negativeTabIndex:'[tabindex="-1"]'},m=["a[href]","button","summary","select","input:not([type=hidden])","textarea",'[tabindex="0"]',"audio[controls]","video[controls]","[contenteditable]"].map(e=>`${e}:not(${Object.values(u).join("):not(")})`);function h(e,t){if(!e||p(e))return!1;const n=v(e,[e]);return Boolean(n)}function p(e){const t=getComputedStyle(e),n=e.matches("[disabled], [hidden], [inert]"),r="none"===t.display||"hidden"===t.visibility;return n||r}function v(e,t){if(!e)return;const n=t.find(t=>t===e),r=p(e);if(e.matches(m.join(", "))&&!n&&!r)return e;for(const n of e.children)if(v(n,t))return!0}var f=n(70070);const g=(e,t)=>a.Children.map(e,e=>a.isValidElement(e)?a.cloneElement(e,{...e.props,square:"square"===t||void 0,className:(0,o.$)(e.props.className,"pc-AvatarItem","prc-AvatarStack-AvatarItem-nS1mt")}):e),w=({disableExpand:e,hasInteractiveChildren:t,stackContainer:n,children:a})=>(0,r.jsx)("div",{"data-disable-expand":e?"":void 0,className:(0,o.$)({"pc-AvatarStack--disableExpand":e},"pc-AvatarStackBody","prc-AvatarStack-AvatarStackBody-mSyoJ"),tabIndex:t||e?void 0:0,ref:n,children:a});w.displayName="AvatarStackBody";const y=({children:e,variant:t="cascade",shape:n="circle",alignRight:c,disableExpand:l,size:d,className:u,style:m,sx:p})=>{const[v,y]=(0,a.useState)(!1),x=(0,a.useRef)(null),b=a.Children.count(e),S=(()=>{const t={narrow:[],regular:[],wide:[]};return a.Children.toArray(e).reduce((e,n)=>{if(!a.isValidElement(n))return e;for(const r of Object.keys(t))(0,i.W8)(n.props.size)?t[r].push(n.props.size[r]||s.E):t[r].push(n.props.size||s.E),e[r]=Math.min(...t[r]);return e},{narrow:s.E,regular:s.E,wide:s.E})})();return(0,a.useEffect)(()=>{if(x.current){const e=()=>{y(h(x.current))},t=new MutationObserver(e);return t.observe(x.current,{childList:!0}),e(),()=>{t.disconnect()}}},[]),(0,r.jsx)(f._,{as:"span","data-variant":t,"data-shape":n,"data-avatar-count":b>3?"3+":b,"data-align-right":c?"":void 0,"data-responsive":!d||(0,i.W8)(d)?"":void 0,className:(0,o.$)({"pc-AvatarStack--variant":t,"pc-AvatarStack--shape":n,"pc-AvatarStack--two":2===b,"pc-AvatarStack--three":3===b,"pc-AvatarStack--three-plus":b>3,"pc-AvatarStack--right":c},u,"prc-AvatarStack-AvatarStack-N-r3C"),style:{...d?(0,i.W8)(d)?{"--stackSize-narrow":`${d.narrow||s.E}px`,"--stackSize-regular":`${d.regular||s.E}px`,"--stackSize-wide":`${d.wide||s.E}px`}:{"--avatar-stack-size":`${d}px`}:{"--stackSize-narrow":`${S.narrow}px`,"--stackSize-regular":`${S.regular}px`,"--stackSize-wide":`${S.wide}px`},...m},sx:p,children:(0,r.jsxs)(w,{disableExpand:l,hasInteractiveChildren:v,stackContainer:x,children:[" ",g(e,n)]})})};y.displayName="AvatarStack";var x=n(45724),b=n(20061);const S=28,k="DatalayerSpacer",C=3e4;var T;!function(e){e.PROGRESS="var(--borderColor-accent-emphasis)",e.ERROR="var(--borderColor-danger-emphasis)",e.SUCCESS="var(--borderColor-success-emphasis)"}(T||(T={}));const A={"-1":T.ERROR,0:T.PROGRESS,1:T.SUCCESS};function V({awareness:e,currentUserHandle:t}){const[n,o]=(0,a.useState)([]);return(0,a.useEffect)(()=>{const n=()=>{const n=e.getStates();o(Array.from(n.values()).filter(e=>e.user&&e.user?.name!==t&&!(e.user?.agent??"").startsWith(k)).reduce((e,t)=>{const n=t.user,r=!((t.notification?.timestamp??0)+C<Date.now()),a=n.agent?{avatarUrl:"https://static.vecteezy.com/system/resources/previews/006/662/139/large_2x/artificial-intelligence-ai-processor-chip-icon-symbol-for-graphic-design-logo-web-site-social-media-mobile-app-ui-illustration-free-vector.jpg",color:n.color,displayName:n.agent,handle:"agent",initials:"AI",username:n.agent,notification:r?`${t.notification?.message} ${(0,x.g)(new Date(t.notification.timestamp))}`:void 0,notificationType:r&&void 0!==t.notification?.message_type?A[t.notification?.message_type.toString()]:void 0}:{avatarUrl:n.avatar_url,color:n.color,displayName:n.display_name,handle:n.name,initials:n.initials,username:n.username};return e.map(e=>e.username).includes(a.username)||e.push(a),e},[]))};n(),e.on("change",n);const r=setInterval(n,C/3);return()=>{clearInterval(r),e.off("change",n)}},[e,t]),(0,r.jsx)(y,{children:n.map(e=>{let t=`${e.displayName}\n${e.handle}`;return e.notification&&(t+=`\n${e.notification}`),(0,r.jsx)(s.A,{sx:{border:e.notificationType?`var(--borderWidth-thick) solid ${e.notificationType}`:"none"},title:t,src:e.avatarUrl?(0,b.$K)(e.avatarUrl):(n=e.color,a=e.initials,"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="${n}" stroke="none" /><text x="12" y="12" fill="black">${a}</text></svg>`)),size:S},e.displayName);var n,a})})}},83788:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(52908),a=n.n(r),o=n(10293),s=n.n(o)()(a());s.push([e.id,'.prc-AvatarStack-AvatarStack-N-r3C{--avatar-border-width:1px;--mask-size:calc(100% + var(--avatar-border-width)*2);--mask-start:-1;--opacity-step:15%;display:flex;height:var(--avatar-stack-size);isolation:isolate;min-width:var(--avatar-stack-size);position:relative}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]){--overlap-size:calc(var(--avatar-stack-size)*0.55);--overlap-size-avatar-three-plus:calc(var(--avatar-stack-size)*0.85)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=stack]){--overlap-size:calc(var(--avatar-stack-size)*0.55);--overlap-size-avatar-three-plus:calc(var(--avatar-stack-size)*0.55)}@media screen and (max-width:calc(48rem - 0.02px)){.prc-AvatarStack-AvatarStack-N-r3C:where([data-responsive]){--avatar-stack-size:var(--stackSize-narrow)}}@media screen and (min-width:48rem){.prc-AvatarStack-AvatarStack-N-r3C:where([data-responsive]){--avatar-stack-size:var(--stackSize-regular)}}@media screen and (min-width:87.5rem){.prc-AvatarStack-AvatarStack-N-r3C:where([data-responsive]){--avatar-stack-size:var(--stackSize-wide)}}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="1"][data-shape=circle]) .prc-AvatarStack-AvatarItem-nS1mt{box-shadow:0 0 0 var(--avatar-border-width) var(--avatar-borderColor,var(--color-avatar-border))}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="1"][data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt{box-shadow:1px 0 #000}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="1"][data-shape=square][data-align-right]) .prc-AvatarStack-AvatarItem-nS1mt{box-shadow:-1px 0 #000}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="2"]){min-width:calc(var(--avatar-stack-size) + var(--avatar-stack-size) - var(--overlap-size))}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3"][data-variant=cascade]){min-width:calc(var(--avatar-stack-size) + var(--avatar-stack-size) - var(--overlap-size) + var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3"][data-variant=stack]){min-width:calc(var(--avatar-stack-size) + (var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))*2)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3+"][data-variant=cascade]){min-width:calc(var(--avatar-stack-size) + var(--avatar-stack-size) - var(--overlap-size) + (var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))*2)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-avatar-count="3+"][data-variant=stack]){min-width:calc(var(--avatar-stack-size) + (var(--avatar-stack-size) - var(--overlap-size-avatar-three-plus))*3);--overlap-size:var(--overlap-size-avatar-three-plus)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-align-right]){--mask-start:1;direction:rtl}.prc-AvatarStack-AvatarStackBody-mSyoJ{display:flex;position:absolute}.prc-AvatarStack-AvatarStackBody-mSyoJ:where([data-disable-expand]){position:relative}.prc-AvatarStack-AvatarItem-nS1mt{--avatarSize-regular:var(--avatar-stack-size);display:flex;flex-shrink:0;height:var(--avatar-stack-size);overflow:hidden;position:relative;transition:margin .2s ease-in-out,opacity .2s ease-in-out,mask-position .2s ease-in-out,mask-size .2s ease-in-out;width:var(--avatar-stack-size)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=circle]) .prc-AvatarStack-AvatarItem-nS1mt:is(img){box-shadow:0 0 0 var(--avatar-border-width) transparent}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:is(img){box-shadow:1px 0 #fff}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square][data-align-right]) .prc-AvatarStack-AvatarItem-nS1mt:is(img){box-shadow:-1px 0 #fff}.prc-AvatarStack-AvatarItem-nS1mt:first-child{margin-inline-start:0}.prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+2){margin-inline-start:calc(var(--overlap-size)*-1);mask-composite:exclude;mask-position:calc((var(--avatar-stack-size) - var(--overlap-size))*var(--mask-start) - var(--avatar-border-width)) center,0 0;mask-repeat:no-repeat,no-repeat;mask-size:var(--mask-size) var(--mask-size),auto;padding:.1px}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=circle]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+2){mask-image:radial-gradient(at 50% 50%,#000 70%,transparent 71%),linear-gradient(#000 0 0)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+2){mask-image:linear-gradient(at 50% 50%,#000 70%,transparent 71%),linear-gradient(#000 0 0)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+3){--overlap-size:var(--overlap-size-avatar-three-plus);opacity:calc(100% - var(--opacity-step)*2)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+4){opacity:calc(100% - var(--opacity-step)*3)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-variant=cascade]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+5){opacity:calc(100% - var(--opacity-step)*4)}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:first-child{z-index:5}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(2){z-index:4}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(3){z-index:3}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(4){z-index:2}.prc-AvatarStack-AvatarStack-N-r3C:where([data-shape=square]) .prc-AvatarStack-AvatarItem-nS1mt:nth-child(5){z-index:1}.prc-AvatarStack-AvatarItem-nS1mt:nth-child(n+6){opacity:0;visibility:hidden}.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):focus-within,.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):hover{width:auto}:is(.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):hover,.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):focus-within) .prc-AvatarStack-AvatarItem-nS1mt{--mask-size:100%;margin-inline-start:var(--base-size-4,.25rem);mask-position:calc(var(--avatar-stack-size)*var(--mask-start)) center,0 0;opacity:1;visibility:visible}:is(:is(.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):hover,.prc-AvatarStack-AvatarStackBody-mSyoJ:not([data-disable-expand]):focus-within) .prc-AvatarStack-AvatarItem-nS1mt):first-child{margin-inline-start:0}',""]);const i=s}}]);