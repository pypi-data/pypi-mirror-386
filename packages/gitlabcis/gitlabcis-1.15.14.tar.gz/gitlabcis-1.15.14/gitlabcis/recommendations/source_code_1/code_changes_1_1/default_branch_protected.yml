---
id: 1.1.20
name: default_branch_protected
title: Ensure branch protection is enforced on the default branch
profile: 1
category: source_code
sub_category: code_changes
description: >-
  Enforce branch protection on the default and main branch.
rationale: >-
  The default or main branch of repositories is considered very important, as it is
  eventually gets deployed to the production. Therefore it needs protection. By enforcing
  branch protection rules on this branch, it is secured from unwanted or unauthorized
  changes. It can also be protected from untested and unreviewed changes and more.
impact: >-
audit: |
  The default branch of GitLab repositories are protected by default. This setting can be overridden at the instance, group, or project level.

  To verify that branch protection is enabled for the main or default branch at the project level:
    1. Navigate to the main page of the GitLab repository.
    2. Select Settings > Repository.
    3. Expand Protected branches.
    4. Verify that initial default branch protection is applied to the "main" or default branch.

  GitLab Group Owners can also perform the following to ensure branch protection is enabled by default for new projects at the group level:
    1. Navigate to the main page for your GitLab group.
    2. Select Settings > Repository.
    3. Under Default branch, verify that initial default branch protection is applied to the "main" or default branch.

  GitLab administrators can perform the following to ensure branch protection is enabled by default for the main or default branch of all new projects at the instance level (self-managed GitLab only):
    1. Navigate to Admin Area.
    2. Select Settings > Repository.
    3. Under Default branch, verify that initial default branch protection is applied to the "main" or default branch.
remediation: |
  Perform the following to enforce branch protection on the main or default branch at the project level:
    1. Navigate to your project page.
    2. Select Settings > Repository.
    3. Expand Protected branches.
    4. Select Add protected branch.
    5. From the Branch dropdown list, select the project's main or default branch.
    6. Choose the roles who should be Allowed to merge and Allowed to push and merge for this protected default branch.
    7. Select Protect.

  Perform the following to enforce branch protection on the main or default branch of new projects at the group level:
    1. Navigate to the main page for your GitLab group.
    2. Select Settings > Repository.
    3. Expand Default branch
    4. Enable initial default branch protection for the "main" or default branch of new repositories created in the group.
    5. Select Save changes.

  Perform the following to enforce branch protection on the main branch of new projects at the instance level (self-managed GitLab administrators only):
    1. Navigate to Admin Area.
    2. Select Settings > Repository.
    3. Expand Default branch.
    4. Enable initial default branch protection for the "main" or default branch of new repositories created on this GitLab instance.
    5. Select Save changes.
default_value:
references:
  - https://docs.gitlab.com/ee/api/protected_branches.html
  - https://docs.gitlab.com/ee/api/group_protected_branches.html
  - https://docs.gitlab.com/ee/api/settings.html
cis_controls:
  - id: 16.1
    version: 8
    name: Establish and Maintain a Secure Application Development Process
    description: >-
      Establish and maintain a secure application development process. In the 
      process, address such items as: secure application design standards, secure coding 
      practices, developer training, vulnerability management, security of third-party code, 
      and application security testing procedures. Review and update documentation 
      annually, or when significant enterprise changes occur that could impact this 
      Safeguard.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.1
    version: 7
    name: Establish Secure Coding Practices
    description: >-
      Establish secure coding practices appropriate to the programming language and 
      development environment being used.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
