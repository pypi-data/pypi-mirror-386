---
id: 1.1.18
name: auto_risk_scan_merges
title: Ensure any merging of code is automatically scanned for risks
profile: 1
category: source_code
sub_category: code_changes
description: >-
  Ensure that every merge request is required to be scanned for risks.
rationale: >-
  Scanning merge requests to detect risks allows for early detection of vulnerable code 
  and/or dependencies and helps mitigate potentially malicious code.
impact: >-
audit: |
  For each project in use, ensure that every merge request must be scanned for risks by performing the following:
  On the left sidebar, select Search or go to and search for the go-example-a project.
    1. Go to Secure > Policies.
    2. Review your list of existing policies. The Policy Type column will indicate whether you have enabled a Scan Execution Policy for the specified project.
    3. Click on the Name in order to view the policy details which specifies which scanners run when code is merged.
remediation: |
  For each project in use, ensure that every merge request must be scanned for risks by creating a scan execution policy:
  1. On the left sidebar, select Search or go to and search for the go-example-a project.
  2. Go to Secure > Policies.
  3. Select New policy.
  4. In the Scan execution policy section, select Select policy.
  5. Complete the fields.
    • Name: Enforce secret detection.
    • Policy status: Enabled.
    • Actions: Run a Secret Detection scan.
    • Conditions: Triggers every time a pipeline runs for all branches.
  6. Select Configure with a merge request.
     The policy project go-example-a - Security project is created, and a merge request is created.
  7. Optional. Review the generated policy YAML in the merge request's Changes tab.
  8. Go to the Overview tab and select Merge.
  9. On the left sidebar, select Search or go to and search for the go-example-a project.
  10. Go to Secure > Policies.

  You now have a scan execution policy that runs a secret detection scan on every MR,
  for any branch. Test the policy by creating a merge request in project A.
default_value:
references:
  - https://docs.gitlab.com/ee/user/application_security/index.html#enforce-scan-execution
  - https://docs.gitlab.com/ee/user/application_security/policies/scan-execution-policies.html
cis_controls:
  - id: 16.12
    version: 8
    name: Implement Code-Level Security Checks
    description: >-
      Apply static and dynamic analysis tools within the application life cycle to 
      verify that secure coding practices are being followed.
    implementation_groups:
      - IG3
  - id: 18.7
    version: 8
    name: Apply Static and Dynamic Code Analysis Tools
    description: >-
      Apply static and dynamic analysis tools to verify that secure coding
      practices are being adhered to for internally developed software.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
