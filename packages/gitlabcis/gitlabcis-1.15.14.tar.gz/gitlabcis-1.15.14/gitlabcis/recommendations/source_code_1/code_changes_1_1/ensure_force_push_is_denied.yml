---
id: 1.1.16
name: ensure_force_push_is_denied
title: Ensure force push code to branches is denied
profile: 1
category: source_code
sub_category: code_changes
description: >-
  The "Force Push" option allows users with "Push" permissions to force their changes 
  directly to the branch without a merge request, and thus should be disabled.
rationale: >-
  The "Force Push" option allows users to override the existing code with their own code. 
  This can lead to both intentional and unintentional data loss, as well as data infection 
  with malicious code. Disabling the "Force Push" option prohibits users from forcing their 
  changes to the master branch, which ultimately prevents malicious code from entering 
  source code.
impact: >-
  Users cannot force push to protected branches.
audit: |
  For every code repository in use, validate that no one can force push code by performing the following:
    • On GitLab, navigate to the main page of the repository.
    • Navigate to Settings > Repository.
    • Click Expand next to the Protected Branches section.
    • Verify that your repository's main (or default) branch is protected.
    • Verify that "Allowed to force push" is toggled off.
remediation: |
  For each repository in use, block the option to "Force Push" code by performing the following:
    • On GitLab, navigate to the main page of the repository.
    • Navigate to Settings > Repository .
    • Click Expand next to the Protected Branches section.
    • Ensure your project's default branch is protected.
    • Toggle "Allowed to force push" off.
default_value:
references:
  - https://docs.gitlab.com/ee/user/project/protected_branches.html
cis_controls:
  - id: 16.1
    version: 8
    name: Establish and Maintain a Secure Application Development Process
    description: >-
      Establish and maintain a secure application development process. In the 
      process, address such items as: secure application design standards, secure coding 
      practices, developer training, vulnerability management, security of third-party code, 
      and application security testing procedures. Review and update documentation 
      annually, or when significant enterprise changes occur that could impact this 
      Safeguard.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.1
    version: 7
    name: Establish Secure Coding Practices
    description: >-
      Establish secure coding practices appropriate to the programming language and 
      development environment being used.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
