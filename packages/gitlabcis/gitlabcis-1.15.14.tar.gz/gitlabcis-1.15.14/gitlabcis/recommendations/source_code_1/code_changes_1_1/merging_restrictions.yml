---
id: 1.1.15
name: merging_restrictions
title: Ensure pushing or merging of new code is restricted to specific individuals or teams
profile: 2
category: source_code
sub_category: code_changes
description: >-
  Ensure that only trusted users can push or merge new code to protected branches.
rationale: >-
  Requiring that only trusted users may push or merge new changes reduces the risk of 
  unverified code, especially malicious code, to a protected branch by reducing the 
  number of trusted users who are capable of doing such.
impact: >-
  Only administrators and trusted users can push or merge to the protected branch.
audit: |
  For every code repository in use, ensure only trusted and responsible users can push or merge new code by performing the following:
    1. On the left sidebar, select Search or go to and find your project.
    2. Select Settings > Repository.
    3. Expand Protected branches.
    4. If there are no protected branches, the repository is not compliant.
    5. For each protected branch, ensure:
      1. The role(s) and user(s) who are 'Allowed to merge' are trusted
      2. The role(s) and user(s) who are 'Allowed to push and merge' are trusted
      3. The 'Allowed to force push' toggle is not selected
remediation: |
  Prerequisites:
    You must have at least the Maintainer role in the group.

  For every code repository in use, allow only trusted and responsible users to push or  merge new code by performing the following:
    1. On the left sidebar, select Search or go to and find your project.
    2. Select Settings > Repository.
    3. Expand Protected branches.
    4. Select Add protected branch.
    5. From the Branch dropdown list, select the branch you want to protect.
    6. From the Allowed to merge list, select a role that can merge into this branch.
    7. From the Allowed to push and merge list, select a role that can push to this branch.
default_value:
references:
  - https://docs.gitlab.com/ee/administration/merge_requests_approvals.html
cis_controls:
  - id: 5.4
    version: 8
    name: Restrict Administrator Privileges to Dedicated Administrator Accounts
    description: >-
      Restrict administrator privileges to dedicated administrator accounts on 
      enterprise assets. Conduct general computing activities, such as internet 
      browsing, email, and productivity suite use, from the user's primary, non-privileged 
      account.
    implementation_groups:
      - IG1
      - IG2
      - IG3
  - id: 4.3
    version: 7
    name: Ensure the Use of Dedicated Administrative Accounts
    description: >-
      Ensure that all users with administrative account access use a dedicated or 
      secondary account for elevated activities. This account should only be used for 
      administrative activities and not internet browsing, email, or similar activities.
    implementation_groups:
      - IG1
      - IG2
      - IG3
additional_info: >-
