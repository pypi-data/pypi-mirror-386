---
id: 1.1.17
name: deny_branch_deletions
title: Ensure branch deletions are denied
profile: 1
category: source_code
sub_category: code_changes
description: >-
  Ensure that users with only push access are incapable of deleting a protected branch.
rationale: >-
  When enabling deletion of a protected branch, any user with at least push access to the 
  repository can delete a branch. This can be potentially dangerous, as a simple human 
  mistake or a hacked account can lead to data loss if a branch is deleted. It is therefore 
  crucial to prevent such incidents by denying protected branch deletion.
impact: >-
audit: |
  For each repository that is being used, verify that protected branches cannot be deleted by performing the following:
    • View your protected branches by going to the left sidebar and selecting Search or go to the Homepage and find your project.
    • Select Settings > Repository.
    • Expand Protected branches to view a list of protected branches
remediation: |
  For each repository that is being used, protect a branch in order to block the option to delete branches. To protect a branch for one project:
    1. On the left sidebar, select Search or go to and find your project.
    2. Select Settings > Repository.
    3. Expand Protected branches.
    4. Select Add protected branch.
    5. From the Branch dropdown list, select the branch you want to protect.
    6. From the Allowed to merge list, select a role that can merge into this branch.
    7. From the Allowed to push and merge list, select a role that can push to this branch.

  Group owners can create protected branches at the group level. These settings are
  inherited by all projects in the group and can't be overridden by project settings. If a
  specific branch is configured with Allowed to force push settings at both the group and
  project levels, the Allowed to force push setting at the project level is ignored in favor
  of the group level setting.

  • You must have the Owner role in the group.

  To protect a branch for all the projects in a group:
    1. On the left sidebar, select Search or go to and find your group.
    2. Select Settings > Repository.
    3. Expand Protected branches.
    4. Select Add protected branch.
    5. In the Branch text box, type the branch name or a wildcard. Branch names and wildcards are case-sensitive.
    6. From the Allowed to merge list, select a role that can merge into this branch.
    7. From the Allowed to push and merge list, select a role that can push to this branch.
    8. Select Protect.
default_value:
references:
  - https://docs.gitlab.com/ee/user/project/protected_branches.html
cis_controls:
  - id: 3.3
    version: 8
    name: Configure Data Access Control Lists
    description: >-
      Configure data access control lists based on a user's need to know. Apply data 
      access control lists, also known as access permissions, to local and remote file 
      systems, databases, and applications.
    implementation_groups:
      - IG1
      - IG2
      - IG3
  - id: 14.6
    version: 7
    name: Protect Information through Access Control Lists
    description: >-
      Protect all information stored on systems with file system, network share, 
      claims, application, or database specific access control lists. These controls will 
      enforce the principle that only authorized individuals should have access to the 
      information based on their need to access the information as a part of their 
      responsibilities.
    implementation_groups:
      - IG1
      - IG2
      - IG3
additional_info: >-
