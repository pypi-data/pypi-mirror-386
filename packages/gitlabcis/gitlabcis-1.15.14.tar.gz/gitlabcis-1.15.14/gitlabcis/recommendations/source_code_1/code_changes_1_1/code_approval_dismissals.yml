---
id: 1.1.4
name: code_approval_dismissals
title: Ensure previous approvals are dismissed when updates are introduced to a code change proposal
profile: 1
category: source_code
sub_category: code_changes
description: >-
  Ensure that when a proposed code change is updated, previous approvals are declined, 
  and new approvals are required.
rationale: >-
  An approval process is necessary when code changes are suggested. Through this 
  approval process, however, changes can still be made to the original proposal even 
  after some approvals have already been given. This means malicious code can find its 
  way into the code base even if the organization has enforced a review policy. To ensure 
  this is not possible, outdated approvals must be declined when changes to the 
  suggestion are introduced.
impact: >-
  If new code changes are pushed to a specific proposal, all previously accepted code 
  change proposals must be declined.
audit: |
  For each code repository in use, perform the next steps to verify that each updated code suggestion declines the previously received approvals:
    • On GitLab, navigate to the main page of a repository.
    • Navigate to Settings > Merge Requests.
    • Click Expand next to the Merge Request Approvals section.
    • Verify the repository has merge request approvals configured on all protected branches.
    • Verify that "Remove all approvals" is selected under Approval Settings for "When a commit is added".
remediation: |
  For each code repository in use, perform the next steps to enforce dismissal of given approvals to code change suggestions if those suggestions were updated:
    • On GitLab, navigate to the main page of a repository.
    • Navigate to Settings > Merge Requests.
    • Click Expand next to the Merge Request Approvals section.
    • Configure approval rules and a list of eligible approvers for all protected branches (or all branches).
    • Select Remove all approvals under "When a commit is added".
    • Click Save changes
default_value:
references:
  - https://docs.gitlab.com/ee/user/project/merge_requests/approvals/rules.html
cis_controls:
  - id: 16.1
    version: 8
    name: Establish and Maintain a Secure Application Development Process
    description: >-
      Establish and maintain a secure application development process. In the 
      process, address such items as: secure application design standards, secure coding 
      practices, developer training, vulnerability management, security of third-party code, 
      and application security testing procedures. Review and update documentation 
      annually, or when significant enterprise changes occur that could impact this 
      Safeguard.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.1
    version: 7
    name: Establish Secure Coding Practices
    description: >-
      Establish secure coding practices appropriate to the programming language and 
      development environment being used.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
