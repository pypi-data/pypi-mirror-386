---
id: 2.3.8
name: pipeline_secret_scanning
title: Ensure scanners are in place to identify and prevent sensitive data in pipeline files
profile: 2
category: build_pipelines
sub_category: pipeline_instructions
description: >-
  Detect and prevent sensitive data, such as confidential ID numbers, passwords, etc., in 
  pipelines.
rationale: >-
  Sensitive data in pipeline configuration, such as cloud provider credentials or repository 
  credentials, create vulnerabilities with which malicious actors could steal such 
  information if they gain access to a pipeline. In order to mitigate this, set scanners that 
  will identify and prevent the existence of sensitive data in the pipeline.
impact: >-
audit: |
  For every pipeline that is in use, verify that scanners are set to identify and prevent the existence of sensitive data within it.
    • On the left sidebar, select Search or go to and find your project.
    • Select Build > Pipeline editor.
    • Ensure the following lines are present in your gitlab-ci.yml.
      include:
        - template: Jobs/Secret-Detection.gitlab-ci.yml
remediation: |
  For every pipeline that is in use, set scanners that will identify and prevent sensitive data within it.
    • On the left sidebar, select Search or go to and find your project.
    • Select Build > Pipeline editor.
    • Copy and paste the following to the bottom of the .gitlab-ci.yml file. If an include line already exists, add only the template line below it.
      include:
        - template: Jobs/Secret-Detection.gitlab-ci.yml
    • Select the Validate tab, then select Validate pipeline. The message Simulation completed successfully indicates the file is valid.
    • Select the Edit tab.
    • Optional. In the Commit message text box, customize the commit message. In the Branch text box, enter the name of the default branch.
    • Select Commit changes
default_value:
references:
  - https://docs.gitlab.com/ee/user/application_security/secret_detection/
cis_controls:
  - id: 3.14
    version: 8
    name: Log Sensitive Data Access
    description: >-
      Log sensitive data access, including modification and disposal.
    implementation_groups:
      - IG3
  - id: 14.5
    version: 7
    name: Utilize an Active Discovery Tool to Identify Sensitive Data
    description: >-
      Utilize an active discovery tool to identify all sensitive information stored, 
      processed, or transmitted by the organization's technology systems, including 
      those located onsite or at a remote service provider and update the organization's 
      sensitive information inventory.
    implementation_groups:
      - IG3
additional_info: >-
