---
id: 2.4.3
name: validate_dependencies
title: Ensure dependencies are validated before being used
profile: 1
category: build_pipelines
sub_category: pipeline_integrity
description: >-
  Validate every dependency of the pipeline before use.
rationale: >-
  To ensure that a dependency used in a pipeline is trusted and has not been infected by 
  malicious actor (for example, the codecov incident), validate dependencies before using 
  them. This can be accomplished by comparing the checksum of the dependency to its 
  checksum in a trusted source. If a difference arises, this is a sign that an unknown actor 
  has interfered and may have added malevolent code. If this dependency is used, it will 
  infect the environment, which could end in a massive breach and leave the organization 
  exposed to data leaks, etc.
impact: >-
audit: |
  For every dependency used in every pipeline, ensure it has been validated.
    • On the left sidebar, select Code > Repository.
    • Check if a .gitlab-ci.yml file is at the root of your repository
    • Verify the following job is included in your .gitlab-ci.yml file:
      include:
        - template: Jobs/Dependency-Scanning.gitlab-ci.yml
    • Go to Build > Pipelines and confirm that the latest pipeline completed successfully.
remediation: >-
  For every dependency used in every pipeline, validate each one.
    • On the left sidebar, select Code > Repository.
    • Check if a .gitlab-ci.yml file is at the root of your repository
    • Include the following job is included in your .gitlab-ci.yml file:
      include:
        - template: Jobs/Dependency-Scanning.gitlab-ci.yml
    • Go to Build > Pipelines and confirm that the latest pipeline completed successfully. In the pipeline, dependency scanning runs and the vulnerabilities are detected automatically.
    • Go to Secure > Vulnerability report.
    • Select each of the vulnerabilities by selecting the checkbox in each row.
    • Review the recommended solution for each vulnerability and investigate further if needed.
    • From the Set status dropdown list select the relevant option and select Change status.
default_value:
references:
  - https://docs.gitlab.com/ee/tutorials/dependency_scanning.html
cis_controls:
  - id: 16.5
    version: 8
    name: Use Up-to-Date and Trusted Third-Party Software Components
    description: >-
      Use up-to-date and trusted third-party software components. When possible, 
      choose established and proven frameworks and libraries that provide adequate 
      security. Acquire these components from trusted sources or evaluate the software 
      for vulnerabilities before use.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.4
    version: 7
    name: Only Use Up-to-date And Trusted Third-Party Components
    description: >-
      Only use up-to-date and trusted third-party components for the software 
      developed by the organization.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
