---
id: 2.1.8
name: vuln_scanning
title: Ensure the build infrastructure is automatically scanned for vulnerabilities
profile: 1
category: build_pipelines
sub_category: build_environment
description: >-
  Scan the build infrastructure and its dependencies for vulnerabilities. It is recommended that this be done automatically.
rationale: >-
  Automatic scanning for vulnerabilities detects known vulnerabilities in the tooling used 
  by the build infrastructure and its dependencies. These vulnerabilities can lead to a 
  potentially massive breach if not handled as fast as possible, as attackers might also be 
  aware of such vulnerabilities.
impact: >-
audit: >-
  Verify that your build infrastructure is reviewed for vulnerabilities. 
  GitLab Runner is designed to run user-controlled scripts. To reduce the attack surface if 
  a job is malicious, you can consider running them in their own network segment. This 
  would provide network separation from other infrastructure and services.
remediation: |
  Ensure security hardening for your build infrastructure.
  For a cloud environment, this could include:
    • Configuring runner virtual machines in their own network segment
    • Blocking SSH access from the Internet to runner virtual machines
    • Restricting traffic between runner virtual machines
    • Filtering access to cloud provider metadata endpoints
  For static host runner, whether bare-metal or virtual machine, you should implement security best practices for the host operating system:
  Malicious code executed in the context of a CI job could compromise the host, so security protocols can help mitigate the impact. Other points to keep in mind include securing or removing files such as SSH keys from the host system that may enable an attacker to access other endpoints in the environment.
default_value:
references:
  - https://docs.gitlab.com/runner/security/
cis_controls:
  - id: 7.5
    version: 8
    name: Perform Automated Vulnerability Scans of Internal Enterprise Assets
    description: >-
      Perform automated vulnerability scans of internal enterprise assets on a 
      quarterly, or more frequent, basis. Conduct both authenticated and 
      unauthenticated scans, using a SCAP-compliant vulnerability scanning tool.
    implementation_groups:
      - IG2
      - IG3
  - id: 7.6
    version: 8
    name: Perform Automated Vulnerability Scans of Externally-Exposed Enterprise Assets
    description: >-
      Perform automated vulnerability scans of externally-exposed enterprise assets 
      using a SCAP-compliant vulnerability scanning tool. Perform scans on a monthly, 
      or more frequent, basis.
    implementation_groups:
      - IG2
      - IG3
  - id: 3.1
    version: 7
    name: Run Automated Vulnerability Scanning Tools
    description: >-
      Utilize an up-to-date SCAP-compliant vulnerability scanning tool to 
      automatically scan all systems on the network on a weekly or more frequent basis 
      to identify all potential vulnerabilities on the organization's systems.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
