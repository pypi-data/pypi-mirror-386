---
id: 2.1.7
name: limit_build_secrets_scope
title: Ensure build secrets are limited to the minimal necessary scope
profile: 2
category: build_pipelines
sub_category: build_environment
description: >-
  Build tools providers offer a secure way to store secrets that should be used during the 
  build process. These secrets will often be credentials used to access other tools, for 
  example for pulling code or for uploading artifacts. Access to these secrets can be 
  defined on various scopes. To protect these critical assets it is important to choose the 
  most restrictive scope necessary.
rationale: >-
  Allowing over permissive access to these secrets may affect on their exposure. For 
  example if a secret is defined in an organization level, and users can create new 
  repositories, there is a scenario where a user can create a new repo and run a 
  controlled build just to exfiltrate these secrets.
impact: >-
  Increased risk of exposure of build related secrets.
audit: |
  In the gitlab-ci.yml file, review the secrets permission scope defined in either a file or in 
  an external secrets manager.
remediation: >-
  In the gitlab-ci.yml file, review the secrets defined in either a file or in an external secrets 
  manager and change over permissive scopes to more restrictive ones based on the 
  required access.
default_value:
references:
  - https://docs.gitlab.com/ee/ci/yaml/index.html#secrets
  - https://docs.gitlab.com/ee/ci/secrets/index.html
cis_controls:
  - id: 5.4
    version: 8
    name: Restrict Administrator Privileges to Dedicated Administrator Accounts
    description: >-
      Restrict administrator privileges to dedicated administrator accounts on 
      enterprise assets. Conduct general computing activities, such as internet 
      browsing, email, and productivity suite use, from the user's primary, non-privileged 
      account.
    implementation_groups:
      - IG1
      - IG2
      - IG3
  - id: 4.3
    version: 7
    name: Ensure the Use of Dedicated Administrative Accounts
    description: >-
      Ensure that all users with administrative account access use a dedicated or 
      secondary account for elevated activities. This account should only be used for 
      administrative activities and not internet browsing, email, or similar activities.
    implementation_groups:
      - IG1
      - IG2
      - IG3
additional_info: >-
