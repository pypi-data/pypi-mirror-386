---
id: 2.4.2
name: lock_dependencies
title: Ensure all external dependencies used in the build process are locked
profile: 1
category: build_pipelines
sub_category: pipeline_integrity
description: >-
  External dependencies may be public packages needed in the pipeline, or perhaps the 
  public image being used for the build worker. Lock these external dependencies in 
  every build pipeline.
rationale: >-
  External dependencies are sources of code that aren't under organizational control. 
  They might be intentionally or unintentionally infected with malicious code or have 
  known vulnerabilities, which could result in sensitive data exposure, data harvesting, or 
  the erosion of trust in an organization. Locking each external dependency to a specific, 
  safe version gives more control and less chance for risk.
impact: >-
audit: |
  Ensure every external dependency being used in pipelines is locked.
    • Go to Code > Repository in your project
    • Review the following files at the root of your repository:
      • Gemfiles
      • package.jsons
      • go.sum
    • Review the versions of the external dependencies
remediation: |
  For all external dependencies being used in pipelines, verify they are locked.
    • Go to Code > Repository in your project
    • Review the following files at the root of your repository:
      • Gemfiles
      • package.jsons
      • go.sum
    • Ensure the version of the external dependencies corresponds to your internal
    policies
default_value:
references:
cis_controls:
  - id: 16.5
    version: 8
    name: Use Up-to-Date and Trusted Third-Party Software Components
    description: >-
      Use up-to-date and trusted third-party software components. When possible, 
      choose established and proven frameworks and libraries that provide adequate 
      security. Acquire these components from trusted sources or evaluate the software 
      for vulnerabilities before use.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.4
    version: 7
    name: Only Use Up-to-date And Trusted Third-Party Components
    description: >-
      Only use up-to-date and trusted third-party components for the software 
      developed by the organization.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
