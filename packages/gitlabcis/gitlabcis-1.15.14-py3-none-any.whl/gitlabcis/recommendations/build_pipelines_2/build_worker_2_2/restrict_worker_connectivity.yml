---
id: 2.2.4
name: restrict_worker_connectivity
title: Ensure build workers have minimal network connectivity
profile: 1
category: build_pipelines
sub_category: build_worker
description: >-
  Ensure that build workers have minimal network connectivity.
rationale: >-
  Restricting the network connectivity of build workers decreases the possibility that an 
  attacker would be capable of entering the organization from the outside. If the build 
  workers are connected to the public internet without any restriction, it is far simpler for 
  attackers to compromise them. Limiting network connectivity between build workers 
  also protects the organization in case an attacker was successful and subsequently 
  attempts to spread the attack to other components of the environment.
impact: >-
  Developers will not have connectivity to every resource they might need from the 
  outside. Workers will also only be able to exchange data through shareable storage.
audit: |
  Verify that build workers, environment, and any other components have only the required minimum of network connectivity.

  Review these configuration measures for your self-managed runners:
    • Configuring runner virtual machines in their own network segment
    • Blocking SSH access from the Internet to runner virtual machines
    • Restricting traffic between runner virtual machines
    • Filtering access to cloud provider metadata endpoints
remediation: |
  Limit the network connectivity of build workers, environment, and any other components to the necessary minimum.

  Ensure these configuration measures are in place for your self-managed runners:
    • Configuring runner virtual machines in their own network segment
    • Blocking SSH access from the Internet to runner virtual machines
    • Restricting traffic between runner virtual machines
    • Filtering access to cloud provider metadata endpoints
default_value:
references:
  - https://docs.gitlab.com/runner/security/#network-segmentation
cis_controls:
  - id: 13.5
    version: 8
    name: Manage Access Control for Remote Assets
    description: >-
      Manage access control for assets remotely connecting to enterprise resources. 
      Determine amount of access to enterprise resources based on: up-to-date anti-
      malware software installed, configuration compliance with the enterprise's secure 
      configuration process, and ensuring the operating system and applications are up-
      to-date.
    implementation_groups:
      - IG2
      - IG3
  - id: 12.12
    version: 7
    name: Manage All Devices Remotely Logging into Internal Network
    description: >-
      Scan all enterprise devices remotely logging into the organization's network 
      prior to accessing the network to ensure that each of the organization's security 
      policies has been enforced in the same manner as local network devices.
    implementation_groups:
      - IG3
additional_info: >-
