---
id: 2.2.6
name: build_worker_vuln_scanning
title: Ensure build workers are automatically scanned for vulnerabilities
profile: 1
category: build_pipelines
sub_category: build_worker
description: >-
  Scan build workers for vulnerabilities. It is recommended that this be done 
  automatically.
rationale: >-
  Automatic scanning for vulnerabilities detects known weaknesses in environmental 
  sources in use, such as docker images or kernel versions. Such vulnerabilities can lead 
  to a massive breach if these environments are not replaced as fast as possible, since 
  attackers also know about these vulnerabilities and often try to take advantage of them. 
  Setting automatic scanning which scans environmental sources ensures that if any new 
  vulnerability is revealed, it can be replaced quickly and easily. This protects the worker 
  from being exposed to attacks.
impact: >-
audit: >-
  If you are using a static host for a runner, whether bare-metal or virtual machine, you 
  should implement security best practices for the host operating system. 
  Malicious code executed in the context of a CI job could compromise the host, so 
  security protocols can help mitigate the impact. Other points to keep in mind include 
  securing or removing files such as SSH keys from the host system that may enable an 
  attacker to access other endpoints in the environment.
remediation: |
  For each build worker, automatically scan its environmental sources, such as docker image, for vulnerabilities.
    • Create a new project.
    • Add a Dockerfile file to the project. This Dockerfile contains minimal configuration required to create a Docker image.
    • Create pipeline configuration for the new project to create a Docker image from the Dockerfile, build and push a Docker image to the container registry, and then scan the Docker image for vulnerabilities.
    • Check for reported vulnerabilities.
    • Update the Docker image and scan the updated image.
default_value:
references:
  - https://docs.gitlab.com/ee/tutorials/container_scanning/
cis_controls:
  - id: 7.5
    version: 8
    name: Perform Automated Vulnerability Scans of Internal Enterprise Assets
    description: >-
      Perform automated vulnerability scans of internal enterprise assets on a 
      quarterly, or more frequent, basis. Conduct both authenticated and 
      unauthenticated scans, using a SCAP-compliant vulnerability scanning tool.
    implementation_groups:
      - IG2
      - IG3
  - id: 3.2
    version: 7
    name: Perform Authenticated Vulnerability Scanning
    description: >-
      Perform authenticated vulnerability scanning with agents running locally on 
      each system or with remote scanners that are configured with elevated rights on 
      the system being tested.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
