---
id: 2.3.5
name: limit_pipeline_triggers
title: Ensure access to build process triggering is minimized
profile: 1
category: build_pipelines
sub_category: pipeline_instructions
description: >-
  Restrict access to pipeline triggers.
rationale: >-
  Build pipelines are used for multiple reasons. Some are very sensitive, such as 
  pipelines which deploy to production. In order to protect the environment from malicious 
  acts or human mistakes, such as a developer deploying a bug to production, it is 
  important to apply the Least Privilege principle to pipeline triggering. This principle 
  requires restrictions placed on which users can run which pipeline. It allows for sensitive 
  pipelines to only be run by administrators, who are generally the most trusted and 
  skilled members of the organization.
impact: >-
audit: |
  For every pipeline in use, verify only the necessary users have permission to trigger it.
    • On the left sidebar, select Search or go to and find your project.
    • Select Manage > Members
    • At the top of the member list, from the dropdown list, sort by Max role the members have in the group
    • Review the members to ensure relevant members are allowed to trigger pipelines in protected environments.
remediation: |
  For every pipeline in use, grant only the necessary users permission to trigger it.
    • On the left sidebar, select Search or go to and find your project.
    • Select Settings > CI/CD.
    • Expand Protected environments.
    • Select Protect an environment.
    • From the Environment list, select the environment you want to protect.
    • In the Allowed to deploy list, select the role, users, or groups you want to give deploy access to. Keep in mind that:
      • There are two roles to choose from:
        • Maintainers: Allows access to all of the project's users with the Maintainer role.
        • Developers: Allows access to all of the project's users with the Maintainer and Developer role.
      • You can only select groups that are already invited to the project.
      • Users must have at least the Developer role to appear in the Allowed to deploy list.
    • In the Approvers list, select the role, users, or groups you want to give deploy access to. Keep in mind that:
      • There are two roles to choose from:
        • Maintainers: Allows access to all of the project's users with the Maintainer role.
        • Developers: Allows access to all of the project's users with the Maintainer and Developer role.
      • You can only select groups that are already invited to the project.
      • Users must have at least the Developer role to appear in the Approvers list.
    • In the Approval rules section:
      • Ensure that this number is less than or equal to the number of members in the rule.
      • See Deployment Approvals for more information about this feature.
    • Select Protect.
default_value:
references:
  - https://docs.gitlab.com/ee/ci/environments/protected_environments.html
cis_controls:
  - id: 3.3
    version: 8
    name: Configure Data Access Control Lists
    description: >-
      Configure data access control lists based on a user's need to know. Apply data 
      access control lists, also known as access permissions, to local and remote file 
      systems, databases, and applications.
    implementation_groups:
      - IG1
      - IG2
      - IG3
  - id: 14.6
    version: 7
    name: Protect Information through Access Control Lists
    description: >-
      Protect all information stored on systems with file system, network share, 
      claims, application, or database specific access control lists. These controls will 
      enforce the principle that only authorized individuals should have access to the 
      information based on their need to access the information as a part of their 
      responsibilities.
    implementation_groups:
      - IG1
      - IG2
      - IG3
additional_info: >-
