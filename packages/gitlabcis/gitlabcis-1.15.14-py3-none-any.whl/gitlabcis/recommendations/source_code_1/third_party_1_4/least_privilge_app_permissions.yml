---
id: 1.4.3
name: least_privilge_app_permissions
title: Ensure the access granted to each installed application is limited to the least privilege needed
profile: 1
category: source_code
sub_category: third_party
description: >-
  Ensure installed application permissions are limited to the lowest privilege level required.
rationale: >-
  Applications are typically automated integrations that can improve the workflow of an 
  organization. They are written by third-party developers, and therefore should be 
  reviewed carefully before use. It is recommended to use the "least privilege" principle, 
  granting applications the lowest level of permissions required. This may prevent harm 
  from a potentially malicious application with unnecessarily high-level permissions 
  leaking data or modifying source code.
impact: >-
audit: |
  Verify that each installed integration and application has the least privilege needed.

  For each Project and each Group, perform the following:
    • Navigate to the project or group homepage
    • In the sidebar, select Settings > Integrations
    • Next to every integration, select 'Configure'
    • Review the integration's configuration and verify that it is limited to the least privilege needed

  For each Group, perform the following:
    • Navigate to the project or group homepage
    • In the sidebar, select Settings > Applications
      • Next to every Application, select Edit
      • Review the Applications configuration and verify that it is limited to the least privilege needed

  As an administrator, perform the following:
    • Navigate to the Admin Area
    • In the sidebar, select Applications
      • Next to every Application, select Edit
      • Review the Applications configuration and verify that it is limited to the least privilege needed
    • In the sidebar, select Settings > Integrations
      • Next to every integration, select 'Configure'
      • Review the integration's configuration and verify that it is limited to the least privilege needed
    • In the sidebar, select Overview > Users
      • Select each user's first name
      • On the users detail page, select 'Impersonate'
      • Navigate to their Preferences page
      • In the sidebar, select Applications
      • Next to every Application under 'Authorized applications', review the scopes permitted
      • Select the 'Stop impersonating' icon (next to the impersonated user's avatar)
      • Repeat for each user
remediation: |
  Grant permissions to applications by the "least privilege" principle, meaning the lowest possible permission necessary.
  
  For any Integrations identified during the audit as needing modification:
    • Next to the integration, select Configure.
    • Edit the permissions or settings so that they grant the least possible privileges.
  
  For example, restrict the branches it can access, or the features that are enabled.
    • (Optionally) Select 'Test settings'
    • Select 'Save changes'.
  
  For any Applications identified during the audit as needing modification:
    • Next to the application, select 'Edit'.
    • Edit the permissions or settings so that they grant the least possible privileges.

  For example, restrict the API scopes it can use.
    • Select 'Save application'.

  If any user authorized applications were identified during the audit as having overly permissive scopes, as an administrator perform the following:
    • Navigate to the Admin Area
    • In the sidebar, select Overview > Users
      • Select the user's first name
      • On the users detail page, select 'Impersonate'
      • Navigate to their Preferences page
      • In the sidebar, select Applications
      • Under 'Authorized applications', re-identify the overly permissive application
      • Select 'Revoke'
      • Select the 'Stop impersonating' icon (next to the impersonated user's avatar)
default_value:
references:
cis_controls:
  - id: 6.8
    version: 8
    name: Define and Maintain Role-Based Access Control
    description: >-
      Define and maintain role-based access control, through determining and
      documenting the access rights necessary for each role within the enterprise to
      successfully carry out its assigned duties. Perform access control reviews of
      enterprise assets to validate that all privileges are authorized, on a recurring
      schedule at a minimum annually, or more frequently.
    implementation_groups:
      - IG3
  - id: 14.6
    version: 7
    name: Protect Information through Access Control Lists
    description: >-
      Protect all information stored on systems with file system, network share, claims,
      application, or database specific access control lists. These controls will enforce the
      principle that only authorized individuals should have access to the information
      based on their need to access the information as a part of their responsibilities.
    implementation_groups:
      - IG1
      - IG2
      - IG3
additional_info: >-
