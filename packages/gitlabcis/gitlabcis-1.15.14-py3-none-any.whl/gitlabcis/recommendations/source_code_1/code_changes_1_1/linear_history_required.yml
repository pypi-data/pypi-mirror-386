---
id: 1.1.13
name: linear_history_required
title: Ensure linear history is required
profile: 2
category: source_code
sub_category: code_changes
description: >-
  Linear history is the name for Git history where all commits are listed in chronological 
  order, one after another. Such history exists if a merge request is merged either by rebase 
  merge (re-order the commits history) or squash merge (squashes all commits to one). 
  Ensure that linear history is required by requiring the use of rebase or squash merge 
  when merging a merge request.
rationale: >-
  Enforcing linear history produces a clear record of activity, and as such it offers specific 
  advantages: it is easier to follow, easier to revert a change, and bugs can be found 
  more easily.
impact: >-
  Merge requests cannot be merged except squash or rebase merge.
audit: |
  For every project, perform the following steps:
    • Navigate to your project
    • In the sidebar, select Settings > Merge Requests
    • Under 'Merge method', if 'Merge Commit' or 'Merge commit with semi-linear history' is selected then the project is not-compliant.
remediation: |
  For every project, perform the following steps:
    • Navigate to your project
    • In the sidebar, select Settings > Repository
    • Under 'Merge method', select 'Fast-forward merge'.
default_value:
references:
  - https://docs.gitlab.com/ee/user/project/merge_requests/methods/
cis_controls:
  - id: 16.1
    version: 8
    name: Establish and Maintain a Secure Application Development Process
    description: >-
      Establish and maintain a secure application development process. In the 
      process, address such items as: secure application design standards, secure coding 
      practices, developer training, vulnerability management, security of third-party code, 
      and application security testing procedures. Review and update documentation 
      annually, or when significant enterprise changes occur that could impact this 
      Safeguard.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.1
    version: 7
    name: Establish Secure Coding Practices
    description: >-
      Establish secure coding practices appropriate to the programming language and 
      development environment being used.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
