---
id: 1.1.9
name: checks_pass_before_merging
title: Ensure all checks have passed before merging new code
profile: 1
category: source_code
sub_category: code_changes
description: >-
  Before a code change request can be merged to the code base, all predefined checks 
  must successfully pass.
rationale: >-
  On top of manual reviews of code changes, a code protect should contain a set of 
  prescriptive checks which validate each change. Organizations should enforce those 
  status checks so that changes can only be introduced if all checks have successfully 
  passed. This set of checks should serve as the absolute quality, stability, and security 
  conditions which must be met in order to merge new code to a project.
impact: >-
  Code changes in which all checks do not pass successfully would not be able to be 
  pushed into the code base of the specific code repository.
audit: |
  Within each project's settings, you can see a list of status check services added to the project:
    1. In your project, go to Settings > Merge requests section.
    2. Scroll down to Status checks.
    3. Ensure that the Status checks must succeed checkbox has been selected.
remediation: |
  To block the merging of merge requests when checks fail:
    1. On the left sidebar, select Search or go to and find your project.
    2. Select Settings > Merge requests.
    3. Select the Status checks must succeed checkbox.
    4. Select Save changes.
default_value: By default, no checks are defined per project, and thus no enforcement of checks is made.
references:
  - https://docs.gitlab.com/ee/user/project/merge_requests/status_checks.html
cis_controls:
  - id: 16.1
    version: 8
    name: Establish and Maintain a Secure Application Development Process
    description: >-
      Establish and maintain a secure application development process. In the 
      process, address such items as: secure application design standards, secure coding 
      practices, developer training, vulnerability management, security of third-party code, 
      and application security testing procedures. Review and update documentation 
      annually, or when significant enterprise changes occur that could impact this 
      Safeguard.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.1
    version: 7
    name: Establish Secure Coding Practices
    description: >-
      Establish secure coding practices appropriate to the programming language and 
      development environment being used.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
