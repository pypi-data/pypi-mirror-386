---
id: 1.1.19
name: audit_branch_protections
title: Ensure any changes to branch protection rules are audited
profile: 1
category: source_code
sub_category: code_changes
description: >-
  Ensure that changes in the branch protection rules are audited.
rationale: >-
  Branch protection rules should be configured on every repository. The only users who 
  may change such rules are administrators. In a case of an attack on an administrator 
  account or of human error on the part of an administrator, protection rules could be 
  disabled, and thus decrease source code confidentiality as a result. It is important to 
  track and audit such changes to prevent potential incidents as soon as possible.
impact: >-
audit: |
  Ensure that changes in the branch protection rules are audited regularly. You can view audit events from user actions across an entire GitLab instance.

  To view instance audit events:
    1. On the left sidebar, select Search or go to.
    2. Select Admin Area.
    3. On the left sidebar, select Monitoring > Audit Events.
    4. Filter by the following:Event Type protected_branch_updated. This event type is triggered when the setting for protected branches is updated.
    5. Ensure every action is reasonable and secure and is investigated if not.
remediation: |
  Use the audit log to audit changes in branch protection rules by performing the following:
    1. On the left sidebar, select Search or go to.
    2. Select Admin Area.
    3. On the left sidebar, select Monitoring > Audit Events.
    4. Filter by the following:Event Type protected_branch_updated
    5. Ensure every action is reasonable and secure and is investigated if not.
default_value:
references:
  - https://docs.gitlab.com/ee/administration/audit_event_streaming/audit_event_types.html
cis_controls:
  - id: 8.5
    version: 8
    name: Collect Detailed Audit Logs
    description: >-
      Configure detailed audit logging for enterprise assets containing sensitive data. 
      Include event source, date, username, timestamp, source addresses, destination 
      addresses, and other useful elements that could assist in a forensic investigation.
    implementation_groups:
      - IG2
      - IG3
  - id: 6.2
    version: 8
    name: Activate audit logging
    description: >-
      Ensure that local logging has been enabled on all systems and networking devices.
    implementation_groups:
      - IG1
      - IG2
      - IG3
additional_info: >-
