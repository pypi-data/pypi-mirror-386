---
id: 1.1.14
name: branch_protections_for_admins
title: Ensure branch protection rules are enforced for administrators
profile: 1
category: source_code
sub_category: code_changes
description: >-
  Ensure administrators are subject to branch protection rules.
rationale: >-
  Administrators by default are excluded from any branch protection rules. This means 
  these privileged users (both on the repository and organization levels) are not subject to 
  protections meant to prevent untrusted code insertion, including malicious code. This is 
  extremely important since administrator accounts are often targeted for account 
  hijacking due to their privileged role.
impact: >-
  Administrator users won't be able to push code directly to the protected branch without 
  being compliant with listed branch protection rules.
audit: |
  GitLab administrators can validate this privilege for group owners, enforcing the instance-level protection rule:
    1. Select Settings > Repository.
    2. On the left sidebar, at the bottom, select Admin Area.
    3. Expand the Default branch section.
    4. Ensure that the Allow owners to manage default branch protection per group is unchecked.
    5. Select Save changes.
remediation: |
  GitLab administrators can disable this privilege for group owners, enforcing the instance-level protection rule:
    1. On the left sidebar, at the bottom, select Admin Area.
    2. Select Settings > Repository.
    3. Expand the Default branch section.
    4. Uncheck Allow owners to manage default branch protection per group checkbox.
    5. Select Save changes.
default_value: Administrator accounts are not subject to branch protection rules by default.
references:
  - https://docs.gitlab.com/ee/user/project/repository/branches/default.html
  - https://docs.gitlab.com/ee/user/project/protected_branches.html#who-can-modify-a-protected-branch
cis_controls:
  - id: 16.1
    version: 8
    name: Establish and Maintain a Secure Application Development Process
    description: >-
      Establish and maintain a secure application development process. In the 
      process, address such items as: secure application design standards, secure coding 
      practices, developer training, vulnerability management, security of third-party code, 
      and application security testing procedures. Review and update documentation 
      annually, or when significant enterprise changes occur that could impact this 
      Safeguard.
    implementation_groups:
      - IG2
      - IG3
  - id: 18.1
    version: 7
    name: Establish Secure Coding Practices
    description: >-
      Establish secure coding practices appropriate to the programming language and 
      development environment being used.
    implementation_groups:
      - IG2
      - IG3
additional_info: >-
