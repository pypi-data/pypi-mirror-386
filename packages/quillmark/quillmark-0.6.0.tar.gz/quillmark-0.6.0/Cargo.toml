[workspace]
members = ["quillmark-core", "quillmark", "quillmark-typst", "quillmark-acroform", "quillmark-fixtures", "quillmark-python"]
# The default members to include when running `cargo build` or `cargo test` in the workspace root.
default-members = [
    "quillmark-core",
    "quillmark",
    "quillmark-typst",
    "quillmark-acroform",
    "quillmark-wasm",
]
resolver = "2"

[workspace.package]
version = "0.6.0"
edition = "2021"
include = ["src/**", "Cargo.toml", "README*", "LICENSE*"]
readme = "README.md"
license = "Apache-2.0"

[workspace.dependencies]
# Core dependencies
serde = { version = "~1.0", features = ["derive"] }
serde_yaml = "~0.9"
serde_json = "~1.0"
toml = "~0.9"

thiserror = "~2.0"
anyhow = "~1.0"

# File globbing
glob = "0.3.3"

# Templating
minijinja = "~2.12"

# Validation
jsonschema = {version = "0.33", default-features = false}

# Typst backend dependencies
fontdb = "0.21.0"
pulldown-cmark = "0.13.0"
time = { version = "0.3.44", features = ["formatting", "parsing"] }
typst = "0.13.1"
typst-kit = { version = "0.13.1", default-features = false }
typst-pdf = "0.13.1"
typst-svg = "0.13.1"
dirs = "6.0"

# AcroForm backend dependencies
acroform = "0.1.3"

# Intra-project dependencies
quillmark-core = { version = "0.6.0", path = "quillmark-core" }
quillmark-typst = { version = "0.6.0", path = "quillmark-typst", default-features = false }
quillmark-acroform = { version = "0.6.0", path = "quillmark-acroform" }
quillmark = { version = "0.6.0", path = "quillmark", default-features = false }

# Test and dev dependencies
tempfile = "~3.23"
proptest = "~1.5"
quillmark-fixtures = { path = "quillmark-fixtures" }

[workspace.metadata.workspaces]
# Exclude fixtures from publishing since it's dev-only
no_individual_tags = true

[workspace.metadata.release]
allow-branch = ["main"]

[profile.release]
opt-level = "z"      # Optimize for size
lto = true           # Link-time optimization
codegen-units = 1    # Better optimization
panic = "abort"      # Smaller binary
strip = true         # Remove debug symbols
