{% load static %}
{% load wagtailcore_tags %}
{% block content %}
<style>
    .section-tabs-cards .section-title span {
        color: var(--primary-color);
    }
    .section-tabs-cards .section-title::after {
        background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    }

    .section-tabs-cards .tab.active {
        color: var(--primary-color);
    }

    .section-tabs-cards .card-item {
        border-left: 4px solid var(--card-highlight-color, var(--primary-color));
    }

    .section-tabs-cards .card-icon i {
        color: var(--card-highlight-color, var(--primary-color));
    }

    .section-tabs-cards .card-link {
        color: var(--card-highlight-color, var(--primary-color));
    }

    .section-tabs-cards .card-link svg {
        stroke: var(--card-highlight-color, var(--primary-color));
    }
</style>
<section id="section-{{ id }}" class="section section-tabs-cards" style="--primary-color: {{ value.primary_color }}; --primary-color-light: {{ value.primary_color }}99; --primary-color-lighter: {{ value.primary_color }}15; --secondary-color: {{ value.secondary_color }}; --background-color: {{ value.background_color }};">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">
                {{ value.title }}
                {% if value.highlight_text %}
                    <span>{{ value.highlight_text }}</span>
                {% endif %}
            </h2>
            <div class="section-description">
                {{ value.subtitle|safe }}
            </div>
        </div>
        
        {% if value.tabs %}
            <!-- Abas -->
            <div class="tabs-container" id="tabs-container-{{ id }}">
                {% for tab in value.tabs %}
                    <button class="tab {% if forloop.first %}active{% endif %}" 
                            data-tab-target="tab-content-{{ forloop.counter }}-{{ id }}">
                        {{ tab.tab_title }}
                    </button>
                {% endfor %}
            </div>
            
            <!-- Conteúdo das abas -->
            <div class="tabs-content-container">
                {% for tab in value.tabs %}
                    <div class="tab-content {% if forloop.first %}active{% endif %}" id="tab-content-{{ forloop.counter }}-{{ id }}">
                        <div class="cards-grid columns-{{ tab.columns }}" data-layout="{{ tab.layout_type }}">
                            {% for card in tab.cards %}
                                <div class="card-item" style="--card-highlight-color: {{ card.highlight_color }};">
                                    <div class="card-icon">
                                        <i class="{{ card.icon_class }}"></i>
                                    </div>
                                    
                                    <h3 class="card-title">{{ card.title }}</h3>
                                    
                                    <div class="card-description">
                                        {{ card.description|safe }}
                                    </div>
                                    
                                    <a href="{{ card.link_url }}" target="_blank" class="card-link">
                                        {{ card.link_text }}
                                        <i class="fa-solid fa-circle-chevron-right"></i>
                                    </a>
                                </div>
                            {% empty %}
                                <div class="empty-state">
                                    <p>Nenhum card foi adicionado a esta aba.</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <p>Nenhuma aba foi configurada para esta seção.</p>
            </div>
        {% endif %}
    </div>
</section>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Para cada seção de tabs na página
        document.querySelectorAll('.section-tabs-cards').forEach(function(section) {
            // Encontrar todas as abas na seção
            const tabs = section.querySelectorAll('.tab');
            
            // Adicionar evento de clique a cada aba
            tabs.forEach(function(tab) {
                tab.addEventListener('click', function() {
                    // ID do conteúdo da aba que deve ser mostrado
                    const targetId = this.getAttribute('data-tab-target');
                    
                    // Remover classe 'active' de todas as abas na seção
                    section.querySelectorAll('.tab').forEach(function(t) {
                        t.classList.remove('active');
                    });
                    
                    // Adicionar classe 'active' à aba clicada
                    this.classList.add('active');
                    
                    // Remover classe 'active' de todos os conteúdos de aba na seção
                    section.querySelectorAll('.tab-content').forEach(function(content) {
                        content.classList.remove('active');
                    });
                    
                    // Adicionar classe 'active' ao conteúdo da aba clicada
                    const targetContent = section.querySelector('#' + targetId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    } else {
                        console.error('Conteúdo de aba não encontrado: #' + targetId);
                    }
                });
            });
        });
    });
</script>
{% endblock %}