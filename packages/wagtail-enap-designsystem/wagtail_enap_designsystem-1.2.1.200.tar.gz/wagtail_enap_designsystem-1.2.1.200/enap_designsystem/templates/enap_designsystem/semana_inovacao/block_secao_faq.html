{% load wagtailimages_tags %}

{% if value.imagem_fundo %}
    {% image value.imagem_fundo original as bg_image %}
{% endif %}

<section class="faq-secao" 
        {% if bg_image %}
        style="background-image: url('{{ bg_image.url }}');"
        {% else %}
        style="background-color: #F5F5DC;"
        {% endif %}>
    
    <div class="faq-container">
        <!-- Título -->
        {% if value.titulo %}
            <h2 class="faq-titulo" style="color: {{ value.cor_titulo }};">
                {{ value.titulo }}
            </h2>
        {% endif %}
        
        <!-- Accordion FAQs -->
        <div class="faq-accordion">
            {% for faq_block in value.faqs %}
                {% if faq_block.block_type == 'faq' %}
                    <div class="faq-item">
                        <!-- Pergunta (botão do accordion) -->
                        <button class="faq-pergunta" 
                                style="color: {{ value.cor_perguntas }};"
                                onclick="toggleFAQ(this)"
                                aria-expanded="false">
                            <span class="pergunta-texto">{{ faq_block.value.pergunta }}</span>
                            <span class="faq-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M6 9l6 6 6-6"/>
                                </svg>
                            </span>
                        </button>
                        
                        <!-- Resposta (conteúdo do accordion) -->
                        <div class="faq-resposta-wrapper">
                            <div class="faq-resposta" style="color: {{ value.cor_respostas }};">
                                {{ faq_block.value.resposta }}
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</section>

<script>
function toggleFAQ(button) {
    const isExpanded = button.getAttribute('aria-expanded') === 'true';
    const wrapper = button.nextElementSibling;
    
    // Fechar todos os outros FAQs
    const allButtons = document.querySelectorAll('.faq-pergunta');
    allButtons.forEach(btn => {
        if (btn !== button) {
            btn.setAttribute('aria-expanded', 'false');
        }
    });
    
    // Toggle do FAQ atual
    button.setAttribute('aria-expanded', !isExpanded);
}
</script>