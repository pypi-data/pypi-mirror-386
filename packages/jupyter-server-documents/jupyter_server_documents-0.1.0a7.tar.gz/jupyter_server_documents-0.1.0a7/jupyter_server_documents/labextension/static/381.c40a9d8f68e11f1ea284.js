"use strict";(self.webpackChunk_jupyter_ai_contrib_server_documents=self.webpackChunk_jupyter_ai_contrib_server_documents||[]).push([[381],{1891:(t,e,s)=>{s.d(e,{Fo:()=>l,Gu:()=>g,Qj:()=>f,xv:()=>c,zd:()=>u});var r=s(3616),n=s(5495),o=s(6891);class a{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const c=()=>new a,l=t=>{const e=new Uint8Array((t=>{let e=t.cpos;for(let s=0;s<t.bufs.length;s++)e+=t.bufs[s].length;return e})(t));let s=0;for(let r=0;r<t.bufs.length;r++){const n=t.bufs[r];e.set(n,s),s+=n.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),s),e},i=(t,e)=>{const s=t.cbuf.length;t.cpos===s&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*s),t.cpos=0),t.cbuf[t.cpos++]=e},u=(t,e)=>{for(;e>n.WD;)i(t,n.wt|n.WD&e),e=r.RI(e/128);i(t,n.WD&e)},h=new Uint8Array(3e4),d=h.length/3,f=o.db&&o.db.encodeInto?(t,e)=>{if(e.length<d){const s=o.db.encodeInto(e,h).written||0;u(t,s);for(let e=0;e<s;e++)i(t,h[e])}else g(t,o.Af(e))}:(t,e)=>{const s=unescape(encodeURIComponent(e)),r=s.length;u(t,r);for(let e=0;e<r;e++)i(t,s.codePointAt(e))},g=(t,e)=>{u(t,e.byteLength),((t,e)=>{const s=t.cbuf.length,n=t.cpos,o=r.jk(s-n,e.length),a=e.length-o;t.cbuf.set(e.subarray(0,o),n),t.cpos+=o,a>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(r.T9(2*s,a)),t.cbuf.set(e.subarray(o)),t.cpos=a)})(t,e)};new DataView(new ArrayBuffer(4))},3616:(t,e,s)=>{s.d(e,{RI:()=>r,T9:()=>o,jk:()=>n,sj:()=>a});const r=Math.floor,n=(Math.ceil,Math.abs,Math.imul,Math.round,Math.log10,Math.log2,Math.log,Math.sqrt,(t,e)=>t<e?t:e),o=(t,e)=>t>e?t:e,a=(Number.isNaN,Math.pow,Math.sign,t=>0!==t?t<0:1/t<0)},5495:(t,e,s)=>{s.d(e,{CW:()=>l,D7:()=>r,P1:()=>o,WD:()=>a,vZ:()=>c,wt:()=>n});const r=64,n=128,o=63,a=127,c=2147483647,l=4294967295},6381:(t,e,s)=>{s.d(e,{ww:()=>p,tQ:()=>y,X3:()=>m,_g:()=>b});var r=s(1891),n=s(7882);const o=Date.now;var a=s(3616);const c=()=>new Map,l=()=>new Set,i=Array.from;Array.isArray;class u{constructor(){this._observers=c()}on(t,e){((t,e,s)=>{let r=t.get(e);return void 0===r&&t.set(e,r=s()),r})(this._observers,t,l).add(e)}once(t,e){const s=(...r)=>{this.off(t,s),e(...r)};this.on(t,s)}off(t,e){const s=this._observers.get(t);void 0!==s&&(s.delete(e),0===s.size&&this._observers.delete(t))}emit(t,e){return i((this._observers.get(t)||c()).values()).forEach((t=>t(...e)))}destroy(){this._observers=c()}}Object.assign;const h=Object.keys,d=t=>h(t).length,f=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),g=(Object.freeze,(t,e)=>{if(null==t||null==e)return((t,e)=>t===e)(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:if(t.byteLength!==e.byteLength)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;break;case Set:if(t.size!==e.size)return!1;for(const s of t)if(!e.has(s))return!1;break;case Map:if(t.size!==e.size)return!1;for(const s of t.keys())if(!e.has(s)||!g(t.get(s),e.get(s)))return!1;break;case Object:if(d(t)!==d(e))return!1;for(const s in t)if(!f(t,s)||!g(t[s],e[s]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!g(t[s],e[s]))return!1;break;default:return!1}return!0});s(2206);class p extends u{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const t=o();null!==this.getLocalState()&&15e3<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const e=[];this.meta.forEach(((s,r)=>{r!==this.clientID&&3e4<=t-s.lastUpdated&&this.states.has(r)&&e.push(r)})),e.length>0&&b(this,e,"timeout")}),a.RI(3e3)),t.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const e=this.clientID,s=this.meta.get(e),r=void 0===s?0:s.clock+1,n=this.states.get(e);null===t?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:r,lastUpdated:o()});const a=[],c=[],l=[],i=[];null===t?i.push(e):null==n?null!=t&&a.push(e):(c.push(e),g(n,t)||l.push(e)),(a.length>0||l.length>0||i.length>0)&&this.emit("change",[{added:a,updated:l,removed:i},"local"]),this.emit("update",[{added:a,updated:c,removed:i},"local"])}setLocalStateField(t,e){const s=this.getLocalState();null!==s&&this.setLocalState({...s,[t]:e})}getStates(){return this.states}}const b=(t,e,s)=>{const r=[];for(let s=0;s<e.length;s++){const n=e[s];if(t.states.has(n)){if(t.states.delete(n),n===t.clientID){const e=t.meta.get(n);t.meta.set(n,{clock:e.clock+1,lastUpdated:o()})}r.push(n)}}r.length>0&&(t.emit("change",[{added:[],updated:[],removed:r},s]),t.emit("update",[{added:[],updated:[],removed:r},s]))},m=(t,e,s=t.states)=>{const n=e.length,o=r.xv();r.zd(o,n);for(let a=0;a<n;a++){const n=e[a],c=s.get(n)||null,l=t.meta.get(n).clock;r.zd(o,n),r.zd(o,l),r.Qj(o,JSON.stringify(c))}return r.Fo(o)},y=(t,e,s)=>{const r=n.$C(e),a=o(),c=[],l=[],i=[],u=[],h=n.cw(r);for(let e=0;e<h;e++){const e=n.cw(r);let s=n.cw(r);const o=JSON.parse(n.t3(r)),h=t.meta.get(e),d=t.states.get(e),f=void 0===h?0:h.clock;(f<s||f===s&&null===o&&t.states.has(e))&&(null===o?e===t.clientID&&null!=t.getLocalState()?s++:t.states.delete(e):t.states.set(e,o),t.meta.set(e,{clock:s,lastUpdated:a}),void 0===h&&null!==o?c.push(e):void 0!==h&&null===o?u.push(e):null!==o&&(g(o,d)||i.push(e),l.push(e)))}(c.length>0||i.length>0||u.length>0)&&t.emit("change",[{added:c,updated:i,removed:u},s]),(c.length>0||l.length>0||u.length>0)&&t.emit("update",[{added:c,updated:l,removed:u},s])}},6891:(t,e,s)=>{s.d(e,{Af:()=>o,db:()=>n,tv:()=>a});const r=String.fromCharCode,n=(String.fromCodePoint,r(65535),"undefined"!=typeof TextEncoder?new TextEncoder:null),o=n?t=>n.encode(t):t=>{const e=unescape(encodeURIComponent(t)),s=e.length,r=new Uint8Array(s);for(let t=0;t<s;t++)r[t]=e.codePointAt(t);return r};let a="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});a&&1===a.decode(new Uint8Array).length&&(a=null)},7882:(t,e,s)=>{s.d(e,{$C:()=>u,t3:()=>g,cw:()=>f,bo:()=>h});var r=s(5495);s(3616);const n=Number.MAX_SAFE_INTEGER;Number.MIN_SAFE_INTEGER,r.vZ,r.CW,Number.isInteger,Number.isNaN,Number.parseInt;var o=s(6891);const a=t=>new Error(t),c=a("Unexpected end of array"),l=a("Integer out of Range");class i{constructor(t){this.arr=t,this.pos=0}}const u=t=>new i(t),h=t=>((t,e)=>{const s=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,s})(t,f(t)),d=t=>t.arr[t.pos++],f=t=>{let e=0,s=1;const o=t.arr.length;for(;t.pos<o;){const o=t.arr[t.pos++];if(e+=(o&r.WD)*s,s*=128,o<r.wt)return e;if(e>n)throw l}throw c},g=o.tv?t=>o.tv.decode(h(t)):t=>{let e=f(t);if(0===e)return"";{let s=String.fromCodePoint(d(t));if(--e<100)for(;e--;)s+=String.fromCodePoint(d(t));else for(;e>0;){const r=e<1e4?e:1e4,n=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,s+=String.fromCodePoint.apply(null,n),e-=r}return decodeURIComponent(escape(s))}}}}]);