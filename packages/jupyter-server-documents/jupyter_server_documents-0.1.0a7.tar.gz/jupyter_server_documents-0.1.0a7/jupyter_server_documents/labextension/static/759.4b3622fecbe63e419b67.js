(self.webpackChunk_jupyter_ai_contrib_server_documents=self.webpackChunk_jupyter_ai_contrib_server_documents||[]).push([[759],{5606:e=>{var t,s,n=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{s="function"==typeof clearTimeout?clearTimeout:o}catch(e){s=o}}();var a,i=[],l=!1,h=-1;function u(){l&&a&&(l=!1,a.length?i=a.concat(i):h=-1,i.length&&d())}function d(){if(!l){var e=c(u);l=!0;for(var t=i.length;t;){for(a=i,i=[];++h<t;)a&&a[h].run();h=-1,t=i.length}a=null,l=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{return s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function w(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];i.push(new f(e,t)),1!==i.length||l||c(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=w,n.addListener=w,n.once=w,n.off=w,n.removeListener=w,n.removeAllListeners=w,n.emit=w,n.prependListener=w,n.prependOnceListener=w,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},6759:(e,t,s)=>{"use strict";s.r(t),s.d(t,{WebsocketProvider:()=>ge,messageAuth:()=>ue,messageAwareness:()=>he,messageQueryAwareness:()=>le,messageSync:()=>ie});var n=s(2206);const r=()=>new Map,o=(e,t,s)=>{let n=e.get(t);return void 0===n&&e.set(t,n=s()),n},c=()=>new Set,a=String.fromCharCode,i=(String.fromCodePoint,a(65535),/^\s*/g),l=/([A-Z])/g,h=(e,t)=>(e=>e.replace(i,""))(e.replace(l,(e=>`${t}${(e=>e.toLowerCase())(e)}`))),u="undefined"!=typeof TextEncoder?new TextEncoder:null;let d="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});d&&1===d.decode(new Uint8Array).length&&(d=null);let f=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},w=!0;try{"undefined"!=typeof localStorage&&localStorage&&(f=localStorage,w=!1)}catch(e){}const b=f,p=Array.from;Array.isArray;var g=s(5606);const y=void 0!==g&&g.release&&/node|io\.js/.test(g.release.name)&&"[object process]"===Object.prototype.toString.call(void 0!==g?g:0),m="undefined"!=typeof window&&"undefined"!=typeof document&&!y;let v;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);const _=[],C=e=>(()=>{if(void 0===v)if(y){v=r();const e=g.argv;let t=null;for(let s=0;s<e.length;s++){const n=e[s];"-"===n[0]?(null!==t&&v.set(t,""),t=n):null!==t?(v.set(t,n),t=null):_.push(n)}null!==t&&v.set(t,"")}else"object"==typeof location?(v=r(),(location.search||"?").slice(1).split("&").forEach((e=>{if(0!==e.length){const[t,s]=e.split("=");v.set(`--${h(t,"-")}`,s),v.set(`-${h(t,"-")}`,s)}}))):v=r();return v})().has(e),T=e=>{return void 0===(t=y?g.env[e.toUpperCase().replaceAll("-","_")]:b.getItem(e))?null:t;var t},A=e=>C("--"+e)||null!==T(e);var I;A("production"),y&&(I=g.env.FORCE_COLOR,["true","1","2"].includes(I))||!C("--no-colors")&&!A("no-color")&&(!y||g.stdout.isTTY)&&(!y||C("--color")||null!==T("COLORTERM")||(T("TERM")||"").includes("color"));const U=m?e=>{let t="";for(let s=0;s<e.byteLength;s++)t+=a(e[s]);return btoa(t)}:e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),M=m?e=>{const t=atob(e),s=(n=t.length,new Uint8Array(n));var n;for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);return s}:e=>{const t=Buffer.from(e,"base64");return s=t.buffer,n=t.byteOffset,r=t.byteLength,new Uint8Array(s,n,r);var s,n,r},S=new Map,E="undefined"==typeof BroadcastChannel?class{constructor(e){var t;this.room=e,this.onmessage=null,this._onChange=t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:M(t.newValue||"")}),t=this._onChange,w||addEventListener("storage",t)}postMessage(e){b.setItem(this.room,U(new Uint8Array(e)))}close(){var e;e=this._onChange,w||removeEventListener("storage",e)}}:BroadcastChannel,k=e=>o(S,e,(()=>{const t=c(),s=new E(e);return s.onmessage=e=>t.forEach((t=>t(e.data,"broadcastchannel"))),{bc:s,subs:t}})),L=(e,t,s=null)=>{const n=k(e);n.bc.postMessage(t),n.subs.forEach((e=>e(t,s)))},R=Date.now,x=Math.floor,B=(Math.ceil,Math.abs,Math.imul,Math.round,Math.log10,Math.log2,Math.log,Math.sqrt,(e,t)=>e<t?e:t),O=(Number.isNaN,Math.pow),N=(Math.sign,128),j=127;class H{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const D=()=>new H,$=e=>{let t=e.cpos;for(let s=0;s<e.bufs.length;s++)t+=e.bufs[s].length;return t},z=e=>{const t=new Uint8Array($(e));let s=0;for(let n=0;n<e.bufs.length;n++){const r=e.bufs[n];t.set(r,s),s+=r.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),s),t},P=(e,t)=>{const s=e.cbuf.length;e.cpos===s&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*s),e.cpos=0),e.cbuf[e.cpos++]=t},W=(e,t)=>{for(;t>j;)P(e,N|j&t),t=x(t/128);P(e,j&t)},X=(new Uint8Array(3e4).length,u&&u.encodeInto,(e,t)=>{const s=e.cbuf.length,n=e.cpos,r=B(s-n,t.length),o=t.length-r;var c,a;e.cbuf.set(t.subarray(0,r),n),e.cpos+=r,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array((c=2*s)>(a=o)?c:a),e.cbuf.set(t.subarray(r)),e.cpos=o)}),G=(e,t)=>{W(e,t.byteLength),X(e,t)};new DataView(new ArrayBuffer(4));const F=Number.MAX_SAFE_INTEGER,V=(Number.MIN_SAFE_INTEGER,Number.isInteger,Number.isNaN,Number.parseInt,e=>new Error(e)),Q=V("Unexpected end of array"),Y=V("Integer out of Range");class q{constructor(e){this.arr=e,this.pos=0}}const Z=e=>((e,t)=>{const s=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,s})(e,J(e)),J=e=>{let t=0,s=1;const n=e.arr.length;for(;e.pos<n;){const n=e.arr[e.pos++];if(t+=(n&j)*s,s*=128,n<N)return t;if(t>F)throw Y}throw Q};var K=s(1891),ee=s(7882);const te=(e,t)=>{K.zd(e,0);const s=n.encodeStateVector(t);K.Gu(e,s)},se=(e,t,s)=>{K.zd(e,1),K.Gu(e,n.encodeStateAsUpdate(t,s))},ne=(e,t,s)=>{try{n.applyUpdate(t,ee.bo(e),s)}catch(e){console.error("Caught error while handling a Yjs update",e)}},re=ne;var oe=s(6381);class ce{constructor(){this._observers=r()}on(e,t){o(this._observers,e,c).add(t)}once(e,t){const s=(...n)=>{this.off(e,s),t(...n)};this.on(e,s)}off(e,t){const s=this._observers.get(e);void 0!==s&&(s.delete(t),0===s.size&&this._observers.delete(e))}emit(e,t){return p((this._observers.get(e)||r()).values()).forEach((e=>e(...t)))}destroy(){this._observers=r()}}Object.assign,Object.keys,Object.freeze;var ae=s(5606);const ie=0,le=3,he=1,ue=2,de=[];de[ie]=(e,t,s,n,r)=>{W(e,ie);const o=((e,t,s,n)=>{const r=ee.cw(e);switch(r){case 0:((e,t,s)=>{se(t,s,ee.bo(e))})(e,t,s);break;case 1:ne(e,s,n);break;case 2:re(e,s,n);break;default:throw new Error("Unknown message type")}return r})(t,e,s.doc,s);n&&1===o&&!s.synced&&(s.synced=!0)},de[le]=(e,t,s,n,r)=>{W(e,he),G(e,oe.X3(s.awareness,Array.from(s.awareness.getStates().keys())))},de[he]=(e,t,s,n,r)=>{oe.tQ(s.awareness,Z(t),s)},de[ue]=(e,t,s,n,r)=>{((e,t,s)=>{0===ee.cw(e)&&s(0,ee.t3(e))})(t,s.doc,((e,t)=>fe(s,t)))};const fe=(e,t)=>console.warn(`Permission denied to access ${e.url}.\n${t}`),we=(e,t,s)=>{const n=new q(t),r=D(),o=J(n),c=e.messageHandlers[o];return c?c(r,n,e,s,o):console.error("Unable to compute message"),r},be=e=>{if(e.shouldConnect&&null===e.ws){const t=new e._WS(e.url);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=s=>{e.wsLastMessageReceived=R();const n=we(e,new Uint8Array(s.data),!0);$(n)>1&&t.send(z(n))},t.onerror=t=>{e.emit("connection-error",[t,e])},t.onclose=t=>{e.emit("connection-close",[t,e]),e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,oe._g(e.awareness,Array.from(e.awareness.getStates().keys()).filter((t=>t!==e.doc.clientID)),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(be,B(100*O(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e)},t.onopen=()=>{e.wsLastMessageReceived=R(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);const s=D();if(W(s,ie),te(s,e.doc),t.send(z(s)),null!==e.awareness.getLocalState()){const s=D();W(s,he),G(s,oe.X3(e.awareness,[e.doc.clientID])),t.send(z(s))}},e.emit("status",[{status:"connecting"}])}},pe=(e,t)=>{const s=e.ws;e.wsconnected&&s&&s.readyState===s.OPEN&&s.send(t),e.bcconnected&&L(e.bcChannel,t,e)};class ge extends ce{constructor(e,t,s,{connect:n=!0,awareness:r=new oe.ww(s),params:o={},WebSocketPolyfill:c=WebSocket,resyncInterval:a=-1,maxBackoffTime:i=2500,disableBc:l=!1}={}){for(super();"/"===e[e.length-1];)e=e.slice(0,e.length-1);const h=(e=>((e,t)=>{const s=[];for(const n in e)s.push(t(e[n],n));return s})(e,((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&"))(o);this.maxBackoffTime=i,this.bcChannel=e+"/"+t,this.url=e+"/"+t+(0===h.length?"":"?"+h),this.roomname=t,this.doc=s,this._WS=c,this.awareness=r,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=l,this.wsUnsuccessfulReconnects=0,this.messageHandlers=de.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=n,this._resyncInterval=0,a>0&&(this._resyncInterval=setInterval((()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){const e=D();W(e,ie),te(e,s),this.ws.send(z(e))}}),a)),this._bcSubscriber=(e,t)=>{if(t!==this){const t=we(this,new Uint8Array(e),!1);$(t)>1&&L(this.bcChannel,z(t),this)}},this._updateHandler=(e,t)=>{if(t!==this){const t=D();W(t,ie),((e,t)=>{K.zd(e,2),K.Gu(e,t)})(t,e),pe(this,z(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:e,updated:t,removed:s},n)=>{const o=e.concat(t).concat(s),c=D();W(c,he),G(c,oe.X3(r,o)),pe(this,z(c))},this._exitHandler=()=>{oe._g(this.awareness,[s.clientID],"app closed")},y&&void 0!==ae&&ae.on("exit",this._exitHandler),r.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval((()=>{this.wsconnected&&3e4<R()-this.wsLastMessageReceived&&this.ws.close()}),3e3),n&&this.connect()}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),y&&void 0!==ae&&ae.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;var e,t;this.bcconnected||(e=this.bcChannel,t=this._bcSubscriber,k(e).subs.add(t),this.bcconnected=!0);const s=D();W(s,ie),te(s,this.doc),L(this.bcChannel,z(s),this);const n=D();W(n,ie),se(n,this.doc),L(this.bcChannel,z(n),this);const r=D();W(r,le),L(this.bcChannel,z(r),this);const o=D();W(o,he),G(o,oe.X3(this.awareness,[this.doc.clientID])),L(this.bcChannel,z(o),this)}disconnectBc(){const e=D();W(e,he),G(e,oe.X3(this.awareness,[this.doc.clientID],new Map)),pe(this,z(e)),this.bcconnected&&(((e,t)=>{const s=k(e);s.subs.delete(t)&&0===s.subs.size&&(s.bc.close(),S.delete(e))})(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(be(this),this.connectBc())}}}}]);