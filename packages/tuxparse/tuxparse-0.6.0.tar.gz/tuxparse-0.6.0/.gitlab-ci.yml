include:
  - https://gitlab.com/Linaro/tuxpkg/-/raw/main/gitlab-ci-pipeline.yml

workflow:
  rules:
    - when: always

variables:
  TUXPKG: python3 -m tuxpkg
  TUXPKG_PROJECT: tuxparse

stylecheck:
  image: $CI_REGISTRY_IMAGE:ci-debian
  stage: test
  rules:
    - if: '$CI_MERGE_REQUEST_ID'
  script:
    - apt-get update -q
    - apt-get build-dep -qy .
    - make stylecheck

pages:
  stage: deploy
  needs:
    - test
    - repository
  only:
    - tags
  script:
    - mkdir public
    - echo SOON > public/index.html
    - cp -r dist/repo public/packages
  artifacts:
    paths:
      - public
