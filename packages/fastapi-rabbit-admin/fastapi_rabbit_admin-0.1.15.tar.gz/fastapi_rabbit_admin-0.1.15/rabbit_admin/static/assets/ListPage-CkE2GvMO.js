import{c as R,j as V,h,A as w,g as $,L as q,r as p,o as B,W as y,O as g,R as k,Q as u,X as f,$ as _,P as m,a0 as N,V as I,N as T,S as b,T as C,U as L}from"./index-DJkg6F8r.js";import{Q as M}from"./QTable-BQpogAfr.js";import{factory as U}from"./crud-D1vEw0Qb.js";import"./QSelect-CLWMwuoD.js";import"./format-BFUIF-qg.js";import"./axios-NU4QR4fF.js";const j=R({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(l,{slots:i}){const n=$(),r=V(()=>"q-td"+(l.autoWidth===!0?" q-table--col-auto-width":"")+(l.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(l.props===void 0)return h("td",{class:r.value},w(i.default));const a=n.vnode.key,d=(l.props.colsMap!==void 0?l.props.colsMap[a]:null)||l.props.col;if(d===void 0)return;const{row:s}=l.props;return h("td",{class:r.value+d.__tdClass(s),style:d.__tdStyle(s)},w(i.default))}}}),W={class:"q-pa-md"},A={key:0,class:"text-center q-pa-lg"},D={class:"text-caption"},E={class:"row justify-between q-gutter-x-md"},G={__name:"ListPage",props:{model_name:{type:String,required:!0}},setup(l){const i=q(),n=p([]),r=p([]);let a;const d=p(""),s=l,c=p([]),S=()=>c.value.length>0?`Selected ${c.value.length}`:"None selected",x=async()=>{console.log(c.value),await a.delete(c.value.map(o=>o.id)),await i.go(0)},Q=o=>{console.log("Row clicked:",o),console.log("Model name:",s.model_name),console.log("Row ID:",o.id),console.log("Full URL:",`/admin/${s.model_name}/${o.id}`),i.push(`/admin/${s.model_name}/${o.id}`)};return B(async()=>{if(a=await U.get_crud_service(s.model_name),a){const o=await a.list();console.log("Raw items from API:",o),n.value=o.map(e=>{const t={id:e.id};return e.fields.forEach(v=>{t[v.name]=v.data}),t}),console.log("Processed rows:",n.value),r.value=await a.get_columns(),console.log(r.value)}}),(o,e)=>(g(),y("div",W,[n.value.length===0?(g(),y("div",A,[e[3]||(e[3]=f("div",{class:"text-h6"},"Loading data...",-1)),f("div",D,"Rows: "+_(n.value.length)+", Columns: "+_(r.value.length),1)])):k("",!0),u(M,{flat:"",bordered:"","binary-state-sort":"",title:s.model_name,rows:n.value,columns:r.value,"row-key":"id",filter:d.value,selection:"multiple",selected:c.value,"onUpdate:selected":e[2]||(e[2]=t=>c.value=t),"selected-rows-label":S},{"body-cell":m(t=>[u(j,{props:t,class:"cursor-pointer hover:bg-grey-2",onClick:v=>Q(t.row)},{default:m(()=>[L(_(t.value),1)]),_:2},1032,["props","onClick"])]),"top-left":m(()=>[c.value.length>0?(g(),T(b,{key:0,label:"delete",icon:"delete",dense:"",flat:"",color:"negative",onClick:x})):k("",!0),u(b,{label:"create",icon:"add",dense:"",flat:"",color:"primary",onClick:e[0]||(e[0]=t=>C(i).push(C(a).frontend_links.create))})]),"top-right":m(()=>[f("div",E,[u(N,{borderless:"",dense:"",debounce:"300",modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value=t),placeholder:"Search"},{append:m(()=>[u(I,{name:"search"})]),_:1},8,["modelValue"])])]),_:1},8,["title","rows","columns","filter","selected"])]))}};export{G as default};
