import{Q as w,a as k}from"./TouchPan-CrNqx_-V.js";import{Q as q,_ as V,a as R}from"./SelectField-CUR69mQ5.js";import{L as S,r as f,o as B,M as C,N as u,O as c,P as n,Q as r,W as N,R as j,U as p,$ as _,S as v,a1 as D,a2 as T,X as g}from"./index-D3Z3DZSY.js";import{Q as E}from"./QSelect-BP87xem-.js";import{factory as y}from"./crud-Ck7i_6se.js";import"./format-DvmtIt1M.js";import"./axios-CZVAb7GI.js";const U={__name:"CreatePage",props:{model_name:{type:String,required:!0}},setup(Q){S();let d;const i=Q,o=f({}),m=f({}),h=(e,t)=>{e&&(m.value[t]=e)},x=()=>{const e=[];return Object.keys(m.value).forEach(t=>{const s=m.value[t];if(s&&s.getValue){const a=s.getValue(),l={name:a.name};a.data!==null&&a.data!==void 0&&(l.data=a.data),a.selected!==null&&a.selected!==void 0&&(l.selected=a.selected),e.push(l)}}),{name:i.model_name,fields:e}},b=async()=>{try{const e=x();console.log("Sending form data:",e);const s=await y.get_crud_service(i.model_name).create(e);console.log("Result:",s),alert(`successfully saved new item with id ${s.id}`)}catch(e){console.error("Error creating item:",e),e.response&&e.response.status===422&&console.error("Validation error:",e.response.data)}};return B(async()=>{d=await y.get_crud_service(i.model_name),d&&(o.value=await d.form(),console.log(o.value))}),(e,t)=>{const s=C("q-label");return c(),u(R,{class:"column justify-start items-stretch"},{default:n(()=>[r(w,{class:"col-4 bg-primary text-primary q-ma-sm q-pa-sm bg-transparent"},{default:n(()=>[o.value.name?(c(),u(k,{key:0},{default:n(()=>[p(_(o.value.name),1)]),_:1})):j("",!0),r(q),r(v,{flat:"",round:"",dense:"",icon:"save",class:"text-h5",onClick:b}),r(v,{flat:"",round:"",dense:"",icon:"delete",class:"text-h5"})]),_:1}),(c(!0),N(D,null,T(o.value.fields,a=>(c(),u(E,{key:a.name,class:"row justify-start items-end full-width q-ma-sm q-pa-md"},{default:n(()=>[t[0]||(t[0]=g("div",{class:"col-1"},null,-1)),r(s,{class:"col-2 text-h5"},{default:n(()=>[p(_(a.name),1)]),_:2},1024),t[1]||(t[1]=g("div",{class:"col-1 text-h5"},":",-1)),r(V,{field:a,ref_for:!0,ref:l=>h(l,a.name)},null,8,["field"])]),_:2},1024))),128))]),_:1})}}};export{U as default};
