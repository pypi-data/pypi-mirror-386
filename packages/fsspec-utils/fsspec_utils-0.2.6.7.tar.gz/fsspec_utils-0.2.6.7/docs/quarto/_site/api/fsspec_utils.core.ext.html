<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>fsspec_utils.core.ext – fsspec-utils</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-bc185b5c5bdbcb35c2eb49d8a876ef70.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b487cddad83ce73ad93f1328ce7d9f7a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-c35703f27e2ef84e2c700e09dd0c80cb.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-b487cddad83ce73ad93f1328ce7d9f7a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">fsspec-utils</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../quickstart.html"> 
<span class="menu-text">Quickstart</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../installation.html"> 
<span class="menu-text">Installation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../advanced.html"> 
<span class="menu-text">Advanced</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../architecture.html"> 
<span class="menu-text">Architecture</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contributing.html"> 
<span class="menu-text">Contributing</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-api-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">API Reference</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-api-reference">    
        <li class="dropdown-header">Core</li>
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.core.base.html">
 <span class="dropdown-text">fsspec_utils.core.base</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.core.ext.html">
 <span class="dropdown-text">fsspec_utils.core.ext</span></a>
  </li>  
        <li class="dropdown-header">Storage Options</li>
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.storage_options.base.html">
 <span class="dropdown-text">fsspec_utils.storage_options.base</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.storage_options.cloud.html">
 <span class="dropdown-text">fsspec_utils.storage_options.cloud</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.storage_options.core.html">
 <span class="dropdown-text">fsspec_utils.storage_options.core</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.storage_options.git.html">
 <span class="dropdown-text">fsspec_utils.storage_options.git</span></a>
  </li>  
        <li class="dropdown-header">Utils</li>
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.utils.datetime.html">
 <span class="dropdown-text">fsspec_utils.utils.datetime</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.utils.logging.html">
 <span class="dropdown-text">fsspec_utils.utils.logging</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.utils.misc.html">
 <span class="dropdown-text">fsspec_utils.utils.misc</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.utils.polars.html">
 <span class="dropdown-text">fsspec_utils.utils.polars</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.utils.pyarrow.html">
 <span class="dropdown-text">fsspec_utils.utils.pyarrow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.utils.sql.html">
 <span class="dropdown-text">fsspec_utils.utils.sql</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../api/fsspec_utils.utils.types.html">
 <span class="dropdown-text">fsspec_utils.utils.types</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/legout/fsspec-utils"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://pypi.org/project/fsspec-utils/"> <i class="bi bi-box-arrow-down" role="img">
</i> 
<span class="menu-text">PyPI</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fsspec_utils.core.ext-api-documentation" id="toc-fsspec_utils.core.ext-api-documentation" class="nav-link active" data-scroll-target="#fsspec_utils.core.ext-api-documentation"><code>fsspec_utils.core.ext</code> API Documentation</a>
  <ul class="collapse">
  <li><a href="#path_to_glob" id="toc-path_to_glob" class="nav-link" data-scroll-target="#path_to_glob"><code>path_to_glob()</code></a></li>
  <li><a href="#read_json_file" id="toc-read_json_file" class="nav-link" data-scroll-target="#read_json_file"><code>read_json_file()</code></a></li>
  <li><a href="#read_json" id="toc-read_json" class="nav-link" data-scroll-target="#read_json"><code>read_json()</code></a></li>
  <li><a href="#read_csv_file" id="toc-read_csv_file" class="nav-link" data-scroll-target="#read_csv_file"><code>read_csv_file()</code></a></li>
  <li><a href="#read_csv" id="toc-read_csv" class="nav-link" data-scroll-target="#read_csv"><code>read_csv()</code></a></li>
  <li><a href="#read_parquet_file" id="toc-read_parquet_file" class="nav-link" data-scroll-target="#read_parquet_file"><code>read_parquet_file()</code></a></li>
  <li><a href="#read_parquet" id="toc-read_parquet" class="nav-link" data-scroll-target="#read_parquet"><code>read_parquet()</code></a></li>
  <li><a href="#read_files" id="toc-read_files" class="nav-link" data-scroll-target="#read_files"><code>read_files()</code></a></li>
  <li><a href="#pyarrow_dataset" id="toc-pyarrow_dataset" class="nav-link" data-scroll-target="#pyarrow_dataset"><code>pyarrow_dataset()</code></a></li>
  <li><a href="#pyarrow_parquet_dataset" id="toc-pyarrow_parquet_dataset" class="nav-link" data-scroll-target="#pyarrow_parquet_dataset"><code>pyarrow_parquet_dataset()</code></a></li>
  <li><a href="#pydala_dataset" id="toc-pydala_dataset" class="nav-link" data-scroll-target="#pydala_dataset"><code>pydala_dataset()</code></a></li>
  <li><a href="#write_parquet" id="toc-write_parquet" class="nav-link" data-scroll-target="#write_parquet"><code>write_parquet()</code></a></li>
  <li><a href="#write_json" id="toc-write_json" class="nav-link" data-scroll-target="#write_json"><code>write_json()</code></a></li>
  <li><a href="#write_csv" id="toc-write_csv" class="nav-link" data-scroll-target="#write_csv"><code>write_csv()</code></a></li>
  <li><a href="#write_file" id="toc-write_file" class="nav-link" data-scroll-target="#write_file"><code>write_file()</code></a></li>
  <li><a href="#write_files" id="toc-write_files" class="nav-link" data-scroll-target="#write_files"><code>write_files()</code></a></li>
  <li><a href="#write_pyarrow_dataset" id="toc-write_pyarrow_dataset" class="nav-link" data-scroll-target="#write_pyarrow_dataset"><code>write_pyarrow_dataset()</code></a></li>
  <li><a href="#write_pydala_dataset" id="toc-write_pydala_dataset" class="nav-link" data-scroll-target="#write_pydala_dataset"><code>write_pydala_dataset()</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>





<section id="fsspec_utils.core.ext-api-documentation" class="level1">
<h1><code>fsspec_utils.core.ext</code> API Documentation</h1>
<p>This module provides extended functionalities for <code>fsspec.AbstractFileSystem</code>, including methods for reading and writing various file formats (JSON, CSV, Parquet) with advanced options like batch processing, parallelization, and data type optimization. It also includes functions for creating PyArrow and Pydala datasets.</p>
<hr>
<section id="path_to_glob" class="level2">
<h2 class="anchored" data-anchor-id="path_to_glob"><code>path_to_glob()</code></h2>
<p>Convert a path to a glob pattern for file matching.</p>
<p>Intelligently converts paths to glob patterns that match files of the specified format, handling various directory and wildcard patterns.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Base path to convert. Can include wildcards (<code>*</code> or <code>**</code>). Examples: “data/”, “data/*.json”, “data/**”</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str | None</code></td>
<td style="text-align: left;">File format to match (without dot). If None, inferred from path. Examples: “json”, “csv”, “parquet”</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Glob pattern that matches files of specified format. Examples: “data/**/<em>.json”, “data/</em>.csv”</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic directory</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>path_to_glob(<span class="st">"data"</span>, <span class="st">"json"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 'data/**/*.json'</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># With wildcards</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>path_to_glob(<span class="st">"data/**"</span>, <span class="st">"csv"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 'data/**/*.csv'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Format inference</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>path_to_glob(<span class="st">"data/file.parquet"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 'data/file.parquet'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="read_json_file" class="level2">
<h2 class="anchored" data-anchor-id="read_json_file"><code>read_json_file()</code></h2>
<p>Read a single JSON file from any filesystem.</p>
<p>A public wrapper around <code>_read_json_file</code> providing a clean interface for reading individual JSON files.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>self</code></td>
<td style="text-align: left;"><code>AbstractFileSystem</code></td>
<td style="text-align: left;">Filesystem instance to use for reading</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to JSON file to read</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to return dict with ilepath as key</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>jsonlines</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to read as JSON Lines format</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>dict</code> or <code>list[dict]</code></td>
<td style="text-align: left;"><code>dict</code> or <code>list[dict]</code></td>
<td style="text-align: left;">Parsed JSON data. For regular JSON, returns a dict. For JSON Lines, returns a list of dicts. If <code>include_file_path=True</code>, returns <code>{filepath: data}</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read regular JSON</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> fs.read_json_file(<span class="st">"config.json"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[<span class="st">"setting"</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 'value'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Read JSON Lines with filepath</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> fs.read_json_file(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logs.jsonl"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    include_file_path<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    jsonlines<span class="op">=</span><span class="va">True</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">list</span>(data.keys())[<span class="dv">0</span>])</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 'logs.jsonl'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="read_json" class="level2">
<h2 class="anchored" data-anchor-id="read_json"><code>read_json()</code></h2>
<p>Read JSON data from one or more files with powerful options.</p>
<p>Provides a flexible interface for reading JSON data with support for:</p>
<ul>
<li>Single file or multiple f</li>
<li>Regular JSON or JSON Lines format</li>
<li>Batch processing for large datasets</li>
<li>Parallel processing</li>
<li>DataFrame conversion</li>
<li>File path tracking</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path(s) to JSON file(s). Can be: - Single path string (globs supported) - List of path strings</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>batch_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">If set, enables batch reading with this many files per batch</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Include source filepath in output</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>jsonlines</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to read as JSON Lines format</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>as_dataframe</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Convert output to Polars DataFrame(s)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Combine multiple files/batches into single result</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Enable parallel file reading</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Print progress information</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize DataFrame dtypes for performance</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to DataFrame conversion</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>dict</code> or <code>list[dict]</code> or <code>pl.DataFrame</code> or <code>list[pl.DataFrame]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on arguments: - <code>dict</code>: Single JSON file as dictionary - <code>list[dict]</code>: Multiple JSON files as list of dictionaries - <code>pl.DataFrame</code>: Single or concatenated DataFrame - <code>list[pl.DataFrame]</code>: List of Dataframes (if <code>concat=False</code>) - <code>Generator</code>: If <code>batch_size</code> set, yields batches of above types</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read all JSON files in directory</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> fs.read_json(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/*.json"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    as_dataframe<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    concat<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (1000, 5)  # Combined data from all files</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Batch process large dataset</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch_df <span class="kw">in</span> fs.read_json(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logs/*.jsonl"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    jsonlines<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    include_file_path<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Processing </span><span class="sc">{</span><span class="bu">len</span>(batch_df)<span class="sc">}</span><span class="ss"> records"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Parallel read with custom options</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> fs.read_json(</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"file1.json"</span>, <span class="st">"file2.json"</span>],</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    use_threads<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    concat<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Read </span><span class="sc">{</span><span class="bu">len</span>(dfs)<span class="sc">}</span><span class="ss"> files"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="read_csv_file" class="level2">
<h2 class="anchored" data-anchor-id="read_csv_file"><code>read_csv_file()</code></h2>
<p>Read a single CSV file from any filesystem.</p>
<p>Internal function that handles reading individual CSV files and optionally adds the source filepath as a column.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>self</code></td>
<td style="text-align: left;"><code>AbstractFileSystem</code></td>
<td style="text-align: left;">Filesystem instance to use for reading</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to CSV file</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize DataFrame dtypes</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pl.read_csv()</code></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pl.DataFrame</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code></td>
<td style="text-align: left;">DataFrame containing CSV data</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This example assumes _read_csv_file is an internal method or needs to be called differently.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For public use, you would typically use fs.read_csv().</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># df = fs.read_csv_file(</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     "data.csv",</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     include_file_path=True,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     delimiter="|"</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print("file_path" in df.columns)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="read_csv" class="level2">
<h2 class="anchored" data-anchor-id="read_csv"><code>read_csv()</code></h2>
<p>Read CSV data from one or more files with powerful options.</p>
<p>Provides a flexible interface for reading CSV files with support for:</p>
<ul>
<li>Single file or multiple files</li>
<li>Batch processing for large datasets</li>
<li>Parallel processing</li>
<li>File path tracking</li>
<li>Polars DataFrame output</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path(s) to CSV file(s). Can be: - Single path string (globs supported) - List of path strings</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>batch_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">If set, enables batch reading with this many files per batch</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Combine multiple files/batches into single DataFrame</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Enable parallel file reading</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Print progress information</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pl.read_csv()</code></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>list[pl.DataFrame]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on arguments: - <code>pl.DataFrame</code>: Single or concatenated DataFrame - <code>list[pl.DataFrame]</code>: List of DataFrames (if <code>concat=False</code>) - <code>Generator</code>: If <code>batch_size</code> set, yields batches of above types</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read all CSVs in directory</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> fs.read_csv(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/*.csv"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    include_file_path<span class="op">=</span><span class="va">True</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ['file_path', 'col1', 'col2', ...]</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Batch process large dataset</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch_df <span class="kw">in</span> fs.read_csv(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logs/*.csv"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    use_threads<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">True</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Processing </span><span class="sc">{</span><span class="bu">len</span>(batch_df)<span class="sc">}</span><span class="ss"> rows"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple files without concatenation</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> fs.read_csv(</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"file1.csv"</span>, <span class="st">"file2.csv"</span>],</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    concat<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    use_threads<span class="op">=</span><span class="va">True</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Read </span><span class="sc">{</span><span class="bu">len</span>(dfs)<span class="sc">}</span><span class="ss"> files"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="read_parquet_file" class="level2">
<h2 class="anchored" data-anchor-id="read_parquet_file"><code>read_parquet_file()</code></h2>
<p>Read a single Parquet file from any filesystem.</p>
<p>Internal function that handles reading individual Parquet files and optionally adds the source filepath as a column.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>self</code></td>
<td style="text-align: left;"><code>AbstractFileSystem</code></td>
<td style="text-align: left;">Filesystem instance to use for reading</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to Parquet file</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize DataFrame dtypes</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pq.read_table()</code></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pa.Table</code></td>
<td style="text-align: left;"><code>pa.Table</code></td>
<td style="text-align: left;">PyArrow Table containing Parquet data</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This example assumes _read_parquet_file is an internal method or needs to be called differently.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For public use, you would typically use fs.read_parquet().</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># table = fs.read_parquet_file(</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     "data.parquet",</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     include_file_path=True,</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     use_threads=True</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print("file_path" in table.column_names)</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="read_parquet" class="level2">
<h2 class="anchored" data-anchor-id="read_parquet"><code>read_parquet()</code></h2>
<p>Read Parquet data with advanced features and optimizations.</p>
<p>Provides a high-performance interface for reading Parquet files with support for:</p>
<ul>
<li>Single file or multiple files</li>
<li>Batch processing for large datasets</li>
<li>Parallel processing</li>
<li>File path tracking</li>
<li>Automatic concatenation</li>
<li>PyArrow Table output</li>
</ul>
<p>The function automatically uses optimal reading strategies:</p>
<ul>
<li>Direct dataset reading for simple cases</li>
<li>Parallel processing for multiple files</li>
<li>Batched reading for memory efficiency</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Pth(s) to Parquet file(s). Can be: - Single path string (globs supported) - List of path strings - Directory containing _metadata file</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>batch_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">If set, enables batch reading with this many files per batch</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>include_file_path</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Add source filepath as a column</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Combine multiple files/batches into single Table</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Enable parallel file reading</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Print progress information</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>opt_dtypes</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Optimize Table dtypes for performance</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments passed to <code>pq.read_table()</code></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pa.Table</code> or <code>list[pa.Table]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on arguments: - <code>pa.Table</code>: Single or concatenated Table - <code>list[pa.Table]</code>: List of Tables (if <code>concat=False</code>) - <code>Generator</code>: If <code>batch_size</code> set, yields batches of above types</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read all Parquet files in directory</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> fs.read_parquet(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/*.parquet"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    include_file_path<span class="op">=</span><span class="va">True</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table.column_names)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ['file_path', 'col1', 'col2', ...]</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Batch process large dataset</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch <span class="kw">in</span> fs.read_parquet(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/*.parquet"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    use_threads<span class="op">=</span><span class="va">True</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Processing </span><span class="sc">{</span>batch<span class="sc">.</span>num_rows<span class="sc">}</span><span class="ss"> rows"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Read from directory with metadata</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> fs.read_parquet(</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/"</span>,  <span class="co"># Contains _metadata</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    use_threads<span class="op">=</span><span class="va">True</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total rows: </span><span class="sc">{</span>table<span class="sc">.</span>num_rows<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="read_files" class="level2">
<h2 class="anchored" data-anchor-id="read_files"><code>read_files()</code></h2>
<p>Universal interface for reading data files of any supported format.</p>
<p>A unified API that automatically delegates to the appropriate reading function based on file format, while preserving all advanced features like:</p>
<ul>
<li>Batch processing</li>
<li>Parallel reading</li>
<li>File path tracking</li>
<li>Format-specific optimizations</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path(s) to data file(s). Can be: - Single path string (globs supported) - List of path strings</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;">str<code>| File format to read. Supported values: - "json": Regular JSON or JSON Lines - "csv": CSV files - "parquet": Parquet files | |</code>batch_size<code>|</code>int</td>
<td style="text-align: left;">None<code>| If set, enables batch reading with this many files per batch | |</code>include_file_path<code>|</code>bool<code>| Add source filepath as column/field | |</code>concat<code>|</code>bool<code>| Combine multiple files/batches into single result | |</code>jsonlines<code>|</code>bool<code>| For JSON format, whether to read as JSON Lines | |</code>use_threads<code>|</code>bool<code>| Enable parallel file reading | |</code>verbose<code>|</code>bool<code>| Print progress information | |</code>opt_dtypes<code>|</code>bool<code>| Optimize DataFrame/Arrow Table dtypes for performance | |</code>**kwargs<code>|</code>Any`</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pa.Table</code> or <code>list[pl.DataFrame]</code> or <code>list[pa.Table]</code> or <code>Generator</code></td>
<td style="text-align: left;">Various types depending on format and arguments: - <code>pl.DataFrame</code>: For CSV and optionally JSON - <code>pa.Table</code>: For Parquet - <code>list[pl.DataFrame</code> or <code>pa.Table]</code>: Without concatenation - <code>Generator</code>: If <code>batch_size</code> set, yields batches</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read CSV files</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> fs.read_files(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/*.csv"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"csv"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    include_file_path<span class="op">=</span><span class="va">True</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(df))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;class 'polars.DataFrame'&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Batch process Parquet files</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch <span class="kw">in</span> fs.read_files(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/*.parquet"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"parquet"</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    use_threads<span class="op">=</span><span class="va">True</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Batch type: </span><span class="sc">{</span><span class="bu">type</span>(batch)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Read JSON Lines</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> fs.read_files(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logs/*.jsonl"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"json"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    jsonlines<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    concat<span class="op">=</span><span class="va">True</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="pyarrow_dataset" class="level2">
<h2 class="anchored" data-anchor-id="pyarrow_dataset"><code>pyarrow_dataset()</code></h2>
<p>Create a PyArrow dataset from files in any supported format.</p>
<p>Creates a dataset that provides optimized reading and querying capabilities including:</p>
<ul>
<li>Schema inference and enforcement</li>
<li>Partition discovery and pruning</li>
<li>Predicate pushdown</li>
<li>Column projection</li>
<li><table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Base path to dataset files</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">File format. Currently supports: - “parquet” (default) - “csv” - “json” (experimental)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>schema</code></td>
<td style="text-align: left;"><code>pa.Schema | None</code></td>
<td style="text-align: left;">Optional schema to enforce. If None, inferred from data.</td>
</tr>
</tbody>
</table></li>
</ul>
<div class="line-block"><code>partitioning</code> | <code>str</code> or <code>list[str]</code> or <code>pds.Partitioning</code> | How the dataset is partitoned. Can be: - <code>str</code>: Single partition field - <code>list[str]</code>: Multiple partition fields - <code>pds.Partitioning</code>: Custom partitioning scheme |<br>
<code>**kwargs</code> | <code>Any</code> | Additional arguments for dataset creation |<br>
Returns | Type | Description |<br>
:—— | :— | :———- |</div>
<div class="line-block"><code>pds.Dataset</code> | <code>pds.Dataset</code> | PyArrow dataset instance |</div>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple Parquet dataset</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> fs.pyarrow_dataset(<span class="st">"data/"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ds.schema)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Partitioned dataset</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> fs.pyarrow_dataset(</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"events/"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    partitioning<span class="op">=</span>[<span class="st">"year"</span>, <span class="st">"month"</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Query with partition pruning</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> ds.to_table(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">filter</span><span class="op">=</span>(ds.field(<span class="st">"year"</span>) <span class="op">==</span> <span class="dv">2024</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV with schema</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> fs.pyarrow_dataset(</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"logs/"</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span><span class="st">"csv"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    schema<span class="op">=</span>pa.schema([</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"timestamp"</span>, pa.timestamp(<span class="st">"s"</span>)),</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"level"</span>, pa.string()),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"message"</span>, pa.string())</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="pyarrow_parquet_dataset" class="level2">
<h2 class="anchored" data-anchor-id="pyarrow_parquet_dataset"><code>pyarrow_parquet_dataset()</code></h2>
<p>Create a PyArrow dataset optimized for Parquet files.</p>
<p>Creates a dataset specifically for Parquet data, automatically handling <code>_metadata</code> files for optimized reading.</p>
<p>This function is particularly useful for:</p>
<ul>
<li>Datasets with existing <code>_metadata</code> files</li>
<li>Multi-file datasets that should be treated as one</li>
<li>Partitioned Parquet datasets</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to dataset directory or <code>_metadata</code> file</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>schema</code></td>
<td style="text-align: left;"><code>pa.Schema | None</code></td>
<td style="text-align: left;">Optional schema to enforce. If None, inferred from data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>partitioning</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>pds.Partitioning</code></td>
<td style="text-align: left;">How the dataset is partitoned. Can be: - <code>str</code>: Single partition field - <code>list[str]</code>: Multiple partition fields - <code>pds.Partitioning</code>: Custom partitioning scheme</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional dataset arguments</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pds.Dataset</code></td>
<td style="text-align: left;"><code>pds.Dataset</code></td>
<td style="text-align: left;">PyArrow dataset instance</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset with _metadata</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> fs.pyarrow_parquet_dataset(<span class="st">"data/_metadata"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ds.files)  <span class="co"># Shows all data files</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Partitioned dataset directory</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> fs.pyarrow_parquet_dataset(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sales/"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    partitioning<span class="op">=</span>[<span class="st">"year"</span>, <span class="st">"region"</span>]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Query with partition pruning</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> ds.to_table(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">filter</span><span class="op">=</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        (ds.field(<span class="st">"year"</span>) <span class="op">==</span> <span class="dv">2024</span>) <span class="op">&amp;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        (ds.field(<span class="st">"region"</span>) <span class="op">==</span> <span class="st">"EMEA"</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="pydala_dataset" class="level2">
<h2 class="anchored" data-anchor-id="pydala_dataset"><code>pydala_dataset()</code></h2>
<p>Create a Pydala dataset for advanced Parquet operations.</p>
<p>Creates a dataset with additional features beyond PyArrow including:</p>
<ul>
<li>Delta table support</li>
<li>Schema evolution</li>
<li>Advanced partitioning</li>
<li>Metadata management</li>
<li>Sort key optimization</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to dataset directory</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>partitioning</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>pds.Partitioning</code></td>
<td style="text-align: left;">How the dataset is partitoned. Can be: - <code>str</code>: Single partition field - <code>list[str]</code>: Multiple partition fields - <code>pds.Partitioning</code>: Custom partitioning scheme</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional dataset configuration</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ParquetDataset</code></td>
<td style="text-align: left;"><code>ParquetDataset</code></td>
<td style="text-align: left;">Pydala dataset instance</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> fs.pydala_dataset(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data/"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    partitioning<span class="op">=</span>[<span class="st">"date"</span>]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Write with delta support</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>ds.write_to_dataset(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    new_data,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">"delta"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    delta_subset<span class="op">=</span>[<span class="st">"id"</span>]</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Read with metadata</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ds.to_polars()</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="write_parquet" class="level2">
<h2 class="anchored" data-anchor-id="write_parquet"><code>write_parquet()</code></h2>
<p>Write data to a Parquet file with automatic format conversion.</p>
<p>Handles writing data from multiple input formats to Parquet with:</p>
<ul>
<li>Automatic conversion to PyArrow</li>
<li>Schema validation/coercion</li>
<li>Metadata collection</li>
<li>Compression and encoding options</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pl.LazyFrame</code> or <code>pa.Table</code> or <code>pd.DataFrame</code> or <code>dict</code> o <code>list[dict]</code></td>
<td style="text-align: left;">Input data in various formats: - Polars DataFrame/LazyFrame - PyArrow Table - Pandas DataFrame - Dict or list of dicts</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Output Parquet file path</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>schema</code></td>
<td style="text-align: left;"><code>pa.Schema | None</code></td>
<td style="text-align: left;">Optional schema to enforce on write</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments for <code>pq.write_table()</code></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pq.FileMetaData</code></td>
<td style="text-align: left;"><code>pq.FileMetaData</code></td>
<td style="text-align: left;">Metadata of written Parquet file</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Raises</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>SchemaError</code></td>
<td style="text-align: left;"><code>SchemaError</code></td>
<td style="text-align: left;">If data doesn’t match schema</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ValueError</code></td>
<td style="text-align: left;"><code>ValueError</code></td>
<td style="text-align: left;">If data cannot be converted</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow <span class="im">as</span> pa</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Write Polars DataFrame</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.DataFrame({</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>: <span class="bu">range</span>(<span class="dv">1000</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"value"</span>: pl.Series(np.random.randn(<span class="dv">1000</span>))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>metadata <span class="op">=</span> fs.write_parquet(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data.parquet"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    compression<span class="op">=</span><span class="st">"zstd"</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    compression_level<span class="op">=</span><span class="dv">3</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Rows: </span><span class="sc">{</span>metadata<span class="sc">.</span>num_rows<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Write with schema</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>schema <span class="op">=</span> pa.schema([</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"id"</span>, pa.int64()),</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"value"</span>, pa.float64())</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>metadata <span class="op">=</span> fs.write_parquet(</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"id"</span>: [<span class="dv">1</span>, <span class="dv">2</span>], <span class="st">"value"</span>: [<span class="fl">0.1</span>, <span class="fl">0.2</span>]},</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data.parquet"</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    schema<span class="op">=</span>schema</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="write_json" class="level2">
<h2 class="anchored" data-anchor-id="write_json"><code>write_json()</code></h2>
<p>Write data to a JSON file with flexible input support.</p>
<p>Handles writing data in various formats to JSON or JSON Lines, with optional appending for streaming writes.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>dict</code> or <code>pl.DataFrame</code> or <code>pl.LazyFrame</code> or <code>pa.Table</code> or <code>pd.DataFrame</code> or <code>dict</code> or <code>list[dict]</code></td>
<td style="text-align: left;">Input data in various formats: - Dict or list of dicts - Polars DataFrame/LazyFrame - PyArrow Table - Pandas DataFrame</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Output JSON file path</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>append</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to append to existing file (JSON Lines mode)</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow <span class="im">as</span> pa</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Write dictionary</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">"name"</span>: <span class="st">"test"</span>, <span class="st">"values"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]}</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>fs.write_json(data, <span class="st">"config.json"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Stream records</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pl.DataFrame({<span class="st">"id"</span>: [<span class="dv">1</span>], <span class="st">"value"</span>: [<span class="st">"first"</span>]})</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pl.DataFrame({<span class="st">"id"</span>: [<span class="dv">2</span>], <span class="st">"value"</span>: [<span class="st">"second"</span>]})</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>fs.write_json(df1, <span class="st">"stream.jsonl"</span>, append<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>fs.write_json(df2, <span class="st">"stream.jsonl"</span>, append<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert PyArrow</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> pa.table({<span class="st">"a"</span>: [<span class="dv">1</span>, <span class="dv">2</span>], <span class="st">"b"</span>: [<span class="st">"x"</span>, <span class="st">"y"</span>]})</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>fs.write_json(table, <span class="st">"data.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="write_csv" class="level2">
<h2 class="anchored" data-anchor-id="write_csv"><code>write_csv()</code></h2>
<p>Write data to a CSV file with flexible input support.</p>
<p>Handles writing data from multiple formats to CSV with options for:</p>
<ul>
<li>Appending to existing files</li>
<li>Custom delimiters and formatting</li>
<li>Automatic type conversion</li>
<li>Header handling</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pl.LazyFrame</code> or <code>pa.Table</code> or <code>pd.DataFrame</code> or <code>dict</code> or <code>list[dict]</code></td>
<td style="text-align: left;">Input data in various formats: - Polars DataFrame/LazyFrame - PyArrow Table - Pandas DataFrame - Dict or list of dicts</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Output CSV file path</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>append</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">Whether to append to existing file</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional arguments for CSV writing: - <code>delimiter</code>: Field separator (default “,”) - <code>header</code>: Whether to write header row - <code>quote_char</code>: Character for quoting fields - <code>date_format</code>: Format for date/time fields - <code>float_precision</code>: Decimal places for floats</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fsspec.implementations.local <span class="im">import</span> LocalFileSystem</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyarrow <span class="im">as</span> pa</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>fs <span class="op">=</span> LocalFileSystem()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Write Polars DataFrame</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.DataFrame({</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>: <span class="bu">range</span>(<span class="dv">100</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"name"</span>: [<span class="st">"item_"</span> <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>fs.write_csv(df, <span class="st">"items.csv"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Append records</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>new_items <span class="op">=</span> pl.DataFrame({</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>: <span class="bu">range</span>(<span class="dv">100</span>, <span class="dv">200</span>),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"name"</span>: [<span class="st">"item_"</span> <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>, <span class="dv">200</span>)]</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>fs.write_csv(</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    new_items,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"items.csv"</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    append<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    header<span class="op">=</span><span class="va">False</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom formatting</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pa.table({</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date"</span>: [datetime.now()],</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"value"</span>: [<span class="fl">123.456</span>]</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>fs.write_csv(</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"formatted.csv"</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    date_format<span class="op">=</span><span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    float_precision<span class="op">=</span><span class="dv">2</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="write_file" class="level2">
<h2 class="anchored" data-anchor-id="write_file"><code>write_file()</code></h2>
<p>Write a DataFrame to a file in the given format.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pl.LazyFrame</code> or <code>pa.Table</code> or <code>pd.DataFrame</code> or <code>dict</code></td>
<td style="text-align: left;">Data to write.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to write the data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Format of the file.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional keyword arguments.</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>None</code></td>
<td style="text-align: left;"><code>None</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="write_files" class="level2">
<h2 class="anchored" data-anchor-id="write_files"><code>write_files()</code></h2>
<p>Write a DataFrame or a list of DataFrames to a file or a list of files.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pl.LazyFrame</code> or <code>pa.Table</code> or <code>pa.RecordBatch</code> or <code>pa.RecordBatchReader</code> or <code>pd.DataFrame</code> or <code>dict</code> or <code>list[pl.DataFrame</code> or <code>pl.LazyFrame</code> or <code>pa.Table</code> or <code>pa.RecordBatch</code> or <code>pa.RecordBatchReader</code> or <code>pd.DataFrame</code> or <code>dict]</code></td>
<td style="text-align: left;">Data to write.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">Path to write the data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>basename</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Basename of the files. Defaults to None.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Format of the data. Defaults to None.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">If True, concatenate the DataFrames. Defaults to True.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>unique</code></td>
<td style="text-align: left;"><code>bool</code> or <code>list[str]</code> or <code>str</code></td>
<td style="text-align: left;">If True, remove duplicates. Defaults to False.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mode</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Write mode. Defaults to ‘append’. Options: ‘append’, ‘overwrite’, ‘delete_matching’, ‘error_if_exists’.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>use_threads</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">If True, use parallel processing. Defaults to True.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">If True, print verbose output Defaults to True.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional keyword arguments.</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>None</code></td>
<td style="text-align: left;"><code>None</code></td>
<td></td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 19%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Raises</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>FileExistsError</code></td>
<td style="text-align: left;"><code>FileExistsError</code></td>
<td style="text-align: left;">If file already exists and mode is ‘error_if_exists’.</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="write_pyarrow_dataset" class="level2">
<h2 class="anchored" data-anchor-id="write_pyarrow_dataset"><code>write_pyarrow_dataset()</code></h2>
<p>Write a tabular data to a PyArrow dataset.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pa.Table</code> or <code>pa.RecordBatch</code> or <code>pa.RecordBatchReader</code> or <code>pd.DataFrame</code> or <code>list[pl.DataFrame]</code> or <code>list[pa.Table]</code> or <code>list[pa.RecordBatch]</code> or <code>list[pa.RecordBatchReader]</code> or <code>list[pd.DataFrame]</code></td>
<td style="text-align: left;">Data to write.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to write the data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>basename</code></td>
<td style="text-align: left;"><code>str | None</code></td>
<td style="text-align: left;">Basename of the files. Defaults to None.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>schema</code></td>
<td style="text-align: left;"><code>pa.Schema | None</code></td>
<td style="text-align: left;">Schema of the data. Defaults to None.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>partition_by</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>pds.Partitioning</code> or <code>None</code></td>
<td style="text-align: left;">Partitioning of the data. Defaults to None.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>partitioning_flavor</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Partitioning flavor. Defaults to ‘hive’.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mode</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Write mode. Defaults to ‘append’.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>format</code></td>
<td style="text-align: left;"><code>str | None</code></td>
<td style="text-align: left;">Format of the data. Defaults to ‘parquet’.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>compression</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Compression algorithm. Defaults to ‘zstd’.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>max_rows_per_file</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">Maximum number of rows per file. Defaults to 2,500,000.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>row_group_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">Row group size. Defaults to 250,000.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>concat</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">If True, concatenate the DataFrames. Defaults to True.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>unique</code></td>
<td style="text-align: left;"><code>bool</code> or <code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">If True, remove duplicates. Deaults to False.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional keyword arguments for <code>pds.write_dataset</code>.</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 18%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>list[pq.FileMetaData]</code> or <code>None</code></td>
<td style="text-align: left;">List of Parquet file metadata or None.</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="write_pydala_dataset" class="level2">
<h2 class="anchored" data-anchor-id="write_pydala_dataset"><code>write_pydala_dataset()</code></h2>
<p>Write a tabular data to a Pydala dataset.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 16%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>pl.DataFrame</code> or <code>pa.Table</code> or <code>pa.RecordBatch</code> or <code>pa.RecordBatchReader</code> or <code>pd.DataFrame</code> or <code>list[pl.DataFrame]</code> or <code>list[pa.Table]</code> or <code>list[pa.RecordBatch]</code> or <code>list[pa.RecordBatchReader]</code> or <code>list[pd.DataFrame]</code></td>
<td style="text-align: left;">Data to write.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Path to write the data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mode</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Write mode. Defaults to ‘append’. Options: ‘delta’, ‘overwrite’.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>basename</code></td>
<td style="text-align: left;"><code>str | None</code></td>
<td style="text-align: left;">Basename of the files. Defaults to None.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>partition_by</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>None</code></td>
<td style="text-align: left;">Partitioning of the data. Defaults to None.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>partitioning_flavor</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Partitioning flavor. Defaults to ‘hive’.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>max_rows_per_file</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">Maximum number of rows per file. Defaults to 2,500,000.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>row_group_size</code></td>
<td style="text-align: left;"><code>int | None</code></td>
<td style="text-align: left;">Row group size. Defaults to 250,000.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>compression</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">Compression algorithm. Defaults to ‘zstd’.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sort_by</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>list[tuple[str, str]]</code> or <code>None</code></td>
<td style="text-align: left;">Columns to sort by. Defaults to None.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>unique</code></td>
<td style="text-align: left;"><code>bool</code> or <code>str</code> or <code>list[str]</code></td>
<td style="text-align: left;">If True, ensure unique values. Defaults to False.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>delta_subset</code></td>
<td style="text-align: left;"><code>str</code> or <code>list[str]</code> or <code>None</code></td>
<td style="text-align: left;">Subset of columns to include in delta table. Defaults to None.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>update_metadata</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">If True, update metadata. Defaults to True.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>alter_schema</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">If True, alter schema. Defaults to False.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>timestamp_column</code></td>
<td style="text-align: left;"><code>str</code> or <code>None</code></td>
<td style="text-align: left;">Timestamp column. Defaults to None.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">If True, print verbose output. Defaults to True.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>**kwargs</code></td>
<td style="text-align: left;"><code>Any</code></td>
<td style="text-align: left;">Additional keyword arguments for <code>ParquetDataset.write_to_dataset</code>.</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Returns</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>None</code></td>
<td style="text-align: left;"><code>None</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>2025 © fsspec-utils</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>