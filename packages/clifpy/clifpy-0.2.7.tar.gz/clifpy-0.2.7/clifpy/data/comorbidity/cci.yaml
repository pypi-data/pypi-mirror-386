# Charlson Comorbidity Index (CCI) Configuration
# Based on Quan et al. adaptation for ICD-10-CM

name: "Charlson Comorbidity Index"
description: "Configuration for calculating Charlson Comorbidity Index scores from hospital diagnosis codes"
version: "quan"
source_of_index: 'https://github.com/ellessenne/comorbidity/blob/master/data-raw/make-mapping.R'
source_of_weight: 'https://github.com/ellessenne/comorbidity/blob/master/data-raw/make-weights.R'

# Supported diagnosis code formats
supported_formats:
  - ICD10CM

# ICD-10-CM condition mappings
# Using prefix matching - e.g., "I21" matches "I21.0", "I21.1", etc.
diagnosis_code_mappings:
  ICD10CM:
    myocardial_infarction:
      codes: ["I21", "I22", "I252"]
      description: "History of definite or probable myocardial infarction"

    congestive_heart_failure:
      codes: ["I099", "I110", "I130", "I132", "I255", "I420", "I425", "I426", "I427", "I428", "I429", "I43", "I50", "P290"]
      description: "Congestive heart failure, left heart failure, cardiac complications"

    peripheral_vascular_disease:
      codes: ["I70", "I71", "I731", "I738", "I739", "I771", "I790", "I792", "K551", "K558", "K559", "Z958", "Z959"]
      description: "Peripheral vascular disease, arterial insufficiency, vascular prosthetics"

    cerebrovascular_disease:
      codes: ["G45", "G46", "H340", "I60", "I61", "I62", "I63", "I64", "I65", "I66", "I67", "I68", "I69"]
      description: "Cerebrovascular disease, stroke, TIA"

    dementia:
      codes: ["F00", "F01", "F02", "F03", "F051", "G30", "G311"]
      description: "Dementia, Alzheimer's disease, cognitive impairment"

    chronic_pulmonary_disease:
      codes: ["I278", "I279", "J40", "J41", "J42", "J43", "J44", "J45", "J46", "J47", "J60", "J61", "J62", "J63", "J64", "J65", "J66", "J67", "J684", "J701", "J703"]
      description: "Chronic obstructive pulmonary disease, asthma, pneumoconiosis"

    connective_tissue_disease:
      codes: ["M05", "M06", "M315", "M32", "M33", "M34", "M351", "M353", "M360"]
      description: "Rheumatoid arthritis, lupus, scleroderma, polymyositis"

    peptic_ulcer_disease:
      codes: ["K25", "K26", "K27", "K28"]
      description: "Peptic ulcer disease"

    mild_liver_disease:
      codes: ["B18", "K700", "K701", "K702", "K703", "K709", "K713", "K714", "K715", "K717", "K73", "K74", "K760", "K762", "K763", "K764", "K768", "K769", "Z944"]
      description: "Chronic hepatitis, mild liver disease without portal hypertension"

    diabetes_uncomplicated:
      codes: ["E100", "E101", "E106", "E108", "E109", "E110", "E111", "E116", "E118", "E119", "E120", "E121", "E126", "E128", "E129", "E130", "E131", "E136", "E138", "E139", "E140", "E141", "E146", "E148", "E149"]
      description: "Diabetes mellitus without complications"

    diabetes_with_complications:
      codes: ["E102", "E103", "E104", "E105", "E107", "E112", "E113", "E114", "E115", "E117", "E122", "E123", "E124", "E125", "E127", "E132", "E133", "E134", "E135", "E137", "E142", "E143", "E144", "E145", "E147"]
      description: "Diabetes mellitus with end-organ damage"

    hemiplegia:
      codes: ["G041", "G114", "G801", "G802", "G81", "G82", "G830", "G831", "G832", "G833", "G834", "G839"]
      description: "Hemiplegia, paraplegia, paralysis"

    renal_disease:
      codes: ["I120", "I131", "N032", "N033", "N034", "N035", "N036", "N037", "N052", "N053", "N054", "N055", "N056", "N057", "N18", "N19", "N250", "Z490", "Z491", "Z492", "Z940", "Z992"]
      description: "Moderate to severe chronic kidney disease, dialysis, transplant"

    cancer:
      codes: ["C00", "C01", "C02", "C03", "C04", "C05", "C06", "C07", "C08", "C09", "C10", "C11", "C12", "C13", "C14", "C15", "C16", "C17", "C18", "C19", "C20", "C21", "C22", "C23", "C24", "C25", "C26", "C30", "C31", "C32", "C33", "C34", "C37", "C38", "C39", "C40", "C41", "C43", "C45", "C46", "C47", "C48", "C49", "C50", "C51", "C52", "C53", "C54", "C55", "C56", "C57", "C58", "C60", "C61", "C62", "C63", "C64", "C65", "C66", "C67", "C68", "C69", "C70", "C71", "C72", "C73", "C74", "C75", "C76", "C81", "C82", "C83", "C84", "C85", "C88", "C90", "C91", "C92", "C93", "C94", "C95", "C96", "C97"]
      description: "Localized solid tumor, leukemia, lymphoma"

    moderate_severe_liver_disease:
      codes: ["I850", "I859", "I864", "I982", "K704", "K711", "K721", "K729", "K765", "K766", "K767"]
      description: "Moderate to severe liver disease with portal hypertension"

    metastatic_solid_tumor:
      codes: ["C77", "C78", "C79", "C80"]
      description: "Metastatic solid tumor"

    aids:
      codes: ["B20", "B21", "B22", "B24"]
      description: "Acquired immunodeficiency syndrome"

# Charlson Comorbidity Index weights (Quan 2011)
# Note: Some conditions have weight 0 because they are superseded by their severe counterparts in the hierarchy
weights:
  myocardial_infarction: 0
  congestive_heart_failure: 2
  peripheral_vascular_disease: 0
  cerebrovascular_disease: 0
  dementia: 2
  chronic_pulmonary_disease: 1
  connective_tissue_disease: 1
  peptic_ulcer_disease: 0
  mild_liver_disease: 2
  diabetes_uncomplicated: 0
  diabetes_with_complications: 1
  hemiplegia: 2
  renal_disease: 1
  cancer: 2
  moderate_severe_liver_disease: 4
  metastatic_solid_tumor: 6
  aids: 4

# Condition hierarchies - higher priority conditions override lower ones
# Used when assign0 = TRUE to avoid double counting
hierarchies:
  diabetes:
    - diabetes_with_complications  # Takes precedence (weight: 1)
    - diabetes_uncomplicated       # Assigned 0 if complications present
  liver_disease:
    - moderate_severe_liver_disease  # Takes precedence (weight: 4)
    - mild_liver_disease             # Assigned 0 if moderate/severe present
  cancer:
    - metastatic_solid_tumor  # Takes precedence (weight: 6)
    - cancer                  # Assigned 0 if metastatic present

# assign0 configuration
# Based on Quan et al. (2011) methodology
assign0:
  description: |
    When true, applies a hierarchy of comorbidities: if a comorbidity is present
    with different degrees of severity, the milder form will be assigned a value
    of 0 when calculating the score. This ensures a type of comorbidity is not
    counted more than once in each patient.
  default: true
  affected_conditions:
    - description: "Mild liver disease (weight: 2) superseded by Moderate/severe liver disease (weight: 4)"
    - description: "Diabetes uncomplicated (weight: 0) superseded by Diabetes with complications (weight: 1)"
    - description: "Cancer (weight: 2) superseded by Metastatic solid tumor (weight: 6)"