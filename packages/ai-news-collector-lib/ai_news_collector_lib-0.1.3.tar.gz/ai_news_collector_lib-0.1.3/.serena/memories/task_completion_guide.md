# 任务完成检查清单

当完成一个任务或特性开发时，按以下清单逐一检查：

## 代码质量检查

### 代码格式
- [ ] 运行 `black ai_news_collector_lib/` 格式化代码
- [ ] 代码行长度不超过 88 个字符
- [ ] 缩进使用 4 个空格

### 代码检查
- [ ] 运行 `flake8 ai_news_collector_lib/` 通过
- [ ] 没有 import 错误或未使用的导入
- [ ] 没有多余的空行或尾部空格

### 类型检查
- [ ] 所有函数都有完整的类型提示
- [ ] 所有返回值都有类型注解
- [ ] 复杂的类型使用 `typing` 模块中的工具
- [ ] 运行 `mypy ai_news_collector_lib/ --strict` 通过（可选）

### 文档
- [ ] 新的类/函数都有文档字符串
- [ ] 文档字符串使用 Google 风格
- [ ] 文档包括 Args、Returns、Raises 部分
- [ ] 复杂逻辑有清晰的代码注释

## 功能实现检查

### 功能完整性
- [ ] 功能按需求实现
- [ ] 处理了所有边界情况
- [ ] 提供了有意义的错误消息

### 代码模块化
- [ ] 遵循单一职责原则
- [ ] 功能被适当地分解成小函数/方法
- [ ] 避免重复代码
- [ ] 代码易于理解和维护

## 测试检查

### 单元测试
- [ ] 为新代码编写了单元测试
- [ ] 所有新的测试通过
- [ ] 测试覆盖了主要路径和边界情况
- [ ] 使用 mock 隔离外部依赖
- [ ] 异步测试使用 `@pytest.mark.asyncio`

### 集成测试（如果适用）
- [ ] 编写了必要的集成测试
- [ ] 集成测试通过
- [ ] 测试包括真实场景

### 测试覆盖率
- [ ] 运行 `pytest --cov=ai_news_collector_lib -v`
- [ ] 新代码的覆盖率至少 80%
- [ ] 没有显著的覆盖率下降

### 运行所有测试
- [ ] 运行 `pytest -v` - 所有测试通过
- [ ] 运行 `pytest -m "not integration" -v` - 单元测试通过
- [ ] 运行 `pytest -m integration -v`（如果有集成测试）

## 依赖和配置检查

### 依赖管理
- [ ] 任何新的外部依赖都已添加到 `pyproject.toml`
- [ ] 依赖版本合理且兼容
- [ ] 可选依赖正确标记为可选
- [ ] 没有冗余的依赖

### 配置文件
- [ ] 如果添加了新的配置选项，已在相关配置类中添加
- [ ] 默认值合理
- [ ] 配置有文档说明

### 环境变量
- [ ] 任何新的环境变量都已在 `env.example` 中记录
- [ ] 代码正确处理缺失的环境变量

## 向后兼容性检查

- [ ] 现有 API 没有破坏性变更
- [ ] 如果必须改变 API，确保了平滑的迁移路径
- [ ] 现有测试都通过（包括旧的测试）

## 文档检查

### 代码文档
- [ ] 文档字符串清晰准确
- [ ] 示例代码正确（如果有的话）
- [ ] 类型提示清晰

### 项目文档
- [ ] 如果添加了新功能，更新了相关文档
- [ ] 更新了 `ARCHITECTURE.md` 中的架构说明（如果改变了架构）
- [ ] 如果这是新功能，添加了使用示例

### CHANGELOG
- [ ] 在相关的文档中记录了变更
- [ ] 变更描述清晰、准确

## Git 提交检查

### 提交消息
- [ ] 提交消息清晰描述了变更
- [ ] 使用了合适的提交类型前缀（feat:, fix:, docs:, test:, style:, refactor:, perf:, chore:）
- [ ] 提交消息采用命令式语气

### 提交历史
- [ ] 提交被合理地分解成逻辑单元
- [ ] 没有混合不相关的变更
- [ ] 历史清晰易于追踪

## 性能检查（如果适用）

- [ ] 新代码没有显著的性能下降
- [ ] 异步操作使用了正确的并发模式
- [ ] 避免了不必要的数据复制
- [ ] 资源（网络连接、文件句柄等）被正确管理

## 安全检查

- [ ] 没有硬编码的密钥或敏感信息
- [ ] 输入验证充分
- [ ] 外部输入被安全处理
- [ ] 依赖没有已知的安全漏洞

## 可访问性检查

- [ ] 代码对所有技能水平的开发者都容易理解
- [ ] 命名清晰且一致
- [ ] 避免了过度的聪明代码

## 最终检查

### 完整性
- [ ] 完成了所有计划的工作
- [ ] 没有遗漏的 TODO 或 FIXME 注释
- [ ] 不应该遗留调试代码或注释掉的代码

### 可用性
- [ ] 代码可以被团队中的其他成员理解和使用
- [ ] 提供了足够的上下文（通过提交消息、代码注释等）

### 验证
- [ ] 本地测试通过
- [ ] 变更已通过 CI/CD（如果有）
- [ ] 没有遗漏的 edge cases

## 最后步骤

1. [ ] 推送分支：`git push origin feature/your-branch-name`
2. [ ] 创建 Pull Request
3. [ ] 在 PR 中提供清晰的描述
4. [ ] 等待代码审查和 CI 结果
5. [ ] 根据反馈进行必要的调整

## 快速检查脚本

将以下内容保存为 `pre-commit.sh` 并在提交前运行：

```bash
#!/bin/bash

echo "🔍 Running code quality checks..."

# 格式化
echo "📝 Formatting with black..."
black ai_news_collector_lib/ || exit 1

# Flake8 检查
echo "🔎 Checking with flake8..."
flake8 ai_news_collector_lib/ || exit 1

# 运行测试
echo "🧪 Running tests..."
pytest -m "not integration" -q || exit 1

echo "✅ All checks passed!"
```

使用：
```bash
chmod +x pre-commit.sh
./pre-commit.sh
```
