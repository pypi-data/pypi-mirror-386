{# def d #}
{# issue in Jinja while setting a variable inside of the loop. namespace solves the issue #}
{% set ns = namespace(language_found=False) %}  
{% for item in as_array(d) %}
    {% if value(item.lang) == current_i18n.language %}
        {% set ns.language_found = True %}  
    {% endif %}
{% endfor %}

<div class="ui multilingual-tabs">
    <div class="ui compact text menu separated">
        {% for item in as_array(d) %}
            <a class="green item 
                {{ 'active' if (value(item.lang) == current_i18n.language and ns.language_found) or 
                                (loop.first and not ns.language_found) else '' }}" 
                data-tab="{{ value(item.value) }}-{{ value(item.lang)|e }}">
                {{ ui_value(item.lang)|upper }}
            </a>
            {% if not loop.last %}
            <div class="ui separated"><div class="single separator"></div></div>
            {% endif %}
        {% endfor %}
    </div>
    
    {% for item in as_array(d) %}
    <div class="ui tab 
        {{ 'active' if (value(item.lang) == current_i18n.language and ns.language_found) or 
                        (loop.first and not ns.language_found) else '' }}" 
        data-tab="{{ value(item.value) }}-{{ value(item.lang)|e }}">
        {{ ui_value(item.value)|safe }}
    </div>
    {% endfor %}
</div>
