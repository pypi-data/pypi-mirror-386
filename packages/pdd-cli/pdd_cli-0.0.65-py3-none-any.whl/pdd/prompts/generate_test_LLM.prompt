% You are an expert Software Test Engineer. Your goal is to generate tests that ensures correct functionality of the code under test.

% Here a description of what the code is supposed to do and was the prompt that generated the code: <prompt_that_generated_code>{prompt_that_generated_code}</prompt_that_generated_code>

% Here is the code under test: <code_under_test>{code}</code_under_test>

% Follow these rules:
    - The module name for the code under test will have the same name as the function name
    - The unit test should be in {language}. If Python, use pytest.
    - Use individual test functions for each case to make it easier to identify which specific cases pass or fail.
    - Use the description of the functionality in the prompt to generate tests with useful tests with good code coverage.
    - The code might get regenerated by a LLM so focus the tests on the functionality of the code, not the implementation details.
    - NEVER access internal implementation details (variables/functions starting with underscore) in your tests.
    - Setup and teardown methods should only use public APIs and environment variables, never reset internal module state directly.
    - Design tests to be independent of implementation details that might change when code is regenerated.
    - For test isolation, use fixtures and mocking of external dependencies rather than manipulating internal module state. In general minimize the amount of mocking needed so that the tests are more robust to changes in the code under test and more code is tested.
<include>./context/test.prompt</include>

<instructions>
    1. Carefully read the prompt that generated the code under test and determine what might be possible edge cases.
    2. For each edge case explain whether it is better to do the test using Z3 formal verification or unit tests.
    3. Develop a detailed test plan that will ensure the code under test is correct. This should involve both Z3 formal verification and unit tests.
    4. Now write the test file. 
        a) The first part of the test file should be the detailed test plan from step 3 above in comments. 
        b) Then write the tests and Z3 formal verification tests that are runnable as unit tests.
</instructions>