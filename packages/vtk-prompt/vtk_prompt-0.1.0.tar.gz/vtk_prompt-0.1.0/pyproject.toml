[project]
name = "vtk-prompt"
dynamic = ["version"]
description = "A project combining VTK visualization with LLM APIs (Anthropic, OpenAI, NVIDIA NIM)"
authors = [
    {name = "Vicente Adolfo Bolea Sanchez", email = "vicente.bolea@kitware.com"},
]
dependencies = [
    "chromadb>=0.6.3",
    "click>=8.0.0",
    "importlib_resources>=5.0.0",
    "llama_index-core>=0.12.17",
    "llama-index-llms-anthropic>=0.6.7",
    "llama-index-llms-openai>=0.3.20",
    "openai>=1.0.0",
    "sentence-transformers>=3.4.1",
    "tqdm>=4.67.1",
    "trame>=3.9.0",
    "trame-vtk>=2.8.0",
    "trame-vuetify>=3",
    "tree_sitter>=0.23",
    "tree_sitter_language_pack>=0.7.0",
    "tree_sitter_languages>=1.9.1",
    "vtk>=9.3.1",
]
requires-python = ">=3.10"
readme = "README.md"
license = "MIT"
keywords = ["vtk", "visualization", "llm", "ai", "anthropic", "openai"]
classifiers = [
    "Development Status :: 3 - Alpha",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Topic :: Scientific/Engineering :: Visualization",
    "Topic :: Software Development :: Code Generators",
]

[project.optional-dependencies]
dev = [
    "pre-commit",
    "ruff",
    "pytest >=6",
    "pytest-cov >=3",
    "tox",
    "black>=23.0.0",
    "isort>=5.12.0",
    "flake8>=6.0.0",
    "flake8-pyproject>=1.2.0",
    "flake8-docstrings>=1.7.0",
    "flake8-bugbear>=23.0.0",
    "flake8-comprehensions>=3.14.0",
    "mypy>=1.0.0",
    "types-requests",
    "types-click",
    "types-setuptools",
]

# Testing dependencies
test = [
    "pytest>=7.0.0",
    "pytest-cov>=4.0.0",
]

# All optional dependencies
all = [
    "vtk-prompt[dev,test]",
]

[project.urls]
Homepage = "https://github.com/vicentebolea/vtk-prompt"
Repository = "https://github.com/vicentebolea/vtk-prompt"
Issues = "https://github.com/vicentebolea/vtk-prompt/issues"

[project.scripts]
vtk-prompt = "vtk_prompt.cli:main"
gen-vtk-file = "vtk_prompt.generate_files:main"
vtk-build-rag = "vtk_prompt.build_rag_db:main"
vtk-test-rag = "vtk_prompt.test_rag:main"
vtk-prompt-ui = "vtk_prompt.vtk_prompt_ui:main"
rag-chat = "vtk_prompt.rag_chat_wrapper:main"

[build-system]
requires = ["setuptools>=61.0", "setuptools-scm>=8.0"]
build-backend = "setuptools.build_meta"

[tool.setuptools_scm]
fallback_version = "0.1.0"

[tool.setuptools.package-data]
vtk_prompt = ["prompts/*.txt"]

[tool.black]
include = 'src/.*.py$'
line-length = 100

[tool.ruff]
line-length = 100

[tool.isort]
profile = "black"
multi_line_output = 3
line_length = 100

[tool.mypy]
python_version = "3.10"
warn_return_any = false
warn_unused_configs = true
disallow_untyped_defs = false
disallow_incomplete_defs = false
exclude = [
    "rag-components/",
    "node_modules/",
    "build/",
    "dist/"
]

[[tool.mypy.overrides]]
module = [
    "vtk.*",
    "vtkmodules.*",
    "trame.*",
    "trame_vtk.*",
    "openai.*",
    "click.*",
    "chromadb.*",
    "sentence_transformers.*",
    "tree_sitter_languages.*",
    "llama_index.*",
    "query_db.*"
]
ignore_missing_imports = true

# Ignore untyped decorators for Trame UI modules
[[tool.mypy.overrides]]
module = [
    "vtk_prompt.vtk_prompt_ui",
]
disable_error_code = ["misc"]

[tool.tox]
requires = ["tox>=4.22"]
env_list = ["format", "lint", "type", "py310", "py311", "py312"]

[tool.tox.env_run_base]
deps = [".[dev]"]

[tool.tox.env.format]
description = "Format code with black and isort"
commands = [
    ["isort", "src/"],
    ["black", "src/"]
]

[tool.tox.env.format-check]
description = "Check code formatting with black and isort"
commands = [
    ["isort", "--check-only", "--diff", "src/"],
    ["black", "--check", "--diff", "src/"]
]

[tool.tox.env.lint]
description = "Lint code with flake8"
commands = [["flake8", "src/"]]

[tool.tox.env.type]
description = "Type check with mypy"
commands = [["mypy", "src/"]]

[tool.flake8]
max-line-length = 100
extend-ignore = [
    # whitespace before ':'
    "E203",
    # line break before binary operator
    "W503"
]
