suite_name: "Multihost Dispatchers Benchmark"

mesh_config:
  mesh_axes: ["data", "model"]
  ici_parallelism: {"data": 2, "model": 2}
  dcn_parallelism: {"data": 2}

checkpoint_config:
  spec:
    array: {dtype: "float32", shape: [1024, 2048], sharding: ["data", "model"]}

benchmarks:
  - generator: "orbax.checkpoint._src.testing.benchmarks.multihost_dispatchers_benchmark.MultihostDispatchersBenchmark"
    options:
      use_colocated: [True, False]
      device_count: [null, 2]
