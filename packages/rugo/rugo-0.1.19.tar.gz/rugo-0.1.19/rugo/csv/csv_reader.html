<!DOCTYPE html>
<!-- Generated by Cython 3.1.6 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: csv_reader.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.1.6</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="csv_reader.cpp">csv_reader.cpp</a></p>
<div class="cython"><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: """Cython wrapper for reading CSV/TSV files."""</pre>
<pre class='cython code score-28 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_kp_u_get_csv_schema_line_65, __pyx_mstate_global-&gt;__pyx_kp_u_Extract_schema_information_from) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_kp_u_read_csv_line_158, __pyx_mstate_global-&gt;__pyx_kp_u_Read_CSV_data_into_columnar_for) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_kp_u_detect_csv_dialect_line_325, __pyx_mstate_global-&gt;__pyx_kp_u_Auto_detect_CSV_dialect_delimit) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_kp_u_read_tsv_line_382, __pyx_mstate_global-&gt;__pyx_kp_u_Read_TSV_tab_separated_values_d) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_test, __pyx_t_2) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: # distutils: language = c++</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: # cython: language_level=3</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: # cython: nonecheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: # cython: cdivision=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: # cython: boundscheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: # cython: wraparound=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: # cython: infer_types=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: from libc.stdint cimport uint8_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: from libcpp.string cimport string</pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: from libcpp.vector cimport vector</pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: from libcpp cimport bool as cbool</pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: from cpython.buffer cimport PyBUF_CONTIG_RO, PyObject_GetBuffer, PyBuffer_Release, Py_buffer</pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: # C++ declarations from csv_parser.hpp</pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: cdef extern from "csv_parser.hpp":</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>:     cdef enum CsvType:</pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>:         Null "CsvType::Null"</pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>:         Boolean "CsvType::Boolean"</pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>:         Integer "CsvType::Integer"</pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>:         Double "CsvType::Double"</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:         String "CsvType::String"</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>:     cdef cppclass CsvColumnSchema:</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>:         string name</pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>:         CsvType type</pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:         cbool nullable</pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>:     cdef cppclass CsvColumn:</pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>:         vector[long long] int_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>:         vector[double] double_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>:         vector[string] string_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>:         vector[uint8_t] boolean_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>:         vector[uint8_t] null_mask</pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>:         string type</pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>:         cbool success</pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>:     cdef cppclass CsvTable:</pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>:         vector[CsvColumn] columns</pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>:         vector[string] column_names</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:         size_t num_rows</pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>:         cbool success</pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>:     cdef cppclass CsvDialect:</pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>:         char delimiter</pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>:         char quote_char</pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>:         char escape_char</pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>:         cbool double_quote</pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:         cbool has_header</pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>:     vector[CsvColumnSchema] GetCsvSchema(const uint8_t* data, size_t size,</pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>:                                          const CsvDialect&amp; dialect, size_t sample_size)</pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>:     CsvTable ReadCsv(const uint8_t* data, size_t size, const CsvDialect&amp; dialect)</pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>:     CsvTable ReadCsv(const uint8_t* data, size_t size, const CsvDialect&amp; dialect,</pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>:                      const vector[string]&amp; column_names)</pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>:     CsvDialect DetectCsvDialect(const uint8_t* data, size_t size, size_t sample_size)</pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: </pre>
<pre class="cython line score-80" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>: def get_csv_schema(data, delimiter=',', quote_char='"', sample_size=100, has_header=True):</pre>
<pre class='cython code score-80 '>/* Python wrapper */
static PyObject *__pyx_pw_4rugo_3csv_1get_csv_schema(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_4rugo_3csv_get_csv_schema, "\n    Extract schema information from CSV data.\n    \n    Parameters\n    ----------\n    data : bytes or memoryview\n        The CSV data to analyze\n    delimiter : str, default ','\n        Field delimiter character (use '\\t' for TSV)\n    quote_char : str, default '\"'\n        Quote character for fields\n    sample_size : int, default 100\n        Number of rows to sample for type inference\n    has_header : bool, default True\n        Whether the first line contains column names\n    \n    Returns\n    -------\n    list of dict\n        List of column schemas with keys: name, type, nullable\n        \n    Examples\n    --------\n    &gt;&gt;&gt; data = b'name,age,salary\\nAlice,30,50000\\nBob,25,45000'\n    &gt;&gt;&gt; schema = get_csv_schema(data)\n    &gt;&gt;&gt; for col in schema:\n    ...     print(f\"{col['name']}: {col['type']}\")\n    name: string\n    age: int64\n    salary: int64\n    ");
static PyMethodDef __pyx_mdef_4rugo_3csv_1get_csv_schema = {"get_csv_schema", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4rugo_3csv_1get_csv_schema, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_4rugo_3csv_get_csv_schema};
static PyObject *__pyx_pw_4rugo_3csv_1get_csv_schema(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_delimiter = 0;
  PyObject *__pyx_v_quote_char = 0;
  PyObject *__pyx_v_sample_size = 0;
  PyObject *__pyx_v_has_header = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_csv_schema (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_data,&amp;__pyx_mstate_global-&gt;__pyx_n_u_delimiter,&amp;__pyx_mstate_global-&gt;__pyx_n_u_quote_char,&amp;__pyx_mstate_global-&gt;__pyx_n_u_sample_size,&amp;__pyx_mstate_global-&gt;__pyx_n_u_has_header,0};
  PyObject* values[5] = {0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "get_csv_schema", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u_)));
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__2)));
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100)));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)Py_True)));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_csv_schema", 0, 1, 5, i); <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u_)));
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__2)));
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100)));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)Py_True)));
    }
    __pyx_v_data = values[0];
    __pyx_v_delimiter = values[1];
    __pyx_v_quote_char = values[2];
    __pyx_v_sample_size = values[3];
    __pyx_v_has_header = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_csv_schema", 0, 1, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.get_csv_schema", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4rugo_3csv_get_csv_schema(__pyx_self, __pyx_v_data, __pyx_v_delimiter, __pyx_v_quote_char, __pyx_v_sample_size, __pyx_v_has_header);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4rugo_3csv_get_csv_schema(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_delimiter, PyObject *__pyx_v_quote_char, PyObject *__pyx_v_sample_size, PyObject *__pyx_v_has_header) {
  uint8_t const *__pyx_v_data_ptr;
  size_t __pyx_v_data_size;
  PyObject *__pyx_v_data_bytes = 0;
  Py_buffer __pyx_v_view;
  bool __pyx_v_have_view;
  CsvDialect __pyx_v_dialect;
  std::vector&lt;CsvColumnSchema&gt;  __pyx_v_schema;
  PyObject *__pyx_v_result = NULL;
  size_t __pyx_v_i;
  int __pyx_v_type_val;
  PyObject *__pyx_v_type_str = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.get_csv_schema", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data_bytes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_type_str);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4rugo_3csv_1get_csv_schema, 0, __pyx_mstate_global-&gt;__pyx_n_u_get_csv_schema, NULL, __pyx_mstate_global-&gt;__pyx_n_u_rugo_csv, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_tuple[0]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_get_csv_schema, __pyx_t_2) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[0] = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u_), ((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__2), ((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100), ((PyObject*)Py_True)); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[0])) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[0]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">066</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:     Extract schema information from CSV data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>:     data : bytes or memoryview</pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:         The CSV data to analyze</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>:     delimiter : str, default ','</pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:         Field delimiter character (use '\\t' for TSV)</pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>:     quote_char : str, default '"'</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>:         Quote character for fields</pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>:     sample_size : int, default 100</pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>:         Number of rows to sample for type inference</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>:     has_header : bool, default True</pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>:         Whether the first line contains column names</pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>:     list of dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>:         List of column schemas with keys: name, type, nullable</pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:     &gt;&gt;&gt; data = b'name,age,salary\\nAlice,30,50000\\nBob,25,45000'</pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:     &gt;&gt;&gt; schema = get_csv_schema(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:     &gt;&gt;&gt; for col in schema:</pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:     ...     print(f"{col['name']}: {col['type']}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>:     name: string</pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>:     age: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>:     salary: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>:     cdef const uint8_t* data_ptr</pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>:     cdef size_t data_size</pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>:     cdef bytes data_bytes</pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>:     cdef Py_buffer view</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:     cdef cbool have_view = False</pre>
<pre class='cython code score-0 '>  __pyx_v_have_view = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>:     # Handle different input types</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:     if isinstance(data, memoryview):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = PyMemoryView_Check(__pyx_v_data); 
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">105</span>:         PyObject_GetBuffer(data.obj, &amp;view, PyBUF_CONTIG_RO)</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_mstate_global-&gt;__pyx_n_u_obj);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_t_2, (&amp;__pyx_v_view), PyBUF_CONTIG_RO);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 105, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>:         data_ptr = &lt;const uint8_t*&gt;view.buf</pre>
<pre class='cython code score-0 '>    __pyx_v_data_ptr = ((uint8_t const *)__pyx_v_view.buf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:         data_size = view.len</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_view.len;
    __pyx_v_data_size = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>:         have_view = True</pre>
<pre class='cython code score-0 '>    __pyx_v_have_view = 1;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:     elif isinstance(data, bytes):</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyBytes_Check</span>(__pyx_v_data); 
  if (likely(__pyx_t_1)) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:         data_bytes = data</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = __pyx_v_data;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("bytes", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
    __pyx_v_data_bytes = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:         data_ptr = &lt;const uint8_t*&gt;&lt;char*&gt;data_bytes</pre>
<pre class='cython code score-12 '>    if (unlikely(__pyx_v_data_bytes == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "expected bytes, NoneType found");
      <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyBytes_AsWritableString</span>(__pyx_v_data_bytes); if (unlikely((!__pyx_t_5) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
    __pyx_v_data_ptr = ((uint8_t const *)((char *)__pyx_t_5));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:         data_size = len(data_bytes)</pre>
<pre class='cython code score-7 '>    if (unlikely(__pyx_v_data_bytes == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>__PYX_ERR(0, 112, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBytes_GET_SIZE</span>(__pyx_v_data_bytes);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 112, __pyx_L1_error)</span>
    __pyx_v_data_size = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">113</span>:     else:</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:         raise TypeError(f"Expected bytes or memoryview, got {type(data)}")</pre>
<pre class='cython code score-14 '>  /*else*/ {
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_TypeError);
    __pyx_t_7 = __pyx_builtin_TypeError; 
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(((PyObject *)Py_TYPE(__pyx_v_data)), __pyx_mstate_global-&gt;__pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Expected_bytes_or_memoryview_got, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_10 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">115</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>:     # Setup dialect</pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>:     cdef CsvDialect dialect</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     dialect.delimiter = ord(delimiter[0]) if delimiter else ord(',')</pre>
<pre class='cython code score-7 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_delimiter); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
  if (__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_delimiter, 0, long, 1, __Pyx_PyLong_From_long, 0, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 118, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = __pyx_t_12;
  } else {
    __pyx_t_11 = 44;
  }
  __pyx_v_dialect.delimiter = __pyx_t_11;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:     dialect.quote_char = ord(quote_char[0]) if quote_char else ord('"')</pre>
<pre class='cython code score-7 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_quote_char); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>
  if (__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_quote_char, 0, long, 1, __Pyx_PyLong_From_long, 0, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 119, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = __pyx_t_12;
  } else {
    __pyx_t_11 = 34;
  }
  __pyx_v_dialect.quote_char = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:     dialect.escape_char = ord('\\')</pre>
<pre class='cython code score-0 '>  __pyx_v_dialect.escape_char = 92;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:     dialect.double_quote = True</pre>
<pre class='cython code score-0 '>  __pyx_v_dialect.double_quote = 1;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:     dialect.has_header = has_header</pre>
<pre class='cython code score-7 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_has_header); if (unlikely((__pyx_t_13 == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
  __pyx_v_dialect.has_header = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">123</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>:     # Get schema</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>:     cdef vector[CsvColumnSchema] schema = GetCsvSchema(data_ptr, data_size, dialect, sample_size)</pre>
<pre class='cython code score-7 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyLong_As_size_t</span>(__pyx_v_sample_size); if (unlikely((__pyx_t_10 == (size_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 125, __pyx_L1_error)</span>
  __pyx_v_schema = GetCsvSchema(__pyx_v_data_ptr, __pyx_v_data_size, __pyx_v_dialect, __pyx_t_10);
</pre><pre class="cython line score-0">&#xA0;<span class="">126</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:     if have_view:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_have_view != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:         PyBuffer_Release(&amp;view)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyBuffer_Release</span>((&amp;__pyx_v_view));
</pre><pre class="cython line score-0">&#xA0;<span class="">129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>:     # Convert to Python</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:     result = []</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_result = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">132</span>:     cdef size_t i</pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>:     cdef int type_val</pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:     for i in range(schema.size()):</pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_schema.size();
  __pyx_t_15 = __pyx_t_14;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_15; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:         type_val = &lt;int&gt;schema[i].type</pre>
<pre class='cython code score-0 '>    __pyx_v_type_val = ((int)(__pyx_v_schema[__pyx_v_i]).type);
</pre><pre class="cython line score-0">&#xA0;<span class="">137</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:         if type_val == &lt;int&gt;CsvType.Integer:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_type_val == ((int)CsvType::Integer));
    if (__pyx_t_1) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:             type_str = "int64"</pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_n_u_int64);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_type_str, __pyx_mstate_global-&gt;__pyx_n_u_int64);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:         elif type_val == &lt;int&gt;CsvType.Double:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_type_val == ((int)CsvType::Double));
    if (__pyx_t_1) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:             type_str = "double"</pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_n_u_double);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_type_str, __pyx_mstate_global-&gt;__pyx_n_u_double);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>:         elif type_val == &lt;int&gt;CsvType.Boolean:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_type_val == ((int)CsvType::Boolean));
    if (__pyx_t_1) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:             type_str = "boolean"</pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_n_u_boolean);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_type_str, __pyx_mstate_global-&gt;__pyx_n_u_boolean);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:         elif type_val == &lt;int&gt;CsvType.String:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_type_val == ((int)CsvType::String));
    if (__pyx_t_1) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:             type_str = "string"</pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_n_u_string);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_type_str, __pyx_mstate_global-&gt;__pyx_n_u_string);
</pre><pre class="cython line score-0">&#xA0;<span class="">146</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:             type_str = "string"</pre>
<pre class='cython code score-2 '>    /*else*/ {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_n_u_string);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_type_str, __pyx_mstate_global-&gt;__pyx_n_u_string);
    }
    __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">148</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:         result.append({</pre>
<pre class='cython code score-3 '>    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_result, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((int)-1))) __PYX_ERR(0, 149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:             'name': schema[i].name.decode('utf-8'),</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = __Pyx_decode_cpp_string((__pyx_v_schema[__pyx_v_i]).name, 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_name, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:             'type': type_str,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_type, __pyx_v_type_str) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:             'nullable': schema[i].nullable</pre>
<pre class='cython code score-8 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((__pyx_v_schema[__pyx_v_i]).nullable);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_nullable, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">153</span>:         })</pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">156</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>: def read_csv(data, columns=None, delimiter=',', quote_char='"', has_header=True):</pre>
<pre class='cython code score-82 '>/* Python wrapper */
static PyObject *__pyx_pw_4rugo_3csv_3read_csv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_4rugo_3csv_2read_csv, "\n    Read CSV data into columnar format.\n    \n    Parameters\n    ----------\n    data : bytes or memoryview\n        The CSV data to read\n    columns : list of str, optional\n        List of column names to read. If None, reads all columns.\n    delimiter : str, default ','\n        Field delimiter character (use '\\t' for TSV)\n    quote_char : str, default '\"'\n        Quote character for fields\n    has_header : bool, default True\n        Whether the first line contains column names\n    \n    Returns\n    -------\n    dict\n        Dictionary with keys:\n        - success: bool - Whether reading succeeded\n        - num_rows: int - Number of rows read\n        - column_names: list of str - Column names\n        - columns: list of list - Column data (one list per column)\n        \n    Examples\n    --------\n    &gt;&gt;&gt; data = b'name,age,salary\\nAlice,30,50000\\nBob,25,45000'\n    &gt;&gt;&gt; result = read_csv(data)\n    &gt;&gt;&gt; print(result['column_names'])\n    ['name', 'age', 'salary']\n    &gt;&gt;&gt; print(result['columns'][0])  # name column\n    ['Alice', 'Bob']\n    \n    &gt;&gt;&gt; # Read with projection\n    &gt;&gt;&gt; result = read_csv(data, columns=['name', 'salary'])\n    &gt;&gt;&gt; print(result['column_names'])\n    ['name', 'salary']\n    ");
static PyMethodDef __pyx_mdef_4rugo_3csv_3read_csv = {"read_csv", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4rugo_3csv_3read_csv, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_4rugo_3csv_2read_csv};
static PyObject *__pyx_pw_4rugo_3csv_3read_csv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_columns = 0;
  PyObject *__pyx_v_delimiter = 0;
  PyObject *__pyx_v_quote_char = 0;
  PyObject *__pyx_v_has_header = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("read_csv (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_data,&amp;__pyx_mstate_global-&gt;__pyx_n_u_columns,&amp;__pyx_mstate_global-&gt;__pyx_n_u_delimiter,&amp;__pyx_mstate_global-&gt;__pyx_n_u_quote_char,&amp;__pyx_mstate_global-&gt;__pyx_n_u_has_header,0};
  PyObject* values[5] = {0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "read_csv", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u_)));
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__2)));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)Py_True)));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_csv", 0, 1, 5, i); <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      if (!values[2]) values[2] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u_)));
      if (!values[3]) values[3] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__2)));
      if (!values[4]) values[4] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)Py_True)));
    }
    __pyx_v_data = values[0];
    __pyx_v_columns = values[1];
    __pyx_v_delimiter = values[2];
    __pyx_v_quote_char = values[3];
    __pyx_v_has_header = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_csv", 0, 1, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.read_csv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4rugo_3csv_2read_csv(__pyx_self, __pyx_v_data, __pyx_v_columns, __pyx_v_delimiter, __pyx_v_quote_char, __pyx_v_has_header);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4rugo_3csv_2read_csv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_columns, PyObject *__pyx_v_delimiter, PyObject *__pyx_v_quote_char, PyObject *__pyx_v_has_header) {
  uint8_t const *__pyx_v_data_ptr;
  size_t __pyx_v_data_size;
  PyObject *__pyx_v_data_bytes = 0;
  Py_buffer __pyx_v_view;
  bool __pyx_v_have_view;
  CsvDialect __pyx_v_dialect;
  std::vector&lt;std::string&gt;  __pyx_v_column_names_cpp;
  PyObject *__pyx_v_col = NULL;
  CsvTable __pyx_v_table;
  PyObject *__pyx_v_result = NULL;
  size_t __pyx_v_i;
  size_t __pyx_v_j;
  PyObject *__pyx_v_col_type = NULL;
  std::vector&lt;PY_LONG_LONG&gt; ::size_type __pyx_v_n;
  std::vector&lt;uint8_t&gt; ::size_type __pyx_v_nm;
  PyObject *__pyx_v_col_data = NULL;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.read_csv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data_bytes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col_data);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4rugo_3csv_3read_csv, 0, __pyx_mstate_global-&gt;__pyx_n_u_read_csv, NULL, __pyx_mstate_global-&gt;__pyx_n_u_rugo_csv, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[1]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 158, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_tuple[1]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_read_csv, __pyx_t_2) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[1] = <span class='py_c_api'>PyTuple_Pack</span>(4, Py_None, ((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u_), ((PyObject*)__pyx_mstate_global-&gt;__pyx_kp_u__2), ((PyObject*)Py_True)); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[1])) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[1]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[1]);
</pre><pre class="cython line score-0">&#xA0;<span class="">159</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>:     Read CSV data into columnar format.</pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>:     data : bytes or memoryview</pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>:         The CSV data to read</pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>:     columns : list of str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>:         List of column names to read. If None, reads all columns.</pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:     delimiter : str, default ','</pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>:         Field delimiter character (use '\\t' for TSV)</pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>:     quote_char : str, default '"'</pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>:         Quote character for fields</pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>:     has_header : bool, default True</pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>:         Whether the first line contains column names</pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>:     dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>:         Dictionary with keys:</pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>:         - success: bool - Whether reading succeeded</pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>:         - num_rows: int - Number of rows read</pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>:         - column_names: list of str - Column names</pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>:         - columns: list of list - Column data (one list per column)</pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>:     &gt;&gt;&gt; data = b'name,age,salary\\nAlice,30,50000\\nBob,25,45000'</pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>:     &gt;&gt;&gt; result = read_csv(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>:     &gt;&gt;&gt; print(result['column_names'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>:     ['name', 'age', 'salary']</pre>
<pre class="cython line score-0">&#xA0;<span class="">190</span>:     &gt;&gt;&gt; print(result['columns'][0])  # name column</pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>:     ['Alice', 'Bob']</pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>:     &gt;&gt;&gt; # Read with projection</pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>:     &gt;&gt;&gt; result = read_csv(data, columns=['name', 'salary'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>:     &gt;&gt;&gt; print(result['column_names'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>:     ['name', 'salary']</pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>:     cdef const uint8_t* data_ptr</pre>
<pre class="cython line score-0">&#xA0;<span class="">199</span>:     cdef size_t data_size</pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>:     cdef bytes data_bytes</pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>:     cdef Py_buffer view</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:     cdef cbool have_view = False</pre>
<pre class='cython code score-0 '>  __pyx_v_have_view = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">203</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">204</span>:     # Handle different input types</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:     if isinstance(data, memoryview):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = PyMemoryView_Check(__pyx_v_data); 
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:         PyObject_GetBuffer(data.obj, &amp;view, PyBUF_CONTIG_RO)</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_mstate_global-&gt;__pyx_n_u_obj);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_t_2, (&amp;__pyx_v_view), PyBUF_CONTIG_RO);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 206, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:         data_ptr = &lt;const uint8_t*&gt;view.buf</pre>
<pre class='cython code score-0 '>    __pyx_v_data_ptr = ((uint8_t const *)__pyx_v_view.buf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         data_size = view.len</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_view.len;
    __pyx_v_data_size = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:         have_view = True</pre>
<pre class='cython code score-0 '>    __pyx_v_have_view = 1;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:     elif isinstance(data, bytes):</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyBytes_Check</span>(__pyx_v_data); 
  if (likely(__pyx_t_1)) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:         data_bytes = data</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = __pyx_v_data;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("bytes", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
    __pyx_v_data_bytes = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:         data_ptr = &lt;const uint8_t*&gt;&lt;char*&gt;data_bytes</pre>
<pre class='cython code score-12 '>    if (unlikely(__pyx_v_data_bytes == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "expected bytes, NoneType found");
      <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyBytes_AsWritableString</span>(__pyx_v_data_bytes); if (unlikely((!__pyx_t_5) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
    __pyx_v_data_ptr = ((uint8_t const *)((char *)__pyx_t_5));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:         data_size = len(data_bytes)</pre>
<pre class='cython code score-7 '>    if (unlikely(__pyx_v_data_bytes == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBytes_GET_SIZE</span>(__pyx_v_data_bytes);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 213, __pyx_L1_error)</span>
    __pyx_v_data_size = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">214</span>:     else:</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:         raise TypeError(f"Expected bytes or memoryview, got {type(data)}")</pre>
<pre class='cython code score-14 '>  /*else*/ {
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_TypeError);
    __pyx_t_7 = __pyx_builtin_TypeError; 
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(((PyObject *)Py_TYPE(__pyx_v_data)), __pyx_mstate_global-&gt;__pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Expected_bytes_or_memoryview_got, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_10 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:     # Setup dialect</pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>:     cdef CsvDialect dialect</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:     dialect.delimiter = ord(delimiter[0]) if delimiter else ord(',')</pre>
<pre class='cython code score-7 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_delimiter); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>
  if (__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_delimiter, 0, long, 1, __Pyx_PyLong_From_long, 0, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 219, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 219, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = __pyx_t_12;
  } else {
    __pyx_t_11 = 44;
  }
  __pyx_v_dialect.delimiter = __pyx_t_11;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:     dialect.quote_char = ord(quote_char[0]) if quote_char else ord('"')</pre>
<pre class='cython code score-7 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_quote_char); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
  if (__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_quote_char, 0, long, 1, __Pyx_PyLong_From_long, 0, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Ord</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 220, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = __pyx_t_12;
  } else {
    __pyx_t_11 = 34;
  }
  __pyx_v_dialect.quote_char = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:     dialect.escape_char = ord('\\')</pre>
<pre class='cython code score-0 '>  __pyx_v_dialect.escape_char = 92;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:     dialect.double_quote = True</pre>
<pre class='cython code score-0 '>  __pyx_v_dialect.double_quote = 1;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:     dialect.has_header = has_header</pre>
<pre class='cython code score-7 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_has_header); if (unlikely((__pyx_t_13 == ((bool)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
  __pyx_v_dialect.has_header = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">224</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">225</span>:     # Convert column names to C++ vector</pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>:     cdef vector[string] column_names_cpp</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:     if columns is not None:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_columns != Py_None);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:         for col in columns:</pre>
<pre class='cython code score-48 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_columns)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_columns)) {
      __pyx_t_2 = __pyx_v_columns; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_4 = 0;
      __pyx_t_14 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_14 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_14)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_4 &gt;= __pyx_temp) break;
          }
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_2, __pyx_t_4);
          ++__pyx_t_4;
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_4 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_4));
          #else
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4);
          #endif
          ++__pyx_t_4;
        }
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
      } else {
        __pyx_t_7 = __pyx_t_14(__pyx_t_2);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
            <span class='py_c_api'>PyErr_Clear</span>();
          }
          break;
        }
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_7);
      __pyx_t_7 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:             column_names_cpp.push_back(col.encode('utf-8'))</pre>
<pre class='cython code score-5 '>      __pyx_t_9 = __pyx_v_col;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      __pyx_t_10 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_mstate_global-&gt;__pyx_kp_u_utf_8};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_encode, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      __pyx_t_15 = __pyx_convert_string_from_py_6libcpp_6string_std__in_string(__pyx_t_7);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 229, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      try {
        __pyx_v_column_names_cpp.push_back(__pyx_t_15);
      } catch(...) {
        __Pyx_CppExn2PyErr();
        <span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">230</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">231</span>:     # Read CSV</pre>
<pre class="cython line score-0">&#xA0;<span class="">232</span>:     cdef CsvTable table</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:     if columns is None:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_columns == Py_None);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L8;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:         table = ReadCsv(data_ptr, data_size, dialect)</pre>
<pre class='cython code score-0 '>    __pyx_v_table = ReadCsv(__pyx_v_data_ptr, __pyx_v_data_size, __pyx_v_dialect);
</pre><pre class="cython line score-0">&#xA0;<span class="">235</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:         table = ReadCsv(data_ptr, data_size, dialect, column_names_cpp)</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_table = ReadCsv(__pyx_v_data_ptr, __pyx_v_data_size, __pyx_v_dialect, __pyx_v_column_names_cpp);
  }
  __pyx_L8:;
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:     if have_view:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_have_view != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:         PyBuffer_Release(&amp;view)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyBuffer_Release</span>((&amp;__pyx_v_view));
</pre><pre class="cython line score-0">&#xA0;<span class="">240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">241</span>:     # Convert to Python</pre>
<pre class="cython line score-0">&#xA0;<span class="">242</span>:     result = {</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:         'success': table.success,</pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_table.success);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_success, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:         'num_rows': table.num_rows,</pre>
<pre class='cython code score-8 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyLong_FromSize_t</span>(__pyx_v_table.num_rows);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 244, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_num_rows, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:         'column_names': [],</pre>
<pre class='cython code score-11 '>  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_column_names, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:         'columns': []</pre>
<pre class='cython code score-11 '>  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_columns, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_result = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">247</span>:     }</pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>:     cdef size_t i, j</pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>:     # Column names</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:     for i in range(table.column_names.size()):</pre>
<pre class='cython code score-0 '>  __pyx_t_16 = __pyx_v_table.column_names.size();
  __pyx_t_17 = __pyx_t_16;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_17; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:         result['column_names'].append(table.column_names[i].decode('utf-8'))</pre>
<pre class='cython code score-6 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_result, __pyx_mstate_global-&gt;__pyx_n_u_column_names);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = __Pyx_decode_cpp_string((__pyx_v_table.column_names[__pyx_v_i]), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_Append</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">254</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">255</span>:     # Column data</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:     for i in range(table.columns.size()):</pre>
<pre class='cython code score-0 '>  __pyx_t_19 = __pyx_v_table.columns.size();
  __pyx_t_20 = __pyx_t_19;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_20; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:         col_type = table.columns[i].type.decode('utf-8')</pre>
<pre class='cython code score-1 '>    __pyx_t_7 = __Pyx_decode_cpp_string((__pyx_v_table.columns[__pyx_v_i]).type, 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col_type, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">258</span>:         # Pre-allocate list for faster assignment and fewer resizes</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:         if col_type == "int64":</pre>
<pre class='cython code score-2 '>    __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_col_type, __pyx_mstate_global-&gt;__pyx_n_u_int64, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 259, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/* … */
      goto __pyx_L14;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:             n = table.columns[i].int_values.size()</pre>
<pre class='cython code score-0 '>      __pyx_v_n = (__pyx_v_table.columns[__pyx_v_i]).int_values.size();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:             nm = table.columns[i].null_mask.size()</pre>
<pre class='cython code score-0 '>      __pyx_v_nm = (__pyx_v_table.columns[__pyx_v_i]).null_mask.size();
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:             col_data = [None] * n</pre>
<pre class='cython code score-9 '>      __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1 * (__pyx_v_n));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_n; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_7, __pyx_temp, Py_None) != (0)) <span class='error_goto'>__PYX_ERR(0, 262, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col_data, ((PyObject*)__pyx_t_7));
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:             for j in range(n):</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_n;
      __pyx_t_22 = __pyx_t_21;
      for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
        __pyx_v_j = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:                 if nm == n:</pre>
<pre class='cython code score-0 '>        __pyx_t_1 = (__pyx_v_nm == __pyx_v_n);
        if (__pyx_t_1) {
/* … */
          goto __pyx_L17;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:                     if table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>          __pyx_t_1 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          if (__pyx_t_1) {
/* … */
            goto __pyx_L18;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 266, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">267</span>:                     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:                         col_data[j] = table.columns[i].int_values[j]</pre>
<pre class='cython code score-5 '>          /*else*/ {
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyLong_From_PY_LONG_LONG</span>(((__pyx_v_table.columns[__pyx_v_i]).int_values[__pyx_v_j]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 268, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L18:;
</pre><pre class="cython line score-0">&#xA0;<span class="">269</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:                     if j &lt; nm and table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_t_24 = (__pyx_v_j &lt; __pyx_v_nm);
          if (__pyx_t_24) {
          } else {
            __pyx_t_1 = __pyx_t_24;
            goto __pyx_L20_bool_binop_done;
          }
          __pyx_t_24 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          __pyx_t_1 = __pyx_t_24;
          __pyx_L20_bool_binop_done:;
          if (__pyx_t_1) {
/* … */
            goto __pyx_L19;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 271, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">272</span>:                     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:                         col_data[j] = table.columns[i].int_values[j]</pre>
<pre class='cython code score-5 '>          /*else*/ {
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyLong_From_PY_LONG_LONG</span>(((__pyx_v_table.columns[__pyx_v_i]).int_values[__pyx_v_j]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 273, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 273, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L19:;
        }
        __pyx_L17:;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:         elif col_type == "double":</pre>
<pre class='cython code score-2 '>    __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_col_type, __pyx_mstate_global-&gt;__pyx_n_u_double, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/* … */
      goto __pyx_L14;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:             n = table.columns[i].double_values.size()</pre>
<pre class='cython code score-0 '>      __pyx_v_n = (__pyx_v_table.columns[__pyx_v_i]).double_values.size();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:             nm = table.columns[i].null_mask.size()</pre>
<pre class='cython code score-0 '>      __pyx_v_nm = (__pyx_v_table.columns[__pyx_v_i]).null_mask.size();
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:             col_data = [None] * n</pre>
<pre class='cython code score-9 '>      __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1 * (__pyx_v_n));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_n; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_7, __pyx_temp, Py_None) != (0)) <span class='error_goto'>__PYX_ERR(0, 277, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col_data, ((PyObject*)__pyx_t_7));
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:             for j in range(n):</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_n;
      __pyx_t_22 = __pyx_t_21;
      for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
        __pyx_v_j = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:                 if nm == n:</pre>
<pre class='cython code score-0 '>        __pyx_t_1 = (__pyx_v_nm == __pyx_v_n);
        if (__pyx_t_1) {
/* … */
          goto __pyx_L24;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:                     if table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>          __pyx_t_1 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          if (__pyx_t_1) {
/* … */
            goto __pyx_L25;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">282</span>:                     else:</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:                         col_data[j] = table.columns[i].double_values[j]</pre>
<pre class='cython code score-8 '>          /*else*/ {
            __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_table.columns[__pyx_v_i]).double_values[__pyx_v_j]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 283, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L25:;
</pre><pre class="cython line score-0">&#xA0;<span class="">284</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:                     if j &lt; nm and table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_t_24 = (__pyx_v_j &lt; __pyx_v_nm);
          if (__pyx_t_24) {
          } else {
            __pyx_t_1 = __pyx_t_24;
            goto __pyx_L27_bool_binop_done;
          }
          __pyx_t_24 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          __pyx_t_1 = __pyx_t_24;
          __pyx_L27_bool_binop_done:;
          if (__pyx_t_1) {
/* … */
            goto __pyx_L26;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">287</span>:                     else:</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:                         col_data[j] = table.columns[i].double_values[j]</pre>
<pre class='cython code score-8 '>          /*else*/ {
            __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_table.columns[__pyx_v_i]).double_values[__pyx_v_j]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L26:;
        }
        __pyx_L24:;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:         elif col_type == "boolean":</pre>
<pre class='cython code score-2 '>    __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_col_type, __pyx_mstate_global-&gt;__pyx_n_u_boolean, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/* … */
      goto __pyx_L14;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:             n = table.columns[i].boolean_values.size()</pre>
<pre class='cython code score-0 '>      __pyx_v_n = (__pyx_v_table.columns[__pyx_v_i]).boolean_values.size();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:             nm = table.columns[i].null_mask.size()</pre>
<pre class='cython code score-0 '>      __pyx_v_nm = (__pyx_v_table.columns[__pyx_v_i]).null_mask.size();
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:             col_data = [None] * n</pre>
<pre class='cython code score-9 '>      __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1 * (__pyx_v_n));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_n; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_7, __pyx_temp, Py_None) != (0)) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col_data, ((PyObject*)__pyx_t_7));
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:             for j in range(n):</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_n;
      __pyx_t_22 = __pyx_t_21;
      for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
        __pyx_v_j = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:                 if nm == n:</pre>
<pre class='cython code score-0 '>        __pyx_t_1 = (__pyx_v_nm == __pyx_v_n);
        if (__pyx_t_1) {
/* … */
          goto __pyx_L31;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:                     if table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>          __pyx_t_1 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          if (__pyx_t_1) {
/* … */
            goto __pyx_L32;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">297</span>:                     else:</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:                         col_data[j] = bool(table.columns[i].boolean_values[j])</pre>
<pre class='cython code score-8 '>          /*else*/ {
            __pyx_t_7 = __Pyx_PyLong_From_uint8_t(((__pyx_v_table.columns[__pyx_v_i]).boolean_values[__pyx_v_j]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(!__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L32:;
</pre><pre class="cython line score-0">&#xA0;<span class="">299</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:                     if j &lt; nm and table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_t_24 = (__pyx_v_j &lt; __pyx_v_nm);
          if (__pyx_t_24) {
          } else {
            __pyx_t_1 = __pyx_t_24;
            goto __pyx_L34_bool_binop_done;
          }
          __pyx_t_24 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          __pyx_t_1 = __pyx_t_24;
          __pyx_L34_bool_binop_done:;
          if (__pyx_t_1) {
/* … */
            goto __pyx_L33;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">302</span>:                     else:</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">303</span>:                         col_data[j] = bool(table.columns[i].boolean_values[j])</pre>
<pre class='cython code score-8 '>          /*else*/ {
            __pyx_t_7 = __Pyx_PyLong_From_uint8_t(((__pyx_v_table.columns[__pyx_v_i]).boolean_values[__pyx_v_j]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(!__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L33:;
        }
        __pyx_L31:;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">304</span>:         else:  # string</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>:             n = table.columns[i].string_values.size()</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_n = (__pyx_v_table.columns[__pyx_v_i]).string_values.size();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:             nm = table.columns[i].null_mask.size()</pre>
<pre class='cython code score-0 '>      __pyx_v_nm = (__pyx_v_table.columns[__pyx_v_i]).null_mask.size();
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:             col_data = [None] * n</pre>
<pre class='cython code score-9 '>      __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1 * (__pyx_v_n));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 307, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_n; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
          <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_7, __pyx_temp, Py_None) != (0)) <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col_data, ((PyObject*)__pyx_t_7));
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:             for j in range(n):</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_n;
      __pyx_t_22 = __pyx_t_21;
      for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
        __pyx_v_j = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:                 if nm == n:</pre>
<pre class='cython code score-0 '>        __pyx_t_1 = (__pyx_v_nm == __pyx_v_n);
        if (__pyx_t_1) {
/* … */
          goto __pyx_L38;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>:                     if table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>          __pyx_t_1 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          if (__pyx_t_1) {
/* … */
            goto __pyx_L39;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">312</span>:                     else:</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:                         col_data[j] = table.columns[i].string_values[j].decode('utf-8')</pre>
<pre class='cython code score-3 '>          /*else*/ {
            __pyx_t_7 = __Pyx_decode_cpp_string(((__pyx_v_table.columns[__pyx_v_i]).string_values[__pyx_v_j]), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L39:;
</pre><pre class="cython line score-0">&#xA0;<span class="">314</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:                     if j &lt; nm and table.columns[i].null_mask[j]:</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_t_24 = (__pyx_v_j &lt; __pyx_v_nm);
          if (__pyx_t_24) {
          } else {
            __pyx_t_1 = __pyx_t_24;
            goto __pyx_L41_bool_binop_done;
          }
          __pyx_t_24 = (((__pyx_v_table.columns[__pyx_v_i]).null_mask[__pyx_v_j]) != 0);
          __pyx_t_1 = __pyx_t_24;
          __pyx_L41_bool_binop_done:;
          if (__pyx_t_1) {
/* … */
            goto __pyx_L40;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:                         col_data[j] = None</pre>
<pre class='cython code score-2 '>            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, Py_None, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">317</span>:                     else:</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:                         col_data[j] = table.columns[i].string_values[j].decode('utf-8')</pre>
<pre class='cython code score-3 '>          /*else*/ {
            __pyx_t_7 = __Pyx_decode_cpp_string(((__pyx_v_table.columns[__pyx_v_i]).string_values[__pyx_v_j]), 0, PY_SSIZE_T_MAX, NULL, NULL, PyUnicode_DecodeUTF8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_col_data, __pyx_v_j, __pyx_t_7, size_t, 0, __Pyx_PyLong_FromSize_t, 1, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L40:;
        }
        __pyx_L38:;
      }
    }
    __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">319</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:         result['columns'].append(col_data)</pre>
<pre class='cython code score-5 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_result, __pyx_mstate_global-&gt;__pyx_n_u_columns);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_Append</span>(__pyx_t_7, __pyx_v_col_data);<span class='error_goto'> if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 320, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">321</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">322</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">323</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">324</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>: def detect_csv_dialect(data, sample_size=100):</pre>
<pre class='cython code score-54 '>/* Python wrapper */
static PyObject *__pyx_pw_4rugo_3csv_5detect_csv_dialect(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_4rugo_3csv_4detect_csv_dialect, "\n    Auto-detect CSV dialect (delimiter, quote character).\n    \n    Parameters\n    ----------\n    data : bytes or memoryview\n        The CSV data to analyze\n    sample_size : int, default 100\n        Number of rows to sample for detection\n    \n    Returns\n    -------\n    dict\n        Dictionary with detected dialect parameters:\n        - delimiter: str - Detected delimiter character\n        - quote_char: str - Quote character\n        \n    Examples\n    --------\n    &gt;&gt;&gt; data = b'name\\tage\\tsalary\\nAlice\\t30\\t50000'\n    &gt;&gt;&gt; dialect = detect_csv_dialect(data)\n    &gt;&gt;&gt; print(dialect['delimiter'])\n    '\t'\n    ");
static PyMethodDef __pyx_mdef_4rugo_3csv_5detect_csv_dialect = {"detect_csv_dialect", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4rugo_3csv_5detect_csv_dialect, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_4rugo_3csv_4detect_csv_dialect};
static PyObject *__pyx_pw_4rugo_3csv_5detect_csv_dialect(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_sample_size = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("detect_csv_dialect (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_data,&amp;__pyx_mstate_global-&gt;__pyx_n_u_sample_size,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "detect_csv_dialect", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100)));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("detect_csv_dialect", 0, 1, 2, i); <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100)));
    }
    __pyx_v_data = values[0];
    __pyx_v_sample_size = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("detect_csv_dialect", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.detect_csv_dialect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4rugo_3csv_4detect_csv_dialect(__pyx_self, __pyx_v_data, __pyx_v_sample_size);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4rugo_3csv_4detect_csv_dialect(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_sample_size) {
  uint8_t const *__pyx_v_data_ptr;
  size_t __pyx_v_data_size;
  PyObject *__pyx_v_data_bytes = 0;
  Py_buffer __pyx_v_view;
  bool __pyx_v_have_view;
  CsvDialect __pyx_v_dialect;
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.detect_csv_dialect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data_bytes);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4rugo_3csv_5detect_csv_dialect, 0, __pyx_mstate_global-&gt;__pyx_n_u_detect_csv_dialect, NULL, __pyx_mstate_global-&gt;__pyx_n_u_rugo_csv, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[2]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_tuple[2]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_detect_csv_dialect, __pyx_t_2) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[2] = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100)); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[2])) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[2]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[2]);
</pre><pre class="cython line score-0">&#xA0;<span class="">326</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">327</span>:     Auto-detect CSV dialect (delimiter, quote character).</pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>:     data : bytes or memoryview</pre>
<pre class="cython line score-0">&#xA0;<span class="">332</span>:         The CSV data to analyze</pre>
<pre class="cython line score-0">&#xA0;<span class="">333</span>:     sample_size : int, default 100</pre>
<pre class="cython line score-0">&#xA0;<span class="">334</span>:         Number of rows to sample for detection</pre>
<pre class="cython line score-0">&#xA0;<span class="">335</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">336</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">337</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>:     dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">339</span>:         Dictionary with detected dialect parameters:</pre>
<pre class="cython line score-0">&#xA0;<span class="">340</span>:         - delimiter: str - Detected delimiter character</pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>:         - quote_char: str - Quote character</pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>:     &gt;&gt;&gt; data = b'name\\tage\\tsalary\\nAlice\\t30\\t50000'</pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>:     &gt;&gt;&gt; dialect = detect_csv_dialect(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>:     &gt;&gt;&gt; print(dialect['delimiter'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>:     '\t'</pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>:     cdef const uint8_t* data_ptr</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>:     cdef size_t data_size</pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>:     cdef bytes data_bytes</pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>:     cdef Py_buffer view</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:     cdef cbool have_view = False</pre>
<pre class='cython code score-0 '>  __pyx_v_have_view = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">355</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>:     # Handle different input types</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:     if isinstance(data, memoryview):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = PyMemoryView_Check(__pyx_v_data); 
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:         PyObject_GetBuffer(data.obj, &amp;view, PyBUF_CONTIG_RO)</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_mstate_global-&gt;__pyx_n_u_obj);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_t_2, (&amp;__pyx_v_view), PyBUF_CONTIG_RO);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 358, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:         data_ptr = &lt;const uint8_t*&gt;view.buf</pre>
<pre class='cython code score-0 '>    __pyx_v_data_ptr = ((uint8_t const *)__pyx_v_view.buf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>:         data_size = view.len</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_view.len;
    __pyx_v_data_size = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:         have_view = True</pre>
<pre class='cython code score-0 '>    __pyx_v_have_view = 1;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:     elif isinstance(data, bytes):</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyBytes_Check</span>(__pyx_v_data); 
  if (likely(__pyx_t_1)) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:         data_bytes = data</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = __pyx_v_data;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    if (!(likely(<span class='py_c_api'>PyBytes_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("bytes", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
    __pyx_v_data_bytes = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:         data_ptr = &lt;const uint8_t*&gt;&lt;char*&gt;data_bytes</pre>
<pre class='cython code score-12 '>    if (unlikely(__pyx_v_data_bytes == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "expected bytes, NoneType found");
      <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyBytes_AsWritableString</span>(__pyx_v_data_bytes); if (unlikely((!__pyx_t_5) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span>
    __pyx_v_data_ptr = ((uint8_t const *)((char *)__pyx_t_5));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>:         data_size = len(data_bytes)</pre>
<pre class='cython code score-7 '>    if (unlikely(__pyx_v_data_bytes == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBytes_GET_SIZE</span>(__pyx_v_data_bytes);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 365, __pyx_L1_error)</span>
    __pyx_v_data_size = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">366</span>:     else:</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:         raise TypeError(f"Expected bytes or memoryview, got {type(data)}")</pre>
<pre class='cython code score-14 '>  /*else*/ {
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_TypeError);
    __pyx_t_7 = __pyx_builtin_TypeError; 
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(((PyObject *)Py_TYPE(__pyx_v_data)), __pyx_mstate_global-&gt;__pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_mstate_global-&gt;__pyx_kp_u_Expected_bytes_or_memoryview_got, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_10 = 1;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 367, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 367, __pyx_L1_error)</span>
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">368</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">369</span>:     # Detect dialect</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:     cdef CsvDialect dialect = DetectCsvDialect(data_ptr, data_size, sample_size)</pre>
<pre class='cython code score-7 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyLong_As_size_t</span>(__pyx_v_sample_size); if (unlikely((__pyx_t_10 == (size_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
  __pyx_v_dialect = DetectCsvDialect(__pyx_v_data_ptr, __pyx_v_data_size, __pyx_t_10);
</pre><pre class="cython line score-0">&#xA0;<span class="">371</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:     if have_view:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_have_view != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:         PyBuffer_Release(&amp;view)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyBuffer_Release</span>((&amp;__pyx_v_view));
</pre><pre class="cython line score-0">&#xA0;<span class="">374</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">375</span>:     return {</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>:         'delimiter': chr(dialect.delimiter),</pre>
<pre class='cython code score-13 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='py_c_api'>PyUnicode_FromOrdinal</span>(__pyx_v_dialect.delimiter);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_delimiter, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:         'quote_char': chr(dialect.quote_char)</pre>
<pre class='cython code score-11 '>  __pyx_t_7 = <span class='py_c_api'>PyUnicode_FromOrdinal</span>(__pyx_v_dialect.quote_char);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_quote_char, __pyx_t_7) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">378</span>:     }</pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">380</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">381</span>: # Convenience function for TSV</pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>: def read_tsv(data, columns=None):</pre>
<pre class='cython code score-47 '>/* Python wrapper */
static PyObject *__pyx_pw_4rugo_3csv_7read_tsv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_4rugo_3csv_6read_tsv, "\n    Read TSV (tab-separated values) data.\n    \n    This is a convenience wrapper around read_csv with delimiter='\\t'.\n    \n    Parameters\n    ----------\n    data : bytes or memoryview\n        The TSV data to read\n    columns : list of str, optional\n        List of column names to read. If None, reads all columns.\n    \n    Returns\n    -------\n    dict\n        Same as read_csv()\n        \n    Examples\n    --------\n    &gt;&gt;&gt; data = b'name\\tage\\tsalary\\nAlice\\t30\\t50000'\n    &gt;&gt;&gt; result = read_tsv(data)\n    &gt;&gt;&gt; print(result['column_names'])\n    ['name', 'age', 'salary']\n    ");
static PyMethodDef __pyx_mdef_4rugo_3csv_7read_tsv = {"read_tsv", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4rugo_3csv_7read_tsv, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_4rugo_3csv_6read_tsv};
static PyObject *__pyx_pw_4rugo_3csv_7read_tsv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_columns = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("read_tsv (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_data,&amp;__pyx_mstate_global-&gt;__pyx_n_u_columns,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "read_tsv", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span>
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_tsv", 0, 1, 2, i); <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)Py_None));
    }
    __pyx_v_data = values[0];
    __pyx_v_columns = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("read_tsv", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.read_tsv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4rugo_3csv_6read_tsv(__pyx_self, __pyx_v_data, __pyx_v_columns);

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4rugo_3csv_6read_tsv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_columns) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.read_tsv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4rugo_3csv_7read_tsv, 0, __pyx_mstate_global-&gt;__pyx_n_u_read_tsv, NULL, __pyx_mstate_global-&gt;__pyx_n_u_rugo_csv, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[3]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_tuple[3]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_read_tsv, __pyx_t_2) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">383</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">384</span>:     Read TSV (tab-separated values) data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">386</span>:     This is a convenience wrapper around read_csv with delimiter='\\t'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">387</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">388</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">389</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">390</span>:     data : bytes or memoryview</pre>
<pre class="cython line score-0">&#xA0;<span class="">391</span>:         The TSV data to read</pre>
<pre class="cython line score-0">&#xA0;<span class="">392</span>:     columns : list of str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">393</span>:         List of column names to read. If None, reads all columns.</pre>
<pre class="cython line score-0">&#xA0;<span class="">394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">395</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">396</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">397</span>:     dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">398</span>:         Same as read_csv()</pre>
<pre class="cython line score-0">&#xA0;<span class="">399</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">400</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">401</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">402</span>:     &gt;&gt;&gt; data = b'name\\tage\\tsalary\\nAlice\\t30\\t50000'</pre>
<pre class="cython line score-0">&#xA0;<span class="">403</span>:     &gt;&gt;&gt; result = read_tsv(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">404</span>:     &gt;&gt;&gt; print(result['column_names'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">405</span>:     ['name', 'age', 'salary']</pre>
<pre class="cython line score-0">&#xA0;<span class="">406</span>:     """</pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">407</span>:     return read_csv(data, columns=columns, delimiter='\t')</pre>
<pre class='cython code score-24 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_read_csv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 407, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 2 : 0)] = {__pyx_t_2, __pyx_v_data};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 407, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_columns, __pyx_v_columns, __pyx_t_5, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_delimiter, __pyx_mstate_global-&gt;__pyx_kp_u__3, __pyx_t_5, __pyx_callargs+2, 1) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">409</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>: def get_tsv_schema(data, sample_size=100):</pre>
<pre class='cython code score-41 '>/* Python wrapper */
static PyObject *__pyx_pw_4rugo_3csv_9get_tsv_schema(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_4rugo_3csv_8get_tsv_schema, "\n    Extract schema from TSV data.\n    \n    This is a convenience wrapper around get_csv_schema with delimiter='\\t'.\n    \n    Parameters\n    ----------\n    data : bytes or memoryview\n        The TSV data to analyze\n    sample_size : int, default 100\n        Number of rows to sample for type inference\n    \n    Returns\n    -------\n    list of dict\n        List of column schemas\n    ");
static PyMethodDef __pyx_mdef_4rugo_3csv_9get_tsv_schema = {"get_tsv_schema", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4rugo_3csv_9get_tsv_schema, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_4rugo_3csv_8get_tsv_schema};
static PyObject *__pyx_pw_4rugo_3csv_9get_tsv_schema(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_sample_size = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_tsv_schema (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_data,&amp;__pyx_mstate_global-&gt;__pyx_n_u_sample_size,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "get_tsv_schema", 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span>
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100)));
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_tsv_schema", 0, 1, 2, i); <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
      if (!values[1]) values[1] = <span class='pyx_c_api'>__Pyx_NewRef</span>(((PyObject *)((PyObject*)__pyx_mstate_global-&gt;__pyx_int_100)));
    }
    __pyx_v_data = values[0];
    __pyx_v_sample_size = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_tsv_schema", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rugo.csv.get_tsv_schema", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4rugo_3csv_8get_tsv_schema(__pyx_self, __pyx_v_data, __pyx_v_sample_size);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4rugo_3csv_8get_tsv_schema(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_sample_size) {
  PyObject *__pyx_r = NULL;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4rugo_3csv_9get_tsv_schema, 0, __pyx_mstate_global-&gt;__pyx_n_u_get_tsv_schema, NULL, __pyx_mstate_global-&gt;__pyx_n_u_rugo_csv, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[4]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 410, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_tuple[2]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_get_tsv_schema, __pyx_t_2) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">411</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">412</span>:     Extract schema from TSV data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">414</span>:     This is a convenience wrapper around get_csv_schema with delimiter='\\t'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">415</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>:     data : bytes or memoryview</pre>
<pre class="cython line score-0">&#xA0;<span class="">419</span>:         The TSV data to analyze</pre>
<pre class="cython line score-0">&#xA0;<span class="">420</span>:     sample_size : int, default 100</pre>
<pre class="cython line score-0">&#xA0;<span class="">421</span>:         Number of rows to sample for type inference</pre>
<pre class="cython line score-0">&#xA0;<span class="">422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">423</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">424</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">425</span>:     list of dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>:         List of column schemas</pre>
<pre class="cython line score-0">&#xA0;<span class="">427</span>:     """</pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">428</span>:     return get_csv_schema(data, delimiter='\t', sample_size=sample_size)</pre>
<pre class='cython code score-24 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_get_csv_schema);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 2 : 0)] = {__pyx_t_2, __pyx_v_data};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 428, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_delimiter, __pyx_mstate_global-&gt;__pyx_kp_u__3, __pyx_t_5, __pyx_callargs+2, 0) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_sample_size, __pyx_v_sample_size, __pyx_t_5, __pyx_callargs+2, 1) &lt; (0)) <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 428, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre></div></body></html>
