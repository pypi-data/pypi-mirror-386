version: "3.1"

actions:
  - check_transfer_funds
  - execute_transfer
  - execute_recurrent_payment

slots:

  transfer_type:
    type: categorical
    values:
      - self transfer
      - third party
    mappings:
      - type: from_llm

  transfer_timing_type:
    type: categorical
    values:
      - immediate
      - scheduled
      - recurring
    mappings:
      - type: from_llm

  recurrent_payment_type:
    type: categorical
    values:
      - direct debit
      - standing order
    mappings:
      - type: from_llm

  recurrent_payment_frequency:
    type: categorical
    values:
      - weekly
      - monthly
      - yearly
    mappings:
      - type: from_llm

  has_sufficient_funds:
    type: bool
    mappings:
      - type: controlled

  transfer_successful:
    type: bool
    mappings:
      - type: controlled

  setup_recurrent_payment_successful:
    type: bool
    mappings:
      - type: controlled

  self_transfer_source_account:
    type: categorical
    values: [savings, checking]
    mappings:
      - type: from_llm

  self_transfer_destination_account:
    type: categorical
    values: [savings, checking]
    mappings:
      - type: from_llm

responses:



  utter_ask_transfer_type:
    - text: What type of transfer would you like to make?
      buttons:
        - title: Send to someone else (domestic)
          payload: /SetSlots(transfer_type=third party)
        - title: Transfer between your own accounts
          payload: /SetSlots(transfer_type=self transfer)

  utter_inform_on_wrong_transfer_type:
    - text: That doesn't seem like a valid transfer type.

  utter_ask_transfer_timing_type:
    - text: Let me know when you'd like this transfer to happen?
      buttons:
        - title: Send now
          payload: /SetSlots(transfer_timing_type=immediate)
        - title: Schedule for later date
          payload: /SetSlots(transfer_timing_type=scheduled)
        - title: Set it up as a recurring payment
          payload: /SetSlots(transfer_timing_type=recurring)

  utter_inform_on_wrong_transfer_timing_type:
    - text: |
        That doesn't seem like a valid option for when to send the money.
        You can choose to send it now, schedule it for later, or set it up as a recurring payment.

  utter_transfer_money_insufficient_funds:
    - text: "I'm sorry, but there aren't enough funds available in your account for this transfer amount."
      metadata:
        rephrase: True

  utter_ask_schedule_transaction_date:
    - text: "What date would you like to schedule this transfer for?"
      metadata:
        rephrase: True

  utter_ask_schedule_transaction_time:
    - text: "What time on that day should I process the transfer?"
      metadata:
        rephrase: True

  utter_ask_recurrent_payment_type:
    - text: What type of payment would you like to set up?
      buttons:
        - title: Direct Debit
          payload: /SetSlots(recurrent_payment_type=direct debit)
        - title: Standing Order
          payload: /SetSlots(recurrent_payment_type=standing order)

  utter_ask_recurrent_payment_frequency:
    - text: How often should the payment be made?
      buttons:
        - title: Weekly
          payload: /SetSlots(recurrent_payment_frequency=weekly)
        - title: Monthly
          payload: /SetSlots(recurrent_payment_frequency=monthly)
        - title: Yearly
          payload: /SetSlots(recurrent_payment_frequency=yearly)

  utter_ask_recurrent_payment_start_date:
    - text: "When would you like the recurring payments to start?"
      metadata:
        rephrase: True

  utter_ask_recurrent_payment_end_date:
    - text: "When should the recurring payments stop?"
      metadata:
        rephrase: True

  utter_invalid_recurrent_payment_end_date:
    - text: "The end date needs to be after the start date. Could you give me a valid end date for the recurring payment?"
      metadata:
        rephrase: True

  utter_ask_self_transfer_source_account:
    - text: Which account do you want to transfer money from - savings or checking?

  utter_ask_self_transfer_destination_account:
    - text: Which account you want to transfer money to - savings or checking?

  utter_ask_immediate_transfer_confirmation:
    - text: |
        You’re about to perform an instant transfer {amount_of_money} to {recipient_account}.
        Do you want to proceed?
      buttons:
        - payload: /SetSlots(confirmation=true)
          title: "Yes"
        - payload: /SetSlots(confirmation=false)
          title: "No, cancel the transfer"

  utter_ask_setup_scheduled_transfer_confirmation:
    - text: |
        You’re scheduling a transfer of {amount_of_money} to {recipient_account} on {date} at {time}.
        Do you want to proceed?
      buttons:
        - payload: /SetSlots(confirmation=true)
          title: "Yes"
        - payload: /SetSlots(confirmation=false)
          title: "No, cancel the transfer"

  utter_ask_setup_recurring_payment_confirmation:
    - text: |
        You’re setting up a recurring {recurrent_payment_type} to transfer {amount_of_money} to {recipient_account}. 
        The payment will be made {recurrent_payment_frequency}, starting on {date_range_start} and ending on {date_range_end}.
        Do you want to proceed?
      buttons:
        - payload: /SetSlots(confirmation=true)
          title: "Yes"
        - payload: /SetSlots(confirmation=false)
          title: "No, cancel the transfer"

  utter_ask_self_transfer_final_confirmation:
    - text: |
        You're about to transfer {amount_of_money} from your {self_transfer_source_account} to {self_transfer_destination_account}.
        Do you want to proceed?
      buttons:
        - payload: /SetSlots(confirmation=true)
          title: "Yes"
        - payload: /SetSlots(confirmation=false)
          title: "No, cancel the transfer"

  utter_self_transfer_completed:
    - text: Successfully transferred {amount_of_money} from {self_transfer_source_account} to {self_transfer_destination_account}.

  utter_transfer_failed:
    - text: Something went wrong. Couldn't complete the transfer.

  utter_transfer_completed:
    - text: Successfully transferred {amount_of_money} to {recipient_account}.

  utter_transfer_cancelled:
    - text: Transfer cancelled.

  utter_schedule_transaction_complete:
    - text: Transfer is scheduled.

  utter_recurring_payment_setup_complete:
    - text: Your payment has been set up.

  utter_recurring_payment_setup_failed:
      - text: Sorry, your payment could not be set up.

  utter_recurring_payment_setup_failed_handover:
    - text: Let me connect you to an agent, to get the details of what happened to your payment.

  utter_recurring_payment_setup_cancelled:
      - text: Your payment has been cancelled.
