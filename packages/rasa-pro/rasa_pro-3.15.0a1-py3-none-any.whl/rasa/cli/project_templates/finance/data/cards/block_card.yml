flows:
  block_card:
    description: Applies a permanent or temporary block to stolen, lost or compromised banking cards.
    name: block card
    steps:
      - action: utter_start_block_card

      - id: get_bank_card_number
        collect: bank_card_number
        description: The number of the card user wants to block
        ask_before_filling: true

      - action: check_that_card_exists
        next:
          - if: not slots.return_value
            then:
              - action: utter_bank_card_not_found
                next: get_bank_card_number
          - else: permanent_or_temporary_block

      - id: permanent_or_temporary_block
        collect: card_block_type
        description: Indicates if the user wants a temporary or permanent block on their card.

      - id: confirm_block_card
        collect: confirmation
        description: "Confirms the request for card blocking; accepts True or False, yes or no."
        utter: utter_ask_block_card_confirmation
        ask_before_filling: true
        next:
          - if: not slots.confirmation
            then:
              - action: utter_block_card_cancelled
                next: END
          - if: slots.card_block_type is "permanent"
            then: execute_permanent_block
          - else: execute_temporary_freeze

      - id: execute_permanent_block
        action: utter_block_card_successful
        next: END

      - id: execute_temporary_freeze
        action: utter_freeze_card_successful
        next: END
