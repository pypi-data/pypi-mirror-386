Metadata-Version: 2.4
Name: fc-code-interpreter-mcp-server
Version: 0.0.6
Summary: Code Interpreter MCP Server - Secure code execution via E2B on Function Compute (stdio transport)
Project-URL: Homepage, https://github.com/your-org/fc-code-interpreter-mcp-server
Project-URL: Repository, https://github.com/your-org/fc-code-interpreter-mcp-server
Project-URL: Bug Tracker, https://github.com/your-org/fc-code-interpreter-mcp-server/issues
Project-URL: Documentation, https://github.com/your-org/fc-code-interpreter-mcp-server#readme
Author: Sandbox Team
License: Apache-2.0
License-File: LICENSE
Keywords: code-interpreter,e2b,function-compute,mcp,sandbox
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: Apache Software License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.10
Requires-Dist: alibabacloud-credentials-api>=1.0.0
Requires-Dist: alibabacloud-credentials>=1.0.2
Requires-Dist: alibabacloud-endpoint-util>=0.0.4
Requires-Dist: alibabacloud-fc20230330>=4.2.7
Requires-Dist: alibabacloud-gateway-spi>=0.0.3
Requires-Dist: alibabacloud-openapi-util>=0.2.2
Requires-Dist: alibabacloud-tea-openapi>=0.3.16
Requires-Dist: alibabacloud-tea-util>=0.3.13
Requires-Dist: alibabacloud-tea>=0.4.3
Requires-Dist: attrs>=25.3.0
Requires-Dist: certifi>=2025.7.14
Requires-Dist: charset-normalizer>=3.4.2
Requires-Dist: e2b>=0.0.0
Requires-Dist: httpcore>=1.0.9
Requires-Dist: httpx>=0.28.1
Requires-Dist: idna>=3.10
Requires-Dist: mcp>=1.0.0
Requires-Dist: packaging>=23.0
Requires-Dist: protobuf>=5.29.5
Requires-Dist: pydantic>=2.10.2
Requires-Dist: python-dateutil>=2.8.0
Requires-Dist: python-dotenv>=1.0.1
Requires-Dist: requests>=2.31.0
Requires-Dist: six>=1.16.0
Requires-Dist: typing-extensions>=4.14.1
Requires-Dist: urllib3>=2.5.0
Provides-Extra: dev
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Description-Content-Type: text/markdown

# Sandbox Code Interpreter MCP Server (SSE)

åŸºäº SSE (Server-Sent Events) åè®®çš„ MCP æœåŠ¡å™¨ï¼Œæ”¯æŒé€šè¿‡ E2B SDK è¿›è¡Œå®‰å…¨çš„ä»£ç æ‰§è¡Œã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨ Sandbox Docker æœåŠ¡

```bash
# å¯åŠ¨æœ¬åœ° sandbox
docker-compose up -d

# éªŒè¯æœåŠ¡è¿è¡Œ
curl http://localhost:5001/health
```

**é¢„æœŸè¾“å‡º**: `{"status":"healthy"}`

### 2. å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ UV (æ¨è)
uv install

# æˆ–ä½¿ç”¨ pip
pip install -e .
```

### 3. å¯åŠ¨ SSE æœåŠ¡å™¨

```bash
# æ–¹å¼ 1: ä½¿ç”¨ Make (æ¨è)
make run

# æ–¹å¼ 2: ç›´æ¥è¿è¡Œ
uv run sandbox-mcp-server

# æ–¹å¼ 3: æŒ‡å®šé…ç½®
SANDBOX_URL=http://localhost:5001 MCP_PORT=3000 uv run sandbox-mcp-server

# æ–¹å¼ 4: å¸¦ Inspector è°ƒè¯•
make debug
```

æœåŠ¡å™¨å°†åœ¨ `http://0.0.0.0:3000` å¯åŠ¨ï¼Œæä¾›ä»¥ä¸‹ç«¯ç‚¹ï¼š
- **SSE ç«¯ç‚¹**: `http://localhost:3000/sse`
- **æ¶ˆæ¯ç«¯ç‚¹**: `http://localhost:3000/messages`

### 4. é…ç½®ç¯å¢ƒå˜é‡ (å¯é€‰)

åˆ›å»º `.env` æ–‡ä»¶æˆ–è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# Sandbox é…ç½®
SANDBOX_URL=http://localhost:5001    # æœ¬åœ° sandbox åœ°å€

# MCP æœåŠ¡å™¨é…ç½®
MCP_HOST=0.0.0.0                      # ç›‘å¬åœ°å€
MCP_PORT=3000                         # æœåŠ¡ç«¯å£
LOG_LEVEL=INFO                        # æ—¥å¿—çº§åˆ«

# AgentRun äº‘æœåŠ¡ (å¯é€‰)
AGENTRUN_ACCESS_KEY_ID=your_key
AGENTRUN_ACCESS_KEY_SECRET=your_secret
AGENTRUN_ACCOUNT_ID=your_account
AGENTRUN_REGION=cn-hangzhou
```

## ğŸ” æµ‹è¯•æœåŠ¡å™¨

### ä½¿ç”¨ MCP Inspector

```bash
# å¯åŠ¨ Inspector è¿æ¥åˆ° SSE æœåŠ¡å™¨
npx @modelcontextprotocol/inspector http://localhost:3000/sse
```

### ä½¿ç”¨ curl æµ‹è¯•

```bash
# æµ‹è¯• SSE ç«¯ç‚¹
curl -N http://localhost:3000/sse

# æµ‹è¯•å¥åº·çŠ¶æ€ï¼ˆå¦‚æœæœ‰å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼‰
curl http://localhost:3000/health
```

## ğŸ“‹ å¯ç”¨å·¥å…·

1. **create_context** - åˆ›å»ºä»£ç æ‰§è¡Œä¸Šä¸‹æ–‡
   ```json
   {
     "name": "my-context",
     "language": "python",
     "description": "Python execution context"
   }
   ```

2. **run_code** - æ‰§è¡Œä»£ç 
   ```json
   {
     "context_id": "ctx-xxx",
     "code": "print('Hello World')"
   }
   ```

3. **list_contexts** - åˆ—å‡ºæ‰€æœ‰ä¸Šä¸‹æ–‡
   ```json
   {}
   ```

4. **stop_context** - åœæ­¢ä¸Šä¸‹æ–‡
   ```json
   {
     "context_id": "ctx-xxx"
   }
   ```

## âš™ï¸ é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡

| å˜é‡ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `SANDBOX_BASE_URL` | `http://localhost:8080` | Sandbox æœåŠ¡åœ°å€ |
| `SANDBOX_TIMEOUT` | `30` | è¯·æ±‚è¶…æ—¶ï¼ˆç§’ï¼‰ |
| `SESSION_POOL_SIZE` | `3` | Session æ± å¤§å° |
| `SESSION_LIFETIME_HOURS` | `6` | Session ç”Ÿå‘½å‘¨æœŸï¼ˆå°æ—¶ï¼‰ |
| `MCP_HOST` | `0.0.0.0` | MCP æœåŠ¡å™¨ç›‘å¬åœ°å€ |
| `MCP_PORT` | `3000` | MCP æœåŠ¡å™¨ç«¯å£ |
| `LOG_LEVEL` | `INFO` | æ—¥å¿—çº§åˆ« |

## ğŸ”§ ä¸ Claude Desktop é›†æˆ

åœ¨ Claude Desktop é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "sandbox": {
      "command": "uv",
      "args": [
        "--directory",
        "/path/to/sandbox-code-interpreter-mcp-server",
        "run",
        "python",
        "-m",
        "mcp_server"
      ],
      "env": {
        "SANDBOX_BASE_URL": "http://localhost:8080",
        "MCP_HOST": "localhost",
        "MCP_PORT": "3000"
      }
    }
  }
}
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ¨¡å—å¯¼å…¥é”™è¯¯

```bash
# ç¡®ä¿ä¾èµ–å·²å®‰è£…
uv sync

# æˆ–æ‰‹åŠ¨å®‰è£…ä¾èµ–
pip install mcp python-dotenv requests pydantic starlette uvicorn
```

### é—®é¢˜ 2: ç«¯å£è¢«å ç”¨

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3000

# ä½¿ç”¨å…¶ä»–ç«¯å£
MCP_PORT=3001 uv run python -m mcp_server
```

### é—®é¢˜ 3: æ— æ³•è¿æ¥åˆ° Sandbox

```bash
# æ£€æŸ¥ Docker å®¹å™¨çŠ¶æ€
docker ps | grep sandbox-code-interpreter

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs sandbox-code-interpreter

# é‡å¯å®¹å™¨
docker-compose restart
```

### é—®é¢˜ 4: Session åˆå§‹åŒ–å¤±è´¥

```bash
# æ£€æŸ¥é…ç½®
echo $SANDBOX_BASE_URL

# æµ‹è¯•è¿æ¥
curl http://localhost:8080/health

# é™ä½ session æ± å¤§å°
SESSION_POOL_SIZE=1 uv run python -m mcp_server
```

## ğŸ“Š æ—¥å¿—è¾“å‡º

æœåŠ¡å™¨å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š

```
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - ============================================================
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Local Sandbox MCP Server (SSE) Starting...
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - ============================================================
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Configuration:
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO -   - Sandbox URL: http://localhost:8080
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO -   - Timeout: 30s
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO -   - Session pool size: 3
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO -   - Session lifetime: 6h
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Initializing local sandbox integration...
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - âœ… Connected to sandbox at http://localhost:8080
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Created session 1/3: sess-xxx
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Created session 2/3: sess-yyy
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Created session 3/3: sess-zzz
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - âœ… Session pool initialized with 3 sessions
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - âœ… Local sandbox integration initialized
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Server initialization complete
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Mode: Local Sandbox
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - ============================================================
2025-10-22 19:53:00 - sandbox-mcp-sse - INFO - Starting SSE server on http://0.0.0.0:3000
INFO:     Started server process [12345]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:3000 (Press CTRL+C to quit)
```

## ğŸ†š stdio vs SSE å¯¹æ¯”

| ç‰¹æ€§ | stdio | SSE |
|------|-------|-----|
| **ä¼ è¾“æ–¹å¼** | æ ‡å‡†è¾“å…¥è¾“å‡º | HTTP |
| **è°ƒè¯•éš¾åº¦** | å›°éš¾ | ç®€å• |
| **ç½‘ç»œè®¿é—®** | ä»…æœ¬åœ° | æ”¯æŒè¿œç¨‹ |
| **æµè§ˆå™¨æµ‹è¯•** | ä¸æ”¯æŒ | æ”¯æŒ |
| **æ—¥å¿—æŸ¥çœ‹** | æ··åœ¨ä¸€èµ· | ç‹¬ç«‹ |
| **è¿æ¥æ–¹å¼** | è¿›ç¨‹ç®¡é“ | HTTP è¯·æ±‚ |

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Session ç®¡ç†å™¨](mcp_server/session_manager.py)
- [æœ¬åœ° Sandbox å®¢æˆ·ç«¯](mcp_server/local_sandbox_client.py)
- [SSE æœåŠ¡å™¨å®ç°](mcp_server/server_sse.py)
- [Docker Compose é…ç½®](docker-compose.yml)
- [æœ¬åœ°è¿ç§»æŒ‡å—](docs/LOCAL_SANDBOX_MIGRATION.md)

## âœ… éªŒè¯æ¸…å•

- [ ] Docker å®¹å™¨è¿è¡Œæ­£å¸¸
- [ ] Sandbox å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] Python ä¾èµ–å·²å®‰è£…
- [ ] SSE æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- [ ] Session æ± åˆå§‹åŒ–å®Œæˆ
- [ ] MCP Inspector å¯ä»¥è¿æ¥
- [ ] å¯ä»¥åˆ›å»º context
- [ ] å¯ä»¥æ‰§è¡Œä»£ç 
- [ ] å¯ä»¥åˆ—å‡º contexts

---

**Happy coding with SSE! ğŸ‰**
