from typing import ClassVar

from ocsf.events.findings.finding import Finding
from ocsf.objects.resource_details import ResourceDetails
from ocsf.objects.vulnerability import Vulnerability


class VulnerabilityFinding(Finding):
    allowed_profiles: ClassVar[list[str]] = ["incident", "cloud", "datetime", "host", "osint", "security_control"]
    class_name: str = "Vulnerability Finding"
    class_uid: int = 2002
    schema_name: ClassVar[str] = "vulnerability_finding"

    # Required
    vulnerabilities: list[Vulnerability]

    # Recommended
    resource: ResourceDetails | None = None
    resources: list[ResourceDetails] | None = None
