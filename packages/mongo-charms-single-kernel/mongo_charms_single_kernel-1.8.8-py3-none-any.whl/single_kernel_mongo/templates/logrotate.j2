{{logs_directory}}/mongodb.log
{
    rotate {{max_rotations}}
    size {{max_log_size}}
    missingok
    notifempty
    create 0600 {{mongo_user}} {{mongo_user}}
    compress
    delaycompress
    nomail
    nocopytruncate
    sharedscripts
    postrotate
        uri={{get_uri}}
        {{shell}} ${uri} --quiet --eval "db.adminCommand({logRotate: 'server'})"
    endscript
}
{{logs_directory}}/audit.log
{
    rotate {{max_rotations}}
    size {{max_log_size}}
    missingok
    notifempty
    create 0600 {{mongo_user}} {{mongo_user}}
    compress
    delaycompress
    nomail
    nocopytruncate
    sharedscripts
    postrotate
        uri={{get_uri}}
        {{shell}} ${uri} --quiet --eval "db.adminCommand({logRotate: 'audit'})"
    endscript
}
