[project]
name = "wbcore"
description = ""
authors = [{ name = "Christopher Wittlinger", email = "c.wittlinger@stainly.com"}]
dynamic = ["version"]

dependencies = [
  # Database Depenendencies
  "redis == 4.*",
  "psycopg[binary] == 3.*",

  # Generic Python Dependencies
  "python-slugify == 8.*",
  "requests == 2.*",
  "inscriptis == 1.*",   # TODO: Discuss if really needed

  # Django Dependencies
  "django == 5.0.*",
  "django-configurations[database] == 2.5.*",
  "django-dynamic-preferences == 1.16.*",
  "django-filter == 24.*",
  "django-extensions == 3.2.*",
  "django-cors-headers == 4.6.*",
  "django-storages[boto3] == 1.14.*",
  "django-fsm == 2.*",  # Locked at 2.*, since 3 only adds the deprecation warning for removal
  "django-ordered-model == 3.7.*",

  # Django Rest Framework Dependencies
  "djangorestframework == 3.15.*",
  "djangorestframework-simplejwt == 5.*",
  "pyjwt == 2.*",
  "django-rest-fuzzysearch == 0.5.*",

  # Background and Periodic Tasks
  "celery[redis] == 5.*",
  "django-celery-beat == 2.*",

  # Model Object Permissions
  "django-guardian == 2.4.*",
  "djangorestframework-guardian == 0.3.*",

  # Revision System
  "django-reversion == 5.1.*",
  "django-reversion-compare == 0.18.*",

  # Visualization
  "plotly == 5.*",

  # Markdown
  "markdown >= 3.8",
  "markdown-blockdiag",

  # Terminal Formatting and Utils
  "tqdm == 4.*",
  "prettytable == 0.*",
  "igraph == 0.*",
  "openpyxl == 3.*",

  "django-colorfield == 0.11.*",
  "django-better-admin-arrayfield == 1.4.*",
  "django-picklefield == 3.*",

  "firebase-admin == 6.*",

  "fabric == 3.2.*",

  "croniter == 2.*",
  "python-magic == 0.*",
  "django-import-export == 4.*",
  "django-admin-inline-paginator == 0.4.0",
  "django-anymail == 12.*",
  "pytest-sftpserver == 1.*",
  "django-mptt == 0.*",
  "pycountry == 23.*",
  "phonenumbers == 8.*",
  "schwifty == 2024.*",  "ics == 0.*",
  "tatsu == 5.*",
  "boto3 == 1.35.*",

  "faker == 25.*",       # We add exlicitly faker because it's used in production
  "graphviz == 0.*",
  "django-maintenance-mode == 0.21.*",
  "rstr == 3.2.*", # We add exlicitly faker because it's used in production
  "langchain >= 0.3",
  "langchain-openai >= 0.3",
  "django-modeltrans >= 0.8",
  "weasyprint == 65.*",
  "pillow==11.*",
  "humanize==4.*"
]

[project.optional-dependencies]
pandas = [
  # Datascience
  "numpy == 1.*",
  "pandas == 2.2.*",
]

[tool.uv.sources]
markdown-blockdiag = { git = "https://github.com/gisce/markdown-blockdiag", tag="v0.9.0" }

[tool.uv]
package = true

[tool.hatch.version]
path = "../../pyproject.toml"

[tool.hatch.build]
include = [
  "wbcore/**/*",
]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.pyright]
venvPath = "../.."
venv = ".venv"
reportIncompatibleVariableOverride = false

[tool.pytest.ini_options]
DJANGO_SETTINGS_MODULE = "wbcore_config.settings"
DJANGO_CONFIGURATION = "Test"
addopts = "--nomigrations --cov=. --cov-report=html --cov-report=xml --cov-report=term-missing:skip-covered"
python_files = ["tests.py", "test_*.py", "*_tests.py"]

markers = [
    "with_db: marks tests that use a testing database",
    "model_tests: marks tests for the models in the directory package",
    "serializer_tests: marks tests that are specifically for serializers",
    "viewset_tests: marks tests that are specifically for viewsets"
]
