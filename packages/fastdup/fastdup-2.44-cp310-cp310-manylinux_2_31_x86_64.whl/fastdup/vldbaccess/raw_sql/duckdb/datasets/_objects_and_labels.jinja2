        SELECT
            objects_to_images.object_id,
            list_distinct(list(CASE WHEN labels.source = 'USER' THEN labels.category_display_name END)) AS labels,
            list_distinct(list(CASE WHEN labels.source = 'VL' THEN labels.category_display_name END)) AS vl_labels
        FROM labels
        JOIN objects_to_images ON objects_to_images.object_id = labels.id
        WHERE labels.category_display_name is not NULL
        AND labels.dataset_id = :dataset_id
        AND objects_to_images.dataset_id = :dataset_id
        GROUP BY objects_to_images.object_id
