        SELECT
            objects_to_images.object_id,
            array_remove(array_agg(CASE WHEN labels.source = 'USER' THEN labels.category_display_name ELSE NULL END), NULL) AS labels,
            array_remove(array_agg(CASE WHEN labels.source = 'VL' THEN labels.category_display_name ELSE NULL END), NULL) AS vl_labels
        FROM
            objects_to_images,
            labels
        WHERE
            objects_to_images.object_id = labels.id
            AND objects_to_images.dataset_id = :dataset_id
            AND labels.dataset_id = :dataset_id
        GROUP BY
            objects_to_images.object_id
