import{_ as U,r as i,c as w,a as o,w as l,E as O,o as J,b as _,d as p,t as x,e as r,f as C,g as M,h as S,i as V,j as k}from"./index-BAPaOAUA.js";const T={class:"converter-container"},j={class:"result-actions"},F={__name:"M3u2Json",setup(B){const d=i(""),n=i(""),c=i(!1),v=i(null),b=s=>{const e=new FileReader;return e.onload=t=>{d.value=t.target.result,r.success("文件加载成功")},e.onerror=()=>{r.error("文件加载失败")},e.readAsText(s),!1},y=()=>{if(!d.value.trim()){r.warning("请输入或上传 M3U 内容");return}c.value=!0;try{const s=d.value.split(`
`),e=[];let t="";s.forEach(a=>{if(a=a.trim(),a.startsWith("#EXTINF:")){const u=a.match(/#EXTINF:.*,(.+)/);u&&u[1]&&(t=u[1])}else a&&a.startsWith("http")&&t&&(e.push({name:t,type:"radio",url:a}),t="")});const m=[{name:"m3u电台",musics:e}];n.value=JSON.stringify(m,null,2),r.success(`成功转换 ${e.length} 个电台`)}catch(s){r.error("转换失败："+s.message),console.error("转换错误：",s)}finally{c.value=!1}},h=async()=>{try{await navigator.clipboard.writeText(n.value),r.success("结果已复制到剪贴板")}catch(s){r.error("复制失败，请手动复制"),console.error("复制错误：",s)}},N=()=>{const s=new Blob([n.value],{type:"application/json"}),e=URL.createObjectURL(s),t=document.createElement("a");t.href=e,t.download="m3u_converted.json",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e),r.success("JSON 文件已下载")};return(s,e)=>{const t=C,m=M,a=S,u=V,g=k,E=O;return J(),w("div",T,[o(E,{class:"converter-card"},{header:l(()=>e[2]||(e[2]=[_("div",{class:"card-header"},[_("span",null,"M3U 到 JSON 转换器")],-1)])),default:l(()=>[o(g,{size:"large"},{default:l(()=>[o(a,{label:"文件上传"},{default:l(()=>[o(m,{ref_key:"upload",ref:v,class:"upload-demo",accept:".m3u","show-file-list":!1,"before-upload":b,"auto-upload":!0},{default:l(()=>[o(t,{type:"primary"},{default:l(()=>e[3]||(e[3]=[p("选择 M3U 文件")])),_:1})]),_:1},512)]),_:1}),o(a,{label:"M3U 内容"},{default:l(()=>[o(u,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=f=>d.value=f),type:"textarea",rows:6,placeholder:"粘贴 M3U 内容或上传文件...",resize:"both"},null,8,["modelValue"])]),_:1}),o(a,null,{default:l(()=>[o(t,{type:"primary",class:"convert-button",onClick:y,loading:c.value},{default:l(()=>[p(x(c.value?"转换中...":"转换"),1)]),_:1},8,["loading"])]),_:1}),o(a,{label:"JSON 结果"},{default:l(()=>[o(u,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=f=>n.value=f),type:"textarea",rows:6,placeholder:"转换后的 JSON 将显示在这里...",resize:"both"},null,8,["modelValue"]),_("div",j,[o(t,{type:"default",onClick:h,disabled:!n.value},{default:l(()=>e[4]||(e[4]=[p(" 复制结果 ")])),_:1},8,["disabled"]),o(t,{type:"default",onClick:N,disabled:!n.value},{default:l(()=>e[5]||(e[5]=[p(" 下载 JSON 文件 ")])),_:1},8,["disabled"])])]),_:1})]),_:1})]),_:1})])}}},R=U(F,[["__scopeId","data-v-ae3a051e"]]);export{R as default};
