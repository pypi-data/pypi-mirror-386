# SSH PAM Manager

ä¸€ä¸ªç”¨äºç®¡ç†Linuxç³»ç»ŸSSH PAMé…ç½®çš„Pythonå·¥å…·ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“– **é…ç½®è¯»å–**: æŸ¥çœ‹å½“å‰SSH PAMé…ç½®
- âœï¸ **é…ç½®ä¿®æ”¹**: ä¿®æ”¹ç°æœ‰çš„PAMé…ç½®é¡¹
- â• **é…ç½®æ·»åŠ **: æ·»åŠ æ–°çš„PAMé…ç½®è§„åˆ™
- ğŸ—‘ï¸ **é…ç½®åˆ é™¤**: åˆ é™¤ä¸éœ€è¦çš„PAMé…ç½®
- ğŸ”’ **å®‰å…¨éªŒè¯**: éªŒè¯PAMé…ç½®çš„å®‰å…¨æ€§å’Œæ­£ç¡®æ€§
- ğŸ’¾ **è‡ªåŠ¨å¤‡ä»½**: ä¿®æ”¹å‰è‡ªåŠ¨å¤‡ä»½åŸé…ç½®
- ğŸ–¥ï¸ **äº¤äº’ç•Œé¢**: å‹å¥½çš„å‘½ä»¤è¡Œäº¤äº’ç•Œé¢

## å®‰è£…

### ä»æºç å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://gitee.com/liumou_site/ssh-pam-management.git
cd ssh-pam-management

# å®‰è£…åˆ°ç³»ç»Ÿ
pip3 install .

# æˆ–è€…ä½¿ç”¨å¼€å‘æ¨¡å¼
pip3 install -e .
```

### ä»PyPIå®‰è£…ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰

```bash
pip3 install ssh-pam-manager
```

## ä½¿ç”¨æ–¹æ³•

### äº¤äº’å¼ç•Œé¢

```bash
# å¯åŠ¨äº¤äº’å¼ç•Œé¢
ssh-pam-manager
```

### å‘½ä»¤è¡Œæ¨¡å¼

```bash
# æŸ¥çœ‹å½“å‰é…ç½®
ssh-pam-manager --view

# éªŒè¯é…ç½®å®‰å…¨æ€§
ssh-pam-manager --validate

# æŒ‡å®šè‡ªå®šä¹‰é…ç½®æ–‡ä»¶è·¯å¾„
ssh-pam-manager --config /etc/pam.d/sshd --view

# æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯
ssh-pam-manager --version
```

## é¡¹ç›®ç»“æ„

```
ssh-pam-manager/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ ssh_pam_manager/
â”‚       â”œâ”€â”€ __init__.py          # åŒ…åˆå§‹åŒ–
â”‚       â”œâ”€â”€ main.py              # ä¸»å…¥å£ç‚¹
â”‚       â”œâ”€â”€ pam_parser.py        # PAMé…ç½®è§£æå™¨
â”‚       â”œâ”€â”€ pam_manager.py       # PAMé…ç½®ç®¡ç†å™¨
â”‚       â”œâ”€â”€ cli_interface.py     # å‘½ä»¤è¡Œäº¤äº’ç•Œé¢
â”‚       â””â”€â”€ config_validator.py  # é…ç½®éªŒè¯å™¨
â”œâ”€â”€ pyproject.toml               # ç°ä»£æ‰“åŒ…é…ç½®
â”œâ”€â”€ setup.py                    # å…¼å®¹æ€§æ‰“åŒ…é…ç½®
â”œâ”€â”€ README.md                   # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ LICENSE                     # è®¸å¯è¯æ–‡ä»¶
```

## æ¨¡å—è¯´æ˜

### pam_parser.py
- **PAMParserç±»**: è´Ÿè´£è§£æPAMé…ç½®æ–‡ä»¶æ ¼å¼
- æ”¯æŒè§£ææ ‡å‡†çš„PAMé…ç½®è¡Œæ ¼å¼
- å¤„ç†æ³¨é‡Šå’Œç©ºè¡Œ

### pam_manager.py  
- **PAMManagerç±»**: æ ¸å¿ƒé…ç½®ç®¡ç†åŠŸèƒ½
- æä¾›é…ç½®çš„è¯»å–ã€ä¿®æ”¹ã€æ·»åŠ ã€åˆ é™¤æ“ä½œ
- è‡ªåŠ¨å¤‡ä»½æœºåˆ¶ç¡®ä¿æ“ä½œå®‰å…¨

### cli_interface.py
- **CLIInterfaceç±»**: ç”¨æˆ·äº¤äº’ç•Œé¢
- æä¾›èœå•é©±åŠ¨çš„å‘½ä»¤è¡Œæ“ä½œ
- æ”¯æŒé…ç½®é¢„è§ˆå’Œç¡®è®¤

### config_validator.py
- **ConfigValidatorç±»**: é…ç½®éªŒè¯åŠŸèƒ½
- éªŒè¯PAMé…ç½®çš„åˆæ³•æ€§å’Œå®‰å…¨æ€§
- æ£€æµ‹æ½œåœ¨çš„å®‰å…¨é£é™©

## PAMé…ç½®æ ¼å¼

å·¥å…·æ”¯æŒæ ‡å‡†çš„PAMé…ç½®æ ¼å¼ï¼š

```
ç±»å‹    æ§åˆ¶æ ‡å¿—    æ¨¡å—    å‚æ•°
```

ç¤ºä¾‹ï¼š
```
auth    required    pam_unix.so    nullok
auth    optional    pam_echo.so    file=/etc/issue
```

## æƒé™è¦æ±‚

ç”±äºPAMé…ç½®æ–‡ä»¶é€šå¸¸ä½äº`/etc/pam.d/`ç›®å½•ä¸‹ï¼Œéœ€è¦rootæƒé™æ‰èƒ½ä¿®æ”¹ï¼š

```bash
sudo ssh-pam-manager
```

æˆ–è€…ï¼š

```bash
sudo ssh-pam-manager --view
```

## å¼€å‘

### è®¾ç½®å¼€å‘ç¯å¢ƒ

```bash
# å…‹éš†é¡¹ç›®
git clone https://gitee.com/liumou_site/ssh-pam-management.git
cd ssh-pam-management

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…å¼€å‘ä¾èµ–
pip install -e .
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡ŒåŸºæœ¬åŠŸèƒ½æµ‹è¯•
python -m pytest tests/

# è¿è¡Œä»£ç é£æ ¼æ£€æŸ¥
flake8 src/

# è¿è¡Œç±»å‹æ£€æŸ¥
mypy src/
```

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦è§[LICENSE](LICENSE)æ–‡ä»¶ã€‚

## å…è´£å£°æ˜

æ­¤å·¥å…·ç”¨äºç³»ç»Ÿç®¡ç†ç›®çš„ã€‚åœ¨ä½¿ç”¨å‰è¯·ç¡®ä¿ï¼š

1. ç†è§£PAMé…ç½®çš„å·¥ä½œåŸç†
2. åœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯é…ç½®æ›´æ”¹
3. å¤‡ä»½é‡è¦çš„ç³»ç»Ÿé…ç½®æ–‡ä»¶
4. äº†è§£ä¿®æ”¹PAMé…ç½®å¯èƒ½å¸¦æ¥çš„å®‰å…¨å½±å“

ä½œè€…å¯¹ä½¿ç”¨æ­¤å·¥å…·é€ æˆçš„ä»»ä½•ç³»ç»Ÿé—®é¢˜ä¸æ‰¿æ‹…è´£ä»»ã€‚
