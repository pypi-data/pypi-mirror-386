import"../chunks/disclose-version.Bg9kRutz.js";import{a as ft,e as I,r as q,p as _t,g as e,f as A,b as i,d as lt,h as F,u as yt,s as vt}from"../chunks/runtime.Qq3DoWX7.js";import{q as pt,u as wt,f as R,s as L,n as p,v as a,g as J,a as z,i as rt,k as bt,c as B,t as ct,d as xt,e as V,b as D,w as ot,x as K,o as kt}from"../chunks/render.DzT6dLEH.js";import{e as Q}from"../chunks/load.BJVQ2rZi.js";import{N as Mt,l as Pt,h as St}from"../chunks/data.LD-exH1K.js";async function Bt(){const k=document.getElementById("chart"),d=new XMLSerializer().serializeToString(k);try{await navigator.clipboard.writeText(d),window.alert("SVG text copied to clipboard")}catch{console.log(d),window.alert("SVG text printed to DEV console (clipboard API not available)")}}var zt=ot('<rect stroke="black"><title> </title></rect>'),Vt=ot("<text> </text>"),Dt=ot("<text> </text>"),Ot=xt('<div class="relative h-[calc(100vh-44px)] w-auto text-blue-700"><svg id="chart" version="1.1" class="block h-full m-auto"><rect fill="white"></rect><!><!><!></svg> <button class="absolute m-2 top-0 right-0" title="Copy SVG text to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div>');function Ct(k,d){ft(d,!0);const f=I(d,"margin",3,2),O=I(d,"labelPadding",3,1.5),C=I(d,"fontSize",3,2),N=I(d,"transpose",3,!0),U=I(d,"color",3,"rgb(29, 78, 216)");function M(r){const s=new Set,x=new Set,t=new Map;for(let{x:_,y,v:u}of r){if(N()){const n=y;y=_,_=n}s.add(_),x.add(y),t.set(_+" /// "+y,u)}const g=[...s].toSorted(),l=[...x].toSorted(),o=Math.min(...t.values())-1e-5,c=Math.max(...t.values());return{xs:g,ys:l,values:t,v_min:o,v_max:c}}const v=lt(()=>M(d.data));let P=A(0),m=A(0),h=A(10),S=A(10);function dt(r){let s=0,x=0,t=10,g=10;for(const l of r.children){const{x:o,y:c,width:_,height:y}=l.getBBox();let u=DOMPoint.fromPoint({x:o,y:c}),n=DOMPoint.fromPoint({x:o+_,y:c+y}),w=DOMPoint.fromPoint({x:o+_,y:c}),b=DOMPoint.fromPoint({x:o,y:c+y});for(const at of l.transform.baseVal){const{a:G,b:j,c:X,d:E,e:ut,f:ht}=at.matrix,Y=new DOMMatrixReadOnly([G,j,X,E,ut,ht]);u=Y.transformPoint(u),n=Y.transformPoint(n),w=Y.transformPoint(w),b=Y.transformPoint(b)}s=Math.min(s,u.x,n.x,w.x,b.x),x=Math.min(x,u.y,n.y,w.y,b.y),t=Math.max(t,u.x,n.x,w.x,b.x),g=Math.max(g,u.y,n.y,w.y,b.y)}F(P,K(s)),F(m,K(x)),F(h,K(t)),F(S,K(g))}var nt=J(k,!0,Ot),T=z(nt),H=z(T),it=L(H),st=L(it),mt=L(st),gt=L(L(T,!0)),W,Z,$,tt,et;q(()=>{W!==(W=`${p(e(P)-f())} ${p(e(m)-f())} ${p(e(h)-e(P)+2*f())} ${p(e(S)-e(m)+2*f())}`)&&a(T,"viewBox",W),Z!==(Z=e(P)-f())&&a(H,"x",Z),$!==($=e(m)-f())&&a(H,"y",$),tt!==(tt=e(h)-e(P)+f()+f())&&a(H,"width",tt),et!==(et=e(S)-e(m)+f()+f())&&a(H,"height",et)}),wt(T,r=>dt(r)),Q(it,()=>e(v).xs,71,(r,s)=>i(r),(r,s,x)=>{var t=V(r),g=D(t);Q(g,()=>e(v).ys,71,(l,o)=>i(l),(l,o,c)=>{var _=V(l),y=D(_);rt(y,()=>e(v).values.get(i(s)+" /// "+i(o))!==void 0,u=>{var n=J(u,!0,zt);const w=lt(()=>(e(v).values.get(i(s)+" /// "+i(o))-e(v).v_min)/(e(v).v_max-e(v).v_min));a(n,"width",9),a(n,"height",9),a(n,"rc",1),a(n,"ry",1),a(n,"stroke-width",.05);var b=z(n),at=z(b);bt(at,()=>`v=${p(e(v).values.get(i(s)+" /// "+i(o)))} x=${p(i(s))} y=${p(i(o))}`);var G,j,X,E;q(()=>{G!==(G=i(x)*10)&&a(n,"x",G),j!==(j=i(c)*10)&&a(n,"y",j),X!==(X=U())&&a(n,"fill",X),E!==(E=e(w))&&a(n,"fill-opacity",E)}),R(u,n)},null),B(l,_)},null),B(r,t)},null),Q(st,()=>e(v).xs,71,(r,s)=>i(r),(r,s,x)=>{var t=J(r,!0,Vt),g=z(t),l,o,c,_;q(()=>{l!==(l=i(x)*10+4.5)&&a(t,"x",l),o!==(o=-O())&&a(t,"y",o),c!==(c=C())&&a(t,"font-size",c),_!==(_=`rotate(-30, ${p(i(x)*10+4.5)}, ${p(-O())})`)&&a(t,"transform",_),ct(g,i(s))}),R(r,t)},null),Q(mt,()=>e(v).ys,71,(r,s)=>i(r),(r,s,x)=>{var t=J(r,!0,Dt),g=z(t),l,o,c;q(()=>{l!==(l=e(v).xs.length*10+O())&&a(t,"x",l),o!==(o=i(x)*10+5)&&a(t,"y",o),c!==(c=C())&&a(t,"font-size",c),ct(g,i(s))}),R(r,t)},null),gt.__click=[Bt],R(k,nt),_t()}pt(["click"]);var Ht=xt("Loading..",!0);function Lt(k,d){ft(d,!1);const f={};yt(f);const O=()=>vt(Pt,"$loading",f),C=()=>vt(St,"$heatmap",f);var N=V(k),U=D(N);rt(U,O,M=>{var v=kt(M,!0,Ht);B(M,v)},M=>{var v=V(M),P=D(v);rt(P,()=>C().length===0,m=>{var h=V(m),S=D(h);Mt(S,{}),B(m,h)},m=>{var h=V(m),S=D(h);Ct(S,{get data(){return C()}}),B(m,h)}),B(M,v)}),B(k,N),_t()}export{Lt as component};
