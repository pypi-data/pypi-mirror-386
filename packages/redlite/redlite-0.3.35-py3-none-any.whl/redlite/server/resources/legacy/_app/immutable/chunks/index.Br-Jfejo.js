import{n as l,c as w}from"./runtime.Qq3DoWX7.js";const f=[];function m(e,n){return{subscribe:x(e,n).subscribe}}function q(e,n){return e!=e?n==n:e!==n||e&&typeof e=="object"||typeof e=="function"}function x(e,n=l){let o=null;const s=new Set;function c(r){if(q(e,r)&&(e=r,o)){const u=!f.length;for(const t of s)t[1](),f.push(t,e);if(u){for(let t=0;t<f.length;t+=2)f[t][0](f[t+1]);f.length=0}}}function a(r){c(r(e))}function b(r,u=l){const t=[r,u];return s.add(t),s.size===1&&(o=n(c,a)||l),r(e),()=>{s.delete(t),s.size===0&&o&&(o(),o=null)}}return{set:c,update:a,subscribe:b}}function z(e){return e()}function A(e){e.forEach(z)}function j(e,n,o){const s=!Array.isArray(e),c=s?[e]:e;if(!c.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=n.length<2;return m(o,(b,r)=>{let u=!1;const t=[];let p=0,d=l;const g=()=>{if(p)return;d();const i=n(s?t[0]:t,b,r);a?b(i):d=typeof i=="function"?i:l},h=c.map((i,y)=>w(i,_=>{t[y]=_,p&=~(1<<y),u&&g()},()=>{p|=1<<y}));return u=!0,g(),function(){A(h),d(),u=!1}})}export{j as d,x as w};
