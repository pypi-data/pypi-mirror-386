<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FMC Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
    <link href="{{ url_for('static', filename='css/overlay.css') }}" rel="stylesheet">
    {% block style %}{% endblock %}
    {% if error %}
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                let countdown = 5;
                const countdownElement = document.getElementById('countdown');

                const timer = setInterval(function () {
                    countdownElement.textContent = countdown;
                    countdown--;

                    if (countdown < 0) {
                        clearInterval(timer)
                        window.location.href = {% block forward_url %}"{{ url_for('fmc_login') }}"{% endblock %}
                    }
                }, 1000);
            });
        </script>
    {% endif %}
</head>
<body>
    <div class="container">
        <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
            <a href="{{ url_for('index') }}" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none" style="gap: 10px;">
                <svg width="142" height="28" viewBox="0 0 284 57" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_9403_1119)">
                        <path d="M262.11 31.92C262.79 28.5 265.47 26.25 268.89 26.25C272.31 26.25 274.89 28.56 275.38 31.92H262.11ZM269.27 50.75C274.75 50.75 279.39 48.47 281.78 44.48L275.27 40.9C273.91 42.8 271.77 43.67 269.38 43.67C265.47 43.67 262.81 41.28 262.11 37.97H283.19C283.35 37.07 283.46 35.91 283.46 34.71C283.46 25.7 277.25 19.22 268.73 19.22C260.21 19.22 253.81 25.57 253.81 34.93C253.81 44.29 259.62 50.75 269.28 50.75M239.99 49.94H248.32V6.52002H239.99V49.94ZM235.79 49.24L233.37 42.24C232.37 42.7 231.23 42.95 230.11 42.95C227.5 42.95 225.77 41.59 225.77 38.42V27.65H233.02L235.71 20.05H227.81L225.77 25.8V12.48H217.44V39.99C217.44 46.56 221.29 50.76 228.27 50.76C231.01 50.76 233.7 50.22 235.79 49.24ZM202.55 33.52V49.94H210.88V32.06C210.88 23.35 205.78 19.22 199.13 19.22C195.9 19.22 193 20.31 190.53 22.5V6.52002H182.2V49.94H190.53V29.56C192.24 28.07 194.38 27.23 196.91 27.23C200.52 27.23 202.55 29.35 202.55 33.53M169.58 50.75C172.46 50.75 175.2 50.04 177.48 48.74L174.47 41.39C173.17 42.37 171.54 42.88 169.8 42.88C165.4 42.88 162.12 39.6 162.12 34.98C162.12 30.36 165.27 27.08 169.72 27.08C171.51 27.08 173.08 27.62 174.36 28.57L177.43 21.22C175.12 19.92 172.41 19.18 169.53 19.18C160.52 19.18 153.71 26.05 153.71 34.97C153.71 43.89 160.58 50.74 169.58 50.74M128.19 31.92C128.87 28.5 131.55 26.25 134.97 26.25C138.39 26.25 140.97 28.56 141.46 31.92H128.19ZM135.36 50.75C140.84 50.75 145.48 48.47 147.87 44.48L141.36 40.9C140 42.8 137.86 43.67 135.47 43.67C131.56 43.67 128.9 41.28 128.2 37.97H149.28C149.44 37.07 149.55 35.91 149.55 34.71C149.55 25.7 143.34 19.22 134.82 19.22C126.3 19.22 119.9 25.57 119.9 34.93C119.9 44.29 125.71 50.75 135.37 50.75M92.9999 40.09V29.86C94.7599 28.12 97.0199 27.17 99.6999 27.17C104.26 27.17 107.08 29.94 107.08 34.96C107.08 39.98 104.26 42.78 99.6999 42.78C97.0099 42.78 94.7599 41.83 92.9999 40.09ZM102.06 50.73C110.26 50.73 115.49 44.05 115.49 34.96C115.49 25.87 110.25 19.22 102.06 19.22C98.5899 19.22 95.5499 20.41 92.9999 22.83V6.52002H84.6699V49.94H90.9099L92.1599 46.28C94.8699 49.26 98.2099 50.73 102.06 50.73Z" fill="#075033"></path>
                        <path d="M28.2199 0.0100098C26.5799 0.0100098 24.9799 0.16001 23.4299 0.42001L17.8799 16.55H45.9099C46.2299 16.55 46.4499 16.83 46.3399 17.13L32.9499 56.04C46.2899 53.79 56.4499 42.2 56.4499 28.22C56.4399 12.64 43.7999 0.0100098 28.2199 0.0100098Z" fill="#23A96A"></path>
                        <path d="M17.87 16.5601L10.03 39.3201C9.92997 39.6201 10.15 39.9301 10.47 39.9301H38.49L46.34 17.1401C46.44 16.8401 46.22 16.5601 45.91 16.5601H17.88H17.87Z" fill="white"></path>
                        <path d="M10.03 39.32L23.42 0.420044C10.16 2.73004 0 14.3 0 28.23C0 43.81 12.63 56.45 28.22 56.45C29.83 56.45 31.41 56.31 32.94 56.05L38.49 39.93H10.47C10.15 39.93 9.93 39.62 10.03 39.32Z" fill="#075033"></path>
                    </g>
                    <defs>
                    <clipPath id="clip0_9403_1119">
                        <rect width="283.46" height="56.44" fill="white" transform="translate(0 0.0100098)"></rect>
                    </clipPath>
                    </defs>
                </svg>
                <span class="fs-4">FMC Report</span>
            </a>
            <ul class="nav nav-pills">
                <li class="nav-item">
                    <a href="{{ url_for('index') }}" class="nav-link {% block index_active %}active{% endblock %}" aria-current="page">Lists</a>
                </li>
                <li class="nav-item">
                    <a href="{{ url_for('fmc_vpn') }}" class="nav-link {% block vpn_active %}{% endblock %}" aria-current="page">VPN</a>
                </li>
            </ul>
        </header>
    </div>
    <br>
    {% if error %}
        {% block error %}
            <div class="container">
                <h2>Error! Unable to connect to FMC!</h2>
                <h3>Please check the hostname, username and password!</h3>
                <h4>Also check the connection to the FMC!</h4>
                <p style="color: red">
                    You will be redirected to the login page in <span id="countdown">5</span> seconds...
                </p>
            </div>
        {% endblock %}
    {% else %}
    <div class="container">
    <div class="p-3 border rounded-3 shadow-sm h-100">

        <form action="{% block domain_action %}{{ url_for('index') }}{% endblock %}" method="POST" id="lists-form">
            <div class="mb-3">
                <label class="form-label" for="domain">Domain:</label><br>
                <select class="form-select" name="domain" id="domain">
                    {% for domain in domains %}
                        <option value="{{ domain.get("name") }}" {% if domain.get("name") == selected_domain %}selected{% endif %}>
                            {{ domain.get("name") }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <input class="btn btn-primary" type="submit" id="submit" name="submit" value="Show Lists">
            </div>
        </form>
    </div>
    </div>
        {% block access_prefilter %}
    <div id="or_container" class="container mt-4">
    <div class="row g-3 justify-content-center">
        <div class="col-12 col-md-5">
        <div class="p-3 border rounded-3 shadow-sm h-100">

        <form action="{{ url_for('fmc_tables') }}" method="POST" id="access-form">
            <div class="mb-3">
                <label class="form-label" for="access_lists">Access List:</label><br>
                <select class="form-select" name="access_lists" id="access_lists">
                    {% for access_policy in access_policy_list %}
                        <option value="{{ access_policy.get("id") }}" {% if access_policy.get("id") == selected_access_list %}selected{% endif %}>
                            {{ access_policy.get("name") }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <input class="btn btn-primary" type="submit" id="submit" name="submit" value="Show rules"
                {% if not access_policy_list %}disabled{% endif %}>
            </div>
        </form>
        </div>
        </div>
        <div class="col-12 col-md-2 d-flex align-items-center justify-content-center text-center">
            or
        </div>
        <div class="col-12 col-md-5">
        <div class="p-3 border rounded-3 shadow-sm h-100">

        <form action="{{ url_for('fmc_prefilter_table') }}" method="POST" id="prefilter-form">

            <div class="mb-3">
                <label class="form-label" for="prefilter_lists">Prefilter List:</label><br>
                <select class="form-select" name="prefilter_lists" id="prefilter_lists">
                    {% for prefilter_policy in prefilter_policy_list %}
                        <option value="{{ prefilter_policy.get("id") }}">{{ prefilter_policy.get("name") }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <input class="btn btn-primary" type="submit" id="submit" name="submit" value="Show rules"
                {% if not prefilter_policy_list %}disabled{% endif %}>
            </div>
        </form>
        </div>
        </div>
    </div>
    </div>
        {% endblock %}
    {% endif %}
    <br>

    {% block tables %}{% endblock %}

    <!-- Vollbild-Overlay -->
    <div id="page-loading-overlay" class="loading-overlay d-none" aria-hidden="true">
        <div class="text-center">
            <div class="spinner-border text-primary" role="status" aria-label="Laden...">
                <span class="visually-hidden">Laden...</span>
            </div>
        </div>
    </div>

</body>
<script src="{{ url_for('static', filename='js/tables-loading.js') }}"></script>
<script>
  initTablesLoadingSpinner();
</script>
</html>
