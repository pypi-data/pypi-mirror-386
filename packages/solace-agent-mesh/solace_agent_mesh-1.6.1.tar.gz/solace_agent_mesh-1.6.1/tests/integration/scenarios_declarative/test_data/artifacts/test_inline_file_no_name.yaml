test_case_id: "artifact_inline_no_name_001"
description: "Tests that an inline file with no name is handled gracefully."
tags: ["all", "common"]
skip_intermediate_events: true

gateway_input:
  target_agent_name: "TestAgent"
  user_identity: "noname_user@test.com"
  external_context:
    a2a_session_id: "inline_no_name_session_001"
  a2a_parts:
    - type: "text"
      text: "Process this unnamed file."
    - type: "file"
      # name is intentionally omitted
      mime_type: "text/plain"
      bytes_base64: "VGhpcyBmaWxlIGhhcyBubyBuYW1lLg==" # "This file has no name."

llm_interactions:
  - expected_request:
      prompt_contains_artifact_summary_for:
        - filename_matches_regex: "^upload-.*[^n]$"
    static_response:
      choices: [{message: {role: "assistant", content: "I have processed the unnamed file."}}]

expected_artifacts:
  - filename_matches_regex: "^upload-.*[^n]$"
    version: 0
    mime_type: "text/plain"
    content_base64_exact: "VGhpcyBmaWxlIGhhcyBubyBuYW1lLg=="

expected_gateway_output:
  - type: "final_response"
    content_parts:
      - type: "text"
        text_contains: "processed the unnamed file"
