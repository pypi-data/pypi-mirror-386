test_case_id: "proxy_simple_passthrough_001"
description: "Tests a simple request/response flow through the A2A proxy."
tags: ["all", "proxy"]
skip_intermediate_events: true

gateway_input:
  target_agent_name: "TestAgent_Proxied"
  user_identity: "proxy_tester@example.com"
  parts:
    - type: "text"
      text: "Hello, proxied agent!"
  external_context:
    a2a_session_id: "session_proxy_simple_passthrough_001"

# This section primes the TestA2AAgentServer's DeclarativeAgentExecutor
downstream_a2a_agent_responses:
  - id: "task-from-downstream-agent"
    contextId: "session_proxy_simple_passthrough_001"
    kind: "task"
    status:
      state: "completed"
      message:
        role: "agent"
        messageId: "msg-from-downstream-agent"
        kind: "message"
        parts:
          - kind: "text"
            text: "Response from downstream agent."

# This section asserts what the TestGatewayComponent receives
expected_gateway_output:
  - type: "final_response"
    kind: "task"
    id: "*" # The task ID is generated by the proxy, so we wildcard it.
    contextId: "session_proxy_simple_passthrough_001"
    status:
      state: "completed"
      message:
        role: "agent"
        messageId: "*" # Message ID is also generated, wildcard it.
        kind: "message"
        parts:
          - type: "text"
            text_exact: "Response from downstream agent."
