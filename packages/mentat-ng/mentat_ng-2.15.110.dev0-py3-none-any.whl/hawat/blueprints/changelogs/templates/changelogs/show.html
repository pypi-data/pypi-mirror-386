{%- extends "_layout.html" %}

{%- block content %}
    <div>
        {{ macros_page.render_breadcrumbs(item) }}

        <h3>
            {{ item.__str__() }}
        </h3>
        <table class="table table-striped">
            <tbody>
                <tr>
                    <th>
                        {{ _("Log time") }}:
                    </th>
                    <td>
                        {{ babel_format_datetime(item.createtime) }}
                        ({{ _('%(delta)s ago', delta = babel_format_timedelta(current_datetime_utc - item.createtime)) }})
                    </td>
                </tr>
                <tr>
                    <th>
                        {{ _("Author") }}:
                    </th>
                    <td>
                        {%- if item.author %}
                            <a data-bs-toggle="tooltip"
                               href="{{ url_for('users.show', item_id = item.author.id) }}"
                               title="{{ _('View details of user account &quot;%(item)s&quot;', item = item.author.login) }}">
                                {{ item.author.login }}
                            </a>
                        {%- else %}
                            {{ _("<< system change >>") }}
                        {%- endif %}
                    </td>
                </tr>
                <tr>
                    <th>
                        {{ _("Item") }}:
                    </th>
                    <td>
                        {{ macros_page.render_item_in_changelog(item) }}
                    </td>
                </tr>
                <tr>
                    <th>
                        {{ _("Endpoint") }}:
                    </th>
                    <td>
                        {{ macros_page.render_label_endpoint(item.endpoint) }}
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="row">
            <div class="col-md-4">
                <h4>
                    {{ _("Initial item state") }}:
                </h4>
                <pre class="border rounded highlight">
                    {%- highlight 'json' %}{{ item.before }}{% endhighlight -%}
                </pre>
            </div>
            <div class="col-md-4">
                <h4>
                    {{ _("Difference") }}:
                </h4>
                <pre class="border rounded highlight">
                    {%- highlight 'diff' %}{{ item.diff }}{% endhighlight -%}
                </pre>
            </div>
            <div class="col-md-4">
                <h4>
                    {{ _("Final item state") }}:
                </h4>
                <pre class="border rounded highlight">
                    {%- highlight 'json' %}{{ item.after }}{% endhighlight -%}
                </pre>
            </div>
        </div>
    </div>

    {%- if permission_can('developer') %}
        <hr>
        {{ macros_site.render_raw_item_view(item) }}
    {%- endif %}
{%- endblock content %}
