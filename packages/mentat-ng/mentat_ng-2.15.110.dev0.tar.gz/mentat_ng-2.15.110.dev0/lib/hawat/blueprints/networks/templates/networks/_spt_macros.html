{%- import '_macros_site.html' as macros_site with context -%}

{%- macro render_result_abuse(whois_result) %}
    <div class="card">
        <ul class="list-group">
            {%- for item in whois_result | reverse %}
                <li class="list-group-item">
                    <p class="lead">
                        <em>
                            {% if 'netname' in item %}
                                {{ item['netname'] }}:
                            {% endif %}
                            {{ item['network'] }}
                        </em>
                    </p>
                    <p class="d-inline-block mb-0">
                        <span>
                            {{ _("Group") }}:
                            <strong>{{ item['abuse_group'] }}</strong>
                        </span>
                        {{ macros_site.render_widget_csag_abuse([item['abuse_group']], without_label=True) }}
                    </p>
                    {% if 'rank' in item %}
                        <p>
                            {{ 'Rank' }}: {{ item['rank'] }}
                        </p>
                    {% endif %}
                    {% if item.get('description') %}
                        <p>
                            {{ _("Description") }}: {{ item['description'] }}
                        </p>
                    {% endif %}
                    {% if item['is_base'] %}
                        <p>
                            <strong>{{ 'Base network.' }}</strong>
                        </p>
                    {% endif %}
                    <p>
                        {{ _("Source") }}: {{ item['source'] }}
                    </p>
                    <a href="{{ url_for('networks.show', item_id=item['id']) }}"
                       target="_blank"
                       class="btn btn-sm btn-secondary mb-1 ms-auto">
                        {{ get_icon('action-show') }} {{ _("Show network record details") }}
                    </a>
                </li>
            {%- endfor %}
        </ul>
    </div>
{%- endmacro %}

{%- macro get_title() -%}
    {{ get_icon("module-networks") }} {{ _("Networks") }}
{%- endmacro %}
