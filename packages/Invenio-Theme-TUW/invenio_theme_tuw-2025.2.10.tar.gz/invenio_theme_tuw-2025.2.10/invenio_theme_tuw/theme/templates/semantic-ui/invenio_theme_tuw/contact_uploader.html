{# -*- coding: utf-8 -*-

  Copyright (C) 2023 TU Wien.

  Invenio-Theme-TUW is free software; you can redistribute it and/or modify
  it under the terms of the MIT License; see LICENSE file for more details.
#}

{%- extends config.BASE_TEMPLATE %}

{%- block page_body %}
  {%- if submitted %}
    <section class="ui container mt-20">
      <h1>Inquiry submitted</h1>

      <p>
        Thank you for your message, it has been forwarded successfully to <strong>{{ uploader.user_profile.full_name }}</strong>.
      </p>
      <p>
        In case you don't hear back within reasonable time, consider contacting our team.
        For more information, see the <a href="{{ url_for('invenio_theme_tuw.tuw_contact') }}">contact page</a>.
      </p>

      <button class="ui basic button">
        <a href="{{ url_for('invenio_app_rdm_records.record_detail', pid_value=record_ui["id"]) }}">Back to the record</a>
      </button>
    </section>

  {%- else %}
    <section class="ui container mt-20">
      <h1>Contact the uploader of record "{{ record_ui["metadata"]["title"] }}"</h1>

      <p>
        By filling out and submitting the following form, you can send an email to the record's uploader, <strong>{{ uploader.user_profile.full_name }}</strong>.
      </p>

      {%- if captcha_failed %}
        <div class="ui error message">
          <div class="header">Captcha mismatch</div>
          <p>Captcha verification failed, please try again.</p>
        </div>
      {%- endif %}
      <form method="POST" class="ui form">

        <div class="two fields">
          <div class="required field">
            <label for="name">Your name</label>
            <input id="name" name="name" type="text" class="ui input" placeholder="Max Mustermann" value="{{ form_values.name }}" required />
          </div>

          <div class="required field">
            <label for="email">Your email address</label>
            <input id="email" name="email" type="email" class="ui input" placeholder="max.mustermann@tuwien.ac.at" value="{{ form_values.email }}" required />
          </div>
        </div>

        <div class="required field">
          <label for="message">Inquiry message</label>
          <textarea id="message" name="message" class="ui input" required>{{ form_values.message }}</textarea>
        </div>

        <div class="required field">
          <div class="ui checkbox">
            <input id="consent" name="consent" type="checkbox" class="hidden" required />
            <label for="consent">I accept that my name and email address will be sent to the record's uploader so that they can reply to me</label>
          </div>
        </div>

        {%- if config.CAPTCHA_ENABLE %}
          <div class="fields">
            {{ captcha(css_class="captcha image") }}
            <div class="required field">
              <label for="captcha">Type the text</label>
              <input id="captcha" name="captcha" type="text" required />
            </div>
          </div>
        {%- endif %}

        <button type="submit" class="ui submit button">Submit</button>
        <a class="ui basic button" href="{{ url_for('invenio_app_rdm_records.record_detail', pid_value=record_ui["id"]) }}">Back to the record</a>
      </form>
    </section>
  {%- endif %}
{%- endblock %}
