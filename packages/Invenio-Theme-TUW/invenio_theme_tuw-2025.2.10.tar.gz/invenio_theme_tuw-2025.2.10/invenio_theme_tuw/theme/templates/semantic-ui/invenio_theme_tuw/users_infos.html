{# -*- coding: utf-8 -*-

  Copyright (C) 2024 TU Wien.

  Invenio Theme TUW is free software; you can redistribute it and/or modify it
  under the terms of the MIT License; see LICENSE file for more details.
#}

{%- extends config.BASE_TEMPLATE %}

{%- block page_body %}
  <section class="ui container rel-mt-3">
    <h1>{{ _("Users") }}</h1>

    <table class="users">
      <caption>Overview of users in the system and select details about them.</caption>
      <thead>
        <tr>
          <th class="id">ID</th>
          <th class="name">Full name</th>
          <th class="email">Email</th>
          <th class="tiss">TISS</th>
          <th class="action">Action</th>
        </tr>
      </thead>
      <tbody>
        {%- for user_info in user_infos %}
          {%- set user = user_info.user %}
          {%- set user_class = "trusted" if user_info.trusted else "untrusted" %}
          <tr class="{{ user_class }} user">
            <td class="id">{{ user.id }}</td>
            <td class="name">
              <a href="{{ url_for('.show_user_welcome_text', uid=user.id) }}">
                {{ user.user_profile.full_name or "&mdash;" | safe }}
              </a>
            </td>
            <td class="email">{{ user.email }}</td>
            <td class="tiss">
              {%- if user_info.tiss_id %}
                <a href="https://tiss.tuwien.ac.at/person/{{ user_info.tiss_id }}.html">{{ user_info.tiss_id }}</a>
              {%- else %}
                &mdash;
              {%- endif %}
            </td>
            <td class="action">
              <form method="POST">
                <input type="hidden" name="user_id" value="{{ user.id }}" />
                {%- if not user_info.trusted %}
                  <button type="submit">Trust</button>
                {%- else %}
                  <button class="untrust" type="submit">Untrust</button>
                {%- endif %}
              </form>
            </td>
          </tr>
        {%- endfor %}
      </tbody>
    </table>
  </section>
{%- endblock page_body %}

{%- block css %}
  {{ super() }}
  {{ webpack['invenio-theme-tuw-user-infos.css'] }}
{%- endblock css %}
