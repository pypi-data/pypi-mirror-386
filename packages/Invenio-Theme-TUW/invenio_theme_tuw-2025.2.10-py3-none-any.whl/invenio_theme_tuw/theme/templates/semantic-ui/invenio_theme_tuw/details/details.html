{# -*- coding: utf-8 -*-

  Copyright (C) 2020-2021 CERN.
  Copyright (C) 2020-2021 Northwestern University.
  Copyright (C) 2021 New York University.
  Copyright (C) 2020-2022 TU Wien.

  Invenio RDM Records is free software; you can redistribute it and/or modify
  it under the terms of the MIT License; see LICENSE file for more details.
#}

{%- from "invenio_app_rdm/records/macros/detail.html" import show_references, show_add_titles,
  show_alternate_identifiers, show_related_identifiers, show_funding, show_dates %}

{%- from "invenio_theme_tuw/macros/detail.html" import show_licenses %}

{%- set hasContent = record_ui["ui"]["additional_titles"] or
                     metadata.identifiers or
                     record_ui["ui"]["related_identifiers"] or
                     metadata.funding or
                     record_ui["ui"]["dates"] or
                     metadata.references
%}
{%- set rights     = record_ui["ui"].get("right") %}
{%- set active     = true %}

{%- if hasContent %}

  <h2 id="record-details-heading">{{ _('Additional details') }}</h2>

  {#- Tabs #}
  <div role="tablist" class="ui top attached tabs menu">

    {%- if record_ui["ui"]["additional_titles"] %}

      <a role="tab"
        aria-selected="{{ active }}"
        aria-controls="additional-titles"
        data-tab="additional-titles"
        tabindex="0"
        class="{{ 'active' if active }} item"
        id="additional-titles-tab"
      >
        {{ _('Additional titles') }}
      </a>
      {%- set active = false %}

    {%- endif %}

    {%- if metadata.identifiers %}

      <a role="tab"
        aria-selected="{{ active }}"
        aria-controls="identifiers"
        data-tab="identifiers"
        tabindex="0"
        class="{{ 'active' if active }} item"
        id="identifiers-tab"
      >
        {{ _('Identifiers') }}
      </a>
      {%- set active = false %}

    {%- endif %}

    {%- if record_ui["ui"]["related_identifiers"] %}

      <a role="tab"
        aria-selected="{{ active }}"
        aria-controls="related-works"
        data-tab="related-works"
        tabindex="0"
        class="{{ 'active' if active }} item"
        id="related-works-tab"
      >
        {{ _('Related works') }}
      </a>
      {%- set active = false %}

    {%- endif %}

    {%- if metadata.funding %}

      <a role="tab"
        aria-selected="{{ active }}"
        aria-controls="funding"
        data-tab="funding"
        tabindex="0"
        class="{{ 'active' if active }} item"
        id="funding-tab"
      >
        {{ _('Funding') }}
      </a>
      {%- set active = false %}

    {%- endif %}

    {%- if record_ui["ui"]["dates"] %}

      <a role="tab"
        aria-selected="{{ active }}"
        aria-controls="dates"
        data-tab="dates"
        tabindex="0"
        class="{{ 'active' if active }} item"
        id="dates-tab"
      >
        {{ _('Dates') }}
      </a>
      {%- set active = false %}

    {%- endif %}

    {%- if metadata.references %}

      <a role="tab"
        aria-selected="{{ active }}"
        aria-controls="references"
        data-tab="references"
        tabindex="0"
        class="{{ 'active' if active }} item"
        id="references-tab"
      >
        {{ _('References') }}
      </a>

    {%- endif %}

  </div>

  {#- Content #}
  {%- set active = true %}

  {%- if record_ui["ui"]["additional_titles"] %}

    <div role="tabpanel"
        class="ui bottom attached {{ 'active' if active }} tab segment"
        data-tab="additional-titles"
        aria-labelledby="additional-titles-tab"
        id="additional-titles"
        hidden="{{ not active }}"

    >
      <dl class="details-list">
        {{ show_add_titles(record_ui["ui"]["additional_titles"]) }}
      </dl>
    </div>
    {%- set active = false %}

  {%- endif %}

  {%- if metadata.identifiers %}
    <div role="tabpanel"
        class="ui bottom attached {{ 'active' if active }} tab segment"
        data-tab="identifiers"
        aria-labelledby="identifiers-tab"
        id="identifiers"
        hidden="{{ not active }}"
    >
      <dl class="details-list">
        {{ show_alternate_identifiers(metadata.identifiers) }}
      </dl>
    </div>
    {%- set active = false %}

  {%- endif %}

  {%- if record_ui["ui"]["related_identifiers"] %}

    <div role="tabpanel"
        class="ui bottom attached {{ 'active' if active }} tab segment"
        data-tab="related-works"
        aria-labelledby="related-works-tab"
        id="related-works"
        hidden="{{ not active }}"
    >
      <dl class="details-list">
        {{ show_related_identifiers(record_ui["ui"]["related_identifiers"]) }}
      </dl>
    </div>
    {%- set active = false %}

  {%- endif %}

  {%- if metadata.funding %}

    <div role="tabpanel"
        class="ui bottom attached {{ 'active' if active }} tab segment"
        data-tab="funding"
        aria-labelledby="funding-tab"
        id="funding"
        hidden="{{ not active }}"
    >
      <dl class="details-list">
        {{ show_funding(metadata.funding) }}
      </dl>
    </div>
    {%- set active = false %}

  {%- endif %}

  {%- if record_ui["ui"]["dates"] %}
    <div role="tabpanel"
        class="ui bottom attached {{ 'active' if active }} tab segment"
        data-tab="dates"
        aria-labelledby="dates-tab"
        id="dates"
        hidden="{{ not active }}"
    >
      <dl class="details-list">
        {{ show_dates(record_ui["ui"]["dates"]) }}
      </dl>
    </div>
    {%- set active = false %}

  {%- endif %}

  {%- if metadata.references %}
    <div role="tabpanel"
        class="ui bottom attached {{ 'active' if active }} tab segment"
        data-tab="references"
        aria-labelledby="references-tab"
        id="references"
        hidden="{{ not active }}"
    >
      <dl class="details-list">
        {{ show_references(metadata.references) }}
      </dl>
    </div>

  {%- endif %}

{%- endif %}


{# Probably to be removed
{%- from "invenio_app_rdm/records/macros/detail.html" import list_formats, list_languages,
  list_sizes, show_add_descriptions, show_add_titles, show_dates, show_detail, show_funding,
  show_references, show_related_identifiers, show_alternate_identifiers %}

<dt><b>{{ _('Details')}}</b></dt>
<hr class="thin-line"></hr>
<dd class="top-bottom-padded">
  {{ show_detail(_('Licenses'), show_licenses(record_ui["ui"].get('rights'))) if metadata.rights }}
  {{ show_detail(_('Resource type'), record_ui["ui"]["resource_type"]["title_l10n"]) if record_ui["ui"]["resource_type"] }}
  {{ show_detail(_('Publication date'), record_ui["ui"]["publication_date_l10n"]) if record_ui["ui"]["publication_date_l10n"] }}
  {{ show_detail(_('Publisher'), metadata.publisher) if metadata.publisher }}
  {{ show_detail(_('Additional titles'), show_add_titles(record_ui["ui"]["additional_titles"])) if metadata.additional_titles }}
  {{ show_detail(_('Additional descriptions'), show_add_descriptions(record_ui["ui"]["additional_descriptions"])) if record_ui["ui"]["additional_descriptions"] }}
  {{ show_detail(_('Dates'), show_dates(record_ui["ui"]["dates"])) if record_ui["ui"]["dates"] }}
  {{ show_detail(_('Languages'), list_languages(record_ui["ui"]["languages"])) if record_ui["ui"]["languages"] }}
  {{ show_detail(_('Formats'), list_formats(metadata.formats)) if metadata.formats }}
  {{ show_detail(_('Sizes'), list_sizes(metadata.sizes)) if metadata.sizes }}
  {{ show_detail(_('Funding'), show_funding(metadata.funding)) if metadata.funding }}
  {{ show_detail(_('Alternate identifiers'), show_alternate_identifiers(metadata.identifiers)) if metadata.identifiers }}
  {{ show_detail(_('Related works'), show_related_identifiers(record_ui["ui"]["related_identifiers"])) if record_ui["ui"]["related_identifiers"] }}
  {{ show_detail(_('References'), show_references(metadata.references)) if metadata.references }}
</dd>
<hr class="thin-line"></hr>
#}
