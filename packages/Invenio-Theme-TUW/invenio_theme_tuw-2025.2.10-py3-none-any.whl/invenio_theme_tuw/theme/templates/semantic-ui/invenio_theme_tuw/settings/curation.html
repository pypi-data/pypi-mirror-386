{#-
  Copyright (C) 2023 TU Wien.

  Invenio Theme TUW is free software; you can redistribute it and/or modify
  it under the terms of the MIT License; see LICENSE file for more details.
#}
{%- extends config.USERPROFILES_SETTINGS_TEMPLATE %}
{%- from "invenio_userprofiles/settings/_macros.html" import render_field, form_errors %}
{%- set policies_url  = url_for("invenio_theme_tuw.tuw_policies") %}

{%- block settings_content scoped %}
  <section aria-label="{{ _('Curation') }}" class="ui segments">
    <div class="ui segment secondary">
      <i class="file icon" aria-hidden="true"></i>
      <strong class="header item">{{ _("Curation") }}</strong>
    </div>
    <div class="ui segment">
      <form method="POST" name="preferences_curation_form" class="ui form">
        {%- set form = preferences_curation_form %}
        {%- for field in form %}
          {%- if field.widget.input_type == 'hidden' %}
            {{ field() }}
          {%- endif %}
        {%- endfor %}

        {%- set consent_field = form.consent %}
        {%- set consent_given = current_user.preferences.get("curation_consent", False) %}
        <div class="field">
          <label for="{{ consent_field.id }}">{{ consent_field.label }}</label>
          <p><small>{{ consent_field.description }}</small></p>

          <div class="ui toggle on-off checkbox">
            <input disabled type="checkbox" name="{{ consent_field.id }}" id="{{ consent_field.id }}" {{ "checked" if consent_given else "" }} />
            <label for="{{ consent_field.id }}">
              <small class="ml-10">Curate my records</small>
            </label>
          </div>

          <p class="mt-15">
            <small>
              <strong>Note:</strong>
              This setting has become obsolete with the revision of the <a href="{{ policies_url }}">deposit policy</a> from 2025-03-11.
              It will be removed in the future.
            </small>
          </p>
        </div>

        <div class="form-actions">
          <a href="." class="ui labeled icon button mt-5">
            <i class="close icon" aria-hidden="true"></i>
            {{ _('Cancel') }}
          </a>
          <button type="submit" name="submit" value="{{ form._prefix }}" class="ui primary labeled icon button mt-5">
            <i class="check icon" aria-hidden="true"></i>
            {{ _('Update curation preferences') }}
          </button>
        </div>
      </form>
    </div>
  </section>
{% endblock %}
