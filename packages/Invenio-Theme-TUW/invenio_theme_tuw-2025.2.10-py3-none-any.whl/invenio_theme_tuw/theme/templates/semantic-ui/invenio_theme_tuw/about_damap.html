{# -*- coding: utf-8 -*-

  Copyright (C) 2025 TU Wien.

  Invenio Theme TUW is free software; you can redistribute it and/or modify it
  under the terms of the MIT License; see LICENSE file for more details.
#}

{%- extends config.BASE_TEMPLATE %}

{# This link is used multiple times throughout this page. #}
{% set token_link = url_for("invenio_oauth2server_settings.token_new") %}

{%- block page_hero %}
  <section id="hero" class="policies no-shrink"></section>
{%- endblock page_hero %}

{%- block page_body %}
  <section class="ui about container rel-mt-3">
    <a href="{{ url_for("invenio_theme_tuw.tuw_about_api") }}">⬅️ {{ _("To parent page") }}</a>

    <h1>{{ _("About DAMAP") }}</h1>
    <ul>
      <li>
        <p>{{ _("Fetch your maDMPs:") }}</p>
        <p><strong>{{ _("Endpoint:") }} </strong><code>GET /api/invenio_damap/damap/dmp</code></p>
        <p>
          <strong>{{ _("Token Required:") }}</strong>
          {% trans trimmed token_link = token_link %}
            Yes — generate one <a href="{{ token_link }}">here</a>.
          {% endtrans %}
        </p>

        <p><strong>cURL:</strong></p>
        <div class="ui code-container">
          <pre class="ui segment code-block">
{#- ################# PREFORMATTED AREA TEXT BEGIN ################# #}
curl "{{ config.SITE_API_URL }}/invenio_damap/damap/dmp" \
     -H "Authorization: Bearer {your-access-token}"
{#- ################## PREFORMATTED AREA TEXT END ################## -#}
            <button class="ui button copy-btn" data-tooltip="{{ _("Copy to clipboard") }}">
              <i class="copy icon"></i>
            </button>
          </pre>
        </div>

        <p><strong>Python (requests):</strong></p>
        <div class="ui code-container">
          <pre class="ui segment code-block">
{#- ################# PREFORMATTED AREA TEXT BEGIN ################# #}
import requests
url = "{{ config.SITE_API_URL }}/invenio_damap/damap/dmp"
headers = {
    "Authorization": "Bearer {your-access-token}",
}
response = requests.post(url, headers=headers)
print(response.json())
{#- ################## PREFORMATTED AREA TEXT END ################## -#}
            <button class="ui button copy-btn" data-tooltip="Copy to clipboard">
              <i class="copy icon"></i>
            </button>
          </pre>
        </div>

        <p><strong>{{ _("Example Response") }} (HTTP 200 - OK):</strong></p>
        <div class="ui code-container">
          <pre class="ui segment code-block">
{#- ################# PREFORMATTED AREA TEXT BEGIN ################# #}
{
  "hits": {
    "hits": [
      {
        "id": 4002,
        "created": "2025-02-10T11:28:03.472Z",
        "project": {
          "id": 4002,
          "description": "A very important chemistry project.",
          "title": "Advanced Chemical Reactions Study"
        },
        "datasets": [],
        "links": {}
      },
      {
        "id": 4001,
        "created": "2025-01-10T14:07:26.234Z",
        "project": {
          "id": 4001,
          "description": "A very important climate project.",
          "title": "Global Climate Change Analysis"
        },
        "datasets": [],
        "links": {}
      }
    ],
    "total": 10
  },
  "links": {
    "self": "{{ config.SITE_API_URL }}/invenio_damap/damap/dmp?facets=%7B%7D"
  }
}
{#- ################## PREFORMATTED AREA TEXT END ################## -#}
            <button class="ui button copy-btn" data-tooltip="{{ _("Copy to clipboard") }}">
              <i class="copy icon"></i>
            </button>
          </pre>
        </div>
      </li>

      <li>
        <p>{{ _("Link your selected InvenioRDM record to the target maDMP:") }}</p>
        <p><strong>{{ _("Endpoint:") }} </strong><code>POST /api/invenio_damap/damap/dmp/{dmp_id}/dataset/{record_id}</code></p>
        <p>
          <strong>{{ _("Token Required:") }}</strong>
          {% trans trimmed token_link = token_link %}
            Yes — generate one <a href="{{ token_link }}">here</a>.
          {% endtrans %}
        </p>

        <p><strong>cURL:</strong></p>
        <div class="ui code-container">
          <pre class="ui segment code-block">
{#- ################# PREFORMATTED AREA TEXT BEGIN ################# #}
curl -X POST "{{ config.SITE_API_URL }}/invenio_damap/dmp/1337/dataset/abcde-12345" \
     -H "Authorization: Bearer {your-access-token}"
{#- ################## PREFORMATTED AREA TEXT END ################## -#}
            <button class="ui button copy-btn" data-tooltip="{{ _("Copy to clipboard") }}">
              <i class="copy icon"></i>
            </button>
          </pre>
        </div>

        <p><strong>Python (requests):</strong></p>
        <div class="ui code-container">
          <pre class="ui segment code-block">
{#- ################# PREFORMATTED AREA TEXT BEGIN ################# #}
import requests
url = "{{ config.SITE_API_URL }}/invenio_damap/dmp/1337/dataset/abcde-12345"
headers = {
    "Authorization": "Bearer {your-access-token}",
}
response = requests.post(url, headers=headers)
print(response.json())
{#- ################## PREFORMATTED AREA TEXT END ################## -#}
            <button class="ui button copy-btn" data-tooltip="{{ _("Copy to clipboard") }}">
              <i class="copy icon"></i>
            </button>
          </pre>
        </div>

        <p><strong>{{ _("Example Response") }} (HTTP 201 - CREATED):</strong></p>
        <div class="ui code-container">
          <pre class="ui segment code-block">
{#- ################# PREFORMATTED AREA TEXT BEGIN ################# #}
{
  "id": "abcde-12345",
  "metadata": {
    "title": "New Dataset Title",
    "creators": [{"name": "Doe, Jane"}],
    "publication_date": "2025-01-09",
    "resource_type": {"id": "dataset"}
  },
  "links": {
    "self": "{{ config.SITE_API_URL }}/records/abcde-12345",
    "files": "{{ config.SITE_API_URL }}/records/abcde-12345/files"
  }
}
{#- ################## PREFORMATTED AREA TEXT END ################## -#}
            <button class="ui button copy-btn" data-tooltip="{{ _("Copy to clipboard") }}">
              <i class="copy icon"></i>
            </button>
          </pre>
        </div>
      </li>
    </ul>
  </section>

  {%- block javascript %}
    {{ super() }}
    {{ webpack["invenio-theme-tuw-clipboard.js"] }}
  {%- endblock javascript %}

{%- endblock page_body %}
