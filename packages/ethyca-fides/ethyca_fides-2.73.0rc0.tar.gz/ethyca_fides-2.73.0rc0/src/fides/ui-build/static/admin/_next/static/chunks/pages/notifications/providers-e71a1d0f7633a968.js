(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1537],{30890:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/notifications/providers",function(){return s(66605)}])},129:function(e,t,s){"use strict";var i=s(24246),n=s(87949),l=s(86677),a=s(16134),r=s(25980),o=s(77830),c=s(65735),d=s(31793);t.Z=()=>{let e=(0,l.useRouter)(),t=e.pathname,{plus:s}=(0,r.hz)(),u="providers";t.startsWith(o.AD)?u="providers":t.startsWith(o.Wi)?u="templates":t.startsWith(o.DN)&&(u="digests");let g=[{key:"templates",label:"Templates",requiresPlus:!0,scopes:[c.Sh.MESSAGING_TEMPLATE_UPDATE],path:o.Wi},{key:"digests",label:"Digests",requiresPlus:!0,scopes:[c.Sh.DIGEST_CONFIG_READ],path:o.DN},{key:"providers",label:"Providers",requiresPlus:!1,scopes:[c.Sh.MESSAGING_CREATE_OR_UPDATE],path:o.AD}];s||(g=g.filter(e=>!e.requiresPlus));let h=(0,a.C)(d.uu);g=g.filter(e=>e.scopes.some(e=>h.includes(e)));let p=t=>{let s=g.find(e=>e.key===t);s&&e.push(s.path)},m=g.map(e=>({label:e.label,key:e.key}));return(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsx)(n.Niu,{mode:"horizontal",selectedKeys:[u],onClick:e=>{let{key:t}=e;return p(t)},items:m})})}},19904:function(e,t,s){"use strict";s.d(t,{Tg:function(){return a}});var i=s(24246),n=s(16134),l=s(31793);let a=e=>(0,n.C)(l.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:s}=e;return a(t)?(0,i.jsx)(i.Fragment,{children:s}):null}},17828:function(e,t,s){"use strict";var i=s(24246);s(27378),t.Z=()=>(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 74.375 85",width:"20",height:"20",fill:"#fff",fillRule:"evenodd",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("use",{xlinkHref:"#A",x:"2.188",y:"2.5"}),(0,i.jsx)("symbol",{id:"A",overflow:"visible",children:(0,i.jsxs)("g",{stroke:"none",children:[(0,i.jsx)("path",{d:"M16.558 12.75L0 38.591l16.558 25.841 13.227-3.324.654-44.869-13.881-3.489z",fill:"#876929"}),(0,i.jsx)("path",{d:"M35.049 59.786l-18.491 4.645V12.75l18.491 4.645v42.391z",fill:"#d9a741"}),(0,i.jsxs)("g",{fill:"#876929",children:[(0,i.jsx)("path",{d:"M32.849 21.614L35.05 80 70 62.867l-.01-43.615-8.914 1.448-28.228.913z"}),(0,i.jsx)("path",{d:"M46.184 33.149l10.906-.632 10.778-19.164L40.612 0 30.439 4.364l15.745 28.785z"})]}),(0,i.jsx)("path",{d:"M40.612 0l27.256 13.353-10.778 19.164L40.612 0z",fill:"#d9a741"}),(0,i.jsx)("path",{d:"M35.049 5.539L57.09 44.742l3.788 22.595L35.049 80l-10.46-5.131V9.64l10.45-4.101h.01z",fill:"#876929"}),(0,i.jsx)("path",{d:"M69.991 19.251L70 62.867 35.05 80V5.539l22.041 39.203 12.899-25.491z",fill:"#d9a741"})]})})]})},44907:function(e,t,s){"use strict";var i=s(24246);s(27378),t.Z=()=>(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",preserveAspectRatio:"xMidYMid",viewBox:"-0.5 0 257 257",children:(0,i.jsx)("path",{fill:"#C02428",d:"M128.418 80.526c-26.51 0-48.884 21.475-48.884 48.728a48.197 48.197 0 0014.187 34.579 48.532 48.532 0 0034.697 14.14c26.511 0 48.875-21.476 48.875-48.719 0-27.253-22.364-48.728-48.875-48.728zm-76.22 47.895c0-41.285 33.968-75.138 75.395-75.138 41.417 0 75.385 33.853 75.385 75.138 0 2.478 0 5.788-.825 8.266-.835 7.422 4.972 13.2 12.43 13.2 12.43 0 14.08-15.678 14.08-21.466 0-55.328-45.573-100.746-101.07-100.746-55.518 0-101.07 45.418-101.07 100.746 0 55.339 45.552 100.747 101.07 100.747 29.822 0 56.333-12.388 74.56-33.03l20.703 17.342c-22.364 26.43-57.158 42.952-94.448 42.952-34.097.105-66.827-13.35-90.932-37.384C13.37 195.016-.118 162.392 0 128.411 0 58.228 57.159.432 128.418.432 198.832.432 256 58.238 256 128.432c0 28.075-13.256 51.205-40.591 51.205-11.605 0-19.053-5.787-23.2-11.565-13.255 21.476-37.29 35.508-64.626 35.508-20.017.068-39.234-7.827-53.388-21.933a74.755 74.755 0 01-22.008-53.205l.01-.02zm76.21-22.297c12.43 0 22.374 9.91 22.374 22.297 0 12.388-9.944 22.298-22.364 22.298a22.322 22.322 0 01-15.848-6.504 22.169 22.169 0 01-6.526-15.794c0-12.387 9.944-22.297 22.374-22.297h-.01z"})})},5144:function(e,t,s){"use strict";var i=s(24246);t.Z=()=>(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 256",children:(0,i.jsx)("path",{fill:"#F12E45",d:"M128 0c70.656 0 128 57.344 128 128s-57.344 128-128 128S0 198.656 0 128 57.344 0 128 0zm0 33.792c-52.224 0-94.208 41.984-94.208 94.208S75.776 222.208 128 222.208s94.208-41.984 94.208-94.208S180.224 33.792 128 33.792zm31.744 99.328c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624zm-63.488 0c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624zm63.488-63.488c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624zm-63.488 0c14.704 0 26.624 11.92 26.624 26.624 0 14.704-11.92 26.624-26.624 26.624-14.704 0-26.624-11.92-26.624-26.624 0-14.704 11.92-26.624 26.624-26.624z"})})},66605:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var i,n,l=s(24246),a=s(77213),r=s(129),o=s(58754),c=s(19904),d=s(87949),u=s(86677),g=s(77830),h=s(47935),p=s(812),m=s(17245),x=s(27378),f=s(8125),v=s(7426),j=s(65735),w=s(17828),_=s(44907),y=s(5144),b=s(42478),k=s(51980),S=s(16394),E=e=>{let{messagingConfig:t}=e,{last_test_succeeded:s,last_test_timestamp:i}=t;if(!i)return(0,l.jsx)(d.j8w,{children:"Verify configuration"});let n=new Date(i),a=(0,S.p6)(n),r=(0,k.B)(n,new Date,{addSuffix:!0});return(0,l.jsx)(d.esZ,{title:"Last verified: ".concat(a),children:(0,l.jsxs)(d.j8w,{color:s?"success":"error","data-testid":s?"test-success":"test-error",children:[s?"Succeeded":"Failed"," ",r]})})};(i=n||(n={})).NAME="name",i.VERIFICATION_STATUS="verification_status",i.ENABLED="enabled",i.ACTIONS="actions";let P=()=>{let e=(0,u.useRouter)(),{handleError:t}=(0,m.HK)(),[s,i]=(0,x.useState)(null),[a]=(0,v.L)(),[r]=(0,b.W)(),o=(0,c.Tg)([j.Sh.MESSAGING_CREATE_OR_UPDATE]),[h,k]=(0,x.useState)(!1),[S,P]=(0,x.useState)(null),C=(0,f.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},sorting:{validColumns:Object.values(n),defaultSortKey:"name",defaultSortOrder:"ascend"}}),{data:z,isLoading:T}=(0,b.JE)(),{data:A,isLoading:M}=(0,b.qt)();(0,x.useEffect)(()=>{z?i(z.service_type):i(null)},[z]);let N=(0,x.useCallback)(async e=>{try{let s=await a({notifications:{notification_service_type:e}});(0,p.D4)(s)?t(s.error):(i(e),d.Pg3.success(e?"Updated active messaging config":"Disabled active messaging config"))}catch(e){t(e)}},[a,t,i]),D=(0,x.useCallback)(t=>{var s,i;let n=g.GE.replace("[key]",t.key);e.push({pathname:n,query:{last_test_succeeded:null!==(s=t.last_test_succeeded)&&void 0!==s?s:"",last_test_timestamp:null!==(i=t.last_test_timestamp)&&void 0!==i?i:""}})},[e]),R=(0,x.useCallback)((e,t)=>{P({key:e,name:t}),k(!0)},[]),L=(0,x.useCallback)(async()=>{if(S)try{let e=await r({key:S.key});(0,p.D4)(e)?t(e.error):d.Pg3.success("Messaging configuration successfully deleted")}catch(e){t(e)}finally{k(!1),P(null)}},[S,r,t]),I=(0,x.useCallback)(()=>{k(!1),P(null)},[]),Z=(0,x.useMemo)(()=>({enableSelection:!1,getRowKey:e=>e.key,isLoading:M||T,dataSource:(null==A?void 0:A.items)||[],totalRows:(null==A?void 0:A.total)||0,customTableProps:{size:"small",pagination:{hideOnSinglePage:!0,showSizeChanger:!0,pageSizeOptions:["25","50","100"]}}}),[M,T,null==A?void 0:A.items,null==A?void 0:A.total]),O=(0,f.V)(C,Z),G=(0,x.useMemo)(()=>[{title:"Provider type",dataIndex:"name",key:"name",render:(e,t)=>(0,l.jsxs)(d.Ugi,{children:[(()=>{switch(t.service_type){case"mailgun":return(0,l.jsx)(_.Z,{});case"twilio_text":case"twilio_email":default:return(0,l.jsx)(y.Z,{});case"aws_ses":return(0,l.jsx)(w.Z,{})}})(),(0,l.jsx)(d.xvT,{children:e})]})},{title:"Verification status",key:"verification_status",render:(e,t)=>(0,l.jsx)(E,{messagingConfig:t})},{title:"Enabled",key:"enabled",width:100,render:(e,t)=>{let i=t.service_type===s,n=!!t.last_test_timestamp&&""!==t.last_test_timestamp&&!1===t.last_test_succeeded&&!i,a=(0,l.jsx)(d.rAg,{checked:i,disabled:n,onChange:e=>{e?N(t.service_type):N(null)}});return n?(0,l.jsx)(d.esZ,{title:"This provider cannot be enabled because its last test failed. Please fix the configuration and test again.",children:a}):a}},{title:"Actions",key:"actions",render:(e,t)=>(0,l.jsxs)(d.Ugi,{children:[o&&(0,l.jsx)(d.wpx,{onClick:e=>{e.stopPropagation(),D(t)},size:"small",icon:(0,l.jsx)(d.PJP.I8b,{}),title:"Edit","aria-label":"Edit messaging configuration","data-testid":"edit-messaging-config-btn"}),o&&(0,l.jsx)(d.wpx,{onClick:e=>{e.stopPropagation(),R(t.key,t.name)},size:"small",icon:(0,l.jsx)(d.PJP.ZNm,{}),title:"Delete","aria-label":"Delete messaging configuration","data-testid":"delete-messaging-config-btn"})]})}],[o,s,D,R,N]),W=(0,x.useMemo)(()=>(0,l.jsx)(d.$zI,{title:"Delete messaging configuration",open:h,onCancel:I,footer:[(0,l.jsx)(d.wpx,{onClick:I,children:"Cancel"},"cancel"),(0,l.jsx)(d.wpx,{type:"primary",danger:!0,onClick:L,children:"Delete"},"delete")],children:(0,l.jsxs)(d.vyj,{direction:"vertical",children:[(0,l.jsxs)(d.xvT,{children:['Are you sure you want to delete "',(0,l.jsx)("strong",{children:null==S?void 0:S.name}),'" messaging configuration?']}),(0,l.jsx)(d.xvT,{children:"This action cannot be undone."})]})}),[h,null==S?void 0:S.name,I,L]);return{columns:G,tableProps:O.tableProps,selectionProps:O.selectionProps,userCanUpdate:o,isLoading:M||T,deleteModal:W,handleEditConfiguration:D,handleDeleteConfiguration:R,setActiveServiceType:N}},C=()=>(0,l.jsx)(d.gCW,{mt:6,p:10,spacing:4,borderRadius:"base",maxW:"70%","data-testid":"no-results-notice",alignSelf:"center",margin:"auto",children:(0,l.jsxs)(d.gCW,{children:[(0,l.jsx)(d.xvT,{fontSize:"md",fontWeight:"600",children:"No messaging providers found."}),(0,l.jsx)(d.xvT,{fontSize:"sm",children:'Click "Add a messaging provider" to add your first messaging provider to Fides.'})]})}),z=()=>{let{columns:e,tableProps:t,userCanUpdate:s,isLoading:i,deleteModal:n}=P(),a=(0,u.useRouter)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(d.xvT,{fontSize:"sm",mb:8,width:{base:"100%",lg:"70%"},children:["Fides requires a messaging provider for sending processing notices to privacy request subjects, and allows for Subject Identity Verification in privacy requests. Please follow the"," ",(0,l.jsx)(d.xvT,{as:"span",color:"complimentary.500",children:"documentation"})," ","to setup a messaging service that Fides supports. Ensure you have completed the setup for the preferred messaging provider and have the details handy prior to the following steps."]}),(0,l.jsxs)(d.kCb,{flex:1,direction:"column",overflow:"auto",children:[s&&(0,l.jsx)(d.vyj,{direction:"horizontal",style:{width:"100%",justifyContent:"flex-end",marginBottom:16},children:(0,l.jsx)(d.wpx,{onClick:()=>{a.push(g.Nu)},role:"link",type:"primary",icon:(0,l.jsx)(d.PJP.mm_,{}),iconPosition:"end","data-testid":"add-messaging-provider-btn",children:"Add a messaging provider"})}),i?(0,l.jsx)(h.I4,{rowHeight:36,numRows:5}):(0,l.jsx)(d.V5H,{...t,columns:e,locale:{emptyText:(0,l.jsx)(C,{})}})]}),n]})};var T=()=>(0,l.jsx)(a.Z,{title:"Notifications",children:(0,l.jsxs)(c.ZP,{scopes:[j.Sh.MESSAGING_CREATE_OR_UPDATE],children:[(0,l.jsx)(o.Z,{heading:"Notifications"}),(0,l.jsx)(r.Z,{}),(0,l.jsx)(z,{})]})})}},function(e){e.O(0,[431,7245,8563,2888,9774,179],function(){return e(e.s=30890)}),_N_E=e.O()}]);