"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3923],{23923:function(e,a,t){t.d(a,{Z:function(){return G}});var s=t(24246),i=t(87949),n=t(34090),r=t(27378),o=t(55484),l=t(16134),d=t(25980),c=t(40324),u=t(33335),p=t(32885),m=t(1315),_=t(57865),g=t(72774),v=t(36345),f=t(812),h=t(8133),y=t(46628);let b={name:"",consent_use:"",data_use:"",data_categories:["user"]},x=[{label:"Analytics",value:"analytics",description:"Provides analytics for activities such as system and advertising performance reporting, insights and fraud detection."},{label:"Essential",value:"essential",description:"Operates the service or product, including legal obligations, support and basic system operations."},{label:"Functional",value:"functional",description:"Used for specific, necessary, and legitimate purposes."},{label:"Marketing",value:"marketing",description:"Enables marketing, promotion, advertising and sales activities for the product, service, application or system."}],j=e=>x.some(a=>a.value===e.split(".")[0]);var k=t(28079),C=t(69525),w=t(97181);let V=e=>{let{index:a,disabled:t}=e;(0,k.fd)();let r=(0,l.C)(k.oW),{values:o}=(0,n.u6)(),d=r.filter(e=>e.value.split(".")[0]===o.privacy_declarations[a].consent_use);return(0,s.jsxs)(i.gCW,{width:"100%",borderRadius:"4px",border:"1px solid",borderColor:"gray.200",spacing:4,p:4,children:[(0,s.jsx)(w.d,{label:"Consent category",tooltip:"What is the system using the data for. For example, is it for third party advertising or perhaps simply providing system operations.",name:"privacy_declarations.".concat(a,".consent_use"),options:x,layout:"stacked",isRequired:!0,disabled:t}),(0,s.jsx)(w.d,{allowClear:!0,label:"Detailed consent category (optional)",tooltip:"Select a more specific consent category",name:"privacy_declarations.".concat(a,".data_use"),options:d,layout:"stacked",disabled:!o.privacy_declarations[a].consent_use||t}),(0,s.jsx)(w.d,{mode:"tags",label:"Cookie names",name:"privacy_declarations.".concat(a,".cookieNames"),options:[],layout:"stacked",disabled:t,className:"w-full"})]})};var F=e=>{var a,t;let{showSuggestions:o,isCreate:d,disabled:c}=e,{values:u,setFieldValue:m}=(0,n.u6)(),{vendor_id:_}=u,{isLoading:g}=(0,p.Wp)({vendor_id:_},{skip:!o||null==_}),v=(0,l.C)((0,p.cL)(_||""));(0,r.useEffect)(()=>{o&&u.vendor_id&&(null==v?void 0:v.length)?m("privacy_declarations",v.filter(e=>j(e.data_use)).map(e=>(0,C.U)(e)).map(e=>{var a;return{name:null!==(a=e.name)&&void 0!==a?a:"",consent_use:e.data_use.split(".")[0],data_use:e.data_use,data_categories:e.data_categories}})):d&&m("privacy_declarations",[b])},[o,d,u.vendor_id,v,m]);let f=(null===(a=u.privacy_declarations[u.privacy_declarations.length-1])||void 0===a?void 0:a.data_use)===b.data_use&&(null===(t=u.privacy_declarations[u.privacy_declarations.length-1])||void 0===t?void 0:t.consent_use)===b.consent_use;return g?(0,s.jsx)(i.$jN,{size:"sm",alignSelf:"center"}):(0,s.jsx)(n.F2,{name:"privacy_declarations",render:e=>(0,s.jsxs)(s.Fragment,{children:[u.privacy_declarations.map((e,a)=>(0,s.jsx)(V,{index:a,disabled:c},e.data_use||a)),(0,s.jsx)(i.wpx,{onClick:()=>e.push(b),size:"small",type:"text",disabled:c||f,"data-testid":"add-data-use-btn",children:"Add data use +"})]})})};let S={name:"",vendor_id:void 0,privacy_declarations:[b]};var G=e=>{let{buttonLabel:a,onButtonClick:t,buttonProps:x}=e,j=(0,i.pmc)(),{isOpen:k,onOpen:C,onClose:w}=(0,i.qY0)(),V=(0,l.T)(),[G]=(0,m.in)(),L=(0,r.useMemo)(()=>o.Ry().shape({name:o.Z_().required().label("Vendor name").test("is-unique","",async(e,a)=>{let{data:t}=await G({page:1,size:10,search:e});return!((null==t?void 0:t.items)||[]).some(a=>a.name===e)||a.createError({message:'You already have a vendor called "'.concat(e,'". Please specify a unique name for this vendor.')})})}),[G]),{tcf:E,dictionaryService:R}=(0,d.hz)(),{isLoading:W}=(0,p.Rd)(void 0,{skip:!R}),q=(0,l.C)(p.o),z=(0,l.C)(_.gU),[N]=(0,m.f7)(),T=(0,l.C)(_.bN),U=()=>{w(),V((0,_.b3)("initial")),V((0,_.gQ)(!1))},Z=(0,r.useRef)(null),A=Z.current?Z.current.values.vendor_id:void 0,M=(0,l.C)((0,p.$e)(A||"")),Q=async(e,a)=>{let t=e.privacy_declarations.filter(e=>e.consent_use!==b.consent_use).flatMap(e=>{let{consent_use:a,...t}=e;return"marketing"!==e.consent_use||e.data_use?{...t,data_use:e.data_use?e.data_use:e.consent_use}:["marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"].map(e=>({...t,data_use:e}))}),s={...M,...e,fides_key:(0,u.E)(e.name),system_type:"",privacy_declarations:t},i=await N(s);if((0,f.D4)(i)){j((0,y.Vo)((0,f.e$)(i.error)));return}j((0,y.t5)("Vendor successfully created!")),a.resetForm(),U()},D=e=>{if(R){if(!e){V((0,_.b3)("hiding")),V((0,_.gQ)(!1));return}V((0,_.b3)("showing")),E&&(0,f.cj)(e)===f.c6.GVL?V((0,_.gQ)(!0)):V((0,_.gQ)(!1))}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.wpx,{onClick:()=>{t?t():C()},"data-testid":"add-vendor-btn",...x,children:a}),(0,s.jsx)(n.J9,{initialValues:S,enableReinitialize:!0,onSubmit:Q,validationSchema:L,innerRef:Z,children:e=>{let{dirty:a,isValid:t,resetForm:r}=e;return(0,s.jsx)(h.Z,{isOpen:k,onClose:U,title:"Add a vendor",children:(0,s.jsxs)(i.xuv,{"data-testid":"add-vendor-modal-content",my:4,children:[z?(0,s.jsx)(g.Z,{}):null,(0,s.jsx)(n.l0,{children:(0,s.jsxs)(i.gCW,{alignItems:"start",spacing:6,children:[R?(0,s.jsx)(v.Z,{label:"Vendor name",options:q,isLoading:W,onVendorSelected:D,isCreate:!0,lockedForGVL:z}):(0,s.jsx)(c.j0,{id:"name",name:"name",isRequired:!0,label:"Vendor name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. “Email Data Warehouse”",variant:"stacked"}),(0,s.jsx)(F,{showSuggestions:"showing"===T,isCreate:!0,disabled:z}),(0,s.jsxs)("div",{className:"flex w-full justify-between",children:[(0,s.jsx)(i.wpx,{onClick:()=>{U(),r()},children:"Cancel"}),(0,s.jsx)(i.wpx,{type:"primary",htmlType:"submit",disabled:W||!a||!t,loading:W,"data-testid":"save-btn",children:"Save vendor"})]})]})})]})})}})]})}},72774:function(e,a,t){t.d(a,{Z:function(){return r}});var s=t(24246),i=t(87949),n=e=>{let{title:a,description:t,button:n}=e;return(0,s.jsxs)(i.Ugi,{backgroundColor:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",py:4,px:6,"data-testid":"empty-state",children:[(0,s.jsx)(i.iid,{alignSelf:"start",color:"blue.400",mt:.5}),(0,s.jsxs)(i.xuv,{flexGrow:1,children:[(0,s.jsx)(i.xvT,{fontWeight:"bold",fontSize:"sm",mb:1,children:a}),(0,s.jsx)(i.xvT,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:t})]}),n]})},r=()=>(0,s.jsx)(i.xuv,{mb:"6",maxW:"720px","data-testid":"locked-for-GVL-notice",children:(0,s.jsx)(n,{title:"This system is part of the TCF Global Vendor List (GVL)",description:(0,s.jsxs)(s.Fragment,{children:["As a result, certain fields are not editable as they come directly from Fides Compass and the Global Vendor List (GVL). In some cases, where the legal basis has been declared to be flexible, you may update the legal basis for particular data uses."," ",(0,s.jsx)(i.rUS,{href:"https://fid.es/tcf_gvl",isExternal:!0,color:"complimentary.500",children:"For more information on the Global Vendor List, click here."})]})})})},69525:function(e,a,t){t.d(a,{U:function(){return s}});let s=e=>{let a=e.data_categories.flatMap(e=>e.split(","));return{data_use:e.data_use,data_categories:a,features:e.features,legal_basis_for_processing:e.legal_basis_for_processing,flexible_legal_basis_for_processing:e.flexible_legal_basis_for_processing,retention_period:e.retention_period?e.retention_period:""}}}}]);