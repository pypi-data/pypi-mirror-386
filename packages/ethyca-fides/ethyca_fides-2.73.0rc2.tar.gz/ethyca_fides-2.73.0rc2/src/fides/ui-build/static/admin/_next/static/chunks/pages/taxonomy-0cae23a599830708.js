(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4202],{58095:function(e,t,n){var r=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},8817:function(e,t,n){var r=n(95372),i=n(1129),a=n(58263);e.exports=function(e,t,n){return t==t?a(e,t,n):r(e,i,n)}},1129:function(e){e.exports=function(e){return e!=e}},75733:function(e){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(i);++r<i;)a[r]=e[r+t];return a}},92198:function(e,t,n){var r=n(52485),i=n(58095),a=n(21796),l=n(65581),o=n(47111),s=n(43735);e.exports=function(e,t,n){var u=-1,d=i,c=e.length,h=!0,f=[],m=f;if(n)h=!1,d=a;else if(c>=200){var p=t?null:o(e);if(p)return s(p);h=!1,d=l,m=new r}else m=t?[]:f;e:for(;++u<c;){var _=e[u],x=t?t(_):_;if(_=n||0!==_?_:0,h&&x==x){for(var v=m.length;v--;)if(m[v]===x)continue e;t&&m.push(x),f.push(_)}else d(m,x,n)||(m!==f&&m.push(x),f.push(_))}return f}},70830:function(e,t,n){var r=n(76747),i=n(31159),a=n(64373),l=n(37948);e.exports=function(e,t){return t=r(t,e),null==(e=a(e,t))||delete e[l(i(t))]}},47111:function(e,t,n){var r=n(46151),i=n(50344),a=n(43735),l=r&&1/a(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=l},64373:function(e,t,n){var r=n(79867),i=n(75733);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},58263:function(e){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,n){var r=n(92198);e.exports=function(e){return e&&e.length?r(e):[]}},43551:function(e,t,n){var r=n(70830);e.exports=function(e,t){return null==e||r(e,t)}},71180:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/taxonomy",function(){return n(33031)}])},18225:function(e,t,n){"use strict";var r=n(24246),i=n(87949);t.Z=e=>{let{alignment:t="center",...n}=e;return(0,r.jsx)(i.kCb,{boxSize:"full",align:"center",justify:t,children:(0,r.jsx)(i.$jN,{color:"primary",...n})})}},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return l}});var r=n(24246),i=n(16134),a=n(31793);let l=e=>(0,i.C)(a.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return l(t)?(0,r.jsx)(r.Fragment,{children:n}):null}},94799:function(e,t,n){"use strict";n.d(t,{k:function(){return a}});var r=n(76649);let i=e=>(0,r.Ln)({id:"string"},e),a=e=>(null!=e?e:[]).filter(i)},30320:function(e,t,n){"use strict";n.d(t,{m:function(){return s}});var r=n(27378),i=n(25980),a=n(17245),l=n(32885),o=n(94799);let s=e=>{let{resourceFidesKey:t,resourceType:n}=e,{errorAlert:s}=(0,a.VY)(),{plus:u}=(0,i.hz)(),d=(0,r.useMemo)(()=>null!=t?t:"",[]),c=(0,l.YU)(!0,{skip:!u}),h=(0,l.VN)(n,{skip:!u}),{data:f,isLoading:m,error:p,isError:_}=(0,l.PV)(null!=t?t:"",{skip:""!==d&&!(u&&d)}),[x]=(0,l._D)(),v=c.isLoading||h.isLoading||m,E=(0,r.useMemo)(()=>new Map((0,o.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),T=(0,r.useMemo)(()=>{var e;return null===(e=h.data)||void 0===e?void 0:e.filter(e=>e.active)},[h.data]),y=(0,r.useMemo)(()=>new Map((0,o.k)(T).map(e=>[e.id,e])),[T]),g=(0,r.useMemo)(()=>_&&(null==p?void 0:p.status)===404?new Map:new Map((0,o.k)(f).map(e=>[e.custom_field_definition_id,e])),[f,_,p]),A=(0,r.useMemo)(()=>{let e=[...y.keys()];return e.sort(),e},[y]),j=(0,r.useMemo)(()=>{let e={};return T&&g&&T.forEach(t=>{let n=g.get(t.id||"");n&&(t.allow_list_id&&"string[]"===t.field_type?e[n.custom_field_definition_id]=n.value:e[n.custom_field_definition_id]=n.value.toString())}),e},[T,g]),S=(0,r.useCallback)(async e=>{if(!u)return;let r="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!r)return;let{customFieldValues:i}=e;if(!i||0===Object.keys(i).length)return;let a=[],l=[];A.forEach(e=>{let t=g.get(e),n=i[e];void 0===n||""===n||Array.isArray(n)&&0===n.length?(null==t?void 0:t.id)&&l.push(t.id):a.push({custom_field_definition_id:e,resource_id:r,id:null==t?void 0:t.id,value:n})});try{await x({resource_type:n,resource_id:r,upsert:a,delete:l})}catch(e){s("One or more custom fields have failed to save, please try again."),console.error(e)}},[u,g,s,t,A,x,n]);return{customFieldValues:j,definitionIdToCustomField:g,idToAllowListWithOptions:E,idToCustomFieldDefinition:y,isEnabled:u,isLoading:v,sortedCustomFieldDefinitionIds:A,upsertCustomFields:S}}},33162:function(e,t,n){"use strict";n.d(t,{uc:function(){return c},mZ:function(){return d.m}});var r=n(24246),i=n(87949),a=n(34090),l=n(30234),o=n(65735),s=n(97181),u=n(40324),d=n(30320);let c=e=>{let{resourceFidesKey:t,resourceType:n}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:h,isEnabled:f,isLoading:m,sortedCustomFieldDefinitionIds:p}=(0,d.m)({resourceFidesKey:t,resourceType:n});return f&&0!==p.length?(0,r.jsx)(l.Z,{heading:"Custom fields",children:(0,r.jsx)(i.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,r.jsx)(i.kCb,{flexDir:"column",gap:"24px",children:m?(0,r.jsx)(i.M5Y,{children:(0,r.jsx)(i.$jN,{})}):p.length>0&&(0,r.jsx)(i.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:p.map(e=>{let t=h.get(e);if(!t)return null;let n="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===o.AL.STRING)return(0,r.jsx)(a.gN,{name:n,children:e=>{let{field:n}=e;return(0,r.jsx)(u.j0,{...n,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let i=c.get(t.allow_list_id);if(!i)return null;let{options:l}=i;return(0,r.jsx)(s.d,{name:n,allowClear:!0,mode:t.field_type!==o.AL.STRING?"multiple":void 0,label:t.name,options:l,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};n(94799)},97181:function(e,t,n){"use strict";n.d(t,{d:function(){return u}});var r=n(24246),i=n(87949),a=n(34090),l=n(27378),o=n(46238),s=n(40324);let u=e=>{let{name:t,label:n,labelProps:u,tooltip:d,isRequired:c,layout:h="inline",helperText:f,...m}=e,[p,_,{setValue:x}]=(0,a.U$)(t),v=!!(_.touched&&_.error),[E,T]=(0,l.useState)("");p.value||"tags"!==m.mode&&"multiple"!==m.mode||(p.value=[]),"tags"===m.mode&&"string"==typeof p.value&&(p.value=[p.value]);let y="tags"===m.mode?(e,t)=>e?e.value!==E||p.value.includes(E)?m.optionRender?m.optionRender(e,t):e.label:'Create "'.concat(E,'"'):void 0:m.optionRender||void 0,g=e=>{T(e),m.onSearch&&m.onSearch(e)},A=(e,t)=>{x(e),m.onChange&&m.onChange(e,t)};return"inline"===h?(0,r.jsx)(i.NIc,{isInvalid:v,isRequired:c,children:(0,r.jsxs)(i.rjZ,{templateColumns:n?"1fr 3fr":"1fr",children:[n?(0,r.jsx)(s.__,{htmlFor:m.id||t,...u,children:n}):null,(0,r.jsxs)(i.jqI,{align:"center",children:[(0,r.jsxs)(i.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,r.jsx)(i.WPr,{...p,id:m.id||t,"data-testid":"controlled-select-".concat(p.name),...m,optionRender:y,onSearch:"tags"===m.mode?g:void 0,onChange:A,value:p.value||void 0,status:v?"error":void 0}),f&&(0,r.jsx)(i.Q6r,{children:f}),(0,r.jsx)(s.Bc,{isInvalid:v,message:_.error,fieldName:p.name})]}),(0,r.jsx)(o.b,{label:d,className:v?"mt-2 self-start":void 0})]})]})}):(0,r.jsx)(i.NIc,{isInvalid:v,isRequired:c,children:(0,r.jsxs)(i.gCW,{alignItems:"start",children:[(0,r.jsxs)(i.jqI,{align:"center",children:[n?(0,r.jsx)(s.__,{htmlFor:m.id||t,fontSize:"xs",my:0,mr:1,...u,children:n}):null,(0,r.jsx)(o.b,{label:d})]}),(0,r.jsx)(i.WPr,{...p,id:m.id||t,"data-testid":"controlled-select-".concat(p.name),...m,optionRender:y,onSearch:"tags"===m.mode?g:void 0,onChange:A,value:p.value||void 0,status:v?"error":void 0}),f&&(0,r.jsx)(i.Q6r,{style:{marginTop:0},children:f}),(0,r.jsx)(s.Bc,{isInvalid:v,message:_.error,fieldName:p.name})]})})}},30234:function(e,t,n){"use strict";var r=n(24246),i=n(87949);t.Z=e=>{let{heading:t,HeadingButton:n,children:a}=e;return(0,r.jsx)(i.Kqy,{spacing:4,children:(0,r.jsxs)(i.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,r.jsxs)(i.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,r.jsx)(i.X6q,{as:"h3",size:"xs",children:t}),n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.LZC,{}),(0,r.jsx)(n,{})]}):null]}),(0,r.jsx)(i.Kqy,{spacing:4,px:6,py:6,children:a})]})})}},22583:function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var r=n(87949),i=n(65735);let a={[i.Ej.TAXONOMY_WHITE]:r.tAb.DEFAULT,[i.Ej.TAXONOMY_RED]:r.tAb.ERROR,[i.Ej.TAXONOMY_ORANGE]:r.tAb.WARNING,[i.Ej.TAXONOMY_YELLOW]:r.tAb.CAUTION,[i.Ej.TAXONOMY_GREEN]:r.tAb.SUCCESS,[i.Ej.TAXONOMY_BLUE]:r.tAb.INFO,[i.Ej.TAXONOMY_PURPLE]:r.tAb.ALERT,[i.Ej.SANDSTONE]:r.tAb.SANDSTONE,[i.Ej.MINOS]:r.tAb.MINOS}},92818:function(e,t,n){"use strict";n.d(t,{r:function(){return s}});var r=n(24246),i=n(27378),a=n(97181),l=n(22583),o=n(65735);let s={[o.Ej.TAXONOMY_WHITE]:"White",[o.Ej.TAXONOMY_RED]:"Red",[o.Ej.TAXONOMY_ORANGE]:"Orange",[o.Ej.TAXONOMY_YELLOW]:"Yellow",[o.Ej.TAXONOMY_GREEN]:"Green",[o.Ej.TAXONOMY_BLUE]:"Blue",[o.Ej.TAXONOMY_PURPLE]:"Purple",[o.Ej.SANDSTONE]:"Sandstone",[o.Ej.MINOS]:"Minos"},u=e=>{let{color:t,...n}=e;return(0,r.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(l.j[t],")"),border:t===o.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...n.style}})},d=e=>{let t=null==e?void 0:e.value,n=null==e?void 0:e.label;return(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(u,{color:t}),(0,r.jsx)("span",{children:n})]})};t.Z=e=>{let t=Object.values(o.Ej).map(e=>({value:e,label:s[e]})),[n,l]=(0,i.useState)(void 0);return(0,r.jsx)(a.d,{...e,options:t,optionRender:d,layout:"stacked",value:n,onChange:e=>{l(e)},prefix:(0,r.jsx)(u,{color:null!=n?n:o.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},59001:function(e,t,n){"use strict";n.d(t,{Ch:function(){return s},Lo:function(){return l},_g:function(){return u},ac:function(){return a},aq:function(){return d}});var r,i,a,l,o=n(65735);let s="root";(r=a||(a={})).DATA_CATEGORY="data_category",r.DATA_USE="data_use",r.DATA_SUBJECT="data_subject",r.SYSTEM_GROUP="system_group",(i=l||(l={})).DATA_CATEGORIES="Data categories",i.DATA_USES="Data uses",i.DATA_SUBJECTS="Data subjects",i.SYSTEM_GROUPS="System groups";let u=e=>{switch(e){case"data_category":return"Data categories";case"data_use":return"Data uses";case"data_subject":return"Data subjects";case"system_group":return"System groups";default:return e}},d=e=>{switch(e){case"data_category":return{UPDATE:o.Sh.DATA_CATEGORY_UPDATE,CREATE:o.Sh.DATA_CATEGORY_CREATE,DELETE:o.Sh.DATA_CATEGORY_DELETE,READ:o.Sh.DATA_CATEGORY_READ};case"data_use":return{UPDATE:o.Sh.DATA_USE_UPDATE,CREATE:o.Sh.DATA_USE_CREATE,DELETE:o.Sh.DATA_USE_DELETE,READ:o.Sh.DATA_USE_READ};case"data_subject":return{UPDATE:o.Sh.DATA_SUBJECT_UPDATE,CREATE:o.Sh.DATA_SUBJECT_CREATE,DELETE:o.Sh.DATA_SUBJECT_DELETE,READ:o.Sh.DATA_SUBJECT_READ};case"system_group":return{UPDATE:o.Sh.SYSTEM_GROUP_UPDATE,CREATE:o.Sh.SYSTEM_GROUP_CREATE,DELETE:o.Sh.SYSTEM_GROUP_DELETE,READ:o.Sh.SYSTEM_GROUP_READ};default:return{UPDATE:o.Sh.TAXONOMY_UPDATE,CREATE:o.Sh.TAXONOMY_CREATE,DELETE:o.Sh.TAXONOMY_DELETE,READ:o.Sh.TAXONOMY_READ}}}},90673:function(e,t,n){"use strict";n.d(t,{Cd:function(){return a},Xl:function(){return l}});var r=n(65735),i=n(59001);let a=(e,t)=>{let n;if(null==t&&e.every(e=>void 0===e.parent_key))n=e;else{let r=null!=t?t:null;n=e.filter(e=>e.parent_key===r)}return n.map(t=>{var n,r;let i=t.fides_key;return{value:t.fides_key,label:""===t.name||null==t.name?t.fides_key:t.name,description:t.description,children:a(e,i),is_default:null!==(n=t.is_default)&&void 0!==n&&n,active:null!==(r=t.active)&&void 0!==r&&r}})},l=e=>{switch(e){case i.ac.DATA_CATEGORY:return r.P6.DATA_CATEGORY;case i.ac.DATA_SUBJECT:return r.P6.DATA_SUBJECT;case i.ac.DATA_USE:return r.P6.DATA_USE;default:return}}},33031:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eL}});var r,i,a=n(24246),l=n(87949),o=n(69238),s=n.n(o),u=n(63662),d=n(27378),c=n(25980),h=n(812),f=n(77213),m=n(58754),p=n(19904),_=n(46628),x=n(33162),v=n(79806),E=n(56358),T=n(59001),y=n(90673),g=n(30002),A=n(28079),j=n(69353),S=n(5785);let{useGetCustomTaxonomiesQuery:b,useLazyGetTaxonomyQuery:C,useCreateTaxonomyMutation:O,useUpdateTaxonomyMutation:N,useDeleteTaxonomyMutation:I}=n(78780).u.injectEndpoints({endpoints:e=>({getCustomTaxonomies:e.query({query:()=>({url:"taxonomies"})}),getTaxonomy:e.query({query:e=>({url:"taxonomies/".concat(e)}),providesTags:(e,t,n)=>[{type:"Taxonomy",id:n}],transformResponse:e=>{let t=[],n=[...e],r=n.filter(e=>null===e.parent_key);r.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...r);let i=n.filter(e=>null!==e.parent_key);for(;i.length>0;){let e=i.filter(e=>t.some(t=>t.fides_key===e.parent_key));if(0===e.length){t.push(...i.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)));break}e.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...e),i=i.filter(t=>!e.includes(t))}return t}}),createTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t),method:"POST",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}}),updateTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t),method:"PUT",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}}),deleteTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,key:n}=e;return{url:"taxonomies/".concat(t,"/").concat(n),method:"DELETE"}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r}]}})})});var D=e=>{let{taxonomyType:t}=e,[n,r]=(0,S.Vj)(),[i,a]=(0,g.nC)(),[l,o]=(0,A.dk)(),[s,u]=(0,j.cw)(),[c,h]=(0,S.Ti)(),[f,m]=(0,A.Ql)(),[p,_]=(0,g.wG)(),[x,v]=(0,j.Nr)(),[E]=(0,S.jU)(),[y]=(0,A.LG)(),[b]=(0,g.h8)(),[D]=(0,j.Xz)(),[k]=(0,S.K9)(),[R]=(0,A.gu)(),[P]=(0,g.Kv)(),[w]=(0,j.Uv)(),[L,M]=C(),[U,V]=O(),[Y]=N(),[F]=I(),B=(0,d.useCallback)(()=>t?L(t):Promise.resolve(void 0),[t,L]),z=(0,d.useCallback)(e=>t?U({taxonomyType:t,...e}):Promise.resolve(void 0),[t,U]),G=(0,d.useCallback)(e=>t?Y({taxonomyType:t,...e}):Promise.resolve(void 0),[t,Y]),H=(0,d.useCallback)(e=>t?F({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,F]);return t===T.ac.DATA_CATEGORY?{getAllTrigger:n,taxonomyItems:r.data||[],updateTrigger:E,deleteTrigger:k,createTrigger:c,isLoading:r.isLoading,isError:r.isError,isCreating:h.isLoading}:t===T.ac.DATA_USE?{getAllTrigger:l,taxonomyItems:o.data||[],updateTrigger:y,deleteTrigger:R,createTrigger:f,isLoading:o.isLoading,isError:o.isError,isCreating:m.isLoading}:t===T.ac.DATA_SUBJECT?{getAllTrigger:i,taxonomyItems:a.data||[],updateTrigger:b,deleteTrigger:P,createTrigger:p,isLoading:a.isLoading,isError:a.isError,isCreating:_.isLoading}:t===T.ac.SYSTEM_GROUP?{getAllTrigger:s,taxonomyItems:u.data||[],updateTrigger:D,deleteTrigger:w,createTrigger:x,isLoading:u.isLoading,isError:u.isError,isCreating:v.isLoading}:{getAllTrigger:B,taxonomyItems:(null==M?void 0:M.data)||[],updateTrigger:G,deleteTrigger:H,createTrigger:z,isLoading:(null==M?void 0:M.isLoading)||!1,isError:(null==M?void 0:M.isError)||!1,isCreating:V.isLoading}},k=n(31883),R=n(90104),P=n.n(R),w=n(18225),L=n(65735),M=e=>{let{customFields:t,formId:n,form:r}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:o,isEnabled:s,isLoading:u,sortedCustomFieldDefinitionIds:d}=t;return s&&0!==d.length?(0,a.jsxs)(l.PPS,{form:r,name:n,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(l.AntTypography.Title,{level:3,children:"Custom fields"})}),u?(0,a.jsx)(w.Z,{}):(0,a.jsx)("div",{children:!P()(d)&&(0,a.jsx)("div",{children:d.map(e=>{let t=o.get(e);if(!t)return null;let{id:n,name:r,description:s,allow_list_id:u,field_type:d}=t;if(!u&&d===L.AL.STRING)return(0,a.jsx)(l.PPS.Item,{name:n,label:r,tooltip:s,children:(0,a.jsx)(l.AntInput,{})},e);let c=i.get(t.allow_list_id);if(!c)return null;let{options:h}=c;return(0,a.jsx)(l.PPS.Item,{name:n,label:r,tooltip:s,children:(0,a.jsx)(l.WPr,{mode:"string"!==d?"multiple":void 0,allowClear:!0,options:h})},e)})})})]}):null},U=n(43551),V=n.n(U),Y=()=>{let e=l.PPS.useFormInstance(),t=l.PPS.useWatch(["rights","values"],e);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.PPS.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,a.jsx)(l.E_O,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,a.jsx)(l.PPS.Item,{name:["rights","values"],label:"Rights",children:(0,a.jsx)(l.WPr,{mode:"multiple",options:(0,h.MM)(L.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!P()(t)&&(0,a.jsx)(l.PPS.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,a.jsx)(l.WPr,{options:(0,h.MM)(L.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},F=n(83766),B=n.n(F),z=n(1315),G=n(22583),H=n(92818);let X=e=>{let{color:t,...n}=e;return(0,a.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(G.j[t],")"),border:t===L.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...n.style}})};var q=e=>{let t=Object.values(L.Ej).map(e=>({value:e,label:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(X,{color:e}),(0,a.jsx)("span",{children:H.r[e]})]})}));return(0,a.jsx)(l.WPr,{...e,options:t,placeholder:"Select color"})};let W="all-suggested";var Z=e=>{let{initialValues:t,onSubmit:n,form:r,formId:i,isDisabled:o}=e,{data:s=[],isLoading:u}=(0,A.fd)(),{data:c,isLoading:h}=(0,z.K3)(),f=(0,d.useMemo)(()=>s.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[s]),m=l.PPS.useWatch("systems",r),p=(0,d.useMemo)(()=>{var e;let t=m||[];if(!c||0===t.length)return[];let n=null!==(e=null==c?void 0:c.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return B()(null==n?void 0:n.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[c,m]),_=(0,d.useMemo)(()=>{var e;return null!==(e=null==c?void 0:c.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[c]),x=(0,d.useMemo)(()=>{let e=[],t=[];return(f.forEach(n=>{p.includes(n.value)?e.push(n):t.push(n)}),0===e.length)?t:[{label:"Select all suggested",value:W},{label:(0,a.jsxs)(l.vyj,{children:[(0,a.jsx)(l.QMR,{size:14}),(0,a.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,a.jsxs)(l.vyj,{children:[(0,a.jsx)(l.PJP.BBB,{}),(0,a.jsx)("span",{children:"All data uses"})]}),options:t}]},[f,p]);return(0,a.jsxs)(l.PPS,{name:i,initialValues:t,onFinish:e=>{var r,i;let a={...t,...e};(!(null==a?void 0:null===(r=a.rights)||void 0===r?void 0:r.values)||P()(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values))&&V()(a,"rights"),n(a)},layout:"vertical",form:r,children:[(0,a.jsx)(l.PPS.Item,{label:"Name",name:"name",children:(0,a.jsx)(l.AntInput,{"data-testid":"edit-taxonomy-form_name",disabled:o})}),(0,a.jsx)(l.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(l.AntInput.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:o})}),(0,a.jsx)(l.PPS.Item,{label:"Systems",name:"systems",children:(0,a.jsx)(l.WPr,{mode:"multiple",placeholder:"Select systems",options:_,allowClear:!0,loading:h,disabled:o,"data-testid":"edit-taxonomy-form_systems"})}),(0,a.jsx)(l.PPS.Item,{label:"Color",name:"label_color",children:(0,a.jsx)(q,{disabled:o,"data-testid":"edit-taxonomy-form_color"})}),(0,a.jsx)(l.PPS.Item,{label:"Data uses",name:"data_uses",children:(0,a.jsx)(l.WPr,{mode:"multiple",placeholder:"Select data uses",options:x,allowClear:!0,loading:u,disabled:o,onChange:e=>{if(e.includes(W)){let t=B()([...p,...e.filter(e=>e!==W)]);r.setFieldsValue({data_uses:t})}else r.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},J=e=>{let{initialValues:t,onSubmit:n,form:r,formId:i,taxonomyType:o,isDisabled:s}=e,u=o===T.ac.DATA_SUBJECT;return o===T.ac.SYSTEM_GROUP?(0,a.jsx)(Z,{initialValues:t,onSubmit:n,form:r,formId:i,isDisabled:s}):(0,a.jsxs)(l.PPS,{name:i,initialValues:t,onFinish:e=>{var r,i;let a={...t,...e};(!(null==a?void 0:null===(r=a.rights)||void 0===r?void 0:r.values)||P()(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values))&&V()(a,"rights"),n(a)},layout:"vertical",form:r,children:[(0,a.jsx)(l.PPS.Item,{label:"Name",name:"name",children:(0,a.jsx)(l.AntInput,{"data-testid":"edit-taxonomy-form_name",disabled:s})}),(0,a.jsx)(l.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(l.AntInput.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:s})}),u&&(0,a.jsx)(Y,{})]})},K=e=>{let{taxonomyItem:t,taxonomyType:n,onClose:r}=e,i="edit-taxonomy-form",[o]=l.PPS.useForm(),[s]=l.PPS.useForm(),u=(0,l.pmc)(),{isOpen:d,onOpen:c,onClose:f}=(0,l.qY0)(),{updateTrigger:m}=D({taxonomyType:n}),g=(0,x.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:(0,y.Xl)(n)}),A=(0,p.Tg)([(0,T.aq)(n).UPDATE]),j=(0,p.Tg)([(0,T.aq)(n).DELETE]),S=async e=>{let n=await m(e);if((0,k.D4)(n)){u((0,_.Vo)((0,h.e$)(n.error)));return}if(g.isEnabled){let e=s.getFieldsValue();await g.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}u((0,_.t5)("Taxonomy successfully updated")),r()},b=async()=>{await m({...t,active:!1}),f(),r()},C=async()=>{await m({...t,active:!0}),f(),r()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(v.ZP,{isOpen:!!t,onClose:r,header:(0,a.jsx)(v.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,a.jsxs)(l.zeN,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&j&&(0,a.jsx)(l.esZ,{title:"Delete label",children:(0,a.jsx)(l.wpx,{"aria-label":"delete",icon:(0,a.jsx)(E.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&A&&(0,a.jsx)(l.esZ,{title:"Enable label",children:(0,a.jsx)(l.wpx,{"aria-label":"enable",onClick:C,"data-testid":"enable-btn",icon:(0,a.jsx)(l.tEF,{fontSize:"small"})})}),(0,a.jsx)("div",{className:"flex gap-2",children:A&&(0,a.jsx)(l.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:i,children:"Save"})})]}),children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(l.AntTypography.Title,{level:3,children:"Details"})}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,a.jsx)(l.esZ,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,a.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,a.jsx)(J,{initialValues:t,onSubmit:S,form:o,formId:i,taxonomyType:n,isDisabled:!A}),g.isEnabled&&!g.isLoading&&(0,a.jsx)(M,{form:s,formId:"custom-fields-form",customFields:g})]}),(0,a.jsx)(l.cVQ,{isOpen:d,onClose:f,onConfirm:b,title:"Delete ".concat(n),message:(0,a.jsx)(l.Kqy,{children:(0,a.jsxs)(l.xvT,{children:["You are about to permanently delete the ",n," ",(0,a.jsx)(l.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};n(51901);var $=n(86298),Q=n(3124),ee=n.n(Q);(r=i||(i={})).DEFAULT="DEFAULT",r.ACTIVE_HOVER="ACTIVE_HOVER",r.PARENT_OF_HOVER="PARENT_OF_HOVER",r.CHILD_OF_HOVER="CHILD_OF_HOVER",r.SIBLING_OF_HOVER="SIBLING_OF_HOVER",r.INACTIVE="INACTIVE";let et=(0,d.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),en=e=>{let{children:t}=e,[n,r]=(0,d.useState)(null),i=(0,d.useCallback)(e=>{e!==n&&r(e)},[n]),l=(0,d.useCallback)(()=>{r(null)},[]),o=(0,d.useCallback)(e=>n?e===n?"ACTIVE_HOVER":n.startsWith("".concat(e,"."))||e===T.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(n,"."))||n===T.Ch?"CHILD_OF_HOVER":n.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[n]),s=(0,d.useMemo)(()=>({activeNodeKey:n,setActiveNodeKey:r,onMouseEnter:i,onMouseLeave:l,getNodeHoverStatus:o}),[n,r,i,l,o]);return(0,a.jsx)(et.Provider,{value:s,children:t})};function er(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function ei(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=el)):void 0===t&&(t=ea);for(var n,r,i,a,l,o=new eu(e),s=[o];n=s.pop();)if((i=t(n.data))&&(l=(i=Array.from(i)).length))for(n.children=i,a=l-1;a>=0;--a)s.push(r=i[a]=new eu(i[a])),r.parent=n,r.depth=n.depth+1;return o.eachBefore(es)}function ea(e){return e.children}function el(e){return Array.isArray(e)?e[1]:null}function eo(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function es(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function eu(e){this.data=e,this.depth=this.height=0,this.parent=null}function ed(e,t){return e.parent===t.parent?1:2}function ec(e){var t=e.children;return t?t[0]:e.t}function eh(e){var t=e.children;return t?t[t.length-1]:e.t}function ef(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function em(e){return null==e?null:function(e){if("function"!=typeof e)throw Error();return e}(e)}eu.prototype=ei.prototype={constructor:eu,count:function(){return this.eachAfter(er)},each:function(e,t){let n=-1;for(let r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,a=this,l=[a],o=[],s=-1;a=l.pop();)if(o.push(a),n=a.children)for(r=0,i=n.length;r<i;++r)l.push(n[r]);for(;a=o.pop();)e.call(t,a,++s,this);return this},eachBefore:function(e,t){for(var n,r,i=this,a=[i],l=-1;i=a.pop();)if(e.call(t,i,++l,this),n=i.children)for(r=n.length-1;r>=0;--r)a.push(n[r]);return this},find:function(e,t){let n=-1;for(let r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)r.push(t=t.parent);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return ei(this).eachBefore(eo)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,a=[i];do for(e=a.reverse(),a=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)a.push(t[n]);while(a.length)}},ef.prototype=Object.create(eu.prototype);var ep={depth:-1},e_={},ex={};function ev(e){return e.id}function eE(e){return e.parentId}function eT(e){let t=e.length;if(t<2)return"";for(;--t>1&&!ey(e,t););return e.slice(0,t)}function ey(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if((1&n)==0)return!0}return!1}let eg=function(){var e=ed,t=1,n=1,r=null;function i(i){var s=function(e){for(var t,n,r,i,a,l=new ef(e,0),o=[l];t=o.pop();)if(r=t._.children)for(t.children=Array(a=r.length),i=a-1;i>=0;--i)o.push(n=t.children[i]=new ef(r[i],i)),n.parent=t;return(l.parent=new ef(null,0)).children=[l],l}(i);if(s.eachAfter(a),s.parent.m=-s.z,s.eachBefore(l),r)i.eachBefore(o);else{var u=i,d=i,c=i;i.eachBefore(function(e){e.x<u.x&&(u=e),e.x>d.x&&(d=e),e.depth>c.depth&&(c=e)});var h=u===d?1:e(u,d)/2,f=h-u.x,m=t/(d.x+h+f),p=n/(c.depth||1);i.eachBefore(function(e){e.x=(e.x+f)*m,e.y=e.depth*p})}return i}function a(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,a=i.length;--a>=0;)t=i[a],t.z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var a=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-a):t.z=a}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,a,l,o=t,s=t,u=n,d=o.parent.children[0],c=o.m,h=s.m,f=u.m,m=d.m;u=eh(u),o=ec(o),u&&o;)d=ec(d),(s=eh(s)).a=t,(l=u.z+f-o.z-c+e(u._,o._))>0&&(function(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}((i=u,a=r,i.a.parent===t.parent?i.a:a),t,l),c+=l,h+=l),f+=u.m,c+=o.m,m+=d.m,h+=s.m;u&&!eh(s)&&(s.t=u,s.m+=f-h),o&&!ec(d)&&(d.t=o,d.m+=c-m,r=t)}return r}(t,i,t.parent.A||r[0])}function l(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function o(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}();var eA=e=>{let{nodes:t,edges:n,options:r}=e;return(0,d.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:n};let e=(function(){var e,t=ev,n=eE;function r(r){var i,a,l,o,s,u,d,c,h=Array.from(r),f=t,m=n,p=new Map;if(null!=e){let t=h.map((t,n)=>{var i;let a;return i=e(t,n,r),a=(i=`${i}`).length,ey(i,a-1)&&!ey(i,a-2)&&(i=i.slice(0,-1)),"/"===i[0]?i:`/${i}`}),n=t.map(eT),i=new Set(t).add("");for(let e of n)i.has(e)||(i.add(e),t.push(e),n.push(eT(e)),h.push(ex));f=(e,n)=>t[n],m=(e,t)=>n[t]}for(l=0,i=h.length;l<i;++l)a=h[l],u=h[l]=new eu(a),null!=(d=f(a,l,r))&&(d+="")&&(c=u.id=d,p.set(c,p.has(c)?e_:u)),null!=(d=m(a,l,r))&&(d+="")&&(u.parent=d);for(l=0;l<i;++l)if(d=(u=h[l]).parent){if(!(s=p.get(d)))throw Error("missing: "+d);if(s===e_)throw Error("ambiguous: "+d);s.children?s.children.push(u):s.children=[u],u.parent=s}else{if(o)throw Error("multiple roots");o=u}if(!o)throw Error("no root");if(null!=e){for(;o.data===ex&&1===o.children.length;)o=o.children[0],--i;for(let e=h.length-1;e>=0&&(u=h[e]).data===ex;--e)u.data=null}if(o.parent=ep,o.eachBefore(function(e){e.depth=e.parent.depth+1,--i}).eachBefore(es),o.parent=null,i>0)throw Error("cycle");return o}return r.id=function(e){return arguments.length?(t=em(e),r):t},r.parentId=function(e){return arguments.length?(n=em(e),r):n},r.path=function(t){return arguments.length?(e=em(t),r):e},r})().id(e=>e.id).parentId(e=>{var t;return null===(t=n.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),i="LR"===r.direction?[35,320]:[320,35];return{nodes:eg.nodeSize(i).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===r.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:n}},[t,n,r])},ej=e=>{let{positionAbsoluteX:t,positionAbsoluteY:n,nodeWidth:r}=e,{setCenter:i,getZoom:a}=(0,$._K)();return{centerScreenOnNode:(0,d.useCallback)(()=>i(t+r/2,n,{duration:500,zoom:a()}),[a,t,n,r,i])}},eS=n(1945),eb=n.n(eS),eC=n(8335),eO=e=>{let{type:t,inactive:n=!1}=e;return(0,a.jsx)($.HH,{type:t,position:"source"===t?eC.Ly.Right:eC.Ly.Left,style:{width:8,height:8,backgroundColor:n?ee().FIDESUI_NEUTRAL_400:ee().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},eN=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:r}=e,{onCancel:i,onSubmit:o,parentKey:s,isLoading:u=!1}=t,c=(0,d.useRef)(null),[h,f]=(0,d.useState)(""),{centerScreenOnNode:m}=ej({positionAbsoluteX:n,positionAbsoluteY:r,nodeWidth:200});(0,d.useEffect)(()=>{f("");let e=()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await m(),e()})()},[s,m,n,r]);let p=()=>{!u&&h.trim()&&o(h)},_=()=>{u||i()};return(0,a.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,a.jsx)(l.AntInput,{placeholder:"Type label name...",ref:c,onBlur:_,onSubmit:p,value:h,onChange:e=>f(e.target.value),onKeyUp:e=>{"Escape"===e.key&&_()},onPressEnter:p,className:eb().input,suffix:u&&(0,a.jsx)(l.ZJQ,{size:"small"})}),(0,a.jsx)(eO,{type:"target"})]})},eI=e=>{let{getNodeHoverStatus:t}=(0,d.useContext)(et),{target:n}=e,r=t(n),l=(0,d.useCallback)(()=>{switch(r){case i.ACTIVE_HOVER:case i.PARENT_OF_HOVER:return ee().FIDESUI_MINOS;case i.INACTIVE:return ee().NEUTRAL_400;default:return ee().FIDESUI_SANDSTONE}},[r]),o=(0,d.useCallback)(()=>{switch(r){case i.ACTIVE_HOVER:case i.PARENT_OF_HOVER:return 2;default:return 1}},[r]);return(0,a.jsx)($.Jd,{...e,style:{stroke:l(),strokeWidth:o(),transition:"stroke 0.3s ease 0s"}})},eD=n(34770),ek=n.n(eD),eR=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:r}=e,{onMouseEnter:o,onMouseLeave:s,getNodeHoverStatus:u}=(0,d.useContext)(et),{taxonomyType:c,taxonomyItem:h,onAddButtonClick:f,onTaxonomyItemClick:m,label:p,hasChildren:_,isLastCreatedItem:x,resetLastCreatedItemKey:v,userCanAddLabels:E}=t,{centerScreenOnNode:y}=ej({positionAbsoluteX:n,positionAbsoluteY:r,nodeWidth:200});(0,d.useEffect)(()=>{let e=async()=>{await y(),o(null==h?void 0:h.fides_key)};x&&(e(),v())},[x,o,null==h?void 0:h.fides_key,v,y]);let g=u(null==h?void 0:h.fides_key),A=(0,d.useCallback)(()=>{switch(g){case i.ACTIVE_HOVER:return ek()["button--hover"];case i.PARENT_OF_HOVER:return ek()["button--parent-hover"];case i.INACTIVE:return ek()["button--inactive"];case i.DEFAULT:case i.CHILD_OF_HOVER:case i.SIBLING_OF_HOVER:default:return""}},[g]),j=(null==h?void 0:h.fides_key)===T.Ch,S=c===T.ac.DATA_SUBJECT;return(0,a.jsxs)("div",{className:ek().container,onMouseEnter:()=>o(null==h?void 0:h.fides_key),onMouseLeave:()=>s(null==h?void 0:h.fides_key),"data-testid":"taxonomy-node-".concat(null==h?void 0:h.fides_key),children:[(0,a.jsx)(l.wpx,{className:"".concat(ek().button," ").concat(A()),onClick:()=>null==m?void 0:m(h),disabled:!m,type:"text",children:(0,a.jsxs)(l.AntTypography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==h?void 0:h.active)===!1?"(disabled) ":"",p]})}),!j&&(0,a.jsx)(eO,{type:"target",inactive:g===i.INACTIVE}),_&&(0,a.jsx)(eO,{type:"source",inactive:g===i.INACTIVE}),E&&(!S||j)&&(0,a.jsx)("div",{className:ek()["add-button-container"],children:(0,a.jsx)(l.wpx,{type:"default",className:"".concat(ek()["add-button"]," ").concat(g===i.ACTIVE_HOVER?ek()["add-button--visible"]:""),icon:(0,a.jsx)(l.PJP.mm_,{size:20}),onClick:()=>null==f?void 0:f(h),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(p)})})]})};let eP=e=>{let{taxonomyType:t,taxonomyItems:n,draftNewItem:r,lastCreatedItemKey:i,resetLastCreatedItemKey:l,onTaxonomyItemClick:o,onAddButtonClick:s,onCancelDraftItem:u,onSubmitDraftItem:c,userCanAddLabels:h,isCreating:f=!1}=e,{fitView:m}=(0,$._K)();(0,d.useEffect)(()=>{setTimeout(()=>m(),150)},[m,t]);let p=[(0,d.useMemo)(()=>({id:T.Ch,position:{x:0,y:0},data:{label:(0,T._g)(t),taxonomyItem:{fides_key:T.Ch},taxonomyType:t,onTaxonomyItemClick:null,onAddButtonClick:s,hasChildren:0!==n.length,userCanAddLabels:h},type:"taxonomyTreeNode"}),[t,n.length,s,h])],_=[];if(n.forEach(e=>{let n=e.name||e.fides_key.split(".").pop()||"",r={id:e.fides_key,position:{x:0,y:0},data:{label:n,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:s,hasChildren:!1,isLastCreatedItem:i===e.fides_key,resetLastCreatedItemKey:l,userCanAddLabels:h},type:"taxonomyTreeNode"};p.push(r);let a=e.parent_key?p.find(t=>t.id===e.parent_key):null,u=a?a.id:T.Ch,d=e.fides_key,c={id:"".concat(u,"-").concat(d),source:u,target:d,type:"taxonomyTreeEdge"};_.push(c),a&&(a.data.hasChildren=!0)}),r){let e=r.parent_key||T.Ch;p.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:u,onSubmit:c,isLoading:f},hidden:!r}),_.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=p.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:x,edges:v}=eA({nodes:p,edges:_,options:{direction:"LR"}}),E=(0,d.useMemo)(()=>({taxonomyTreeNode:eR,textInputNode:eN}),[]),y=(0,d.useMemo)(()=>({taxonomyTreeEdge:eI}),[]);return(0,a.jsx)("div",{className:"size-full",style:{backgroundColor:ee().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,a.jsx)(en,{children:(0,a.jsxs)($.x$,{nodes:x,edges:v,nodeTypes:E,edgeTypes:y,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,a.jsx)($.Aq,{color:ee().FIDESUI_NEUTRAL_100,variant:$.T7.Dots,size:3}),(0,a.jsx)($.a9,{nodeStrokeWidth:3,pannable:!0}),(0,a.jsx)($.ZX,{showInteractive:!1})]})})})};var ew=e=>(0,a.jsx)($.tV,{children:(0,a.jsx)(eP,{...e})}),eL=()=>{let[e,t]=(0,d.useState)(T.ac.DATA_CATEGORY),n=(0,c.hz)().plus,{data:r}=b(void 0,{skip:!n}),{createTrigger:i,getAllTrigger:o,taxonomyItems:x=[],isCreating:v}=D({taxonomyType:e}),E=(0,u.useSearchParams)(),y=(null==E?void 0:E.get("showDisabledItems"))==="true";(0,d.useEffect)(()=>{o()},[o,e]);let[g,A]=(0,d.useState)(null),[j,S]=(0,d.useState)(null),[C,O]=(0,d.useState)(null);(0,d.useEffect)(()=>{S(null),O(null),A(null)},[e]),(0,d.useEffect)(()=>{e!==T.ac.SYSTEM_GROUP||n||t(T.ac.DATA_CATEGORY)},[e,n]);let N=(0,l.pmc)(),I=(0,d.useCallback)(async e=>{if(!j)return;let t=(null==j?void 0:j.parent_key)===T.Ch,n={...j,name:e,parent_key:t?null:j.parent_key},r=await i(n);if((0,h.D4)(r)){N((0,_.Vo)((0,h.e$)(r.error)));return}O(r.data.fides_key),N((0,_.t5)("New label successfully created")),S(null)},[i,j,N]),k=s()(x,"active"),R=(0,p.Tg)([(0,T.aq)(e).CREATE]);return(0,a.jsxs)(f.Z,{title:"Taxonomy",children:[(0,a.jsxs)(l.jqI,{vertical:!0,className:"h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m.Z,{heading:"Taxonomy"}),(0,a.jsx)("div",{className:"hidden",children:(0,a.jsx)("div",{className:"mb-5 flex justify-between",children:(0,a.jsxs)(l.vyj.Compact,{children:[(0,a.jsx)(l.AntInput,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,a.jsx)(l.wpx,{type:"default",children:"Clear"})]})})})]}),(0,a.jsxs)("div",{className:"relative grow",children:[(0,a.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,a.jsx)(l.AHg,{selectedKeys:[e],onSelect:e=>{let{key:n}=e;return t(n)},items:(()=>{let e={[T.Lo.DATA_CATEGORIES]:T.ac.DATA_CATEGORY,[T.Lo.DATA_USES]:T.ac.DATA_USE,[T.Lo.DATA_SUBJECTS]:T.ac.DATA_SUBJECT,[T.Lo.SYSTEM_GROUPS]:T.ac.SYSTEM_GROUP},t=(0,h.MM)(T.Lo).filter(e=>n||e.value!==T.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==r?void 0:r.length)&&r.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),t})(),"data-testid":"taxonomy-type-selector"})}),!!x.length&&(0,a.jsx)(ew,{userCanAddLabels:R,taxonomyItems:y?x:k,draftNewItem:j,lastCreatedItemKey:C,resetLastCreatedItemKey:()=>O(null),onTaxonomyItemClick:e=>{A(e)},onAddButtonClick:e=>{var t;S({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:e,onCancelDraftItem:()=>S(null),onSubmitDraftItem:I,isCreating:v})]})]}),g&&(0,a.jsx)(K,{taxonomyItem:g,taxonomyType:e,onClose:()=>A(null)})]})}},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return r.Bw},D4:function(){return r.D4}});var r=n(19043)},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}},function(e){e.O(0,[1096,431,8765,9278,5163,3662,6148,7245,3772,2888,9774,179],function(){return e(e.s=71180)}),_N_E=e.O()}]);