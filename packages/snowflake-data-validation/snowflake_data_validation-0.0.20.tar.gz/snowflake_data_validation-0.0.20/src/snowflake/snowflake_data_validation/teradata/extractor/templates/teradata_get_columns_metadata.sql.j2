SELECT
    TRIM(C.DatabaseName) AS DATABASE_NAME,
    TRIM(C.DatabaseName) AS SCHEMA_NAME,
    TRIM(C.TableName) AS TABLE_NAME,
    TRIM(C.ColumnName) AS COLUMN_NAME,
    CASE TRIM(C.ColumnType)
        WHEN 'A1' THEN 'ARRAY'
        WHEN 'AN' THEN 'MULTI-DIMENSIONAL ARRAY'
        WHEN 'AT' THEN 'TIME'
        WHEN 'BF' THEN 'BYTE'
        WHEN 'BO' THEN 'BLOB'
        WHEN 'BV' THEN 'VARBYTE'
        WHEN 'CF' THEN 'CHAR'
        WHEN 'CO' THEN 'CLOB'
        WHEN 'CV' THEN 'VARCHAR'
        WHEN 'D'  THEN 'DECIMAL'
        WHEN 'DA' THEN 'DATE'
        WHEN 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN 'DY' THEN 'INTERVAL DAY'
        WHEN 'F'  THEN 'FLOAT'
        WHEN 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN 'HR' THEN 'INTERVAL HOUR'
        WHEN 'I'  THEN 'INTEGER'
        WHEN 'I1' THEN 'BYTEINT'
        WHEN 'I2' THEN 'SMALLINT'
        WHEN 'I8' THEN 'BIGINT'
        WHEN 'JN' THEN 'JSON'
        WHEN 'MI' THEN 'INTERVAL MINUTE'
        WHEN 'MO' THEN 'INTERVAL MONTH'
        WHEN 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN 'N'  THEN 'NUMBER'
        WHEN 'PD' THEN 'PERIOD(DATE)'
        WHEN 'PM' THEN 'PERIOD(TIMESTAMP WITH TIME ZONE)'
        WHEN 'PS' THEN 'PERIOD(TIMESTAMP)'
        WHEN 'PT' THEN 'PERIOD(TIME)'
        WHEN 'PZ' THEN 'PERIOD(TIME WITH TIME ZONE)'
        WHEN 'SC' THEN 'INTERVAL SECOND'
        WHEN 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN 'TS' THEN 'TIMESTAMP'
        WHEN 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN 'UT' THEN TRIM(C.ColumnUDTName)
        WHEN 'XM' THEN 'XML'
        WHEN 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN 'YR' THEN 'INTERVAL YEAR'
        ELSE TRIM(C.ColumnType)  -- Fallback to original type if not matched
    END AS DATA_TYPE,
    C.ColumnLength AS "CHARACTER_LENGTH",
    CASE 
        WHEN C.ColumnType IN ('DECIMAL', 'NUMERIC', 'NUMBER') THEN C.DecimalTotalDigits
        ELSE NULL 
    END AS "PRECISION",
    CASE 
        WHEN C.ColumnType IN ('DECIMAL', 'NUMERIC', 'NUMBER') THEN C.DecimalFractionalDigits
        ELSE NULL 
    END AS "SCALE",
    CASE 
        WHEN C.Nullable = 'Y' THEN 1
        ELSE 0
    END AS NULLABLE,
    0 AS IS_PRIMARY_KEY,
    COALESCE(C.ColumnLength, 0) AS CALCULATED_COLUMN_SIZE_IN_BYTES,
    C.ColumnId AS ORDINAL_POSITION,
    C.DefaultValue AS COLUMN_DEFAULT,
    C.CommentString AS COLUMN_COMMENT
FROM DBC.Columns C
WHERE TRIM(C.DatabaseName) = '{{ schema_name }}'
    AND TRIM(C.TableName) = '{{ table_name }}'