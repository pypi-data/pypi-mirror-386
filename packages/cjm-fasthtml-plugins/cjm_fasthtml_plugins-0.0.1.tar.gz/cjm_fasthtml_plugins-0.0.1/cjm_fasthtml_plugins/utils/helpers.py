"""Utility functions for plugin registry operations"""

# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/utils/helpers.ipynb.

# %% auto 0
__all__ = ['filter_plugins_by_execution_mode', 'get_cloud_plugins', 'get_local_plugins', 'get_configured_plugins',
           'get_unconfigured_plugins', 'get_plugin_stats']

# %% ../../nbs/utils/helpers.ipynb 3
from typing import Any, Dict, List
from ..core.metadata import PluginMetadata
from ..core.execution_mode import PluginExecutionMode

# %% ../../nbs/utils/helpers.ipynb 5
def filter_plugins_by_execution_mode(
    plugins: List[PluginMetadata],  # List of plugin metadata
    mode: PluginExecutionMode  # Execution mode to filter by
) -> List[PluginMetadata]:  # Filtered list
    """Filter plugins by execution mode.
    
    Args:
        plugins: List of plugin metadata
        mode: Execution mode to filter by
    
    Returns:
        List of plugins matching the execution mode
    """
    return [p for p in plugins if p.execution_mode == mode]

def get_cloud_plugins(plugins: List[PluginMetadata]) -> List[PluginMetadata]:
    """Get all cloud/remote execution plugins.
    
    Args:
        plugins: List of plugin metadata
    
    Returns:
        List of cloud/remote plugins
    """
    return [p for p in plugins if p.is_cloud_execution()]

def get_local_plugins(plugins: List[PluginMetadata]) -> List[PluginMetadata]:
    """Get all local execution plugins.
    
    Args:
        plugins: List of plugin metadata
    
    Returns:
        List of local plugins
    """
    return [p for p in plugins if p.is_local_execution()]

def get_configured_plugins(plugins: List[PluginMetadata]) -> List[PluginMetadata]:
    """Get plugins that have saved configuration.
    
    Args:
        plugins: List of plugin metadata
    
    Returns:
        List of configured plugins
    """
    return [p for p in plugins if p.is_configured]

def get_unconfigured_plugins(plugins: List[PluginMetadata]) -> List[PluginMetadata]:
    """Get plugins that need configuration.
    
    Args:
        plugins: List of plugin metadata
    
    Returns:
        List of unconfigured plugins
    """
    return [p for p in plugins if not p.is_configured]

# %% ../../nbs/utils/helpers.ipynb 8
def get_plugin_stats(plugins: List[PluginMetadata]) -> Dict[str, Any]:
    """Get statistics about a list of plugins.
    
    Args:
        plugins: List of plugin metadata
    
    Returns:
        Dictionary with plugin statistics
    """
    return {
        "total": len(plugins),
        "configured": len([p for p in plugins if p.is_configured]),
        "unconfigured": len([p for p in plugins if not p.is_configured]),
        "local": len([p for p in plugins if p.is_local_execution()]),
        "cloud": len([p for p in plugins if p.is_cloud_execution()]),
        "with_active_resources": len([p for p in plugins if p.has_active_resources()]),
        "by_category": {}
    }
