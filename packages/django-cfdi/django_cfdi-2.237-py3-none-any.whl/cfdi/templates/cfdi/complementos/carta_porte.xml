{% load cfdi_tags %}
<cartaporte{{ complemento.version_code }}:CartaPorte 
	Version="{{ complemento.Version }}" 

    {% set_field 'IdCCP' complemento.IdCCP %}

    {% set_field 'TranspInternac' complemento.TranspInternac %}
    {% set_field 'EntradaSalidaMerc' complemento.EntradaSalidaMerc %}
    {% set_field 'ViaEntradaSalida' complemento.ViaEntradaSalida %}
    {% set_field 'TotalDistRec' complemento.TotalDistRec %} 
>
	
	<cartaporte{{ complemento.version_code }}:Ubicaciones> 
        {% for ubicacion in complemento.ubicaciones %}
		<cartaporte{{ complemento.version_code }}:Ubicacion 
            {% set_field 'TipoEstacion' ubicacion.TipoEstacion %} 
            {% set_field 'DistanciaRecorrida' ubicacion.DistanciaRecorrida %}
            {% if ubicacion.Origen %}
                TipoUbicacion="Origen"
                {% set_field 'IDUbicacion' ubicacion.Origen.IDOrigen %}
                {% set_field 'RFCRemitenteDestinatario' ubicacion.Origen.RFCRemitente %}
                {% set_field 'NombreRemitenteDestinatario' ubicacion.Origen.NombreRemitente %}
                {% set_field 'NumRegIdTrib' ubicacion.Origen.NumRegIdTrib %}
                {% set_field 'ResidenciaFiscal' ubicacion.Origen.ResidenciaFiscal %}
                {% set_field 'NumEstacion' ubicacion.Origen.NumEstacion %}
                {% set_field 'NombreEstacion' ubicacion.Origen.NombreEstacion %}
                {% set_field 'NavegacionTrafico' ubicacion.Origen.NavegacionTrafico %}
                {% set_field 'FechaHoraSalidaLlegada' ubicacion.Origen.FechaHoraSalida %}
            {% else %}
                TipoUbicacion="Destino" 
            {% endif %}

            {% if ubicacion.Destino %}
                
                {% set_field 'IDUbicacion' ubicacion.Destino.IDDestino %}
                {% set_field 'RFCRemitenteDestinatario' ubicacion.Destino.RFCDestinatario %}
                {% set_field 'NombreRemitenteDestinatario' ubicacion.Destino.NombreDestinatario %}
                {% set_field 'NumRegIdTrib' ubicacion.Destino.NumRegIdTrib %}
                {% set_field 'ResidenciaFiscal' ubicacion.Destino.ResidenciaFiscal %}
                {% set_field 'NumEstacion' ubicacion.Destino.NumEstacion %}
                {% set_field 'NombreEstacion' ubicacion.Destino.NombreEstacion %}
                {% set_field 'NavegacionTrafico' ubicacion.Destino.NavegacionTrafico %}
                {% set_field 'FechaHoraSalidaLlegada' ubicacion.Destino.FechaHoraProgLlegada %}
            {% endif %}
			
        >
        
			<cartaporte{{ complemento.version_code }}:Domicilio 
                {% set_field 'Calle' ubicacion.Domicilio.Calle %}
                {% set_field 'NumeroExterior' ubicacion.Domicilio.NumeroExterior %}
                {% set_field 'NumeroInterior' ubicacion.Domicilio.NumeroInterior %}
                {% set_field 'Colonia' ubicacion.Domicilio.CalColoniale %}
                {% set_field 'Localidad' ubicacion.Domicilio.Localidad %}
                {% set_field 'Referencia' ubicacion.Domicilio.Referencia %}
                {% set_field 'Municipio' ubicacion.Domicilio.Municipio %}
                {% set_field 'Estado' ubicacion.Domicilio.Estado %}
                {% set_field 'Pais' ubicacion.Domicilio.Pais %}
                {% set_field 'CodigoPostal' ubicacion.Domicilio.CodigoPostal %}
            />
		</cartaporte{{ complemento.version_code }}:Ubicacion>
        {% endfor %}
	</cartaporte{{ complemento.version_code }}:Ubicaciones>
	
	<cartaporte{{ complemento.version_code }}:Mercancias 
		{% set_field 'PesoBrutoTotal' complemento.Mercancias.PesoBrutoTotal %}
        {% set_field 'UnidadPeso' complemento.Mercancias.UnidadPeso %}
        {% set_field 'PesoNetoTotal' complemento.Mercancias.PesoNetoTotal %}
        {% set_field 'NumTotalMercancias' complemento.Mercancias.NumTotalMercancias %}
        {% set_field 'CargoPorTasacion' complemento.Mercancias.CargoPorTasacion %}
	>
        {% for mercancia in complemento.mercancias %}
            <cartaporte{{ complemento.version_code }}:Mercancia 
                {% set_field 'BienesTransp' mercancia.BienesTransp %}
                {% set_field 'ClaveSTCC' mercancia.ClaveSTCC %}
                {% set_field 'Descripcion' mercancia.Descripcion %}
                {% set_field 'ClaveUnidad' mercancia.ClaveUnidad %}
                {% set_field 'Cantidad' mercancia.Cantidad %}
                {% set_field 'Unidad' mercancia.Unidad %}
                {% set_field 'Dimensiones' mercancia.Dimensiones %}
                {% set_field 'MaterialPeligroso' mercancia.MaterialPeligroso %}
                {% set_field 'CveMaterialPeligroso' mercancia.CveMaterialPeligroso %}
                {% set_field 'Embalaje' mercancia.Embalaje %}
                {% set_field 'PesoEnKg' mercancia.PesoEnKg %}
                {% set_field 'ValorMercancia' mercancia.ValorMercancia %}
                {% set_field 'Moneda' mercancia.Moneda %}
                {% set_field 'FraccionArancelaria' mercancia.FraccionArancelaria %}
                {% set_field 'UUIDComercioExt' mercancia.UUIDComercioExt %}
            >

                {% for guia in mercancia.guias_identificacion %}
                    <cartaporte{{ complemento.version_code }}:GuiasIdentificacion 
                        {% set_field 'NumeroGuiaIdentificacion' guia.NumeroGuiaIdentificacion %}
                        {% set_field 'DescripGuiaIdentificacion' guia.DescripGuiaIdentificacion %}
                        {% set_field 'PesoGuiaIdentificacion' guia.PesoGuiaIdentificacion %}
                    />
                {% endfor %}

                {% for ct in mercancia.cantidades_transporta %}
                    <cartaporte{{ complemento.version_code }}:CantidadTransporta 
                        {% set_field 'Cantidad' ct.Cantidad %}
                        {% set_field 'IDOrigen' ct.IDOrigen %}
                        {% set_field 'IDDestino' ct.IDDestino %}
                        {% set_field 'CvesTransporte' ct.CvesTransporte %}
                    />
                {% endfor %}
                {% if mercancia.DetalleMercancia %}
                    <cartaporte{{ complemento.version_code }}:DetalleMercancia 
                        {% set_field 'UnidadPeso' mercancia.DetalleMercancia.UnidadPeso %}
                        {% set_field 'PesoBruto' mercancia.DetalleMercancia.PesoBruto %}
                        {% set_field 'PesoNeto' mercancia.DetalleMercancia.PesoNeto %}
                        {% set_field 'PesoTara' mercancia.DetalleMercancia.PesoTara %}
                        {% set_field 'NumPiezas' mercancia.DetalleMercancia.NumPiezas %}
                    >
                {% endif %}
            </cartaporte{{ complemento.version_code }}:Mercancia>
		{% endfor %}
        
        {% if complemento.AutotransporteFederal %}
            <cartaporte{{ complemento.version_code }}:Autotransporte 
                {% set_field 'PermSCT' complemento.AutotransporteFederal.PermSCT %}
                {% set_field 'NumPermisoSCT' complemento.AutotransporteFederal.NumPermisoSCT %}
            >

            {% if complemento.AutotransporteFederal.IdentificacionVehicular %}
                <cartaporte{{ complemento.version_code }}:IdentificacionVehicular 
                    {% set_field 'ConfigVehicular' complemento.AutotransporteFederal.IdentificacionVehicular.ConfigVehicular %}
                    {% set_field 'PlacaVM' complemento.AutotransporteFederal.IdentificacionVehicular.PlacaVM %}
                    {% set_field 'AnioModeloVM' complemento.AutotransporteFederal.IdentificacionVehicular.AnioModeloVM %}
                    {% set_field 'PesoBrutoVehicular' complemento.AutotransporteFederal.IdentificacionVehicular.PesoBrutoVehicular %}
                />
            {% endif %}

            <cartaporte{{ complemento.version_code }}:Seguros 
                {% set_field 'AseguraRespCivil' complemento.AutotransporteFederal.NombreAseg %}
                {% set_field 'PolizaRespCivil' complemento.AutotransporteFederal.NumPolizaSeguro %}

                {% set_field 'AseguraCarga' complemento.AutotransporteFederal.Seguros.AseguraCarga %}
                {% set_field 'AseguraMedAmbiente' complemento.AutotransporteFederal.Seguros.AseguraMedAmbiente %}
                {% set_field 'PolizaMedAmbiente' complemento.AutotransporteFederal.Seguros.PolizaMedAmbiente %}

         
            />
            {% if complemento.AutotransporteFederal.IdentificacionVehicular.remolques %}
                <cartaporte{{ complemento.version_code }}:Remolques>
                {% for remolque in complemento.AutotransporteFederal.IdentificacionVehicular.remolques %}
                    <cartaporte{{ complemento.version_code }}:Remolque 
                        {% set_field 'SubTipoRem' remolque.SubTipoRem %}
                        {% set_field 'Placa' remolque.Placa %}
                    />
                {% endfor %}
                </cartaporte{{ complemento.version_code }}:Remolques>
            {% endif %}
            </cartaporte{{ complemento.version_code }}:Autotransporte>
        {% endif %}
    </cartaporte{{ complemento.version_code }}:Mercancias>
    
    <cartaporte{{ complemento.version_code }}:FiguraTransporte >
        {% if complemento.FiguraTransporte.operadores %}
            {% for operador in complemento.FiguraTransporte.operadores %}

                <cartaporte{{ complemento.version_code }}:TiposFigura 
                    TipoFigura="01" 
                    {% set_field 'RFCFigura' operador.RFCOperador %}
                    {% set_field 'NumLicencia' operador.NumLicencia %}
                    {% set_field 'NombreFigura' operador.NombreOperador %}
                    {% set_field 'NumRegIdTribFigura' operador.NumRegIdTribPropietario %}
                    {% set_field 'ResidenciaFiscalFigura' operador.ResidenciaFiscalOperador %}
                >

                    {% if operador.Domicilio %}
                
                        <cartaporte{{ complemento.version_code }}:Domicilio 
                            {% set_field 'Calle' operador.Domicilio.Calle %}
                            {% set_field 'NumeroExterior' operador.Domicilio.NumeroExterior %}
                            {% set_field 'NumeroInterior' operador.Domicilio.NumeroInterior %}
                            {% set_field 'Colonia' operador.Domicilio.Colonia %}
                            {% set_field 'Localidad' operador.Domicilio.Localidad %}
                            {% set_field 'Referencia' operador.Domicilio.Referencia %}
                            {% set_field 'Municipio' operador.Domicilio.Municipio %}
                            {% set_field 'Estado' operador.Domicilio.Estado %}
                            {% set_field 'Pais' operador.Domicilio.Pais %}
                            {% set_field 'CodigoPostal' operador.Domicilio.CodigoPostal %}
                        />

                    {% endif %}


                </cartaporte{{ complemento.version_code }}:TiposFigura>
           {% endfor %}
        {% endif %}
        
        
        {% if complemento.FiguraTransporte.Propietario.RFCPropietario %}
            <cartaporte{{ complemento.version_code }}:TiposFigura 
                TipoFigura="02" 
                {% set_field 'RFCFigura' complemento.FiguraTransporte.Propietario.RFCPropietario %}
                {% set_field 'NombreFigura' complemento.FiguraTransporte.Propietario.NombrePropietario %}
                {% set_field 'NumRegIdTribFigura' complemento.FiguraTransporte.Propietario.NumRegIdTribPropietario %}
                {% set_field 'ResidenciaFiscalFigura' complemento.FiguraTransporte.Propietario.ResidenciaFiscalPropietario %}
            >

                {% for pt in complemento.FiguraTransporte.PartesTransporte %}
                    <cartaporte{{ complemento.version_code }}:PartesTransporte ParteTransporte="{{ pt }}" />
                {% endfor %}
                
                {% if complemento.FiguraTransporte.Propietario.Domicilio %}
                    <cartaporte{{ complemento.version_code }}:Domicilio 
                        {% set_field 'Calle' complemento.FiguraTransporte.Propietario.Domicilio.Calle %}
                        {% set_field 'NumeroExterior' complemento.FiguraTransporte.Propietario.Domicilio.NumeroExterior %}
                        {% set_field 'NumeroInterior' complemento.FiguraTransporte.Propietario.Domicilio.NumeroInterior %}
                        {% set_field 'Colonia' complemento.FiguraTransporte.Propietario.Domicilio.Colonia %}
                        {% set_field 'Localidad' complemento.FiguraTransporte.Propietario.Domicilio.Localidad %}
                        {% set_field 'Referencia' complemento.FiguraTransporte.Propietario.Domicilio.Referencia %}
                        {% set_field 'Municipio' complemento.FiguraTransporte.Propietario.Domicilio.Municipio %}
                        {% set_field 'Estado' complemento.FiguraTransporte.Propietario.Domicilio.Estado %}
                        {% set_field 'Pais' complemento.FiguraTransporte.Propietario.Domicilio.Pais %}
                        {% set_field 'CodigoPostal' complemento.FiguraTransporte.Propietario.Domicilio.CodigoPostal %}
                    />
                {% endif %}
                    
            </cartaporte{{ complemento.version_code }}:TiposFigura>
        
        {% endif %}

        {% if complemento.FiguraTransporte.Arrendatario %}
            <cartaporte{{ complemento.version_code }}:TiposFigura 
                TipoFigura="03" 
                {% set_field 'RFCFigura' complemento.FiguraTransporte.Arrendatario.RFCArrendatario %}
                {% set_field 'NombreFigura' complemento.FiguraTransporte.Arrendatario.NombreArrendatario %}
                {% set_field 'NumRegIdTribFigura' complemento.FiguraTransporte.Arrendatario.NumRegIdTribArrendatario %}
                {% set_field 'ResidenciaFiscalFigura' complemento.FiguraTransporte.Arrendatario.ResidenciaFiscalArrendatario %}

            >

                {% for pt in complemento.FiguraTransporte.PartesTransporte %}
                    <cartaporte{{ complemento.version_code }}:PartesTransporte ParteTransporte="{{ pt }}" />
                {% endfor %}

                {% if complemento.FiguraTransporte.Arrendatario.Domicilio %}
                    <cartaporte{{ complemento.version_code }}:Domicilio 
                        {% set_field 'Calle' complemento.FiguraTransporte.Arrendatario.Domicilio.Calle %}
                        {% set_field 'NumeroExterior' complemento.FiguraTransporte.Arrendatario.Domicilio.NumeroExterior %}
                        {% set_field 'Colonia' complemento.FiguraTransporte.Arrendatario.Domicilio.Colonia %}
                        {% set_field 'Localidad' complemento.FiguraTransporte.Arrendatario.Domicilio.Localidad %}
                        {% set_field 'Referencia' complemento.FiguraTransporte.Arrendatario.Domicilio.Referencia %}
                        {% set_field 'Municipio' complemento.FiguraTransporte.Arrendatario.Domicilio.Municipio %}
                        {% set_field 'Estado' complemento.FiguraTransporte.Arrendatario.Domicilio.Estado %}
                        {% set_field 'Pais' complemento.FiguraTransporte.Arrendatario.Domicilio.Pais %}
                        {% set_field 'CodigoPostal' complemento.FiguraTransporte.Arrendatario.Domicilio.CodigoPostal %}
                    />
                {% endif %}
            </cartaporte{{ complemento.version_code }}:TiposFigura>
        {% endif %}

        {% if complemento.FiguraTransporte.Notificado %}
            <cartaporte{{ complemento.version_code }}:TiposFigura  
                TipoFigura="04" 
                {% set_field 'RFCFigura' complemento.FiguraTransporte.Notificado.RFCNotificado %}
                {% set_field 'NombreFigura' complemento.FiguraTransporte.Notificado.NombreNotificado %}
                {% set_field 'NumRegIdTribFigura' complemento.FiguraTransporte.Notificado.NumRegIdTribNotificado %}
                {% set_field 'ResidenciaFiscalFigura' complemento.FiguraTransporte.Notificado.ResidenciaFiscalNotificado %}
            >
                {% if complemento.FiguraTransporte.Notificado.Domicilio %}
                    <cartaporte{{ complemento.version_code }}:Domicilio 

                        {% set_field 'Calle' complemento.FiguraTransporte.Notificado.Domicilio.Calle %}
                        {% set_field 'NumeroExterior' complemento.FiguraTransporte.Notificado.Domicilio.NumeroExterior %}
                        {% set_field 'NumeroInterior' complemento.FiguraTransporte.Notificado.Domicilio.NumeroInterior %}
                        {% set_field 'Colonia' complemento.FiguraTransporte.Notificado.Domicilio.Colonia %}
                        {% set_field 'Localidad' complemento.FiguraTransporte.Notificado.Domicilio.Localidad %}
                        {% set_field 'Referencia' complemento.FiguraTransporte.Notificado.Domicilio.Referencia %}
                        {% set_field 'Municipio' complemento.FiguraTransporte.Notificado.Domicilio.Municipio %}
                        {% set_field 'Estado' complemento.FiguraTransporte.Notificado.Domicilio.Estado %}
                        {% set_field 'Pais' complemento.FiguraTransporte.Notificado.Domicilio.Pais %}
                        {% set_field 'CodigoPostal' complemento.FiguraTransporte.Notificado.Domicilio.CodigoPostal %}
                    />
                {% endif %}

            </cartaporte{{ complemento.version_code }}:TiposFigura>
        {% endif %}
    </cartaporte{{ complemento.version_code }}:FiguraTransporte>
</cartaporte{{ complemento.version_code }}:CartaPorte>