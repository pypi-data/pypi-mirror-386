import{SvelteComponent as ge,init as be,safe_not_equal as de,binding_callbacks as ne,bind as ke,create_component as N,claim_component as S,mount_component as V,add_flush_callback as we,transition_in as v,transition_out as I,destroy_component as q,assign as ve,space as F,element as T,claim_space as G,claim_element as j,children as J,detach as w,attr as k,insert_hydration as B,get_spread_update as Ie,get_spread_object as Be,group_outros as te,check_outros as ie,ensure_array_like as W,empty as A,src_url_equal as H,toggle_class as D,append_hydration as O,destroy_each as ae,text as Ee,claim_text as Me,set_style as Z,listen as L,set_data as De,run_all as Ne}from"../../../svelte/svelte.js";import"../../../svelte/svelte-submodules.js";import{B as Se,S as Ve,I as qe}from"./2.kHWxRulR.js";import{B as ze}from"./BlockLabel.BOO7yzSi.js";import{E as Fe}from"./Empty.CO7FZzAD.js";import{I as se}from"./Image.CTVzPhL7.js";import{F as Ge}from"./FullscreenButton.ZmySZmof.js";function p(l,e,i){const n=l.slice();return n[32]=e[i],n[34]=i,n}function y(l,e,i){const n=l.slice();return n[32]=e[i],n[34]=i,n}function Te(l){var M;let e,i,n,a,o,t,u,_,b;i=new qe({props:{$$slots:{default:[Ce]},$$scope:{ctx:l}}});let h=W(l[15]?(M=l[15])==null?void 0:M.annotations:[]),c=[];for(let s=0;s<h.length;s+=1)c[s]=x(y(l,h,s));let m=l[6]&&l[15]&&ee(l);return{c(){e=T("div"),N(i.$$.fragment),n=F(),a=T("img"),t=F();for(let s=0;s<c.length;s+=1)c[s].c();u=F(),m&&m.c(),_=A(),this.h()},l(s){e=j(s,"DIV",{class:!0});var r=J(e);S(i.$$.fragment,r),n=G(r),a=j(r,"IMG",{class:!0,src:!0,alt:!0}),t=G(r);for(let d=0;d<c.length;d+=1)c[d].l(r);r.forEach(w),u=G(s),m&&m.l(s),_=A(),this.h()},h(){k(a,"class","base-image svelte-303fln"),H(a.src,o=l[15]?l[15].image.url:null)||k(a,"src",o),k(a,"alt","the base file that is annotated"),D(a,"fit-height",l[7]&&!l[18]),k(e,"class","image-container svelte-303fln")},m(s,r){B(s,e,r),V(i,e,null),O(e,n),O(e,a),O(e,t);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(e,null);l[25](e),B(s,u,r),m&&m.m(s,r),B(s,_,r),b=!0},p(s,r){var E;const d={};if(r[0]&278528|r[1]&32&&(d.$$scope={dirty:r,ctx:s}),i.$set(d),(!b||r[0]&32768&&!H(a.src,o=s[15]?s[15].image.url:null))&&k(a,"src",o),(!b||r[0]&262272)&&D(a,"fit-height",s[7]&&!s[18]),r[0]&360976){h=W(s[15]?(E=s[15])==null?void 0:E.annotations:[]);let g;for(g=0;g<h.length;g+=1){const z=y(s,h,g);c[g]?c[g].p(z,r):(c[g]=x(z),c[g].c(),c[g].m(e,null))}for(;g<c.length;g+=1)c[g].d(1);c.length=h.length}s[6]&&s[15]?m?m.p(s,r):(m=ee(s),m.c(),m.m(_.parentNode,_)):m&&(m.d(1),m=null)},i(s){b||(v(i.$$.fragment,s),b=!0)},o(s){I(i.$$.fragment,s),b=!1},d(s){s&&(w(e),w(u),w(_)),q(i),ae(c,s),l[25](null),m&&m.d(s)}}}function je(l){let e,i;return e=new Fe({props:{size:"large",unpadded_box:!0,$$slots:{default:[Le]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,a){V(e,n,a),i=!0},p(n,a){const o={};a[1]&32&&(o.$$scope={dirty:a,ctx:n}),e.$set(o)},i(n){i||(v(e.$$.fragment,n),i=!0)},o(n){I(e.$$.fragment,n),i=!1},d(n){q(e,n)}}}function $(l){let e,i;return e=new Ge({props:{fullscreen:l[18]}}),e.$on("fullscreen",l[24]),{c(){N(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,a){V(e,n,a),i=!0},p(n,a){const o={};a[0]&262144&&(o.fullscreen=n[18]),e.$set(o)},i(n){i||(v(e.$$.fragment,n),i=!0)},o(n){I(e.$$.fragment,n),i=!1},d(n){q(e,n)}}}function Ce(l){var o;let e=((o=l[14])==null?void 0:o.includes("fullscreen"))??!0,i,n,a=e&&$(l);return{c(){a&&a.c(),i=A()},l(t){a&&a.l(t),i=A()},m(t,u){a&&a.m(t,u),B(t,i,u),n=!0},p(t,u){var _;u[0]&16384&&(e=((_=t[14])==null?void 0:_.includes("fullscreen"))??!0),e?a?(a.p(t,u),u[0]&16384&&v(a,1)):(a=$(t),a.c(),v(a,1),a.m(i.parentNode,i)):a&&(te(),I(a,1,1,()=>{a=null}),ie())},i(t){n||(v(a),n=!0)},o(t){I(a),n=!1},d(t){t&&w(i),a&&a.d(t)}}}function x(l){let e,i,n,a;return{c(){e=T("img"),this.h()},l(o){e=j(o,"IMG",{alt:!0,class:!0,src:!0,style:!0}),this.h()},h(){var o;k(e,"alt",i="segmentation mask identifying "+l[4]+" within the uploaded file"),k(e,"class","mask fit-height svelte-303fln"),H(e.src,n=l[32].image.url)||k(e,"src",n),k(e,"style",a=l[9]&&l[32].label in l[9]?null:`filter: hue-rotate(${Math.round(l[34]*360/((o=l[15])==null?void 0:o.annotations.length))}deg);`),D(e,"fit-height",!l[18]),D(e,"active",l[16]==l[32].label),D(e,"inactive",l[16]!=l[32].label&&l[16]!=null)},m(o,t){B(o,e,t)},p(o,t){var u;t[0]&16&&i!==(i="segmentation mask identifying "+o[4]+" within the uploaded file")&&k(e,"alt",i),t[0]&32768&&!H(e.src,n=o[32].image.url)&&k(e,"src",n),t[0]&33280&&a!==(a=o[9]&&o[32].label in o[9]?null:`filter: hue-rotate(${Math.round(o[34]*360/((u=o[15])==null?void 0:u.annotations.length))}deg);`)&&k(e,"style",a),t[0]&262144&&D(e,"fit-height",!o[18]),t[0]&98304&&D(e,"active",o[16]==o[32].label),t[0]&98304&&D(e,"inactive",o[16]!=o[32].label&&o[16]!=null)},d(o){o&&w(e)}}}function ee(l){let e,i=W(l[15].annotations),n=[];for(let a=0;a<i.length;a+=1)n[a]=le(p(l,i,a));return{c(){e=T("div");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=j(a,"DIV",{class:!0});var o=J(e);for(let t=0;t<n.length;t+=1)n[t].l(o);o.forEach(w),this.h()},h(){k(e,"class","legend svelte-303fln")},m(a,o){B(a,e,o);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null)},p(a,o){if(o[0]&3703296){i=W(a[15].annotations);let t;for(t=0;t<i.length;t+=1){const u=p(a,i,t);n[t]?n[t].p(u,o):(n[t]=le(u),n[t].c(),n[t].m(e,null))}for(;t<n.length;t+=1)n[t].d(1);n.length=i.length}},d(a){a&&w(e),ae(n,a)}}}function le(l){let e,i=l[32].label+"",n,a,o,t;function u(){return l[26](l[32])}function _(){return l[27](l[32])}function b(){return l[30](l[34],l[32])}return{c(){e=T("button"),n=Ee(i),a=F(),this.h()},l(h){e=j(h,"BUTTON",{class:!0,style:!0});var c=J(e);n=Me(c,i),a=G(c),c.forEach(w),this.h()},h(){k(e,"class","legend-item svelte-303fln"),Z(e,"background-color",l[9]&&l[32].label in l[9]?l[9][l[32].label]+"88":`hsla(${Math.round(l[34]*360/l[15].annotations.length)}, 100%, 50%, 0.3)`)},m(h,c){B(h,e,c),O(e,n),O(e,a),o||(t=[L(e,"mouseover",u),L(e,"focus",_),L(e,"mouseout",l[28]),L(e,"blur",l[29]),L(e,"click",b)],o=!0)},p(h,c){l=h,c[0]&32768&&i!==(i=l[32].label+"")&&De(n,i),c[0]&33280&&Z(e,"background-color",l[9]&&l[32].label in l[9]?l[9][l[32].label]+"88":`hsla(${Math.round(l[34]*360/l[15].annotations.length)}, 100%, 50%, 0.3)`)},d(h){h&&w(e),o=!1,Ne(t)}}}function Le(l){let e,i;return e=new se({}),{c(){N(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,a){V(e,n,a),i=!0},i(n){i||(v(e.$$.fragment,n),i=!0)},o(n){I(e.$$.fragment,n),i=!1},d(n){q(e,n)}}}function Oe(l){let e,i,n,a,o,t,u,_;const b=[{autoscroll:l[3].autoscroll},{i18n:l[3].i18n},l[13]];let h={};for(let s=0;s<b.length;s+=1)h=ve(h,b[s]);e=new Ve({props:h}),n=new ze({props:{show_label:l[5],Icon:se,label:l[4]||l[3].i18n("image.image")}});const c=[je,Te],m=[];function M(s,r){return s[15]==null?0:1}return t=M(l),u=m[t]=c[t](l),{c(){N(e.$$.fragment),i=F(),N(n.$$.fragment),a=F(),o=T("div"),u.c(),this.h()},l(s){S(e.$$.fragment,s),i=G(s),S(n.$$.fragment,s),a=G(s),o=j(s,"DIV",{class:!0});var r=J(o);u.l(r),r.forEach(w),this.h()},h(){k(o,"class","container svelte-303fln")},m(s,r){V(e,s,r),B(s,i,r),V(n,s,r),B(s,a,r),B(s,o,r),m[t].m(o,null),_=!0},p(s,r){const d=r[0]&8200?Ie(b,[r[0]&8&&{autoscroll:s[3].autoscroll},r[0]&8&&{i18n:s[3].i18n},r[0]&8192&&Be(s[13])]):{};e.$set(d);const E={};r[0]&32&&(E.show_label=s[5]),r[0]&24&&(E.label=s[4]||s[3].i18n("image.image")),n.$set(E);let g=t;t=M(s),t===g?m[t].p(s,r):(te(),I(m[g],1,1,()=>{m[g]=null}),ie(),u=m[t],u?u.p(s,r):(u=m[t]=c[t](s),u.c()),v(u,1),u.m(o,null))},i(s){_||(v(e.$$.fragment,s),v(n.$$.fragment,s),v(u),_=!0)},o(s){I(e.$$.fragment,s),I(n.$$.fragment,s),I(u),_=!1},d(s){s&&(w(i),w(a),w(o)),q(e,s),q(n,s),m[t].d()}}}function Ue(l){let e,i,n;function a(t){l[31](t)}let o={visible:l[2],elem_id:l[0],elem_classes:l[1],padding:!1,height:l[7],width:l[8],allow_overflow:!1,container:l[10],scale:l[11],min_width:l[12],$$slots:{default:[Oe]},$$scope:{ctx:l}};return l[18]!==void 0&&(o.fullscreen=l[18]),e=new Se({props:o}),ne.push(()=>ke(e,"fullscreen",a)),{c(){N(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,u){V(e,t,u),n=!0},p(t,u){const _={};u[0]&4&&(_.visible=t[2]),u[0]&1&&(_.elem_id=t[0]),u[0]&2&&(_.elem_classes=t[1]),u[0]&128&&(_.height=t[7]),u[0]&256&&(_.width=t[8]),u[0]&1024&&(_.container=t[10]),u[0]&2048&&(_.scale=t[11]),u[0]&4096&&(_.min_width=t[12]),u[0]&516856|u[1]&32&&(_.$$scope={dirty:u,ctx:t}),!i&&u[0]&262144&&(i=!0,_.fullscreen=t[18],we(()=>i=!1)),e.$set(_)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function We(l,e,i){let{elem_id:n=""}=e,{elem_classes:a=[]}=e,{visible:o=!0}=e,{value:t=null}=e,u=null,_=null,{gradio:b}=e,{label:h=b.i18n("annotated_image.annotated_image")}=e,{show_label:c=!0}=e,{show_legend:m=!0}=e,{height:M}=e,{width:s}=e,{color_map:r}=e,{container:d=!0}=e,{scale:E=null}=e,{min_width:g=void 0}=e,z=null,{loading_status:R}=e,{buttons:X=null}=e,K,U=!1;function P(f){i(16,z=f)}function Q(){i(16,z=null)}function Y(f,C){b.dispatch("select",{value:h,index:f})}const oe=({detail:f})=>{i(18,U=f)};function ue(f){ne[f?"unshift":"push"](()=>{K=f,i(17,K)})}const fe=f=>P(f.label),re=f=>P(f.label),_e=()=>Q(),ce=()=>Q(),me=(f,C)=>Y(f,C.label);function he(f){U=f,i(18,U)}return l.$$set=f=>{"elem_id"in f&&i(0,n=f.elem_id),"elem_classes"in f&&i(1,a=f.elem_classes),"visible"in f&&i(2,o=f.visible),"value"in f&&i(22,t=f.value),"gradio"in f&&i(3,b=f.gradio),"label"in f&&i(4,h=f.label),"show_label"in f&&i(5,c=f.show_label),"show_legend"in f&&i(6,m=f.show_legend),"height"in f&&i(7,M=f.height),"width"in f&&i(8,s=f.width),"color_map"in f&&i(9,r=f.color_map),"container"in f&&i(10,d=f.container),"scale"in f&&i(11,E=f.scale),"min_width"in f&&i(12,g=f.min_width),"loading_status"in f&&i(13,R=f.loading_status),"buttons"in f&&i(14,X=f.buttons)},l.$$.update=()=>{if(l.$$.dirty[0]&12582920)if(t!==u&&(i(23,u=t),b.dispatch("change")),t){const f={image:t.image,annotations:t.annotations.map(C=>({image:C.image,label:C.label}))};i(15,_=f)}else i(15,_=null)},[n,a,o,b,h,c,m,M,s,r,d,E,g,R,X,_,z,K,U,P,Q,Y,t,u,oe,ue,fe,re,_e,ce,me,he]}class Xe extends ge{constructor(e){super(),be(this,e,We,Ue,de,{elem_id:0,elem_classes:1,visible:2,value:22,gradio:3,label:4,show_label:5,show_legend:6,height:7,width:8,color_map:9,container:10,scale:11,min_width:12,loading_status:13,buttons:14},null,[-1,-1])}}export{Xe as default};
//# sourceMappingURL=Index.BXE4Cpzh.js.map
