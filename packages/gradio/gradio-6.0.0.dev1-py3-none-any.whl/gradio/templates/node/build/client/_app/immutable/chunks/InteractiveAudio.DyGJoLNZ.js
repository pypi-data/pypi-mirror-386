const __vite__fileDeps=["./module.wlByRTQQ.js","./module.C-VadMaF.js","./2.kHWxRulR.js","./preload-helper.D6kgxu3v.js","./stores.DyCjMXH4.js","./client.BGRRoguZ.js","../assets/2.DVLOI_yw.css","./module.niXGEr8P.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{SvelteComponent as ye,init as Ee,safe_not_equal as De,element as M,claim_element as A,children as B,detach as p,attr as T,insert_hydration as z,noop as be,createEventDispatcher as Pe,ensure_array_like as Oe,empty as ve,destroy_each as vt,text as ie,claim_text as ne,set_input_value as Ae,append_hydration as w,set_data as oe,binding_callbacks as j,bind as se,space as U,create_component as K,claim_space as N,claim_component as Q,mount_component as X,listen as de,add_flush_callback as le,transition_in as L,transition_out as S,destroy_component as Z,run_all as pt,group_outros as pe,check_outros as we,onMount as We,get_svelte_dataset as Te,set_style as Ue,null_to_empty as Ne,onDestroy as wt,bubble as ge,create_slot as kt,update_slot_base as yt,get_all_dirty_from_scope as Et,get_slot_changes as Dt}from"../../../svelte/svelte.js";import"../../../svelte/svelte-submodules.js";import{a as Rt}from"./Upload.McbAR2b8.js";import{M as xe}from"./ModifyUpload.C2wJL4Cs.js";import{R as _e,F as Tt}from"./2.kHWxRulR.js";/* empty css                                             */import{B as It}from"./BlockLabel.BOO7yzSi.js";import{M as Mt}from"./Music.BVFRDHso.js";import{a as At,S as Lt}from"./SelectSource.CN99WALW.js";import{S as Pt}from"./StreamingBar.ZKxDkUIw.js";import{W as St,p as ze,s as Ve,a as Le,A as Bt}from"./AudioPlayer.DZJ9newS.js";import{P as Ct}from"./Trim.CWFkmJwA.js";import{_ as je}from"./preload-helper.D6kgxu3v.js";function Me(i,e,t,n){return new(t||(t=Promise))(function(r,s){function l(a){try{f(n.next(a))}catch(o){s(o)}}function u(a){try{f(n.throw(a))}catch(o){s(o)}}function f(a){var o;a.done?r(a.value):(o=a.value,o instanceof t?o:new t(function(d){d(o)})).then(l,u)}f((n=n.apply(i,[])).next())})}class Ot{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener}addEventListener(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),n==null?void 0:n.once){const r=()=>{this.removeEventListener(e,r),this.removeEventListener(e,t)};return this.addEventListener(e,r),r}return()=>this.removeEventListener(e,t)}removeEventListener(e,t){var n;(n=this.listeners[e])===null||n===void 0||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(n=>n(...t))}}class Ut extends Ot{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}const Nt=["audio/webm","audio/wav","audio/mpeg","audio/mp4","audio/mp3"];class Re extends Ut{constructor(e){var t;super(Object.assign(Object.assign({},e),{audioBitsPerSecond:(t=e.audioBitsPerSecond)!==null&&t!==void 0?t:128e3})),this.stream=null,this.mediaRecorder=null}static create(e){return new Re(e||{})}renderMicStream(e){const t=new AudioContext,n=t.createMediaStreamSource(e),r=t.createAnalyser();n.connect(r);const s=r.frequencyBinCount,l=new Float32Array(s),u=s/t.sampleRate;let f;const a=()=>{r.getFloatTimeDomainData(l),this.wavesurfer&&(this.wavesurfer.options.cursorWidth=0,this.wavesurfer.options.interact=!1,this.wavesurfer.load("",[l],u)),f=requestAnimationFrame(a)};return a(),()=>{cancelAnimationFrame(f),n==null||n.disconnect(),t==null||t.close()}}startMic(e){return Me(this,void 0,void 0,function*(){let t;try{t=yield navigator.mediaDevices.getUserMedia({audio:!(e!=null&&e.deviceId)||{deviceId:e.deviceId}})}catch(r){throw new Error("Error accessing the microphone: "+r.message)}const n=this.renderMicStream(t);return this.subscriptions.push(this.once("destroy",n)),this.stream=t,t})}stopMic(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null,this.mediaRecorder=null)}startRecording(e){return Me(this,void 0,void 0,function*(){const t=this.stream||(yield this.startMic(e)),n=this.mediaRecorder||new MediaRecorder(t,{mimeType:this.options.mimeType||Nt.find(s=>MediaRecorder.isTypeSupported(s)),audioBitsPerSecond:this.options.audioBitsPerSecond});this.mediaRecorder=n,this.stopRecording();const r=[];n.ondataavailable=s=>{s.data.size>0&&r.push(s.data)},n.onstop=()=>{var s;const l=new Blob(r,{type:n.mimeType});this.emit("record-end",l),this.options.renderRecordedAudio!==!1&&((s=this.wavesurfer)===null||s===void 0||s.load(URL.createObjectURL(l)))},n.start(),this.emit("record-start")})}isRecording(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="recording"}isPaused(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="paused"}stopRecording(){var e;this.isRecording()&&((e=this.mediaRecorder)===null||e===void 0||e.stop())}pauseRecording(){var e;this.isRecording()&&((e=this.mediaRecorder)===null||e===void 0||e.pause(),this.emit("record-pause"))}resumeRecording(){var e;this.isPaused()&&((e=this.mediaRecorder)===null||e===void 0||e.resume(),this.emit("record-resume"))}static getAvailableAudioDevices(){return Me(this,void 0,void 0,function*(){return navigator.mediaDevices.enumerateDevices().then(e=>e.filter(t=>t.kind==="audioinput"))})}destroy(){super.destroy(),this.stopRecording(),this.stopMic()}}function He(i,e,t){const n=i.slice();return n[3]=e[t],n}function zt(i){let e,t=Oe(i[0]),n=[];for(let r=0;r<t.length;r+=1)n[r]=qe(He(i,t,r));return{c(){for(let r=0;r<n.length;r+=1)n[r].c();e=ve()},l(r){for(let s=0;s<n.length;s+=1)n[s].l(r);e=ve()},m(r,s){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(r,s);z(r,e,s)},p(r,s){if(s&1){t=Oe(r[0]);let l;for(l=0;l<t.length;l+=1){const u=He(r,t,l);n[l]?n[l].p(u,s):(n[l]=qe(u),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(r){r&&p(e),vt(n,r)}}}function Vt(i){let e,t=i[1]("audio.no_microphone")+"",n;return{c(){e=M("option"),n=ie(t),this.h()},l(r){e=A(r,"OPTION",{});var s=B(e);n=ne(s,t),s.forEach(p),this.h()},h(){e.__value="",Ae(e,e.__value)},m(r,s){z(r,e,s),w(e,n)},p(r,s){s&2&&t!==(t=r[1]("audio.no_microphone")+"")&&oe(n,t)},d(r){r&&p(e)}}}function qe(i){let e,t=i[3].label+"",n,r;return{c(){e=M("option"),n=ie(t),this.h()},l(s){e=A(s,"OPTION",{});var l=B(e);n=ne(l,t),l.forEach(p),this.h()},h(){e.__value=r=i[3].deviceId,Ae(e,e.__value)},m(s,l){z(s,e,l),w(e,n)},p(s,l){l&1&&t!==(t=s[3].label+"")&&oe(n,t),l&1&&r!==(r=s[3].deviceId)&&(e.__value=r,Ae(e,e.__value))},d(s){s&&p(e)}}}function jt(i){let e,t;function n(l,u){return l[0].length===0?Vt:zt}let r=n(i),s=r(i);return{c(){e=M("select"),s.c(),this.h()},l(l){e=A(l,"SELECT",{class:!0,"aria-label":!0});var u=B(e);s.l(u),u.forEach(p),this.h()},h(){T(e,"class","mic-select svelte-1ya9x7a"),T(e,"aria-label","Select input device"),e.disabled=t=i[0].length===0},m(l,u){z(l,e,u),s.m(e,null)},p(l,[u]){r===(r=n(l))&&s?s.p(l,u):(s.d(1),s=r(l),s&&(s.c(),s.m(e,null))),u&1&&t!==(t=l[0].length===0)&&(e.disabled=t)},i:be,o:be,d(l){l&&p(e),s.d()}}}function Ht(i,e,t){let{i18n:n}=e,{micDevices:r=[]}=e;const s=Pe();return i.$$set=l=>{"i18n"in l&&t(1,n=l.i18n),"micDevices"in l&&t(0,r=l.micDevices)},i.$$.update=()=>{if(i.$$.dirty&2&&typeof window<"u")try{let l=[];Re.getAvailableAudioDevices().then(u=>{t(0,r=u),u.forEach(f=>{f.deviceId&&l.push(f)}),t(0,r=l)})}catch(l){throw l instanceof DOMException&&l.name=="NotAllowedError"&&s("error",n("audio.allow_recording_access")),l}},[r,n]}class $e extends ye{constructor(e){super(),Ee(this,e,Ht,jt,De,{i18n:1,micDevices:0})}}function Fe(i){let e,t;return{c(){e=M("time"),t=ie(i[2]),this.h()},l(n){e=A(n,"TIME",{class:!0});var r=B(e);t=ne(r,i[2]),r.forEach(p),this.h()},h(){T(e,"class","duration-button duration svelte-1oiuk2f")},m(n,r){z(n,e,r),w(e,t)},p(n,r){r&4&&oe(t,n[2])},d(n){n&&p(e)}}}function qt(i){let e,t,n,r=i[1]("audio.record")+"",s,l,u,f=i[1]("audio.stop")+"",a,o,d,c,g=i[1]("audio.stop")+"",E,I,m,D,h,v,C=i[1]("audio.resume")+"",y,Y,G,q,re,O,k,W;D=new Ct({});let V=i[4]&&!i[3]&&Fe(i);function ce(P){i[23](P)}let ae={i18n:i[1]};return i[5]!==void 0&&(ae.micDevices=i[5]),q=new $e({props:ae}),j.push(()=>se(q,"micDevices",ce)),{c(){e=M("div"),t=M("div"),n=M("button"),s=ie(r),l=U(),u=M("button"),a=ie(f),d=U(),c=M("button"),E=ie(g),I=U(),m=M("button"),K(D.$$.fragment),h=U(),v=M("button"),y=ie(C),Y=U(),V&&V.c(),G=U(),K(q.$$.fragment),this.h()},l(P){e=A(P,"DIV",{class:!0});var F=B(e);t=A(F,"DIV",{class:!0});var R=B(t);n=A(R,"BUTTON",{class:!0});var x=B(n);s=ne(x,r),x.forEach(p),l=N(R),u=A(R,"BUTTON",{class:!0});var $=B(u);a=ne($,f),$.forEach(p),d=N(R),c=A(R,"BUTTON",{id:!0,class:!0});var ee=B(c);E=ne(ee,g),ee.forEach(p),I=N(R),m=A(R,"BUTTON",{"aria-label":!0,class:!0});var ue=B(m);Q(D.$$.fragment,ue),ue.forEach(p),h=N(R),v=A(R,"BUTTON",{class:!0});var me=B(v);y=ne(me,C),me.forEach(p),Y=N(R),V&&V.l(R),R.forEach(p),G=N(F),Q(q.$$.fragment,F),F.forEach(p),this.h()},h(){T(n,"class","record record-button svelte-1oiuk2f"),T(u,"class",o="stop-button "+(i[0].isPaused()?"stop-button-paused":"")+" svelte-1oiuk2f"),T(c,"id","stop-paused"),T(c,"class","stop-button-paused svelte-1oiuk2f"),T(m,"aria-label","pause"),T(m,"class","pause-button svelte-1oiuk2f"),T(v,"class","resume-button svelte-1oiuk2f"),T(t,"class","wrapper svelte-1oiuk2f"),T(e,"class","controls svelte-1oiuk2f")},m(P,F){z(P,e,F),w(e,t),w(t,n),w(n,s),i[13](n),w(t,l),w(t,u),w(u,a),i[15](u),w(t,d),w(t,c),w(c,E),i[17](c),w(t,I),w(t,m),X(D,m,null),i[19](m),w(t,h),w(t,v),w(v,y),i[21](v),w(t,Y),V&&V.m(t,null),w(e,G),X(q,e,null),O=!0,k||(W=[de(n,"click",i[14]),de(u,"click",i[16]),de(c,"click",i[18]),de(m,"click",i[20]),de(v,"click",i[22])],k=!0)},p(P,[F]){(!O||F&2)&&r!==(r=P[1]("audio.record")+"")&&oe(s,r),(!O||F&2)&&f!==(f=P[1]("audio.stop")+"")&&oe(a,f),(!O||F&1&&o!==(o="stop-button "+(P[0].isPaused()?"stop-button-paused":"")+" svelte-1oiuk2f"))&&T(u,"class",o),(!O||F&2)&&g!==(g=P[1]("audio.stop")+"")&&oe(E,g),(!O||F&2)&&C!==(C=P[1]("audio.resume")+"")&&oe(y,C),P[4]&&!P[3]?V?V.p(P,F):(V=Fe(P),V.c(),V.m(t,null)):V&&(V.d(1),V=null);const R={};F&2&&(R.i18n=P[1]),!re&&F&32&&(re=!0,R.micDevices=P[5],le(()=>re=!1)),q.$set(R)},i(P){O||(L(D.$$.fragment,P),L(q.$$.fragment,P),O=!0)},o(P){S(D.$$.fragment,P),S(q.$$.fragment,P),O=!1},d(P){P&&p(e),i[13](null),i[15](null),i[17](null),Z(D),i[19](null),i[21](null),V&&V.d(),Z(q),k=!1,pt(W)}}}function Ft(i,e,t){let{record:n}=e,{i18n:r}=e,{recording:s=!1}=e,l=[],u,f,a,o,d,c=!1,{record_time:g}=e,{show_recording_waveform:E}=e,{timing:I=!1}=e;function m(k){j[k?"unshift":"push"](()=>{u=k,t(6,u),t(0,n)})}const D=()=>n.startRecording();function h(k){j[k?"unshift":"push"](()=>{o=k,t(9,o),t(0,n)})}const v=()=>{n.isPaused()&&(n.resumeRecording(),n.stopRecording()),n.stopRecording()};function C(k){j[k?"unshift":"push"](()=>{d=k,t(10,d),t(0,n)})}const y=()=>{n.isPaused()&&(n.resumeRecording(),n.stopRecording()),n.stopRecording()};function Y(k){j[k?"unshift":"push"](()=>{f=k,t(7,f),t(0,n)})}const G=()=>n.pauseRecording();function q(k){j[k?"unshift":"push"](()=>{a=k,t(8,a),t(0,n)})}const re=()=>n.resumeRecording();function O(k){l=k,t(5,l)}return i.$$set=k=>{"record"in k&&t(0,n=k.record),"i18n"in k&&t(1,r=k.i18n),"recording"in k&&t(11,s=k.recording),"record_time"in k&&t(2,g=k.record_time),"show_recording_waveform"in k&&t(3,E=k.show_recording_waveform),"timing"in k&&t(4,I=k.timing)},i.$$.update=()=>{i.$$.dirty&1&&n.on("record-start",()=>{n.startMic(),t(6,u.style.display="none",u),t(9,o.style.display="flex",o),t(7,f.style.display="block",f)}),i.$$.dirty&1&&n.on("record-end",()=>{n.isPaused()&&(n.resumeRecording(),n.stopRecording()),n.stopMic(),t(6,u.style.display="flex",u),t(9,o.style.display="none",o),t(7,f.style.display="none",f),t(6,u.disabled=!1,u)}),i.$$.dirty&1&&n.on("record-pause",()=>{t(7,f.style.display="none",f),t(8,a.style.display="block",a),t(9,o.style.display="none",o),t(10,d.style.display="flex",d)}),i.$$.dirty&1&&n.on("record-resume",()=>{t(7,f.style.display="block",f),t(8,a.style.display="none",a),t(6,u.style.display="none",u),t(9,o.style.display="flex",o),t(10,d.style.display="none",d)}),i.$$.dirty&6145&&(s&&!c?(n.startRecording(),t(12,c=!0)):(n.stopRecording(),t(12,c=!1)))},[n,r,g,E,I,l,u,f,a,o,d,s,c,m,D,h,v,C,y,Y,G,q,re,O]}class Yt extends ye{constructor(e){super(),Ee(this,e,Ft,qt,De,{record:0,i18n:1,recording:11,record_time:2,show_recording_waveform:3,timing:4})}}function Ye(i){let e,t,n="0:00",r,s,l,u=i[0]==="edit"&&i[17]>0&&Ge(i);function f(d,c){return d[16]?Jt:Gt}let a=f(i),o=a(i);return{c(){e=M("div"),t=M("time"),t.textContent=n,r=U(),s=M("div"),u&&u.c(),l=U(),o.c(),this.h()},l(d){e=A(d,"DIV",{class:!0});var c=B(e);t=A(c,"TIME",{class:!0,"data-svelte-h":!0}),Te(t)!=="svelte-1rda9am"&&(t.textContent=n),r=N(c),s=A(c,"DIV",{});var g=B(s);u&&u.l(g),l=N(g),o.l(g),g.forEach(p),c.forEach(p),this.h()},h(){T(t,"class","time svelte-9n45fh"),T(e,"class","timestamps svelte-9n45fh")},m(d,c){z(d,e,c),w(e,t),i[23](t),w(e,r),w(e,s),u&&u.m(s,null),w(s,l),o.m(s,null)},p(d,c){d[0]==="edit"&&d[17]>0?u?u.p(d,c):(u=Ge(d),u.c(),u.m(s,l)):u&&(u.d(1),u=null),a===(a=f(d))&&o?o.p(d,c):(o.d(1),o=a(d),o&&(o.c(),o.m(s,null)))},d(d){d&&p(e),i[23](null),u&&u.d(),o.d()}}}function Ge(i){let e,t=_e(i[17])+"",n;return{c(){e=M("time"),n=ie(t),this.h()},l(r){e=A(r,"TIME",{class:!0});var s=B(e);n=ne(s,t),s.forEach(p),this.h()},h(){T(e,"class","trim-duration svelte-9n45fh")},m(r,s){z(r,e,s),w(e,n)},p(r,s){s[0]&131072&&t!==(t=_e(r[17])+"")&&oe(n,t)},d(r){r&&p(e)}}}function Gt(i){let e,t="0:00";return{c(){e=M("time"),e.textContent=t,this.h()},l(n){e=A(n,"TIME",{class:!0,"data-svelte-h":!0}),Te(e)!=="svelte-1llsiqq"&&(e.textContent=t),this.h()},h(){T(e,"class","duration svelte-9n45fh")},m(n,r){z(n,e,r),i[24](e)},p:be,d(n){n&&p(e),i[24](null)}}}function Jt(i){let e,t=_e(i[15])+"",n;return{c(){e=M("time"),n=ie(t),this.h()},l(r){e=A(r,"TIME",{class:!0});var s=B(e);n=ne(s,t),s.forEach(p),this.h()},h(){T(e,"class","duration svelte-9n45fh")},m(r,s){z(r,e,s),w(e,n)},p(r,s){s[0]&32768&&t!==(t=_e(r[15])+"")&&oe(n,t)},d(r){r&&p(e)}}}function Je(i){let e,t,n;function r(l){i[25](l)}let s={i18n:i[1],timing:i[16],recording:i[5],show_recording_waveform:i[2].show_recording_waveform,record_time:_e(i[15])};return i[7]!==void 0&&(s.record=i[7]),e=new Yt({props:s}),j.push(()=>se(e,"record",r)),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,u){X(e,l,u),n=!0},p(l,u){const f={};u[0]&2&&(f.i18n=l[1]),u[0]&65536&&(f.timing=l[16]),u[0]&32&&(f.recording=l[5]),u[0]&4&&(f.show_recording_waveform=l[2].show_recording_waveform),u[0]&32768&&(f.record_time=_e(l[15])),!t&&u[0]&128&&(t=!0,f.record=l[7],le(()=>t=!1)),e.$set(f)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){Z(e,l)}}}function Ke(i){let e,t,n,r,s;function l(o){i[26](o)}function u(o){i[27](o)}function f(o){i[28](o)}let a={container:i[11],playing:i[10],audio_duration:i[14],i18n:i[1],editable:i[4],interactive:!0,handle_trim_audio:i[18],show_redo:!0,handle_reset_value:i[3],waveform_options:i[2]};return i[6]!==void 0&&(a.waveform=i[6]),i[17]!==void 0&&(a.trimDuration=i[17]),i[0]!==void 0&&(a.mode=i[0]),e=new St({props:a}),j.push(()=>se(e,"waveform",l)),j.push(()=>se(e,"trimDuration",u)),j.push(()=>se(e,"mode",f)),{c(){K(e.$$.fragment)},l(o){Q(e.$$.fragment,o)},m(o,d){X(e,o,d),s=!0},p(o,d){const c={};d[0]&2048&&(c.container=o[11]),d[0]&1024&&(c.playing=o[10]),d[0]&16384&&(c.audio_duration=o[14]),d[0]&2&&(c.i18n=o[1]),d[0]&16&&(c.editable=o[4]),d[0]&8&&(c.handle_reset_value=o[3]),d[0]&4&&(c.waveform_options=o[2]),!t&&d[0]&64&&(t=!0,c.waveform=o[6],le(()=>t=!1)),!n&&d[0]&131072&&(n=!0,c.trimDuration=o[17],le(()=>n=!1)),!r&&d[0]&1&&(r=!0,c.mode=o[0],le(()=>r=!1)),e.$set(c)},i(o){s||(L(e.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),s=!1},d(o){Z(e,o)}}}function Kt(i){let e,t,n,r,s,l,u,f,a=(i[16]||i[13])&&i[2].show_recording_waveform&&Ye(i),o=i[12]&&!i[13]&&Je(i),d=i[6]&&i[13]&&Ke(i);return{c(){e=M("div"),t=M("div"),n=U(),r=M("div"),s=U(),a&&a.c(),l=U(),o&&o.c(),u=U(),d&&d.c(),this.h()},l(c){e=A(c,"DIV",{class:!0});var g=B(e);t=A(g,"DIV",{class:!0,"data-testid":!0}),B(t).forEach(p),n=N(g),r=A(g,"DIV",{"data-testid":!0}),B(r).forEach(p),s=N(g),a&&a.l(g),l=N(g),o&&o.l(g),u=N(g),d&&d.l(g),g.forEach(p),this.h()},h(){T(t,"class","microphone svelte-9n45fh"),T(t,"data-testid","microphone-waveform"),T(r,"data-testid","recording-waveform"),T(e,"class","component-wrapper svelte-9n45fh")},m(c,g){z(c,e,g),w(e,t),i[21](t),w(e,n),w(e,r),i[22](r),w(e,s),a&&a.m(e,null),w(e,l),o&&o.m(e,null),w(e,u),d&&d.m(e,null),f=!0},p(c,g){(c[16]||c[13])&&c[2].show_recording_waveform?a?a.p(c,g):(a=Ye(c),a.c(),a.m(e,l)):a&&(a.d(1),a=null),c[12]&&!c[13]?o?(o.p(c,g),g[0]&12288&&L(o,1)):(o=Je(c),o.c(),L(o,1),o.m(e,u)):o&&(pe(),S(o,1,1,()=>{o=null}),we()),c[6]&&c[13]?d?(d.p(c,g),g[0]&8256&&L(d,1)):(d=Ke(c),d.c(),L(d,1),d.m(e,null)):d&&(pe(),S(d,1,1,()=>{d=null}),we())},i(c){f||(L(o),L(d),f=!0)},o(c){S(o),S(d),f=!1},d(c){c&&p(e),i[21](null),i[22](null),a&&a.d(),o&&o.d(),d&&d.d()}}}function Qt(i,e,t){let{mode:n}=e,{i18n:r}=e,{dispatch_blob:s}=e,{waveform_settings:l}=e,{waveform_options:u={show_recording_waveform:!0}}=e,{handle_reset_value:f}=e,{editable:a=!0}=e,{recording:o=!1}=e,d,c,g=!1,E,I,m,D=null,h,v,C,y=0,Y,G=!1,q=0;const re=()=>{clearInterval(Y),Y=setInterval(()=>{t(15,y++,y)},1e3)},O=Pe();function k(){if(re(),t(16,G=!0),O("start_recording"),u.show_recording_waveform){let b=I;b&&(b.style.display="block")}}async function W(b){t(15,y=0),t(16,G=!1),clearInterval(Y);try{const J=await b.arrayBuffer(),H=await new AudioContext({sampleRate:l.sampleRate}).decodeAudioData(J);H&&await ze(H).then(async fe=>{await s([fe],"change"),await s([fe],"stop_recording")})}catch(J){console.error(J)}}const V=()=>{I&&t(12,I.innerHTML="",I),d!==void 0&&d.destroy(),I&&(d=Le.create({...l,normalize:!1,container:I}),t(7,m=d.registerPlugin(Re.create())),m==null||m.on("record-end",W),m==null||m.on("record-start",k),m==null||m.on("record-pause",()=>{O("pause_recording"),clearInterval(Y)}),m==null||m.on("record-end",b=>{t(13,D=URL.createObjectURL(b));const J=I,he=E;J&&(J.style.display="none"),he&&D&&(he.innerHTML="",ce())}))},ce=()=>{let b=E;!D||!b||t(6,c=Le.create({container:b,url:D,...l}))},ae=async(b,J)=>{t(0,n="edit");const he=c.getDecodedData();he&&await ze(he,b,J).then(async H=>{await s([H],"change"),await s([H],"stop_recording"),c.destroy(),ce()}),O("edit")};We(()=>{V(),window.addEventListener("keydown",b=>{E&&E.contains(document.activeElement)&&(b.key==="ArrowRight"?Ve(c,.1):b.key==="ArrowLeft"&&Ve(c,-.1))})});function P(b){j[b?"unshift":"push"](()=>{I=b,t(12,I)})}function F(b){j[b?"unshift":"push"](()=>{E=b,t(11,E)})}function R(b){j[b?"unshift":"push"](()=>{h=b,t(8,h),t(6,c)})}function x(b){j[b?"unshift":"push"](()=>{v=b,t(9,v),t(6,c)})}function $(b){m=b,t(7,m)}function ee(b){c=b,t(6,c)}function ue(b){q=b,t(17,q)}function me(b){n=b,t(0,n)}return i.$$set=b=>{"mode"in b&&t(0,n=b.mode),"i18n"in b&&t(1,r=b.i18n),"dispatch_blob"in b&&t(19,s=b.dispatch_blob),"waveform_settings"in b&&t(20,l=b.waveform_settings),"waveform_options"in b&&t(2,u=b.waveform_options),"handle_reset_value"in b&&t(3,f=b.handle_reset_value),"editable"in b&&t(4,a=b.editable),"recording"in b&&t(5,o=b.recording)},i.$$.update=()=>{i.$$.dirty[0]&128&&(m==null||m.on("record-resume",()=>{re()})),i.$$.dirty[0]&576&&(c==null||c.on("decode",b=>{t(14,C=b),v&&t(9,v.textContent=_e(b),v)})),i.$$.dirty[0]&320&&(c==null||c.on("timeupdate",b=>h&&t(8,h.textContent=_e(b),h))),i.$$.dirty[0]&64&&(c==null||c.on("pause",()=>{O("pause"),t(10,g=!1)})),i.$$.dirty[0]&64&&(c==null||c.on("play",()=>{O("play"),t(10,g=!0)})),i.$$.dirty[0]&64&&(c==null||c.on("finish",()=>{O("stop"),t(10,g=!1)}))},[n,r,u,f,a,o,c,m,h,v,g,E,I,D,C,y,G,q,ae,s,l,P,F,R,x,$,ee,ue,me]}class Xt extends ye{constructor(e){super(),Ee(this,e,Qt,Kt,De,{mode:0,i18n:1,dispatch_blob:19,waveform_settings:20,waveform_options:2,handle_reset_value:3,editable:4,recording:5},null,[-1,-1])}}function Qe(i){let e;return{c(){e=M("div"),this.h()},l(t){e=A(t,"DIV",{}),B(e).forEach(p),this.h()},h(){Ue(e,"display",i[0]?"block":"none")},m(t,n){z(t,e,n),i[11](e)},p(t,n){n&1&&Ue(e,"display",t[0]?"block":"none")},d(t){t&&p(e),i[11](null)}}}function Zt(i){let e,t,n='<span class="dot"></span>',r,s=i[4]("audio.record")+"",l,u,f;return{c(){e=M("button"),t=M("span"),t.innerHTML=n,r=U(),l=ie(s),this.h()},l(a){e=A(a,"BUTTON",{class:!0});var o=B(e);t=A(o,"SPAN",{class:!0,"data-svelte-h":!0}),Te(t)!=="svelte-1dwz2xe"&&(t.innerHTML=n),r=N(o),l=ne(o,s),o.forEach(p),this.h()},h(){T(t,"class","record-icon"),T(e,"class","record-button svelte-1fz19cj")},m(a,o){z(a,e,o),w(e,t),w(e,r),w(e,l),u||(f=de(e,"click",i[14]),u=!0)},p(a,o){o&16&&s!==(s=a[4]("audio.record")+"")&&oe(l,s)},i:be,o:be,d(a){a&&p(e),u=!1,f()}}}function Wt(i){let e,t,n,r,s=i[4]("audio.waiting")+"",l,u,f,a;return n=new At({}),{c(){e=M("button"),t=M("div"),K(n.$$.fragment),r=U(),l=ie(s),this.h()},l(o){e=A(o,"BUTTON",{class:!0});var d=B(e);t=A(d,"DIV",{class:!0});var c=B(t);Q(n.$$.fragment,c),c.forEach(p),r=N(d),l=ne(d,s),d.forEach(p),this.h()},h(){T(t,"class","icon svelte-1fz19cj"),T(e,"class","spinner-button svelte-1fz19cj")},m(o,d){z(o,e,d),w(e,t),X(n,t,null),w(e,r),w(e,l),u=!0,f||(a=de(e,"click",i[13]),f=!0)},p(o,d){(!u||d&16)&&s!==(s=o[4]("audio.waiting")+"")&&oe(l,s)},i(o){u||(L(n.$$.fragment,o),u=!0)},o(o){S(n.$$.fragment,o),u=!1},d(o){o&&p(e),Z(n),f=!1,a()}}}function xt(i){let e,t,n='<span class="pinger"></span> <span class="dot"></span>',r,s=(i[1]?i[4]("audio.pause"):i[4]("audio.stop"))+"",l,u,f,a;return{c(){e=M("button"),t=M("span"),t.innerHTML=n,r=U(),l=ie(s),this.h()},l(o){e=A(o,"BUTTON",{class:!0});var d=B(e);t=A(d,"SPAN",{class:!0,"data-svelte-h":!0}),Te(t)!=="svelte-bla7qm"&&(t.innerHTML=n),r=N(d),l=ne(d,s),d.forEach(p),this.h()},h(){T(t,"class","record-icon"),T(e,"class",u=Ne(i[1]?"stop-button-paused":"stop-button")+" svelte-1fz19cj")},m(o,d){z(o,e,d),w(e,t),w(e,r),w(e,l),f||(a=de(e,"click",i[12]),f=!0)},p(o,d){d&18&&s!==(s=(o[1]?o[4]("audio.pause"):o[4]("audio.stop"))+"")&&oe(l,s),d&2&&u!==(u=Ne(o[1]?"stop-button-paused":"stop-button")+" svelte-1fz19cj")&&T(e,"class",u)},i:be,o:be,d(o){o&&p(e),f=!1,a()}}}function $t(i){let e,t,n,r,s,l,u,f,a,o=i[5].show_recording_waveform&&Qe(i);const d=[xt,Wt,Zt],c=[];function g(m,D){return m[0]&&!m[6]?0:m[0]&&m[6]?1:2}r=g(i),s=c[r]=d[r](i);function E(m){i[15](m)}let I={i18n:i[4]};return i[9]!==void 0&&(I.micDevices=i[9]),u=new $e({props:I}),j.push(()=>se(u,"micDevices",E)),{c(){e=M("div"),o&&o.c(),t=U(),n=M("div"),s.c(),l=U(),K(u.$$.fragment),this.h()},l(m){e=A(m,"DIV",{class:!0});var D=B(e);o&&o.l(D),t=N(D),n=A(D,"DIV",{class:!0});var h=B(n);s.l(h),l=N(h),Q(u.$$.fragment,h),h.forEach(p),D.forEach(p),this.h()},h(){T(n,"class","controls svelte-1fz19cj"),T(e,"class","mic-wrap svelte-1fz19cj")},m(m,D){z(m,e,D),o&&o.m(e,null),w(e,t),w(e,n),c[r].m(n,null),w(n,l),X(u,n,null),a=!0},p(m,[D]){m[5].show_recording_waveform?o?o.p(m,D):(o=Qe(m),o.c(),o.m(e,t)):o&&(o.d(1),o=null);let h=r;r=g(m),r===h?c[r].p(m,D):(pe(),S(c[h],1,1,()=>{c[h]=null}),we(),s=c[r],s?s.p(m,D):(s=c[r]=d[r](m),s.c()),L(s,1),s.m(n,l));const v={};D&16&&(v.i18n=m[4]),!f&&D&512&&(f=!0,v.micDevices=m[9],le(()=>f=!1)),u.$set(v)},i(m){a||(L(s),L(u.$$.fragment,m),a=!0)},o(m){S(s),S(u.$$.fragment,m),a=!1},d(m){m&&p(e),o&&o.d(),c[r].d(),Z(u)}}}function ei(i,e,t){let{recording:n=!1}=e,{paused_recording:r=!1}=e,{stop:s}=e,{record:l}=e,{i18n:u}=e,{waveform_settings:f}=e,{waveform_options:a={show_recording_waveform:!0}}=e,{waiting:o=!1}=e,d,c,g,E=[];We(()=>{I()});const I=()=>{d!==void 0&&d.destroy(),g&&(d=Le.create({...f,normalize:!1,container:g}),t(7,c=d.registerPlugin(Re.create())))};function m(y){j[y?"unshift":"push"](()=>{g=y,t(8,g)})}const D=()=>{c==null||c.stopMic(),s()},h=()=>{s()},v=()=>{c==null||c.startMic(),l()};function C(y){E=y,t(9,E)}return i.$$set=y=>{"recording"in y&&t(0,n=y.recording),"paused_recording"in y&&t(1,r=y.paused_recording),"stop"in y&&t(2,s=y.stop),"record"in y&&t(3,l=y.record),"i18n"in y&&t(4,u=y.i18n),"waveform_settings"in y&&t(10,f=y.waveform_settings),"waveform_options"in y&&t(5,a=y.waveform_options),"waiting"in y&&t(6,o=y.waiting)},[n,r,s,l,u,a,o,c,g,E,f,m,D,h,v,C]}class ti extends ye{constructor(e){super(),Ee(this,e,ei,$t,De,{recording:0,paused_recording:1,stop:2,record:3,i18n:4,waveform_settings:10,waveform_options:5,waiting:6})}}let Xe;async function ii(){const{MediaRecorder:i,register:e}=await je(()=>import("./module.wlByRTQQ.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url),{connect:t}=await je(()=>import("./module.niXGEr8P.js"),__vite__mapDeps([7,1]),import.meta.url);return e(await t()),Xe=i,Xe}function ni(i){var f;let e,t,n,r,s;e=new xe({props:{i18n:i[13],download:i[10]===null||i[10].includes("download")?i[2].url:null}}),e.$on("clear",i[29]),e.$on("edit",i[48]);function l(a){i[49](a)}let u={value:i[2],subtitles:Array.isArray(i[5])?i[5]:(f=i[5])==null?void 0:f.url,label:i[6],i18n:i[13],dispatch_blob:i[27],waveform_settings:i[14],waveform_options:i[16],trim_region_settings:i[15],handle_reset_value:i[17],editable:i[18],loop:i[8],interactive:!0};return i[25]!==void 0&&(u.mode=i[25]),n=new Bt({props:u}),j.push(()=>se(n,"mode",l)),n.$on("stop",i[50]),n.$on("play",i[51]),n.$on("pause",i[52]),n.$on("edit",i[53]),{c(){K(e.$$.fragment),t=U(),K(n.$$.fragment)},l(a){Q(e.$$.fragment,a),t=N(a),Q(n.$$.fragment,a)},m(a,o){X(e,a,o),z(a,t,o),X(n,a,o),s=!0},p(a,o){var g;const d={};o[0]&8192&&(d.i18n=a[13]),o[0]&1028&&(d.download=a[10]===null||a[10].includes("download")?a[2].url:null),e.$set(d);const c={};o[0]&4&&(c.value=a[2]),o[0]&32&&(c.subtitles=Array.isArray(a[5])?a[5]:(g=a[5])==null?void 0:g.url),o[0]&64&&(c.label=a[6]),o[0]&8192&&(c.i18n=a[13]),o[0]&16384&&(c.waveform_settings=a[14]),o[0]&65536&&(c.waveform_options=a[16]),o[0]&32768&&(c.trim_region_settings=a[15]),o[0]&131072&&(c.handle_reset_value=a[17]),o[0]&262144&&(c.editable=a[18]),o[0]&256&&(c.loop=a[8]),!r&&o[0]&33554432&&(r=!0,c.mode=a[25],le(()=>r=!1)),n.$set(c)},i(a){s||(L(e.$$.fragment,a),L(n.$$.fragment,a),s=!0)},o(a){S(e.$$.fragment,a),S(n.$$.fragment,a),s=!1},d(a){a&&p(t),Z(e,a),Z(n,a)}}}function oi(i){let e,t,n,r;const s=[si,ri],l=[];function u(f,a){return f[3]==="microphone"?0:f[3]==="upload"?1:-1}return~(e=u(i))&&(t=l[e]=s[e](i)),{c(){t&&t.c(),n=ve()},l(f){t&&t.l(f),n=ve()},m(f,a){~e&&l[e].m(f,a),z(f,n,a),r=!0},p(f,a){let o=e;e=u(f),e===o?~e&&l[e].p(f,a):(t&&(pe(),S(l[o],1,1,()=>{l[o]=null}),we()),~e?(t=l[e],t?t.p(f,a):(t=l[e]=s[e](f),t.c()),L(t,1),t.m(n.parentNode,n)):t=null)},i(f){r||(L(t),r=!0)},o(f){S(t),r=!1},d(f){f&&p(n),~e&&l[e].d(f)}}}function ri(i){let e,t,n,r;function s(f){i[45](f)}function l(f){i[46](f)}let u={filetype:"audio/aac,audio/midi,audio/mpeg,audio/ogg,audio/wav,audio/x-wav,audio/opus,audio/webm,audio/flac,audio/vnd.rn-realaudio,audio/x-ms-wma,audio/x-aiff,audio/amr,audio/*",root:i[7],max_file_size:i[19],upload:i[20],stream_handler:i[21],aria_label:i[13]("audio.drop_to_upload"),$$slots:{default:[li]},$$scope:{ctx:i}};return i[0]!==void 0&&(u.dragging=i[0]),i[4]!==void 0&&(u.uploading=i[4]),e=new Rt({props:u}),j.push(()=>se(e,"dragging",s)),j.push(()=>se(e,"uploading",l)),e.$on("load",i[30]),e.$on("error",i[47]),{c(){K(e.$$.fragment)},l(f){Q(e.$$.fragment,f)},m(f,a){X(e,f,a),r=!0},p(f,a){const o={};a[0]&128&&(o.root=f[7]),a[0]&524288&&(o.max_file_size=f[19]),a[0]&1048576&&(o.upload=f[20]),a[0]&2097152&&(o.stream_handler=f[21]),a[0]&8192&&(o.aria_label=f[13]("audio.drop_to_upload")),a[1]&16777216&&(o.$$scope={dirty:a,ctx:f}),!t&&a[0]&1&&(t=!0,o.dragging=f[0],le(()=>t=!1)),!n&&a[0]&16&&(n=!0,o.uploading=f[4],le(()=>n=!1)),e.$set(o)},i(f){r||(L(e.$$.fragment,f),r=!0)},o(f){S(e.$$.fragment,f),r=!1},d(f){Z(e,f)}}}function si(i){let e,t,n,r,s,l;e=new xe({props:{i18n:i[13]}}),e.$on("clear",i[29]);const u=[ui,ai],f=[];function a(o,d){return o[12]?0:1}return n=a(i),r=f[n]=u[n](i),{c(){K(e.$$.fragment),t=U(),r.c(),s=ve()},l(o){Q(e.$$.fragment,o),t=N(o),r.l(o),s=ve()},m(o,d){X(e,o,d),z(o,t,d),f[n].m(o,d),z(o,s,d),l=!0},p(o,d){const c={};d[0]&8192&&(c.i18n=o[13]),e.$set(c);let g=n;n=a(o),n===g?f[n].p(o,d):(pe(),S(f[g],1,1,()=>{f[g]=null}),we(),r=f[n],r?r.p(o,d):(r=f[n]=u[n](o),r.c()),L(r,1),r.m(s.parentNode,s))},i(o){l||(L(e.$$.fragment,o),L(r),l=!0)},o(o){S(e.$$.fragment,o),S(r),l=!1},d(o){o&&(p(t),p(s)),Z(e,o),f[n].d(o)}}}function li(i){let e;const t=i[40].default,n=kt(t,i,i[55],null);return{c(){n&&n.c()},l(r){n&&n.l(r)},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s[1]&16777216)&&yt(n,t,r,r[55],e?Dt(t,r[55],s,null):Et(r[55]),null)},i(r){e||(L(n,r),e=!0)},o(r){S(n,r),e=!1},d(r){n&&n.d(r)}}}function ai(i){let e,t,n;function r(l){i[41](l)}let s={i18n:i[13],editable:i[18],recording:i[1],dispatch_blob:i[27],waveform_settings:i[14],waveform_options:i[16],handle_reset_value:i[17]};return i[25]!==void 0&&(s.mode=i[25]),e=new Xt({props:s}),j.push(()=>se(e,"mode",r)),e.$on("start_recording",i[42]),e.$on("pause_recording",i[43]),e.$on("stop_recording",i[44]),{c(){K(e.$$.fragment)},l(l){Q(e.$$.fragment,l)},m(l,u){X(e,l,u),n=!0},p(l,u){const f={};u[0]&8192&&(f.i18n=l[13]),u[0]&262144&&(f.editable=l[18]),u[0]&2&&(f.recording=l[1]),u[0]&16384&&(f.waveform_settings=l[14]),u[0]&65536&&(f.waveform_options=l[16]),u[0]&131072&&(f.handle_reset_value=l[17]),!t&&u[0]&33554432&&(t=!0,f.mode=l[25],le(()=>t=!1)),e.$set(f)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){Z(e,l)}}}function ui(i){let e,t;return e=new ti({props:{record:i[28],recording:i[1],stop:i[31],i18n:i[13],waveform_settings:i[14],waveform_options:i[16],waiting:i[24]==="waiting"}}),{c(){K(e.$$.fragment)},l(n){Q(e.$$.fragment,n)},m(n,r){X(e,n,r),t=!0},p(n,r){const s={};r[0]&2&&(s.recording=n[1]),r[0]&8192&&(s.i18n=n[13]),r[0]&16384&&(s.waveform_settings=n[14]),r[0]&65536&&(s.waveform_options=n[16]),r[0]&16777216&&(s.waiting=n[24]==="waiting"),e.$set(s)},i(n){t||(L(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function fi(i){let e,t,n,r,s,l,u,f,a,o,d,c;e=new It({props:{show_label:i[9],Icon:Mt,float:i[3]==="upload"&&i[2]===null,label:i[6]||i[13]("audio.audio")}}),r=new Pt({props:{time_limit:i[23]}});const g=[oi,ni],E=[];function I(h,v){return h[2]===null||h[12]?0:1}l=I(i),u=E[l]=g[l](i);function m(h){i[54](h)}let D={sources:i[11],handle_clear:i[29]};return i[3]!==void 0&&(D.active_source=i[3]),a=new Lt({props:D}),j.push(()=>se(a,"active_source",m)),{c(){K(e.$$.fragment),t=U(),n=M("div"),K(r.$$.fragment),s=U(),u.c(),f=U(),K(a.$$.fragment),this.h()},l(h){Q(e.$$.fragment,h),t=N(h),n=A(h,"DIV",{class:!0});var v=B(n);Q(r.$$.fragment,v),s=N(v),u.l(v),f=N(v),Q(a.$$.fragment,v),v.forEach(p),this.h()},h(){T(n,"class",d="audio-container "+i[22]+" svelte-1ud6e7m")},m(h,v){X(e,h,v),z(h,t,v),z(h,n,v),X(r,n,null),w(n,s),E[l].m(n,null),w(n,f),X(a,n,null),c=!0},p(h,v){const C={};v[0]&512&&(C.show_label=h[9]),v[0]&12&&(C.float=h[3]==="upload"&&h[2]===null),v[0]&8256&&(C.label=h[6]||h[13]("audio.audio")),e.$set(C);const y={};v[0]&8388608&&(y.time_limit=h[23]),r.$set(y);let Y=l;l=I(h),l===Y?E[l].p(h,v):(pe(),S(E[Y],1,1,()=>{E[Y]=null}),we(),u=E[l],u?u.p(h,v):(u=E[l]=g[l](h),u.c()),L(u,1),u.m(n,f));const G={};v[0]&2048&&(G.sources=h[11]),!o&&v[0]&8&&(o=!0,G.active_source=h[3],le(()=>o=!1)),a.$set(G),(!c||v[0]&4194304&&d!==(d="audio-container "+h[22]+" svelte-1ud6e7m"))&&T(n,"class",d)},i(h){c||(L(e.$$.fragment,h),L(r.$$.fragment,h),L(u),L(a.$$.fragment,h),c=!0)},o(h){S(e.$$.fragment,h),S(r.$$.fragment,h),S(u),S(a.$$.fragment,h),c=!1},d(h){h&&(p(t),p(n)),Z(e,h),Z(r),E[l].d(),Z(a)}}}const Ze=44;function ci(i,e,t){let{$$slots:n={},$$scope:r}=e,{value:s=null}=e,{subtitles:l=null}=e,{label:u}=e,{root:f}=e,{loop:a}=e,{show_label:o=!0}=e,{buttons:d=["download","share"]}=e,{sources:c=["microphone","upload"]}=e,{pending:g=!1}=e,{streaming:E=!1}=e,{i18n:I}=e,{waveform_settings:m}=e,{trim_region_settings:D={}}=e,{waveform_options:h={}}=e,{dragging:v}=e,{active_source:C}=e,{handle_reset_value:y=()=>{}}=e,{editable:Y=!0}=e,{max_file_size:G=null}=e,{upload:q}=e,{stream_handler:re}=e,{stream_every:O}=e,{uploading:k=!1}=e,{recording:W=!1}=e,{class_name:V=""}=e,ce=null,ae="closed";const P=_=>{_==="closed"?(t(23,ce=null),t(24,ae="closed")):_==="waiting"?t(24,ae="waiting"):t(24,ae="open")},F=_=>{W&&t(23,ce=_)};let R,x="",$,ee=[],ue=!1,me=!1,b,J=[];typeof window<"u"&&E&&ii().then(_=>{b=_});const H=Pe(),fe=async(_,te)=>{var Ce;let ke=new File(_,"audio.wav");const Ie=await Tt([ke],te==="stream");t(2,s=(Ce=await q(Ie,f,void 0,G||void 0))==null?void 0:Ce.filter(Boolean)[0]),H(te,s)};wt(()=>{E&&R&&R.state!=="inactive"&&R.stop()});async function et(){let _;try{_=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(te){if(!navigator.mediaDevices){H("error",I("audio.no_device_support"));return}if(te instanceof DOMException&&te.name=="NotAllowedError"){H("error",I("audio.allow_recording_access"));return}throw te}_!=null&&(E?(t(36,R=new b(_,{mimeType:"audio/wav"})),R.addEventListener("dataavailable",tt)):(t(36,R=new MediaRecorder(_)),R.addEventListener("dataavailable",te=>{J.push(te.data)})),R.addEventListener("stop",async()=>{t(1,W=!1),await fe(J,"change"),await fe(J,"stop_recording"),J=[]}),me=!0)}async function tt(_){let te=await _.data.arrayBuffer(),ke=new Uint8Array(te);if($||(t(37,$=new Uint8Array(te.slice(0,Ze))),ke=new Uint8Array(te.slice(Ze))),g)ee.push(ke);else{let Ie=[$].concat(ee,[ke]);if(!W||ae==="waiting")return;fe(Ie,"stream"),t(38,ee=[])}}async function Se(){t(1,W=!0),H("start_recording"),me||await et(),t(37,$=void 0),E&&R.state!="recording"&&R.start(O*1e3)}function it(){H("change",null),H("clear"),t(25,x=""),t(2,s=null)}function nt({detail:_}){t(2,s=_),H("change",_),H("upload",_)}async function Be(){t(1,W=!1),E&&(H("close_stream"),H("stop_recording"),R.stop(),g&&t(39,ue=!0),fe(J,"stop_recording"),H("clear"),t(25,x=""))}function ot(_){x=_,t(25,x)}function rt(_){ge.call(this,i,_)}function st(_){ge.call(this,i,_)}function lt(_){ge.call(this,i,_)}function at(_){v=_,t(0,v)}function ut(_){k=_,t(4,k)}const ft=({detail:_})=>H("error",_),ct=()=>t(25,x="edit");function dt(_){x=_,t(25,x)}function _t(_){ge.call(this,i,_)}function mt(_){ge.call(this,i,_)}function ht(_){ge.call(this,i,_)}function gt(_){ge.call(this,i,_)}function bt(_){C=_,t(3,C)}return i.$$set=_=>{"value"in _&&t(2,s=_.value),"subtitles"in _&&t(5,l=_.subtitles),"label"in _&&t(6,u=_.label),"root"in _&&t(7,f=_.root),"loop"in _&&t(8,a=_.loop),"show_label"in _&&t(9,o=_.show_label),"buttons"in _&&t(10,d=_.buttons),"sources"in _&&t(11,c=_.sources),"pending"in _&&t(32,g=_.pending),"streaming"in _&&t(12,E=_.streaming),"i18n"in _&&t(13,I=_.i18n),"waveform_settings"in _&&t(14,m=_.waveform_settings),"trim_region_settings"in _&&t(15,D=_.trim_region_settings),"waveform_options"in _&&t(16,h=_.waveform_options),"dragging"in _&&t(0,v=_.dragging),"active_source"in _&&t(3,C=_.active_source),"handle_reset_value"in _&&t(17,y=_.handle_reset_value),"editable"in _&&t(18,Y=_.editable),"max_file_size"in _&&t(19,G=_.max_file_size),"upload"in _&&t(20,q=_.upload),"stream_handler"in _&&t(21,re=_.stream_handler),"stream_every"in _&&t(33,O=_.stream_every),"uploading"in _&&t(4,k=_.uploading),"recording"in _&&t(1,W=_.recording),"class_name"in _&&t(22,V=_.class_name),"$$scope"in _&&t(55,r=_.$$scope)},i.$$.update=()=>{if(i.$$.dirty[0]&1&&H("drag",v),i.$$.dirty[1]&450&&ue&&g===!1&&(t(39,ue=!1),$&&ee)){let _=[$].concat(ee);t(38,ee=[]),fe(_,"stream")}i.$$.dirty[0]&2|i.$$.dirty[1]&32&&!W&&R&&Be(),i.$$.dirty[0]&2|i.$$.dirty[1]&32&&W&&R&&Se()},[v,W,s,C,k,l,u,f,a,o,d,c,E,I,m,D,h,y,Y,G,q,re,V,ce,ae,x,H,fe,Se,it,nt,Be,g,O,P,F,R,$,ee,ue,n,ot,rt,st,lt,at,ut,ft,ct,dt,_t,mt,ht,gt,bt,r]}class di extends ye{constructor(e){super(),Ee(this,e,ci,fi,De,{value:2,subtitles:5,label:6,root:7,loop:8,show_label:9,buttons:10,sources:11,pending:32,streaming:12,i18n:13,waveform_settings:14,trim_region_settings:15,waveform_options:16,dragging:0,active_source:3,handle_reset_value:17,editable:18,max_file_size:19,upload:20,stream_handler:21,stream_every:33,uploading:4,recording:1,class_name:22,modify_stream:34,set_time_limit:35},null,[-1,-1])}get modify_stream(){return this.$$.ctx[34]}get set_time_limit(){return this.$$.ctx[35]}}const Ti=di;export{Ti as I};
//# sourceMappingURL=InteractiveAudio.DyGJoLNZ.js.map
