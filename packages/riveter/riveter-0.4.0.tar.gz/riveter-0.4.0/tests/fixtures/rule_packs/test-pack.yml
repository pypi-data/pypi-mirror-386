metadata:
  name: test-pack
  version: 1.0.0
  description: Test rule pack for unit testing
  author: Test Author
  created: 2024-01-01
  updated: 2024-01-01
  dependencies: []
  tags: [test, example]
  min_riveter_version: 0.1.0

rules:
  - id: test_rule_1
    resource_type: aws_instance
    description: Test rule for EC2 instances
    severity: error
    filter:
      tags.Environment: production
    assert:
      instance_type:
        regex: "^(t3|m5)\\.(large|xlarge)$"
    metadata:
      tags: [ec2, test]
      references: ["https://example.com"]

  - id: test_rule_2
    resource_type: aws_s3_bucket
    description: Test rule for S3 buckets
    severity: warning
    assert:
      versioning.enabled: true
    metadata:
      tags: [s3, test]
      references: ["https://example.com"]
