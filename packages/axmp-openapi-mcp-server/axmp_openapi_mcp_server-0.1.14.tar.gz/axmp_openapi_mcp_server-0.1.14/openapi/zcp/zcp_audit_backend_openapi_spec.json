{
    "openapi": "3.0.1",
    "info": {
       "title": "ZMP AuditLog Backend",
       "description": "ZMP AuditLog Backend API",
       "version": "v1.0.0"
    },
    "servers": [
       {
          "url": "https://api.ags.cloudzcp.net"
       },
       {
          "url": "/"
       }
    ],
    "paths": {
       "/api/audit/v1/event-logs/config": {
          "get": {
             "tags": [
                "event-log-config-controller"
             ],
             "operationId": "getEventLogConfig",
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          },
          "put": {
             "tags": [
                "event-log-config-controller"
             ],
             "operationId": "updateEventLogConfig",
             "requestBody": {
                "content": {
                   "application/json": {
                      "schema": {
                         "$ref": "#/components/schemas/EventLogConfigVO"
                      }
                   }
                },
                "required": true
             },
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          }
       },
       "/api/audit/v1/external/event-logs": {
          "post": {
             "tags": [
                "external-event-log-controller"
             ],
             "operationId": "createEventLog",
             "requestBody": {
                "content": {
                   "application/json": {
                      "schema": {
                         "$ref": "#/components/schemas/EventLog"
                      }
                   }
                },
                "required": true
             },
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          }
       },
       "/api/audit/v1/event-logs": {
          "get": {
             "tags": [
                "event-log-controller"
             ],
             "operationId": "getEventLogList",
             "parameters": [
                {
                   "name": "source",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string",
                         "enum": [
                            "KEYCLOAK",
                            "K8S",
                            "CONSOLE"
                         ]
                      }
                   }
                },
                {
                   "name": "actionType",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "resourceType",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "username",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "ip",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "fromDate",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date"
                   }
                },
                {
                   "name": "toDate",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date"
                   }
                },
                {
                   "name": "fromDatetime",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date-time"
                   }
                },
                {
                   "name": "toDatetime",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date-time"
                   }
                },
                {
                   "name": "resourceUuid",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "cluster",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "projectKey",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "resourceUsername",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "requestUri",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "requestResource",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "page",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "integer",
                      "format": "int32",
                      "default": 0
                   }
                },
                {
                   "name": "size",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "integer",
                      "format": "int32",
                      "default": 10
                   }
                },
                {
                   "name": "sort",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "default": "timeInMillis"
                   }
                },
                {
                   "name": "direction",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "default": "DESC",
                      "enum": [
                         "ASC",
                         "DESC"
                      ]
                   }
                }
             ],
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          },
          "post": {
             "tags": [
                "event-log-controller"
             ],
             "operationId": "createEventLog_1",
             "requestBody": {
                "content": {
                   "application/json": {
                      "schema": {
                         "$ref": "#/components/schemas/EventLog"
                      }
                   }
                },
                "required": true
             },
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          },
          "delete": {
             "tags": [
                "event-log-controller"
             ],
             "operationId": "deleteEventLog",
             "requestBody": {
                "content": {
                   "application/json": {
                      "schema": {
                         "$ref": "#/components/schemas/EventLog"
                      }
                   }
                },
                "required": true
             },
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          }
       },
       "/api/audit/v1/event-logs/{id}": {
          "get": {
             "tags": [
                "event-log-controller"
             ],
             "operationId": "getEventLog",
             "parameters": [
                {
                   "name": "id",
                   "in": "path",
                   "required": true,
                   "schema": {
                      "type": "string"
                   }
                }
             ],
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          }
       },
       "/api/audit/v1/event-logs/init-data": {
          "get": {
             "tags": [
                "event-log-controller"
             ],
             "operationId": "getInitData",
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          }
       },
       "/api/audit/v1/event-logs/export": {
          "get": {
             "tags": [
                "event-log-controller"
             ],
             "operationId": "export",
             "parameters": [
                {
                   "name": "source",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string",
                         "enum": [
                            "KEYCLOAK",
                            "K8S",
                            "CONSOLE"
                         ]
                      }
                   }
                },
                {
                   "name": "actionType",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "resourceType",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "username",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "ip",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "fromDate",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date"
                   }
                },
                {
                   "name": "toDate",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date"
                   }
                },
                {
                   "name": "fromDatetime",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date-time"
                   }
                },
                {
                   "name": "toDatetime",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "format": "date-time"
                   }
                },
                {
                   "name": "resourceUuid",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "cluster",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "projectKey",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "resourceUsername",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "requestUri",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "requestResource",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "array",
                      "items": {
                         "type": "string"
                      }
                   }
                },
                {
                   "name": "sort",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "default": "timeInMillis"
                   }
                },
                {
                   "name": "direction",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "string",
                      "default": "DESC",
                      "enum": [
                         "ASC",
                         "DESC"
                      ]
                   }
                }
             ],
             "responses": {
                "200": {
                   "description": "OK"
                }
             }
          }
       },
       "/api/audit/v1/event-logs/config/init-data": {
          "get": {
             "tags": [
                "event-log-config-controller"
             ],
             "operationId": "getInitData_1",
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          }
       },
       "/api/audit/v1/dashboard": {
          "get": {
             "tags": [
                "dashboard-controller"
             ],
             "operationId": "dashboard",
             "parameters": [
                {
                   "name": "panelType",
                   "in": "query",
                   "required": true,
                   "schema": {
                      "type": "string",
                      "enum": [
                         "loginCountOverLast30Days",
                         "loginCountOverThisYear",
                         "loginCountOfToday",
                         "loginCountByUser",
                         "loginFailCountByUser",
                         "requestCountByUserAgent",
                         "requestCountByResourceType",
                         "requestCountByUri",
                         "requestFailCountByUri",
                         "requestCountPerResponseCodeOverThisYear",
                         "requestCountPerResponseCodeOverLast30Days",
                         "longestResponseTimeByUri",
                         "requestCountByCluster",
                         "requestCountByNamespace",
                         "requestCountByResource",
                         "requestCountByActionType",
                         "requestCountPerActionTypeOverThisYear",
                         "requestCountPerActionTypeOverLast30Days",
                         "requestCountByUser"
                      ]
                   }
                },
                {
                   "name": "startDate",
                   "in": "query",
                   "required": true,
                   "schema": {
                      "type": "string",
                      "format": "date"
                   }
                },
                {
                   "name": "endDate",
                   "in": "query",
                   "required": true,
                   "schema": {
                      "type": "string",
                      "format": "date"
                   }
                },
                {
                   "name": "limit",
                   "in": "query",
                   "required": false,
                   "schema": {
                      "type": "integer",
                      "format": "int32",
                      "default": 5
                   }
                }
             ],
             "responses": {
                "200": {
                   "description": "OK",
                   "content": {
                      "*/*": {
                         "schema": {
                            "type": "object"
                         }
                      }
                   }
                }
             }
          }
       }
    },
    "components": {
       "schemas": {
          "ConfigVO": {
             "type": "object",
             "properties": {
                "retentionPeriodInDays": {
                   "type": "integer",
                   "format": "int32"
                },
                "retentionPeriodInWeeks": {
                   "type": "integer",
                   "format": "int32"
                },
                "retentionPeriodInMonths": {
                   "type": "integer",
                   "format": "int32"
                },
                "retentionPeriodInYears": {
                   "type": "integer",
                   "format": "int32"
                },
                "payloadStoreEnable": {
                   "type": "boolean"
                },
                "logStoreEnable": {
                   "type": "boolean"
                },
                "k8sConfigs": {
                   "type": "object",
                   "additionalProperties": {
                      "$ref": "#/components/schemas/K8sConfigVO"
                   }
                },
                "storedTypes": {
                   "type": "array",
                   "items": {
                      "type": "string"
                   }
                },
                "namespaceSelectorOperator": {
                   "type": "string"
                },
                "namespaceSelectorValues": {
                   "type": "array",
                   "items": {
                      "type": "string"
                   }
                },
                "storedTypesForKeycloakUser": {
                   "type": "array",
                   "items": {
                      "type": "string"
                   }
                },
                "storedTypesForKeycloakAdmin": {
                   "type": "array",
                   "items": {
                      "type": "string"
                   }
                },
                "isArchive": {
                   "type": "boolean"
                },
                "storageType": {
                   "type": "string",
                   "enum": [
                      "S3",
                      "SFTP",
                      "NAS"
                   ]
                },
                "s3AccessKeyId": {
                   "type": "string"
                },
                "s3SecretAccessKey": {
                   "type": "string"
                },
                "s3Bucket": {
                   "type": "string"
                },
                "s3Region": {
                   "type": "string"
                },
                "sftpRemoteHost": {
                   "type": "string"
                },
                "sftpRemoteFolder": {
                   "type": "string"
                },
                "sftpUsername": {
                   "type": "string"
                },
                "sftpPassword": {
                   "type": "string"
                },
                "nasUsername": {
                   "type": "string"
                },
                "nasPassword": {
                   "type": "string"
                },
                "nasFolder": {
                   "type": "string"
                },
                "executionTime": {
                   "type": "string"
                }
             }
          },
          "EventLogConfigVO": {
             "type": "object",
             "properties": {
                "createTime": {
                   "type": "string",
                   "format": "date-time"
                },
                "updateTime": {
                   "type": "string",
                   "format": "date-time"
                },
                "creator": {
                   "type": "string"
                },
                "objectId": {
                   "type": "string"
                },
                "zcp": {
                   "$ref": "#/components/schemas/ConfigVO"
                },
                "k8s": {
                   "$ref": "#/components/schemas/ConfigVO"
                },
                "keyCloak": {
                   "$ref": "#/components/schemas/ConfigVO"
                }
             }
          },
          "K8sConfigVO": {
             "type": "object",
             "properties": {
                "payloadStoreEnable": {
                   "type": "boolean"
                },
                "logStoreEnable": {
                   "type": "boolean"
                },
                "storedTypes": {
                   "type": "array",
                   "items": {
                      "type": "string"
                   }
                },
                "namespaceSelectorOperator": {
                   "type": "string"
                },
                "namespaceSelectorValues": {
                   "type": "array",
                   "items": {
                      "type": "string"
                   }
                }
             }
          },
          "EventLog": {
             "required": [
                "id",
                "source"
             ],
             "type": "object",
             "properties": {
                "createTime": {
                   "type": "string",
                   "format": "date-time"
                },
                "updateTime": {
                   "type": "string",
                   "format": "date-time"
                },
                "creator": {
                   "type": "string"
                },
                "id": {
                   "type": "string"
                },
                "realm": {
                   "type": "string"
                },
                "source": {
                   "type": "string",
                   "enum": [
                      "KEYCLOAK",
                      "K8S",
                      "CONSOLE"
                   ]
                },
                "username": {
                   "type": "string"
                },
                "timeInMillis": {
                   "type": "integer",
                   "format": "int64"
                },
                "ipAddress": {
                   "type": "string"
                },
                "resourceType": {
                   "type": "string"
                },
                "actionType": {
                   "type": "string"
                },
                "resourceUuid": {
                   "type": "string"
                },
                "clientId": {
                   "type": "string"
                },
                "client": {
                   "type": "string"
                },
                "userId": {
                   "type": "string"
                },
                "firstName": {
                   "type": "string"
                },
                "lastName": {
                   "type": "string"
                },
                "email": {
                   "type": "string"
                },
                "representation": {
                   "type": "string"
                },
                "scheme": {
                   "type": "string"
                },
                "host": {
                   "type": "string"
                },
                "requestUri": {
                   "type": "string"
                },
                "method": {
                   "type": "string"
                },
                "query": {
                   "type": "string"
                },
                "headersUserAgent": {
                   "type": "string"
                },
                "headersXForwarded": {
                   "type": "string"
                },
                "requestTime": {
                   "type": "string"
                },
                "responseTime": {
                   "type": "string"
                },
                "duration": {
                   "type": "integer",
                   "format": "int64"
                },
                "responseHttpStatus": {
                   "type": "integer",
                   "format": "int32"
                },
                "referer": {
                   "type": "string"
                },
                "requestBody": {
                   "type": "string"
                },
                "responseBody": {
                   "type": "string"
                },
                "realmId": {
                   "type": "string"
                },
                "projectKey": {
                   "type": "string"
                },
                "projectName": {
                   "type": "string"
                },
                "servletPath": {
                   "type": "string"
                },
                "resourceUserId": {
                   "type": "string"
                },
                "resourceUsername": {
                   "type": "string"
                },
                "uid": {
                   "type": "string"
                },
                "cluster": {
                   "type": "string"
                },
                "namespace": {
                   "type": "string"
                },
                "requestKind": {
                   "type": "object"
                },
                "requestResource": {
                   "type": "object"
                },
                "name": {
                   "type": "string"
                },
                "userInfo": {
                   "type": "object"
                },
                "object": {
                   "type": "string"
                },
                "oldObject": {
                   "type": "string"
                }
             }
          }
       }
    }
 }