apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-agent-config
data:
  agent.yaml: |
    metrics:
      wal_directory: /tmp/agent/wal
      global:
        scrape_interval: ${SCRAPE_INTERVAL:5s}
      configs:
        - name: svc-infra
          scrape_configs:
            - job_name: svc-infra
              scheme: http
              metrics_path: /metrics
              static_configs:
                - targets: ["localhost:8000"]
          remote_write:
            - url: ${GRAFANA_CLOUD_PROM_URL}
              basic_auth:
                username: ${GRAFANA_CLOUD_PROM_USERNAME}
                password: ${GRAFANA_CLOUD_TOKEN}
