{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "description": "MANDATORY output structure for follow-up agent responses. You must always provide your reasoning and follow-up decision.",
  "properties": {
    "chain_of_thought": {
      "type": "object",
      "description": "REQUIRED: Your reasoning process and follow-up decision explanation",
      "properties": {
        "trigger": {
          "type": "string",
          "description": "Type of event triggering this follow-up evaluation",
          "enum": ["follow_up"]
        },
        "trigger_id": {
          "type": "string",
          "description": "ID of the smart follow-up workflow triggering this evaluation"
        },
        "chatty_ai_agent_id": {
          "type": "string",
          "description": "Your follow-up AI agent identifier"
        },
        "chain_of_thought": {
          "type": "string",
          "description": "Your detailed reasoning explaining why you chose this follow-up action, considering conversation context, timing, and strategy objectives"
        },
        "title": {
          "type": "string",
          "description": "Short preview title summarizing your follow-up decision (e.g., 'Sending 2nd follow-up on proposal', 'Skipping - customer needs time')"
        }
      },
      "required": [
        "trigger",
        "trigger_id",
        "chatty_ai_agent_id",
        "chain_of_thought",
        "title",
        "confidence"
      ],
      "additionalProperties": false
    },
    "follow_up_action": {
      "type": "object",
      "description": "Your follow-up decision and execution details",
      "properties": {
        "action": {
          "type": "string",
          "description": "Follow-up action to take: 'send' for automatic message, 'skip' to postpone, 'suggest' for human review, 'remove' to stop all follow-ups",
          "enum": ["send", "skip", "suggest", "remove"]
        },
        "payload": {
          "type": "object",
          "description": "Action payload - required for 'send' and 'suggest', optional for 'skip', omit for 'remove'",
          "properties": {
            "messages": {
              "type": "array",
              "description": "Array of follow-up messages to send (for send/suggest actions)",
              "items": {
                "type": "string",
                "description": "The actual follow-up message text"
              }
            },
            "next_call": {
              "type": "string",
              "description": "ISO 8601 timestamp for next follow-up attempt (required for send/skip/suggest, omit for remove)",
              "format": "date-time"
            }
          },
          "additionalProperties": false
        }
      },
      "required": ["action"],
      "additionalProperties": false
    }
  },
  "required": ["chain_of_thought", "follow_up_action"],
  "additionalProperties": false
}
