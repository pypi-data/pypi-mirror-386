# Pre-commit Setup

This project uses pre-commit hooks to maintain code quality and prevent large files from being committed to git.

## What's Configured

### 1. Notebook Output Stripping (`nbstripout`)
- **Purpose**: Automatically removes outputs from Jupyter notebooks before committing
- **Why**: Widget outputs contain large JavaScript bundles (~1.9MB per widget), which bloat the repository
- **What it does**: Clears all cell outputs while preserving the notebook code and markdown

### 2. Basic File Checks
- **Trailing whitespace**: Removes trailing whitespace from files
- **End of file fixer**: Ensures files end with a newline
- **YAML check**: Validates YAML files
- **Large files check**: Prevents committing files larger than 1MB

## Installation

Pre-commit hooks are automatically installed when you run:

```bash
uv sync --group dev
uv run pre-commit install
```

## Usage

### Automatic (Recommended)
Once installed, hooks run automatically on `git commit`. If a notebook has outputs, they will be stripped automatically.

### Manual
Run hooks on all files:
```bash
uv run pre-commit run --all-files
```

Run on specific files:
```bash
uv run pre-commit run --files path/to/file.ipynb
```

## Documentation Build

Notebooks are stored **without outputs** in git. During documentation build, MkDocs executes all notebooks to generate fresh outputs.

### Configuration (`mkdocs.yml`)
```yaml
plugins:
  - mkdocs-jupyter:
      execute: true          # Execute notebooks during build
      allow_errors: false    # Fail build on execution errors
      kernel_name: python3
```

### Building Docs
```bash
uv run mkdocs build  # Executes all notebooks and builds docs
uv run mkdocs serve  # Development server with live reload
```

**Note**: Notebook execution during docs build does NOT mutate the source notebooks - outputs are only generated in the build artifacts.

## Benefits

1. **Smaller repository**: Notebooks without outputs are ~98% smaller
2. **Clean diffs**: Git diffs show only code changes, not output changes
3. **No conflicts**: Eliminates merge conflicts from output cells
4. **Fresh outputs**: Documentation always shows current execution results
5. **Security**: Prevents accidentally committing sensitive data in outputs
